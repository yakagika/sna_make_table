<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE  BangPatterns, StrictData #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">{- |
      Module     : V
      Copyright  : (c) Kaya Akagi. 2018-2019
      Maintainer : akagi15@cs.dis.titech.ac.jp

      V&#34920;&#20316;&#34920;&#12398;&#12383;&#12417;&#12398;&#12514;&#12472;&#12517;&#12540;&#12523; 
      
      * &#34920;&#35352;&#12434;&#12510;&#12491;&#12517;&#12450;&#12523;&#12392;&#32113;&#19968;&#12377;&#12427;&#12383;&#12417;&#12395;&#26085;&#26412;&#35486;&#12434;&#20351;&#12387;&#12390;&#12356;&#12427;&#12398;&#12391;,&#31561;&#24133;&#12501;&#12457;&#12531;&#12488;&#25512;&#22888;
      * &#12467;&#12513;&#12531;&#12488;&#12398;&#23383;&#19979;&#12370;&#12399;,&#20316;&#32773;&#12398;&#12486;&#12461;&#12473;&#12488;&#12456;&#12487;&#12451;&#12479;(SublimeText3)&#12395;&#26368;&#36969;&#21270;&#12373;&#12428;&#12390;&#12356;&#12427;.
      * &#12456;&#12531;&#12467;&#12540;&#12487;&#12451;&#12531;&#12464;&#12395;&#38306;&#12375;&#12390;
         
         &gt; &#20837;&#20986;&#21147;&#12418;&#21547;&#12417;&#12390;&#12377;&#12409;&#12390;UTF-8&#12391;&#32113;&#19968;&#12377;&#12427;
         &gt; Windows&#12391;&#12398;&#36215;&#21205;&#12399;&#24819;&#23450;&#12375;&#12390;&#12356;&#12394;&#12356;&#12398;&#65292;Docker&#12434;&#21033;&#29992;&#12375;&#12390;&#65292;Linux&#19978;&#12391;&#21205;&#12363;&#12377;&#12371;&#12392;
         &gt; Docker for Windows &#12434;&#21033;&#29992;&#12377;&#12427;&#22580;&#21512;&#12399;chcp 65001&#12434;&#12375;&#12394;&#12356;&#12392;TemplateHaskell&#37096;&#20998;&#12398;&#12467;&#12531;&#12497;&#12452;&#12523;&#12364;&#36890;&#12425;&#12394;&#12356;&#65294;
 
      * &#12487;&#12540;&#12479;&#22411;&#12398;&#31777;&#21336;&#12394;&#35211;&#26041;
 
      &gt; f :: A -&gt; B -&gt; C
      &gt; A &#12392; B &#12434;&#24341;&#25968;&#12395;&#12392;&#12387;&#12390;&#65292;C&#12364;&#36820;&#12427;&#65294;


      * &#20966;&#29702;&#12395;&#12513;&#12514;&#12522;&#12364;&#36275;&#12426;&#12394;&#12356;&#12398;&#12391;&#65292;Conduit &#12434;&#29992;&#12356;&#12390;&#36880;&#27425;&#20966;&#29702;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;
-}</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">V</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Vector</span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Vector</span><span>                     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Vector.Mutable</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MV</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Map.Strict</span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Map.Strict</span><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Text</span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Text.Lazy</span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TL</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Text.IO</span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TO</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Text.Lazy.IO</span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TLO</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.List</span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Maybe</span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Semigroup</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Array.IArray</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Array.ST</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Array.IO</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Ix</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.STRef</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.IORef</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">GHC.Err</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Monad.ST</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.STRef</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.IORef</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Either</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">System.IO</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">System.Process</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Text.Read</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Debug.Trace</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Monad.IO.Class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftIO</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- import              Contorl.Monad.ST.Class (liftST, MonadST)</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">--  for pararel </span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Parallel.Strategies</span><span>     </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parMap</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-operator hs-var">.|</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Parallel</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Control.Monad.Parallel</span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CMP</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- conduit</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Conduit</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Conduit.List</span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CL</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Conduit.Binary</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CB</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sequence</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">sourceFile</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Conduit.Combinators</span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CC</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">--  Original Modules     </span><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">CSVAttoParserTLazy</span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CSV</span><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">CSVAttoParserTLazy</span><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span>              </span><a href="VIO.html"><span class="hs-identifier">VIO</span></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span>              </span><a href="VDS.html"><span class="hs-identifier">VDS</span></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span>              </span><a href="VClass.html"><span class="hs-identifier">VClass</span></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- * V&#34920;&#20316;&#25104;</span><span>
</span><a name="line-87"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-88"></a><span class="hs-comment">{- | 
 &#31227;&#34892;&#24460;S&#34920;&#12398;&#35373;&#35336;&#12398;&#35696;&#35542;&#12395;&#20808;&#31435;&#12387;&#12390;&#65292;&#29694;&#34892;V&#34920;&#12398;&#25512;&#35336;&#25163;&#27861;&#12434;&#21487;&#33021;&#12394;&#38480;&#12426;&#35443;&#32048;&#12395;&#26908;&#35388;&#12377;&#12427;&#65294;

 &#12300;&#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920; &#32207;&#21512;&#35299;&#35500;&#32232;&#12301;&#12395;&#12424;&#12428;&#12400;,V&#34920;&#12399;&#65292;&#24179;&#25104;17&#24180;&#12414;&#12391;&#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#65292;
 &#21830;&#26989;&#32113;&#35336;&#35519;&#26619;&#21450;&#12403;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#22522;&#26412;&#35519;&#26619;&#12434;&#20027;&#12395;&#29992;&#12356;&#12390;&#25512;&#35336;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
 23&#24180;&#20197;&#38477;&#12399;&#23550;&#24540;&#12377;&#12427;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;- &#27963;&#21205;&#35519;&#26619;&#12398;&#32080;&#26524;&#12434;&#20027;&#12394;&#36039;&#26009;&#12392;&#12375;&#12390;&#25512;&#35336;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#12383;&#12384;&#12375;&#65292;&#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12391;&#12399;&#65292;CT&#12395;&#38306;&#12375;&#12390;17&#34920;&#20197;&#21069;&#12395;&#19978;&#35352;&#65299;&#12388;&#12398;&#32113;&#35336;&#20197;&#22806;&#12363;&#12425;&#25512;&#35336;&#12373;&#12428;&#12390;&#12356;&#12383;&#36786;&#26519;&#27700;&#29987;&#65292;
 &#24314;&#35373;&#65292;&#37329;&#34701;&#12394;&#12393;&#12398;&#37096;&#38272;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12434;&#29992;&#12356;&#12378;&#65292;
 17&#24180;&#34920;&#20197;&#21069;&#12398;&#23550;&#24540;&#12377;&#12427;&#22522;&#30990;&#32113;&#35336;&#12398;&#20516;&#12434;&#22269;&#20869;&#32207;&#29983;&#29987;&#38989;&#65288;CT&#65307;Control Total&#65289;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#12356;&#12427;&#12392;&#12398;&#35352;&#36848;&#12364;&#12354;&#12427;&#65294;
 &#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#20184;&#24111;&#34920;V&#34920;&#20316;&#25104;&#25163;&#38918;&#12399;&#22823;&#12414;&#12363;&#12395;&#12399;&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#12394;&#12427;&#65294;&#12414;&#12378;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12398;&#32080;&#26524;&#12434;&#29992;&#12356;&#12390;&#65292;
 &#29987;&#26989;&#21029;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;&#38989;&#21450;&#12403;&#65292;&#29987;&#26989;&#21029;&#20107;&#26989;&#21029;&#22770;&#19978;&#38989;&#12487;&#12540;&#12479;&#12434;&#38598;&#35336;&#12375;&#65292;V&#34920;&#29987;&#26989;&#20998;&#39006;&#12395;&#21512;&#12431;&#12379;&#12390;&#20998;&#39006;&#12398;&#22793;&#25563;&#12434;&#34892;&#12356;&#65292;
 &#20182;&#12398;&#36039;&#26009;&#12392;&#20341;&#12379;&#12390;&#24471;&#12425;&#12428;&#12383;CT&#12434;&#12475;&#12531;&#12469;&#12473;&#32068;&#26367;&#34920;&#12424;&#12426;&#24471;&#12425;&#12428;&#12383;&#27604;&#29575;&#12391;&#26696;&#20998;&#12377;&#12427;&#12371;&#12392;&#12391;&#65292;&#19968;&#27425;&#25512;&#35336;&#20516;&#12434;&#20316;&#25104;&#12377;&#12427;&#65294;

 &#12381;&#12398;&#24460;&#65292;&#12381;&#12398;&#19968;&#27425;&#25512;&#35336;&#20516;&#12434;&#21508;&#31278;&#32113;&#35336;&#36039;&#26009;&#12395;&#12424;&#12387;&#12390;&#20418;&#25968;&#12434;&#35519;&#25972;&#12377;&#12427;&#12371;&#12392;&#12391;&#20844;&#34920;&#20516;&#12364;&#20316;&#25104;&#12373;&#12428;&#12427;&#65294;

 &#12414;&#12383;&#65292;&#23633;&#12539;&#21103;&#29987;&#29289;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21462;&#24341;&#22522;&#26412;&#34920;&#12395;&#12362;&#12369;&#12427;&#23633;&#12539;&#21103;&#29987;&#29289;&#30330;&#29983;&#37096;&#38272;&#12434;V&#34920;&#29987;&#26989;&#20998;&#39006;&#12408;&#32068;&#26367;&#12360;&#65292;
 &#12381;&#12398;&#20516;&#12434;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#27714;&#12417;&#12425;&#12428;&#12383;&#29987;&#26989;&#215;&#21830;&#21697;&#34920;&#12398;&#24403;&#35442;&#20132;&#28857;&#12395;&#35336;&#19978;&#12375;&#12390;&#12356;&#12427;&#65294;

 &#12371;&#12398;&#12424;&#12358;&#12395;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#20027;&#12394;&#36039;&#26009;&#12392;&#12375;&#12390;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#29992;&#12356;&#12390;&#12399;&#12356;&#12427;&#12364;&#65292;
 &#27096;&#12293;&#12394;&#32113;&#35336;&#35519;&#26619;&#12398;&#20516;&#12364;&#35079;&#21512;&#30340;&#12395;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12427;&#65294;&#26412;&#26469;&#12391;&#12354;&#12428;&#12400;&#65292;&#29694;&#34892;V&#34920;&#12398;&#20316;&#25104;&#25163;&#27861;&#12392;&#12399;&#65292;
 &#12381;&#12428;&#12425;&#21033;&#29992;&#12373;&#12428;&#12427;&#20840;&#12390;&#12398;&#22522;&#30990;&#32113;&#35336;&#21450;&#12403;&#12381;&#12398;&#21033;&#29992;&#26041;&#27861;&#12434;&#12418;&#12428;&#12394;&#12367;&#35352;&#36617;&#12377;&#12427;&#12371;&#12392;&#12392;&#12394;&#12427;&#12364;&#65292;
 &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#22522;&#30990;&#32113;&#35336;&#12398;&#20516;&#12434;&#21033;&#29992;&#12377;&#12427;&#20966;&#29702;&#12395;&#38306;&#12377;&#12427;&#36039;&#26009;&#12399;&#23569;&#12394;&#12367;&#65292;&#12414;&#12383;&#65292;&#20316;&#26989;&#12418;&#21508;&#30465;&#24193;&#12395;&#12424;&#12387;&#12390;&#22810;&#23696;&#12395;&#28193;&#12427;&#12383;&#12417;&#65292;
 &#12381;&#12398;&#35443;&#32048;&#12434;&#25226;&#25569;&#12377;&#12427;&#12371;&#12392;&#12399;&#22256;&#38627;&#12391;&#12354;&#12427;&#65294;

 &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#12381;&#12428;&#12425;&#12398;&#20966;&#29702;&#12395;&#38306;&#12375;&#12390;&#12414;&#12392;&#12417;&#12427;&#12371;&#12392;&#12399;&#12379;&#12378;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#21033;&#29992;&#12377;&#12427;&#37096;&#20998;&#12395;&#12381;&#12398;&#23550;&#35937;&#12434;&#32094;&#12426;&#65292;
 &#20182;&#12398;&#36039;&#26009;&#12364;&#21033;&#29992;&#12373;&#12428;&#12390;&#12356;&#12427;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#12381;&#12398;&#26088;&#12434;&#35328;&#21450;&#12375;&#12383;&#19978;&#12391;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#21033;&#29992;&#12375;&#12383;&#20195;&#26367;&#30340;&#12394;&#25512;&#35336;&#25163;&#27861;&#12434;&#25522;&#36617;&#12377;&#12427;&#65294;
 &#12371;&#12428;&#12399;&#65292;&#37096;&#20998;&#30340;&#12395;&#12363;&#12369;&#12390;&#12356;&#12427;&#25512;&#35336;&#25163;&#27861;&#12391;&#12399;&#65292;&#20840;&#20307;&#20687;&#12364;&#12388;&#12363;&#12415;&#12395;&#12367;&#12367;&#65292;&#12414;&#12383;&#65292;&#25968;&#20516;&#35336;&#31639;&#31561;&#12434;&#34892;&#12358;&#38555;&#12395;&#19981;&#20855;&#21512;&#12364;&#29983;&#12376;&#12427;&#12371;&#12392;&#12395;&#12418;&#12424;&#12427;&#65294;
 &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#20197;&#38477;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#25163;&#27861;&#12398;&#35519;&#26619;&#12395;&#24403;&#12383;&#12387;&#12390;&#21487;&#33021;&#12394;&#38480;&#12426;&#65292;&#36039;&#26009;&#12395;&#22522;&#12389;&#12356;&#12383;&#25512;&#28204;&#12434;&#34892;&#12358;&#12364;&#65292;
 &#9312;&#36039;&#26009;&#12398;&#19981;&#36275;&#12395;&#12424;&#12426;&#35443;&#32048;&#12398;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#31623;&#25152;&#65292;&#9313;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#22522;&#30990;&#32113;&#35336;&#12434;&#12418;&#12392;&#12395;&#25512;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#20491;&#25152;&#65292;
 &#12398;&#65298;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#22810;&#20998;&#12395;&#31558;&#32773;&#12398;&#25014;&#28204;&#12364;&#21547;&#12414;&#12428;&#12390;&#12356;&#12427;&#28857;&#12395;&#30041;&#24847;&#12375;&#12390;&#38914;&#12365;&#12383;&#12356;&#65294;
 
 &#26412;&#31295;&#12391;&#12399;V&#34920;&#12398;&#20316;&#25104;&#12399;&#22823;&#12414;&#12363;&#12395;&#65292;&#20197;&#19979;&#9312;~&#9316;&#12398;&#20316;&#26989;&#12434;&#24819;&#23450;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#12394;&#12362;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#23633;&#65292;&#21103;&#29987;&#29289;&#12398;&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#21462;&#24341;&#22522;&#26412;&#34920;&#12434;&#32076;&#30001;&#12375;&#12390;&#12362;&#12426;&#65292;
 &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#21508;&#31278;&#22522;&#30990;&#32113;&#35336;&#20516;&#12418;&#12381;&#12398;&#25512;&#35336;&#12395;&#21033;&#29992;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#26412;&#30740;&#31350;&#12399;&#65292;&#39165;&#12367;&#12414;&#12391;&#21516;&#19968;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12377;&#12427;&#12371;&#12392;&#12391;&#25512;&#35336;&#25163;&#27861;&#27598;&#12398;&#24046;&#30064;&#12434;&#20998;&#26512;&#12377;&#12427;&#12371;&#12392;&#12434;&#30446;&#30340;&#12392;&#12375;&#12390;&#12362;&#12426;&#65292;
 &#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12363;&#12425;&#30452;&#25509;&#30340;&#12395;&#20516;&#12434;&#27083;&#25104;&#12377;&#12427;&#12392;&#12356;&#12358;&#28857;&#12391;&#65292;&#25512;&#35336;&#25163;&#27861;&#12364;&#29694;&#34892;&#12398;&#12418;&#12398;&#12392;&#12399;&#30064;&#12394;&#12427;&#65294;

 &#24190;&#12388;&#12363;&#12398;&#35036;&#36275;&#12391;&#12365;&#12394;&#12356;&#27010;&#24565;&#31561;&#12418;&#12381;&#12398;&#12414;&#12414;&#26410;&#25226;&#25569;&#12392;&#12375;&#12390;&#25201;&#12356;&#65292;&#22823;&#12365;&#12394;&#38917;&#30446;&#12395;&#12388;&#12356;&#12390;&#12399;&#20182;&#12398;&#32113;&#35336;&#12434;&#29992;&#12356;&#12390;&#31777;&#26131;&#30340;&#12395;&#25512;&#35336;&#12377;&#12427;&#12394;&#12393;&#65292;
 &#31777;&#26131;&#30340;&#20316;&#25104;&#25163;&#27861;&#12434;&#25505;&#29992;&#12377;&#12427;&#65294;


   * &#20966;&#29702;&#38918;
 
         &gt; &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;
         &gt; &#29987;&#26989;&#26684;&#20184;&#12369;
         &gt; &#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;
         &gt; &#12510;&#12540;&#12472;&#12531;&#25512;&#35336;
         &gt; &#20385;&#26684;&#22793;&#25563;
         &gt; &#20225;&#26989;&#20869;&#21462;&#24341;&#12398;&#21066;&#38500;
         &gt; &#23633;&#12398;&#25512;&#35336;
         &gt; &#21103;&#26989;&#12398;&#20998;&#35299;
         &gt; CT&#25512;&#35336;
         &gt; &#29987;&#26989;&#21029;&#21830;&#21697;&#21029;&#29987;&#20986;&#38989;&#12398;&#25226;&#25569;
 
-}</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-identifier">compileVTable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-146"></a><a name="compileVTable"><a href="V.html#compileVTable"><span class="hs-identifier">compileVTable</span></a></a><span> </span><a name="local-6989586621679412653"><a href="#local-6989586621679412653"><span class="hs-identifier">filePath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- * &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span><span>
</span><a name="line-151"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- | &#12501;&#12449;&#12452;&#12523;&#12434;&#21463;&#12369;&#21462;&#12387;&#12390;&#65292;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#34892;&#12387;&#12390;&#20986;&#21147;&#12377;&#12427;</span><span>
</span><a name="line-154"></a><span class="hs-comment">--</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- -N5 &#12391;&#65299;&#26178;&#38291;&#31243;&#24230;</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-identifier">full&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><a name="full%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><a href="V.html#full%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier">full&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a></a><span> </span><a name="local-6989586621679412654"><a href="#local-6989586621679412654"><span class="hs-identifier">inputFile</span></a></a><span> </span><a name="local-6989586621679412655"><a href="#local-6989586621679412655"><span class="hs-identifier">maxRowNum</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runConduitRes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VDS.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679412654"><span class="hs-identifier hs-var">inputFile</span></a><span>
</span><a name="line-160"></a><span>                                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="V.html#conduit%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier hs-var">conduit&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a><span>
</span><a name="line-161"></a><span>                                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VDS.html#sinkCensus"><span class="hs-identifier hs-var">sinkCensus</span></a><span> </span><a href="#local-6989586621679412655"><span class="hs-identifier hs-var">maxRowNum</span></a><span> </span><a href="#local-6989586621679412656"><span class="hs-identifier hs-var">outputFile</span></a><span>
</span><a name="line-162"></a><span>                                </span><span class="hs-keyword">where</span><span>
</span><a name="line-163"></a><span>                                </span><a name="local-6989586621679412656"><a href="#local-6989586621679412656"><span class="hs-identifier">outputFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412654"><span class="hs-identifier hs-var">inputFile</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Stock.csv&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-comment">-- | &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12384;&#12369;&#12434;&#34892;&#12387;&#12390;&#20986;&#21147;&#12377;&#12427;</span><span>
</span><a name="line-166"></a><span class="hs-comment">--</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-identifier">conduit&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679412652"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412652"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412652"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><a name="conduit%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><a href="V.html#conduit%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier">conduit&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-170"></a><span>            </span><a name="local-6989586621679412657"><a href="#local-6989586621679412657"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-171"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679412657"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-172"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679412658"><a href="#local-6989586621679412658"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a><span> </span><a href="#local-6989586621679412658"><span class="hs-identifier hs-var">icd</span></a><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>                         </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679412658"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-175"></a><span>                         </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#conduit%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier hs-var">conduit&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">--  | &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#34892;&#12358;&#38306;&#25968;</span><span>
</span><a name="line-179"></a><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span class="hs-comment">--    &#21508;&#20107;&#26989;&#25152;&#12364;&#12393;&#12398;&#35519;&#26619;&#31080;&#12391;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#12363;&#12395;&#24540;&#12376;&#12390;&#20966;&#29702;&#12434;&#22793;&#12360;&#12427;</span><span>
</span><a name="line-181"></a><span class="hs-comment">--    &#21830;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12391;&#34892;&#12358;&#12383;&#12417;&#65292;&#12371;&#12371;&#12391;&#12399;&#65292;&#20966;&#29702;&#12375;&#12394;&#12356;</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-184"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a></a><span> </span><a name="local-6989586621679412659"><a href="#local-6989586621679412659"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-185"></a><span>        </span><a name="local-6989586621679412660"><a href="#local-6989586621679412660"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412659"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-186"></a><span>        </span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5206%5C90"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20998;&#23696;</span></a><span> </span><a href="#local-6989586621679412660"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679412659"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- | &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#21029;&#12398;&#20966;&#29702;&#12434;&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12395;&#24540;&#12376;&#12390;&#20998;&#23696;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-190"></a><span class="hs-comment">--</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20998;&#23696;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-193"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5206%5C90"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5206%5C90"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20998;&#23696;</span></a></a><span> </span><a name="local-6989586621679412661"><a href="#local-6989586621679412661"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679412662"><a href="#local-6989586621679412662"><span class="hs-identifier">icd</span></a></a><span>
</span><a name="line-194"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%8FB2%6797%6F01%696D"><span class="hs-identifier hs-var">E&#36786;&#26519;&#28417;&#26989;</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%8FB2%6797%6C34%7523%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span></a><span>       </span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">-- = return ()</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%9271%696D"><span class="hs-identifier hs-var">E&#37489;&#26989;</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%9271%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span></a><span>             </span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-197"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%88FD%9020%696D"><span class="hs-identifier hs-var">E&#35069;&#36896;&#26989;</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%88FD%9020%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span></a><span>           </span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-198"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5546%696D"><span class="hs-identifier hs-var">E&#21830;&#26989;</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5546%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;</span></a><span>             </span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">-- = return ()</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%30B5%30FC%30D3%30B9B"><span class="hs-identifier hs-var">E&#12469;&#12540;&#12499;&#12473;B</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%51FA%7248%30BD%30D5%30C8%30A6%30A7%30A2"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span></a><span> </span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">-- = return ()</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5EFA%8A2D%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;&#26989;</span></a><span>           </span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">-- = return ()</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- ** &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12398;&#35519;&#26619;&#31080;&#65292;&#29987;&#26989;&#21029;&#20966;&#29702;</span><span>
</span><a name="line-206"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span><span>
</span><a name="line-209"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-210"></a><span class="hs-comment">{- |  
    &#36786;&#26519;&#27700;&#29987;&#26989;&#12395;&#38306;&#12375;&#12390;&#21462;&#24471;&#21487;&#33021;&#12394;&#22770;&#19978;&#37329;&#38989;&#12399;&#65292;&#20027;&#26989;&#12399;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#65289;&#65292;
    &#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#65289;&#12398;&#21452;&#26041;&#12363;&#12425;&#24471;&#12425;&#12428;&#12427;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#12398;&#21454;&#20837;&#12301;&#21450;&#12403;&#65292;
    &#35023;&#38754;&#12300;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12391;&#12354;&#12426;&#65292;&#20849;&#12395;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12364;&#35352;&#20837;&#12373;&#12428;&#12390;&#12356;&#12427;&#12383;&#12417;&#65292;&#29987;&#20986;&#37327;&#12398;&#31639;&#20986;&#12398;&#12383;&#12417;&#12395;&#12399;&#65292;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#24517;&#35201;&#12392;&#12377;&#12427;&#65294;

    &#12375;&#12363;&#12375;&#65292;&#22312;&#24235;&#65292;&#20385;&#26684;&#20849;&#12395;&#12475;&#12531;&#12469;&#12473;&#20491;&#31080;&#12363;&#12425;&#25512;&#35336;&#12377;&#12427;&#12371;&#12392;&#12399;&#12391;&#12365;&#12394;&#12356;&#12383;&#12417;&#26412;&#31295;&#12391;&#12399;&#20197;&#38477;&#22770;&#19978;&#12434;&#31639;&#20986;&#12392;&#12375;&#12390;&#25201;&#12358;&#65294;-}</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%8FB2%6797%6C34%7523%696D"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%8FB2%6797%6C34%7523%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span></a></a><span> </span><a name="local-6989586621679412663"><a href="#local-6989586621679412663"><span class="hs-identifier">cd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span><span>
</span><a name="line-222"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-223"></a><span class="hs-comment">{- |
    &#37489;&#26989;&#65292;&#25505;&#30707;&#26989;&#65292;&#30722;&#21033;&#25505;&#21462;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21508;&#31278;&#35519;&#26619;&#31080;&#34920;&#38754;&#12300;&#20107;&#26989;&#25152;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12391;&#12399;&#22770;&#19978;&#12434;&#35352;&#20837;&#12377;&#12427;&#12383;&#12417;&#12371;&#12398;&#20516;&#12434;&#29992;&#12356;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;
    &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12364;&#24517;&#35201;&#12392;&#12394;&#12427;&#65294;

    &#19968;&#26041;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#37489;&#26989;&#65292;&#25505;&#30707;&#26989;&#65292;&#30722;&#21033;&#25505;&#21462;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35023;&#38754;&#12300;&#29983;&#29987;&#25968;&#37327;&#21450;&#12403;&#29983;&#29987;&#37329;&#38989;&#12301;&#12391;&#12399;&#65292;
    &#30330;&#29983;&#20027;&#32681;&#12395;&#22522;&#12389;&#12367;&#29983;&#29987;&#25968;&#37327;&#21450;&#12403;&#37329;&#38989;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#12383;&#12417;&#65292;&#35023;&#38754;&#12398;&#24773;&#22577;&#12395;&#38306;&#12375;&#12390;&#12399;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#24517;&#35201;&#12392;&#12375;&#12394;&#12356;&#65294;

     &#24467;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#34920;&#38754;&#12398;&#24773;&#22577;&#12434;&#35023;&#38754;&#12398;&#24773;&#22577;&#12395;&#32622;&#12365;&#25563;&#12360;&#12427;&#12383;&#12417;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#35023;&#38754;&#12398;&#21512;&#35336;&#38989;&#12392;&#34920;&#38754;&#12398;&#38989;&#12398;&#27604;&#12363;&#12425;&#65292;
     &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#25351;&#25968;&#12434;&#20316;&#25104;&#12375;&#65292;&#12381;&#12428;&#12434;&#21103;&#29987;&#29289;&#12398;&#25512;&#35336;&#12398;&#38555;&#12395;&#21508;&#24467;&#26989;&#12398;&#22770;&#19978;&#37329;&#38989;&#12395;&#20055;&#12376;&#12427;&#20966;&#29702;&#12434;&#34892;&#12358;&#65294;
     &#12371;&#12398;&#12424;&#12358;&#12394;&#20966;&#29702;&#12364;&#23455;&#38555;&#12395;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12363;&#12399;&#19981;&#26126;&#12391;&#12354;&#12427;&#12364;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#12475;&#12531;&#12469;&#12473;&#38598;&#35336;&#21450;&#12403;&#65292;&#32068;&#26367;&#38598;&#35336;&#12395;&#12390;&#12371;&#12428;&#12434;&#34892;&#12358;&#12418;&#12398;&#12392;&#12375;&#12390;&#35373;&#35336;&#12377;&#12427;&#65294;-}</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%9271%696D"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%9271%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span></a></a><span> </span><a name="local-6989586621679412664"><a href="#local-6989586621679412664"><span class="hs-identifier">cd</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412664"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412678"><a href="#local-6989586621679412678"><span class="hs-identifier">front</span></a></a><span>
</span><a name="line-236"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412664"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%751F%7523_%9271%696D_%91D1%984D"><span class="hs-identifier hs-var">H&#29983;&#29987;_&#37489;&#26989;_&#37329;&#38989;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412679"><a href="#local-6989586621679412679"><span class="hs-identifier">back</span></a></a><span>
</span><a name="line-237"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412665"><span class="hs-identifier hs-var">convert</span></a><span> </span><a href="#local-6989586621679412664"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="#local-6989586621679412678"><span class="hs-identifier hs-var">front</span></a><span> </span><a href="#local-6989586621679412679"><span class="hs-identifier hs-var">back</span></a><span>
</span><a name="line-238"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-239"></a><span>    </span><span class="hs-identifier">convert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>    </span><a name="local-6989586621679412665"><a href="#local-6989586621679412665"><span class="hs-identifier">convert</span></a></a><span> </span><a name="local-6989586621679412666"><a href="#local-6989586621679412666"><span class="hs-identifier">cd</span></a></a><span> </span><a name="local-6989586621679412667"><a href="#local-6989586621679412667"><span class="hs-identifier">front</span></a></a><span> </span><a name="local-6989586621679412668"><a href="#local-6989586621679412668"><span class="hs-identifier">back</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412667"><span class="hs-identifier hs-var">front</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412668"><span class="hs-identifier hs-var">back</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-241"></a><span>        </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412669"><a href="#local-6989586621679412669"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412670"><a href="#local-6989586621679412670"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412671"><a href="#local-6989586621679412671"><span class="hs-identifier">frontTotal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412672"><a href="#local-6989586621679412672"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412672"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T2&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412669"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-242"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412673"><a href="#local-6989586621679412673"><span class="hs-identifier">backTotal</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412670"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-243"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412674"><a href="#local-6989586621679412674"><span class="hs-identifier">r</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412673"><span class="hs-identifier hs-var">backTotal</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679412671"><span class="hs-identifier hs-var">frontTotal</span></a><span>
</span><a name="line-244"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412675"><a href="#local-6989586621679412675"><span class="hs-identifier">newFront</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679412676"><a href="#local-6989586621679412676"><span class="hs-identifier">z</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412677"><a href="#local-6989586621679412677"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412676"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679412676"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412677"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679412674"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412669"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-245"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412666"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679412675"><span class="hs-identifier hs-var">newFront</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span><span>
</span><a name="line-251"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-252"></a><span class="hs-comment">{- | 
    &#35069;&#36896;&#26989;&#12399;&#24467;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21508;&#31278;&#35519;&#26619;&#31080;&#12398;&#34920;&#38754;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12391;&#22770;&#19978;&#12434;&#32862;&#12356;&#12390;&#12362;&#12426;&#65292;
    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#35069;&#36896;&#26989;&#65289;&#35023;&#38754;&#12300;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;&#65292;&#22312;&#24235;&#38989;&#31561;&#12301;&#12391;&#12399;&#65292;&#12300;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;&#12301;&#21450;&#12403;&#12300;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#12301;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;
    &#12414;&#12383;&#65292;&#21516;&#35023;&#38754;&#35519;&#26619;&#38917;&#30446;&#12300;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#65292;&#21322;&#35069;&#21697;&#65292;&#20181;&#25499;&#21697;&#12398;&#20385;&#38989;&#21450;&#12403;&#21407;&#26448;&#26009;&#65292;&#29123;&#26009;&#12398;&#22312;&#24235;&#38989;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;&#20107;&#26989;&#25152;&#20840;&#20307;&#12398;&#24180;&#21021;&#24180;&#26411;&#12300;&#35069;&#36896;&#21697;&#12301;&#65292;
    &#12300;&#21322;&#35069;&#21697;&#21450;&#12403;&#20181;&#25499;&#21697;&#12301;&#25152;&#26377;&#37329;&#38989;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#12371;&#12428;&#12425;&#12398;&#24773;&#22577;&#12434;&#21033;&#29992;&#12375;&#12390;&#65292;&#35069;&#36896;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#20197;&#19979;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;&#65294;

     &#35069;&#36896;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#35069;&#36896;&#21697;&#30446;&#12364;&#36861;&#35352;&#24335;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#34920;&#38754;&#12398;&#32207;&#21644;&#12392;&#35023;&#38754;&#12398;&#32207;&#21644;&#12364;&#19968;&#33268;&#12377;&#12427;&#12392;&#12399;&#12363;&#12366;&#12425;&#12394;&#12356;&#12383;&#12417;&#65292;&#34920;&#38754;&#35023;&#38754;&#12381;&#12428;&#12382;&#12428;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#65294;

    * &#34920;&#38754;

        &gt;  &#24180;&#21021;&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#65292;&#21322;&#35069;&#21697;&#21450;&#12403;&#20181;&#25499;&#21697;&#22312;&#24235;&#38989;&#12363;&#12425;&#21517;&#30446;&#22312;&#24235;&#22793;&#21205;&#12434;&#27714;&#12417;&#65292;
        &gt; &#21517;&#30446;&#22312;&#24235;&#22793;&#21205;&#12434;&#22770;&#19978;&#39640;&#12395;&#36275;&#12375;&#12383;&#32207;&#29987;&#20986;&#38989;&#12434;&#27714;&#12417;&#12427;&#65294;

    * &#35023;&#38754;

        &gt; &#21517;&#30446;&#22312;&#24235;&#38989;/&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#12398;&#27604;&#12434;&#27714;&#12417;&#12390;&#12381;&#12428;&#12434;&#65292;&#21508;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#12395;&#20055;&#12378;&#12427;&#12371;&#12392;&#12391;&#21517;&#30446;&#21697;&#30446;&#21029;&#22312;&#24235;&#22793;&#21205;&#38989;&#12434;&#25512;&#35336;&#12375;&#65292;
        &gt; &#12381;&#12428;&#12434;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;&#12395;&#36275;&#12377;&#12371;&#12392;&#12391;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#29987;&#20986;&#38989;&#12434;&#27714;&#12417;&#12427;&#65294;-}</span><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-273"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%88FD%9020%696D"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%88FD%9020%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span></a></a><span> </span><a name="local-6989586621679412680"><a href="#local-6989586621679412680"><span class="hs-identifier">cd</span></a></a><span>
</span><a name="line-274"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%5E74%521D%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412716"><a href="#local-6989586621679412716"><span class="hs-identifier">first</span></a></a><span>
</span><a name="line-275"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%5E74%672B%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412717"><a href="#local-6989586621679412717"><span class="hs-identifier">final</span></a></a><span>
</span><a name="line-276"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412718"><a href="#local-6989586621679412718"><span class="hs-identifier">front</span></a></a><span>
</span><a name="line-277"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%5728%5EAB%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#22312;&#24235;&#38989;_&#35069;&#36896;&#26989;</span></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-keyword">stock</span><span>
</span><a name="line-278"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412720"><a href="#local-6989586621679412720"><span class="hs-identifier">output</span></a></a><span>
</span><a name="line-279"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412681"><span class="hs-identifier hs-var">convertFront</span></a><span> </span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="#local-6989586621679412716"><span class="hs-identifier hs-var">first</span></a><span> </span><a href="#local-6989586621679412717"><span class="hs-identifier hs-var">final</span></a><span> </span><a href="#local-6989586621679412718"><span class="hs-identifier hs-var">front</span></a><span>
</span><a name="line-280"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621679412682"><span class="hs-identifier hs-var">convertBack</span></a><span>  </span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="#local-6989586621679412716"><span class="hs-identifier hs-var">first</span></a><span> </span><a href="#local-6989586621679412717"><span class="hs-identifier hs-var">final</span></a><span> </span><a href="#local-6989586621679412718"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-keyword">stock</span><span> </span><a href="#local-6989586621679412720"><span class="hs-identifier hs-var">output</span></a><span>
</span><a name="line-281"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-identifier">convertFront</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>    </span><a name="local-6989586621679412681"><a href="#local-6989586621679412681"><span class="hs-identifier">convertFront</span></a></a><span> </span><a name="local-6989586621679412683"><a href="#local-6989586621679412683"><span class="hs-identifier">cd</span></a></a><span>  </span><a name="local-6989586621679412684"><a href="#local-6989586621679412684"><span class="hs-identifier">first</span></a></a><span> </span><a name="local-6989586621679412685"><a href="#local-6989586621679412685"><span class="hs-identifier">final</span></a></a><span> </span><a name="local-6989586621679412686"><a href="#local-6989586621679412686"><span class="hs-identifier">front</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412684"><span class="hs-identifier hs-var">first</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412685"><span class="hs-identifier hs-var">final</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412686"><span class="hs-identifier hs-var">front</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- &#34920;&#38754;&#20966;&#29702; </span><span>
</span><a name="line-284"></a><span>        </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679412687"><a href="#local-6989586621679412687"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679412688"><a href="#local-6989586621679412688"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412689"><a href="#local-6989586621679412689"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-285"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412690"><a href="#local-6989586621679412690"><span class="hs-identifier">newFront</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412691"><a href="#local-6989586621679412691"><span class="hs-identifier">car</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412692"><a href="#local-6989586621679412692"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412691"><span class="hs-identifier hs-var">car</span></a><span>
</span><a name="line-286"></a><span>                                            </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412691"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T3&quot;</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679412691"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412692"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412688"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679412687"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-287"></a><span>                                                                            </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679412691"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412689"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-288"></a><span>            </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412683"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679412690"><span class="hs-identifier hs-var">newFront</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span>    </span><span class="hs-identifier">convertBack</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>    </span><a name="local-6989586621679412682"><a href="#local-6989586621679412682"><span class="hs-identifier">convertBack</span></a></a><span> </span><a name="local-6989586621679412693"><a href="#local-6989586621679412693"><span class="hs-identifier">cd</span></a></a><span> </span><a name="local-6989586621679412694"><a href="#local-6989586621679412694"><span class="hs-identifier">first</span></a></a><span> </span><a name="local-6989586621679412695"><a href="#local-6989586621679412695"><span class="hs-identifier">final</span></a></a><span> </span><a name="local-6989586621679412696"><a href="#local-6989586621679412696"><span class="hs-identifier">front</span></a></a><span> </span><span class="hs-keyword">stock</span><span> </span><a name="local-6989586621679412698"><a href="#local-6989586621679412698"><span class="hs-identifier">output</span></a></a><span>
</span><a name="line-293"></a><span>        </span><span class="hs-glyph">=</span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412694"><span class="hs-identifier hs-var">first</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412695"><span class="hs-identifier hs-var">final</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412696"><span class="hs-identifier hs-var">front</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">stock</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412698"><span class="hs-identifier hs-var">output</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- &#35023;&#38754;&#20966;&#29702;</span><span>
</span><a name="line-294"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679412699"><a href="#local-6989586621679412699"><span class="hs-identifier">ft</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679412700"><a href="#local-6989586621679412700"><span class="hs-identifier">fl</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412701"><a href="#local-6989586621679412701"><span class="hs-identifier">fr</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412702"><a href="#local-6989586621679412702"><span class="hs-identifier">st</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412703"><a href="#local-6989586621679412703"><span class="hs-identifier">ou</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-295"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412704"><a href="#local-6989586621679412704"><span class="hs-identifier">stockDiffRatio</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412700"><span class="hs-identifier hs-var">fl</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679412699"><span class="hs-identifier hs-var">ft</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679412700"><span class="hs-identifier hs-var">fl</span></a><span>
</span><a name="line-296"></a><span>                    </span><a name="local-6989586621679412705"><a href="#local-6989586621679412705"><span class="hs-identifier">mapSt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span>
</span><a name="line-297"></a><span>                          </span><span class="hs-operator hs-var">.</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412709"><a href="#local-6989586621679412709"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412709"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412709"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679412704"><span class="hs-identifier hs-var">stockDiffRatio</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412702"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-298"></a><span>                    </span><a name="local-6989586621679412706"><a href="#local-6989586621679412706"><span class="hs-identifier">ouF</span></a></a><span> </span><a name="local-6989586621679412710"><a href="#local-6989586621679412710"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412711"><a href="#local-6989586621679412711"><span class="hs-identifier">toAdd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412710"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412705"><span class="hs-identifier hs-var">mapSt</span></a><span>
</span><a name="line-299"></a><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679412711"><span class="hs-identifier hs-var">toAdd</span></a><span> </span><span class="hs-keyword">of</span><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412710"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-300"></a><span>                                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679412712"><a href="#local-6989586621679412712"><span class="hs-identifier">y</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412713"><a href="#local-6989586621679412713"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412710"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679412710"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412713"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679412712"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">}</span><span>
</span><a name="line-301"></a><span>                    </span><a name="local-6989586621679412707"><a href="#local-6989586621679412707"><span class="hs-identifier">newOu</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><a href="#local-6989586621679412706"><span class="hs-identifier hs-var">ouF</span></a><span> </span><a href="#local-6989586621679412703"><span class="hs-identifier hs-var">ou</span></a><span>
</span><a name="line-302"></a><span>                    </span><a name="local-6989586621679412708"><a href="#local-6989586621679412708"><span class="hs-identifier">newSt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412714"><a href="#local-6989586621679412714"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412715"><a href="#local-6989586621679412715"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412714"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679412714"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412715"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679412704"><span class="hs-identifier hs-var">stockDiffRatio</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412702"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span>                </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412693"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679412707"><span class="hs-identifier hs-var">newOu</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>                </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412693"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VDS.html#H%5728%5EAB%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#22312;&#24235;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679412708"><span class="hs-identifier hs-var">newSt</span></a><span class="hs-special">)</span><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;&#20966;&#29702;</span><span>
</span><a name="line-312"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-313"></a><span class="hs-comment">{- | 
    &#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#22312;&#24235;&#27010;&#24565;&#12399;&#65292;&#21508;&#31278;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;&#12420;&#65292;
    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35023;&#38754;&#12300;&#65288;&#24180;&#26411;&#24180;&#21021;&#65289;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#12395;&#12424;&#12387;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
    &#12381;&#12428;&#12425;&#21517;&#30446;&#22312;&#24235;&#20966;&#29702;&#12398;&#35443;&#32048;&#12399;&#12300;4.6.1&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12301;&#12398;&#25512;&#35336;&#12434;&#21442;&#29031;&#65294;-}</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-319"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5546%696D"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5546%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;</span></a></a><span> </span><a name="local-6989586621679412721"><a href="#local-6989586621679412721"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span><span>
</span><a name="line-323"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-324"></a><span class="hs-comment">{- | 
    &#20986;&#29256;&#21450;&#12403;&#26377;&#24418;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#12399;&#65292;&#22312;&#24235;&#12364;&#35336;&#19978;&#12373;&#12428;&#12427;&#12364;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#35519;&#26619;&#38917;&#30446;&#12363;&#12425;&#12399;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#12383;&#12417;&#65292;&#12371;&#12371;&#12391;&#12399;&#65292;&#21454;&#20837;&#37329;&#38989;=&#29987;&#20986;&#37329;&#38989;&#12392;&#12375;&#12390;&#25201;&#12358;&#65294;-}</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-329"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%51FA%7248%30BD%30D5%30C8%30A6%30A7%30A2"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%51FA%7248%30BD%30D5%30C8%30A6%30A7%30A2"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span></a></a><span> </span><a name="local-6989586621679412722"><a href="#local-6989586621679412722"><span class="hs-identifier">cd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;</span><span>
</span><a name="line-332"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-333"></a><span class="hs-comment">{- | 
    &#24314;&#35373;&#26989;&#12399;&#21508;&#31278;&#35519;&#26619;&#31080;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12356;&#12390;&#20027;&#26989;&#65292;
    &#24467;&#26989;&#12398;&#32207;&#38989;&#12434;&#65292;&#12300;&#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;&#20027;&#26989;&#12398;&#20869;&#35379;&#12434;&#25226;&#25569;&#12377;&#12427;&#65294;
    SNA&#12395;&#12362;&#12369;&#12427;&#24314;&#35373;&#26989;&#12399;&#65292;&#23436;&#25104;&#24037;&#20107;&#39640;&#12398;&#20182;&#12395;&#65292;&#26410;&#23436;&#25104;&#24037;&#20107;&#39640;&#12418;&#12381;&#12398;&#29983;&#29987;&#37329;&#38989;&#12395;&#21547;&#12416;&#12364;&#12371;&#12428;&#12425;&#12398;&#26410;&#23436;&#25104;&#24037;&#20107;&#39640;&#12399;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12391;&#12399;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#65294;
    &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#24314;&#35373;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#26410;&#23436;&#25104;&#24037;&#20107;&#39640;&#12434;&#21547;&#12417;&#12394;&#12356;&#23436;&#25104;&#24037;&#20107;&#39640;&#20998;&#12398;&#22770;&#19978;&#38989;&#12434;&#29983;&#29987;&#38989;&#12392;&#12415;&#12394;&#12375;&#12390;&#20197;&#24460;&#25512;&#35336;&#12434;&#34892;&#12358;&#65294;-}</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-340"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5EFA%8A2D%696D"><a href="V.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5EFA%8A2D%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;&#26989;</span></a></a><span> </span><a name="local-6989586621679412723"><a href="#local-6989586621679412723"><span class="hs-identifier">cd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-345"></a><span class="hs-comment">-- * &#29987;&#26989;&#26684;&#20184;</span><span>
</span><a name="line-346"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- | &#12501;&#12449;&#12452;&#12523;&#12434;&#21463;&#12369;&#21462;&#12387;&#12390;&#65292;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12387;&#12383;&#24460;&#20986;&#21147;</span><span>
</span><a name="line-349"></a><span class="hs-identifier">full&#29987;&#26989;&#26684;&#20184;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-350"></a><a name="full%7523%696D%683C%4ED8"><a href="V.html#full%7523%696D%683C%4ED8"><span class="hs-identifier">full&#29987;&#26989;&#26684;&#20184;</span></a></a><span> </span><a name="local-6989586621679412724"><a href="#local-6989586621679412724"><span class="hs-identifier">inputFile</span></a></a><span> </span><a name="local-6989586621679412725"><a href="#local-6989586621679412725"><span class="hs-identifier">maxRowNum</span></a></a><span> </span><a name="local-6989586621679412726"><a href="#local-6989586621679412726"><span class="hs-identifier">year</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runConduitRes</span><span>
</span><a name="line-351"></a><span>                                        </span><span class="hs-operator hs-var">$</span><span> </span><a href="VDS.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679412724"><span class="hs-identifier hs-var">inputFile</span></a><span>
</span><a name="line-352"></a><span>                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="V.html#conduit%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">conduit&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412726"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VDS.html#sinkCensus"><span class="hs-identifier hs-var">sinkCensus</span></a><span> </span><a href="#local-6989586621679412725"><span class="hs-identifier hs-var">maxRowNum</span></a><span> </span><a href="#local-6989586621679412727"><span class="hs-identifier hs-var">outputFile</span></a><span>
</span><a name="line-353"></a><span>                                </span><span class="hs-keyword">where</span><span>
</span><a name="line-354"></a><span>                                </span><a name="local-6989586621679412727"><a href="#local-6989586621679412727"><span class="hs-identifier">outputFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412724"><span class="hs-identifier hs-var">inputFile</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Classify.csv&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-comment">{- | &#29987;&#26989;&#26684;&#20184;&#12398;&#12415;&#12434;&#34892;&#12358;Conduit

    &#20197;&#38477;&#12398;&#20966;&#29702;&#12391;&#24517;&#35201;&#12398;&#12394;&#12356;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12399;,&#12487;&#12540;&#12479;&#12434;&#21066;&#38500;&#12377;&#12427;.
    
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#65292;&#29987;&#26989;&#27598;&#12395;&#22770;&#19978;&#65292;&#24467;&#26989;&#32773;&#25968;&#12420;&#26989;&#24907;&#12394;&#12393;&#12398;&#38598;&#35336;&#12434;&#34892;&#12358;&#12383;&#12417;&#65292;
    &#12381;&#12398;&#38598;&#35336;&#12395;&#12354;&#12383;&#12387;&#12390;&#35519;&#26619;&#23458;&#20307;&#12391;&#12354;&#12427;&#20225;&#26989;/&#20107;&#26989;&#25152;&#21508;&#12293;&#12398;&#20027;&#26989;&#12434;&#23450;&#12417;&#12427;&#20316;&#26989;&#12434;&#34892;&#12358;&#24517;&#35201;&#12364;&#12354;&#12427;&#65294;
    
    &#12371;&#12398;&#20225;&#26989;&#12539;&#20107;&#26989;&#25152;&#21029;&#12398;&#20027;&#26989;&#12398;&#31574;&#23450;&#20316;&#26989;&#12434;&#19968;&#33324;&#12395;&#12300;&#29987;&#26989;&#26684;&#20184;&#12369;&#12301;&#12392;&#12356;&#12358;&#65294;
    
    24&#24180;&#21450;&#12403;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#35519;&#26619;&#31080;&#12395;&#12399;&#65292;&#21454;&#20837;&#38989;&#65292;&#36009;&#22770;&#38989;&#12392;&#12399;&#21029;&#12395;&#12300;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12395;&#38306;&#12377;&#12427;&#35519;&#26619;&#38917;&#30446;&#12364;&#23384;&#22312;&#12377;&#12427;&#65294;
    &#12371;&#12398;&#12300;&#20027;&#12394;&#20107;&#26989;&#25152;&#12301;&#12399;&#65292;&#26085;&#26412;&#22269;&#20869;&#12398;&#12377;&#12409;&#12390;&#12398;&#20107;&#26989;&#25152;&#12539;&#20225;&#26989;&#24773;&#22577;&#12434;&#35036;&#36275;&#12377;&#12427;&#12300;&#20107;&#26989;&#25152;&#27597;&#38598;&#22243;&#12487;&#12540;&#12479;&#12505;&#12540;&#12473;&#65288;&#12499;&#12472;&#12493;&#12473;&#12524;&#12472;&#12473;&#12479;&#12540;&#65289;&#12301; 
    &#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#12539;&#20225;&#26989;&#29031;&#20250;&#65292;&#21450;&#12403;&#12300;&#20107;&#26989;&#12398;&#23455;&#26045;&#29366;&#27841;&#30906;&#35469;&#12301;&#12434;&#12418;&#12392;&#12395;&#20107;&#21069;&#12395;&#35352;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
    &#22793;&#26356;&#12398;&#12354;&#12387;&#12383;&#22580;&#21512;&#12398;&#12415;&#35519;&#26619;&#31080;&#12395;&#21508;&#20107;&#26989;&#25152;&#12364;&#35352;&#36617;&#12377;&#12427;&#12371;&#12392;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;

    &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26032;&#35215;&#20107;&#26989;&#25152;&#12434;&#38500;&#12356;&#12390;&#21508;&#12293;&#12398;&#20107;&#26989;&#25152;&#12399;&#65292;&#35519;&#26619;&#27573;&#38542;&#12391;&#26082;&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12364;&#12394;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
    &#12375;&#12363;&#12375;&#65292;&#12524;&#12473;&#12488;&#12521;&#12531;&#12420;&#12452;&#12505;&#12531;&#12488;&#20250;&#22580;&#12434;&#21547;&#12435;&#12384;&#12507;&#12486;&#12523;&#26045;&#35373;&#12395;&#12362;&#12356;&#12390;&#65292;&#12524;&#12473;&#12488;&#12521;&#12531;&#12398;&#22770;&#12426;&#19978;&#12370;&#12364;&#65292;&#23487;&#27850;&#20107;&#26989;&#12424;&#12426;&#12418;&#21454;&#30410;&#12364;&#22823;&#12365;&#12356;&#22580;&#21512;&#12394;&#12393;&#65292;
    &#20107;&#26989;&#25152;&#21450;&#12403;&#20225;&#26989;&#12398;&#35469;&#35672;&#12377;&#12427;&#20027;&#12394;&#20107;&#26989;&#12392;&#12300;&#21454;&#20837;&#38989;&#12414;&#12383;&#12399;&#20986;&#33655;&#38989;&#12398;&#26368;&#12418;&#22810;&#12356;&#12418;&#12398;&#12301;&#12392;&#12356;&#12358;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#21407;&#21063;&#12364;&#19968;&#33268;&#12375;&#12394;&#12356;&#12371;&#12392;&#12364;&#12414;&#12414;&#12354;&#12427;&#65294;
    &#12371;&#12398;&#12383;&#12417;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#38598;&#35336;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#21508;&#20107;&#26989;&#25152;&#12434;&#21407;&#21063;&#12395;&#21063;&#12387;&#12390;&#20877;&#12403;&#29987;&#26989;&#26684;&#20184;&#12369;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12424;&#12427;&#26684;&#20184;&#12369;&#12399;&#29987;&#26989;&#21029;&#12398;&#38598;&#35336;&#12398;&#38555;&#12395;&#29992;&#12356;&#12425;&#12428;&#12427;&#12364;&#65292;
    &#32068;&#26367;&#38598;&#35336;&#12398;&#12383;&#12417;&#12395;&#12399;&#65292;&#20027;&#12395;&#35519;&#26619;&#31080;&#31532;&#65298;&#38754;&#12391;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12427;&#29983;&#29987;&#29289;&#21029;&#12398;&#22770;&#19978;&#38989;&#12434;&#25226;&#25569;&#12375;&#65292;
    &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#29983;&#29987;&#37327;&#12434;&#25226;&#25569;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12426;&#65292;&#12381;&#12398;&#12383;&#12417;&#12395;&#12399;&#65292;&#35519;&#26619;&#31080;&#12391;&#35352;&#36617;&#12373;&#12428;&#12383;&#21508;&#35519;&#26619;&#38917;&#30446;&#12363;&#12425;&#65292;
    &#12381;&#12398;&#20107;&#26989;&#25152;&#12395;&#12362;&#12369;&#12427;&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#65292;&#21103;&#29983;&#29987;&#29289;&#12434;&#25226;&#25569;&#12377;&#12427;&#12371;&#12392;&#12364;&#27714;&#12417;&#12425;&#12428;&#12427;&#65294;

    &#12381;&#12398;&#38555;&#65292;&#35023;&#38754;&#12395;&#12362;&#12360;&#12369;&#12427;&#21508;&#35519;&#26619;&#38917;&#30446;&#12399;&#65292;&#29983;&#29987;&#29289;&#12392;&#19968;&#23550;&#19968;&#23550;&#24540;&#12395;&#12354;&#12427;&#12431;&#12369;&#12391;&#12399;&#12394;&#12356;&#12398;&#12391;&#65292;
    &#12381;&#12428;&#12382;&#12428;&#12398;&#35519;&#26619;&#38917;&#30446;&#12363;&#12425;&#29983;&#29987;&#29289;&#21450;&#12403;&#22770;&#19978;&#38989;&#12434;&#29305;&#23450;&#12377;&#12427;&#20316;&#26989;&#12434;&#24517;&#35201;&#12392;&#12377;&#12427;&#65294;

    &#12371;&#12428;&#12425;&#12398;&#20966;&#29702;&#12399;&#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12362;&#12369;&#12427;&#20966;&#29702;&#12364;&#21442;&#32771;&#12392;&#12394;&#12427;&#12383;&#12417;&#65292;&#12371;&#12371;&#12391;&#12399;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;&#12392;&#21516;&#26178;&#12395;&#65292;
    &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12364;&#25226;&#25569;&#12391;&#12365;&#12427;&#12424;&#12358;&#12395;&#35373;&#35336;&#12377;&#12427;&#65294;

    &#20840;&#12390;IO&#12395;&#12375;&#12390;,&#19968;&#34892;&#12378;&#12388;&#20966;&#29702;&#12377;&#12427;&#12411;&#12358;&#12364;&#33391;&#12356;(&#35201;&#20462;&#27491;)
-}</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-identifier">conduit&#29987;&#26989;&#26684;&#20184;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679412651"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412651"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412651"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-392"></a><a name="conduit%7523%696D%683C%4ED8"><a href="V.html#conduit%7523%696D%683C%4ED8"><span class="hs-identifier">conduit&#29987;&#26989;&#26684;&#20184;</span></a></a><span> </span><a name="local-6989586621679412728"><a href="#local-6989586621679412728"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-393"></a><span>    </span><a name="local-6989586621679412729"><a href="#local-6989586621679412729"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-394"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679412729"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-395"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679412730"><a href="#local-6989586621679412730"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;</span></a><span> </span><a href="#local-6989586621679412728"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412730"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span></a><span> </span><a href="#local-6989586621679412728"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412730"><span class="hs-identifier hs-var">icd</span></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679412730"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-398"></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#conduit%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">conduit&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412728"><span class="hs-identifier hs-var">year</span></a><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-comment">-- ** &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span><span>
</span><a name="line-401"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-comment">{- | &#22770;&#19978;&#39640;&#12391;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;&#12383;&#12417;&#65292;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12398;&#21069;&#12395;&#34892;&#12358;&#65294;

    &#26412;&#31295;&#12391;&#12399;,&#12371;&#12398;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#37329;&#38989;&#12398;&#12487;&#12540;&#12479;&#12434;&#20316;&#25104;&#12377;&#12427;&#12371;&#12392;&#12434;&#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12362;&#12369;&#12427;&#65378;&#29305;&#27530;&#12394;&#26041;&#27861;&#65379;&#12434;&#21033;&#29992;&#12375;&#12390;&#34892;&#12356;,
    &#20316;&#25104;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#21029;&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#12398;&#20869;&#26368;&#22823;&#12398;&#12418;&#12398;&#12434;&#20027;&#26989;&#12392;&#12375;&#12390;&#36984;&#25246;&#12377;&#12427;&#12371;&#12392;&#12434;&#65378;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#65379;&#12392;&#12375;&#12390;&#12356;&#12427;(&#21516;&#26178;&#12395;&#24467;&#26989;,&#20027;&#29983;&#29987;&#29289;,&#21103;&#29983;&#29987;&#29289;&#12364;&#20309;&#12391;&#12354;&#12427;&#12363;&#12364;&#21028;&#26126;&#12377;&#12427;)&#12290;
    &#12371;&#12428;&#12425;&#12398;&#26041;&#27861;&#12434;&#29992;&#12356;&#12390;&#27770;&#23450;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#21450;&#12403;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#20998;&#39006;&#38917;&#30446;&#12434;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#20998;&#39006;&#12395;&#22793;&#25563;&#12375;&#65292;
    &#29987;&#26989;&#21029;&#12395;&#38598;&#35336;&#12377;&#12427;&#12371;&#12392;&#12391;&#29987;&#26989;&#21029;&#21697;&#30446;&#21029;&#12398;&#32068;&#26367;&#38598;&#35336;&#12364;&#23436;&#20102;&#12377;&#12427;&#12290;


     &#12300;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12301;&#12399;&#65292;&#20197;&#19979;&#12398;&#25163;&#32154;&#12365;&#12395;&#21063;&#12387;&#12390;&#34892;&#12431;&#12428;&#12427;&#12290;

    1. &#20107;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#37329;&#38989;&#21450;&#12403;&#65292;&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#12398;&#26368;&#22823;&#22770;&#19978;&#37096;&#38272;&#12434;&#21462;&#24471;&#12377;&#12427;&#12290;

    2. &#12391;&#27770;&#23450;&#12375;&#12383;&#21306;&#20998;&#12395;&#35442;&#24403;&#12377;&#12427;&#37096;&#38272;&#12398;&#12415;&#12398;&#12487;&#12540;&#12479;&#12434;&#29992;&#12356;&#12390;&#65292;&#27425;&#28857;&#12391;&#32048;&#12363;&#12356;&#20998;&#39006;&#12398;&#26368;&#22823;&#22770;&#19978;&#21306;&#20998;&#12434;&#25226;&#25569;&#12377;&#12427;&#12290;
     &#26368;&#22823;&#22770;&#19978;&#21306;&#20998;&#12395;&#37325;&#35079;&#12364;&#12354;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;&#21452;&#26041;&#12395;&#12362;&#12356;&#12390;&#27425;&#28857;&#12391;&#32048;&#12363;&#12356;&#20998;&#39006;&#12398;&#26368;&#22823;&#22770;&#12426;&#19978;&#12370;&#21306;&#20998;&#12434;&#25226;&#25569;&#12375;&#65292;&#12381;&#12398;&#38989;&#12398;&#22823;&#12365;&#12356;&#26041;&#12434;&#25505;&#29992;&#12377;&#12427;&#12290;

    3. &#12381;&#12428;&#20197;&#19978;&#32048;&#12363;&#12356;&#21306;&#20998;&#12364;&#23384;&#22312;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399;&#21069;&#27573;&#38542;&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#19979;&#20301;&#20998;&#39006;&#12398;&#12300;&#26684;&#20184;&#12369;&#19981;&#33021;&#12301;&#38917;&#30446;&#12395;&#20998;&#39006;&#12377;&#12427;&#12290;
    &#37325;&#35079;&#12364;&#12354;&#12427;&#12398;&#12364;&#26368;&#12418;&#32048;&#12363;&#12356;&#20998;&#39006;&#12391;&#12354;&#12427;&#22580;&#21512;&#12399;&#65292;&#35672;&#21029;&#30058;&#21495;&#12398;&#33509;&#12356;&#26041;&#12434;&#25505;&#29992;&#12377;&#12427;&#12290;

     ![&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;](general.png)

    &#21103;&#26989;&#12398;&#20998;&#35299;&#12399;&#65292;&#21103;&#26989;&#12398;&#20998;&#35299;&#12398;&#38917;&#30446;&#12391;&#34892;&#12358;&#65294;

    &#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#12395;&#12399;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#22770;&#12426;&#19978;&#12370;&#12418;&#21547;&#12414;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;&#27880;&#24847;

    

-}</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-432"></a><a name="f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5"><a href="V.html#f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span></a></a><span> </span><a name="local-6989586621679412731"><a href="#local-6989586621679412731"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412732"><a href="#local-6989586621679412732"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-433"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412733"><a href="#local-6989586621679412733"><span class="hs-identifier">en</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412732"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-var">H&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span>
</span><a name="line-434"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412734"><a href="#local-6989586621679412734"><span class="hs-identifier">es</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412732"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-var">H&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span>
</span><a name="line-435"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412735"><a href="#local-6989586621679412735"><span class="hs-identifier">sev</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412732"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-436"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412736"><a href="#local-6989586621679412736"><span class="hs-identifier">tar</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412732"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-437"></a><span>        </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412732"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="V.html#f%4E00%822C%7684%306A%65B9%6CD5%51E6%7406"><span class="hs-identifier hs-var">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412735"><span class="hs-identifier hs-var">sev</span></a><span> </span><a href="#local-6989586621679412736"><span class="hs-identifier hs-var">tar</span></a><span> </span><a href="#local-6989586621679412733"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412734"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-identifier">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-440"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-441"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span>
</span><a name="line-442"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span>
</span><a name="line-443"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-444"></a><a name="f%4E00%822C%7684%306A%65B9%6CD5%51E6%7406"><a href="V.html#f%4E00%822C%7684%306A%65B9%6CD5%51E6%7406"><span class="hs-identifier">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412737"><a href="#local-6989586621679412737"><span class="hs-identifier">sev</span></a></a><span>  </span><a name="local-6989586621679412738"><a href="#local-6989586621679412738"><span class="hs-identifier">tar</span></a></a><span> </span><a name="local-6989586621679412739"><a href="#local-6989586621679412739"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679412740"><a href="#local-6989586621679412740"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">sev</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">tar</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679412739"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412740"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-445"></a><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">sev</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">tar</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">tar</span></a><span> </span><a href="#local-6989586621679412739"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412740"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-446"></a><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">sev</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">tar</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><span class="hs-special">(</span><a href="V.html#f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><span class="hs-identifier hs-var">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679412739"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412740"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-447"></a><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">sev</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">tar</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412741"><a href="#local-6989586621679412741"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="V.html#f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><span class="hs-identifier hs-var">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>                                                                  </span><span class="hs-keyword">in</span><span> </span><a href="V.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412741"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">tar</span></a><span> </span><a href="#local-6989586621679412739"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412740"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-comment">-- | &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12398;&#20869;&#26368;&#22823;&#12398;&#38917;&#30446;&#12398;&#29987;&#26989;&#20998;&#39006;&#12434;&#21462;&#24471;</span><span>
</span><a name="line-452"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><a href="VClass.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span>
</span><a name="line-453"></a><a name="f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><a href="V.html#f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-454"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412742"><a href="#local-6989586621679412742"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412743"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-455"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679412743"><a href="#local-6989586621679412743"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#vmaximumsNameWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumsNameWithoutErr</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><a href="V.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412742"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-comment">-- | &#12431;&#12369;&#12431;&#12363;&#12425;&#12435;&#25991;&#23383;&#21015;&#12395;&#23550;&#12377;&#12427;&#20966;&#29702;&#65292;Map&#20351;&#12358;&#12392;&#36933;&#12356;&#12398;&#12391;&#65292;&#12392;&#12426;&#12354;&#12360;&#12378;&#20986;&#12390;&#12365;&#12383;&#12497;&#12479;&#12540;&#12531;&#12395;&#23550;&#24540;&#12377;&#12427;</span><span>
</span><a name="line-458"></a><a name="notSuiteCarName"><a href="V.html#notSuiteCarName"><span class="hs-identifier">notSuiteCarName</span></a></a><span> </span><a name="local-6989586621679412744"><a href="#local-6989586621679412744"><span class="hs-identifier">tx</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.null</span><span> </span><a href="#local-6989586621679412744"><span class="hs-identifier hs-var">tx</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-459"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.all</span><span> </span><span class="hs-special">(</span><span class="hs-char">' '</span><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679412744"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-460"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.all</span><span> </span><span class="hs-special">(</span><span class="hs-char">'&#12288;'</span><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412744"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-461"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-comment">-- | &#20107;&#21069;&#26684;&#20184;&#12434;&#21033;&#29992;&#12375;&#12383;&#20966;&#29702;</span><span>
</span><a name="line-465"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-466"></a><span class="hs-identifier">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="VClass.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-467"></a><a name="f%4E8B%524D%683C%4ED8%51E6%7406"><a href="V.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412745"><a href="#local-6989586621679412745"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679412746"><a href="#local-6989586621679412746"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679412747"><a href="#local-6989586621679412747"><span class="hs-identifier">es</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.null</span><span> </span><a href="#local-6989586621679412745"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412746"><span class="hs-identifier hs-var">en</span></a><span class="hs-special">,</span><a href="#local-6989586621679412747"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-468"></a><span>                                        </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#generalCNC"><span class="hs-identifier hs-var">generalCNC</span></a><span>
</span><a name="line-469"></a><span>                                        </span><span class="hs-special">(</span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679412748"><a href="#local-6989586621679412748"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412748"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-470"></a><span>                                        </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span>        </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679412749"><a href="#local-6989586621679412749"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412749"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-471"></a><span>                                        </span><span class="hs-special">(</span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679412750"><a href="#local-6989586621679412750"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679412751"><a href="#local-6989586621679412751"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412751"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-472"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.minimum</span><span> </span><a href="#local-6989586621679412745"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-comment">-- | &#20107;&#26989;&#20869;&#23481;&#31561;&#19981;&#35443;</span><span>
</span><a name="line-475"></a><a name="generalCNC"><a href="V.html#generalCNC"><span class="hs-identifier">generalCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span>  </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-476"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-477"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;15#&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;35#&#9651;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-comment">-- | &#19982;&#12360;&#12425;&#12428;&#12383;&#26368;&#19979;&#23652;&#29987;&#26989;&#20998;&#39006;&#12434;&#21033;&#29992;&#12375;&#12390;,&#29987;&#26989;&#26684;&#20184;&#12434;&#22475;&#12417;&#12427;</span><span>
</span><a name="line-484"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-485"></a><a name="f%7523%696D%683C%4ED8%88DC%5B8C"><a href="V.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a></a><span> </span><a name="local-6989586621679412752"><a href="#local-6989586621679412752"><span class="hs-identifier">ind</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="V.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="V.html#generalCNC"><span class="hs-identifier hs-var">generalCNC</span></a><span>
</span><a name="line-486"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#Large"><span class="hs-identifier hs-var">Large</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="#local-6989586621679412755"><span class="hs-identifier hs-var">oemp</span></a><span> </span><a href="#local-6989586621679412756"><span class="hs-identifier hs-var">memp</span></a><span> </span><a href="#local-6989586621679412757"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="#local-6989586621679412758"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-487"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#Business"><span class="hs-identifier hs-var">Business</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679412755"><span class="hs-identifier hs-var">oemp</span></a><span> </span><a href="#local-6989586621679412756"><span class="hs-identifier hs-var">memp</span></a><span> </span><a href="#local-6989586621679412757"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="#local-6989586621679412758"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-488"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#OF"><span class="hs-identifier hs-var">OF</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="#local-6989586621679412756"><span class="hs-identifier hs-var">memp</span></a><span> </span><a href="#local-6989586621679412757"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="#local-6989586621679412758"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-489"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#Middle"><span class="hs-identifier hs-var">Middle</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679412762"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="#local-6989586621679412757"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="#local-6989586621679412758"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-490"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#Small"><span class="hs-identifier hs-var">Small</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679412762"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679412763"><span class="hs-identifier hs-var">m</span></a><span>    </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="#local-6989586621679412758"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-491"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#TF"><span class="hs-identifier hs-var">TF</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679412762"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679412763"><span class="hs-identifier hs-var">m</span></a><span>    </span><a href="#local-6989586621679412764"><span class="hs-identifier hs-var">s</span></a><span>    </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-492"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#Detail"><span class="hs-identifier hs-var">Detail</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679412762"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679412763"><span class="hs-identifier hs-var">m</span></a><span>    </span><a href="#local-6989586621679412764"><span class="hs-identifier hs-var">s</span></a><span>    </span><a href="#local-6989586621679412765"><span class="hs-identifier hs-var">t</span></a><span>    </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span>
</span><a name="line-493"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span>    </span><a name="local-6989586621679412753"><a href="#local-6989586621679412753"><span class="hs-identifier">indStratum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VClass.html#whichStratum"><span class="hs-identifier hs-var">whichStratum</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span>
</span><a name="line-496"></a><span>    </span><a name="local-6989586621679412754"><a href="#local-6989586621679412754"><span class="hs-identifier">lemp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&quot;</span><span>
</span><a name="line-497"></a><span>    </span><a name="local-6989586621679412755"><a href="#local-6989586621679412755"><span class="hs-identifier">oemp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;15#&#9651;&#9651;&quot;</span><span>
</span><a name="line-498"></a><span>    </span><a name="local-6989586621679412756"><a href="#local-6989586621679412756"><span class="hs-identifier">memp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&quot;</span><span>
</span><a name="line-499"></a><span>    </span><a name="local-6989586621679412757"><a href="#local-6989586621679412757"><span class="hs-identifier">semp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&quot;</span><span>
</span><a name="line-500"></a><span>    </span><a name="local-6989586621679412758"><a href="#local-6989586621679412758"><span class="hs-identifier">temp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;35#&#9651;&#9651;&#9651;&quot;</span><span>
</span><a name="line-501"></a><span>    </span><a name="local-6989586621679412759"><a href="#local-6989586621679412759"><span class="hs-identifier">demp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&#9651;&quot;</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span>    </span><a name="local-6989586621679412760"><a href="#local-6989586621679412760"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679412766"><a href="#local-6989586621679412766"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679412767"><a href="#local-6989586621679412767"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="V.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span> </span><a href="#local-6989586621679412766"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412767"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-504"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="VClass.html#elevateStratum"><span class="hs-identifier hs-var">elevateStratum</span></a><span> </span><a href="#local-6989586621679412766"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679412767"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-505"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679412768"><a href="#local-6989586621679412768"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412768"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-506"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">demp</span></a><span> </span><a href="#local-6989586621679412767"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-507"></a><span>
</span><a name="line-508"></a><span>    </span><a name="local-6989586621679412761"><a href="#local-6989586621679412761"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VClass.html#Large"><span class="hs-identifier hs-var">Large</span></a><span>
</span><a name="line-509"></a><span>    </span><a name="local-6989586621679412762"><a href="#local-6989586621679412762"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VClass.html#OF"><span class="hs-identifier hs-var">OF</span></a><span>
</span><a name="line-510"></a><span>    </span><a name="local-6989586621679412763"><a href="#local-6989586621679412763"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VClass.html#Middle"><span class="hs-identifier hs-var">Middle</span></a><span>
</span><a name="line-511"></a><span>    </span><a name="local-6989586621679412764"><a href="#local-6989586621679412764"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VClass.html#Small"><span class="hs-identifier hs-var">Small</span></a><span>
</span><a name="line-512"></a><span>    </span><a name="local-6989586621679412765"><a href="#local-6989586621679412765"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VClass.html#TF"><span class="hs-identifier hs-var">TF</span></a><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span>
</span><a name="line-515"></a><span class="hs-comment">-- | &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#20869;&#26368;&#22823;&#12398;&#38917;&#30446;&#12398;&#29987;&#26989;&#20998;&#39006;&#12434;&#21462;&#24471;</span><span>
</span><a name="line-516"></a><span class="hs-comment">--  </span><span>
</span><a name="line-517"></a><span class="hs-comment">--   &#29987;&#26989;&#20998;&#39006;&#12395;&#35598;&#12398;&#12418;&#12398;&#12364;&#28151;&#12374;&#12387;&#12390;&#12356;&#12383;&#12425;&#12371;&#12371;&#12391;&#38500;&#21435;&#12377;&#12427;</span><span>
</span><a name="line-518"></a><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">]</span><span>
</span><a name="line-521"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-522"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span>
</span><a name="line-523"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span>
</span><a name="line-524"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-525"></a><a name="f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><a href="V.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412769"><a href="#local-6989586621679412769"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679412770"><a href="#local-6989586621679412770"><span class="hs-identifier">tar</span></a></a><span> </span><a name="local-6989586621679412771"><a href="#local-6989586621679412771"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679412772"><a href="#local-6989586621679412772"><span class="hs-identifier">es</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412770"><span class="hs-identifier hs-var">tar</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.null</span><span> </span><a href="#local-6989586621679412769"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412769"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679412771"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412772"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-526"></a><span>                                            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412770"><span class="hs-identifier hs-var">tar</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412773"><a href="#local-6989586621679412773"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412770"><span class="hs-identifier hs-var">tar</span></a><span>
</span><a name="line-527"></a><span>                                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412774"><a href="#local-6989586621679412774"><span class="hs-identifier">csSafe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412775"><a href="#local-6989586621679412775"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="V.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span class="hs-operator hs-var">.</span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412775"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-528"></a><span>                                                                                        </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679412775"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-529"></a><span>                                                                                        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679412775"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412773"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-530"></a><span>                                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412776"><a href="#local-6989586621679412776"><span class="hs-identifier">looped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#generalLoop"><span class="hs-identifier hs-var">generalLoop</span></a><span> </span><a href="#local-6989586621679412769"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679412773"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-531"></a><span>                                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679412776"><span class="hs-identifier hs-var">looped</span></a><span>  </span><span class="hs-keyword">of</span><span>
</span><a name="line-532"></a><span>                                                            </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="V.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412769"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679412771"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412772"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-533"></a><span>                                                            </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="V.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.head</span><span> </span><a href="#local-6989586621679412776"><span class="hs-identifier hs-var">looped</span></a><span>
</span><a name="line-534"></a><span>                                                            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="V.html#f%6700%4E0B%5C64%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#26368;&#19979;&#23652;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412769"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679412773"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679412771"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412772"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span class="hs-comment">-- | &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#32368;&#12426;&#36820;&#12375;&#37096;&#20998;</span><span>
</span><a name="line-537"></a><span class="hs-comment">--</span><span>
</span><a name="line-538"></a><span class="hs-comment">--   &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12395;&#12399;&#26368;&#19979;&#23652;&#20197;&#22806;&#12399;&#12394;&#12356;</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- </span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-identifier">generalLoop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="VClass.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^&#20107;&#26989;&#20998;&#39006;&#12391;&#19982;&#12360;&#12425;&#12428;&#12383;,&#26368;&#22823;&#21306;&#20998;</span><span>
</span><a name="line-542"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-543"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">]</span><span>
</span><a name="line-544"></a><a name="generalLoop"><a href="V.html#generalLoop"><span class="hs-identifier">generalLoop</span></a></a><span> </span><a name="local-6989586621679412777"><a href="#local-6989586621679412777"><span class="hs-identifier">higs</span></a></a><span> </span><a name="local-6989586621679412778"><a href="#local-6989586621679412778"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-545"></a><span>                </span><a name="local-6989586621679412793"><a href="#local-6989586621679412793"><span class="hs-identifier">top</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><a href="#local-6989586621679412777"><span class="hs-identifier hs-var">higs</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412792"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412792"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-546"></a><span>                </span><a name="local-6989586621679412795"><a href="#local-6989586621679412795"><span class="hs-identifier">tmpMaxValue</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412794"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412794"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span>                </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-special">[</span><a href="VClass.html#Detail"><span class="hs-identifier hs-var">Detail</span></a><span> </span><span class="hs-glyph">..</span><span> </span><a href="VClass.html#Business"><span class="hs-identifier hs-var">Business</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412796"><a href="#local-6989586621679412796"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-549"></a><span>                    </span><a name="local-6989586621679412797"><a href="#local-6989586621679412797"><span class="hs-identifier">currentTop</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679412793"><span class="hs-identifier hs-var">top</span></a><span>
</span><a name="line-550"></a><span>                    </span><a name="local-6989586621679412798"><a href="#local-6989586621679412798"><span class="hs-identifier">tmpTop</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- &#19979;&#20301;&#20998;&#39006;&#12364;[]&#12398;&#22580;&#21512;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412799"><a href="#local-6989586621679412799"><span class="hs-identifier">tmpCs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412780"><span class="hs-identifier hs-var">filtSelect</span></a><span> </span><a href="#local-6989586621679412797"><span class="hs-identifier hs-var">currentTop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412779"><span class="hs-identifier hs-var">convToStratum</span></a><span> </span><a href="#local-6989586621679412778"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679412796"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span>                    </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679412795"><span class="hs-identifier hs-var">tmpMaxValue</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span>                    </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679412799"><span class="hs-identifier hs-var">tmpCs</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679412800"><a href="#local-6989586621679412800"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-556"></a><span>                        </span><a name="local-6989586621679412801"><a href="#local-6989586621679412801"><span class="hs-identifier">currentMaxValue</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679412795"><span class="hs-identifier hs-var">tmpMaxValue</span></a><span>
</span><a name="line-557"></a><span>                        </span><a name="local-6989586621679412802"><a href="#local-6989586621679412802"><span class="hs-identifier">currentTmpTop</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679412798"><span class="hs-identifier hs-var">tmpTop</span></a><span>
</span><a name="line-558"></a><span>                        </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span>  </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412800"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679412801"><span class="hs-identifier hs-var">currentMaxValue</span></a><span class="hs-special">)</span><span>
</span><a name="line-559"></a><span>                             </span><span class="hs-special">(</span><span>  </span><span class="hs-identifier hs-var">writeSTRef</span><span>  </span><a href="#local-6989586621679412795"><span class="hs-identifier hs-var">tmpMaxValue</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412800"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-560"></a><span>                             </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span>  </span><a href="#local-6989586621679412798"><span class="hs-identifier hs-var">tmpTop</span></a><span>         </span><span class="hs-special">[</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412800"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span>                        </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span>  </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412800"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679412801"><span class="hs-identifier hs-var">currentMaxValue</span></a><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span>                             </span><span class="hs-special">(</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span>  </span><a href="#local-6989586621679412798"><span class="hs-identifier hs-var">tmpTop</span></a><span>         </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412800"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span>                    </span><a name="local-6989586621679412803"><a href="#local-6989586621679412803"><span class="hs-identifier">currentTmpTop</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679412798"><span class="hs-identifier hs-var">tmpTop</span></a><span>
</span><a name="line-566"></a><span>                    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.null</span><span> </span><a href="#local-6989586621679412803"><span class="hs-identifier hs-var">currentTmpTop</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679412793"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679412803"><span class="hs-identifier hs-var">currentTmpTop</span></a><span class="hs-special">)</span><span>
</span><a name="line-567"></a><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span>                </span><a name="local-6989586621679412804"><a href="#local-6989586621679412804"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679412793"><span class="hs-identifier hs-var">top</span></a><span>
</span><a name="line-570"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679412804"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-573"></a><span>                </span><span class="hs-comment">--  &#19982;&#12360;&#12425;&#12428;&#12383;Stratum&#12395;Cars&#12434;&#22793;&#25563;&#32113;&#21512;&#12377;&#12427;</span><span>
</span><a name="line-574"></a><span>                </span><span class="hs-identifier">convToStratum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VClass.html#Stratum"><span class="hs-identifier hs-type">Stratum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-575"></a><span>                </span><a name="local-6989586621679412779"><a href="#local-6989586621679412779"><span class="hs-identifier">convToStratum</span></a></a><span> </span><a name="local-6989586621679412781"><a href="#local-6989586621679412781"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679412782"><a href="#local-6989586621679412782"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span>
</span><a name="line-576"></a><span>                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier hs-var">Maybe.fromJust</span><span>
</span><a name="line-577"></a><span>                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-identifier hs-var">Maybe.isJust</span><span>
</span><a name="line-578"></a><span>                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412783"><span class="hs-identifier hs-var">elevateStratumOfCar</span></a><span> </span><a href="#local-6989586621679412782"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412781"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-579"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-580"></a><span>                    </span><span class="hs-identifier">elevateStratumOfCar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Stratum"><span class="hs-identifier hs-type">Stratum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-581"></a><span>                    </span><a name="local-6989586621679412783"><a href="#local-6989586621679412783"><span class="hs-identifier">elevateStratumOfCar</span></a></a><span> </span><a name="local-6989586621679412784"><a href="#local-6989586621679412784"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-6989586621679412785"><a href="#local-6989586621679412785"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="VClass.html#elevateStratum"><span class="hs-identifier hs-var">elevateStratum</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412785"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412784"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-582"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679412786"><a href="#local-6989586621679412786"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412785"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412786"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-583"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-584"></a><span>
</span><a name="line-585"></a><span>                </span><span class="hs-comment">--  &#25351;&#23450;&#12373;&#12428;&#12383;&#29987;&#26989;&#20998;&#39006;&#12398;&#19979;&#20301;&#20998;&#39006;&#12384;&#12369;&#12391;filter&#12434;&#12363;&#12369;&#12427;</span><span>
</span><a name="line-586"></a><span>                </span><span class="hs-identifier">filtSelect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="VClass.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-587"></a><span>                </span><a name="local-6989586621679412780"><a href="#local-6989586621679412780"><span class="hs-identifier">filtSelect</span></a></a><span> </span><a name="local-6989586621679412787"><a href="#local-6989586621679412787"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679412788"><a href="#local-6989586621679412788"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412789"><a href="#local-6989586621679412789"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679412790"><a href="#local-6989586621679412790"><span class="hs-identifier">hig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412791"><a href="#local-6989586621679412791"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VClass.html#isMemberOf"><span class="hs-identifier hs-var">isMemberOf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412791"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412790"><span class="hs-identifier hs-var">hig</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412788"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-588"></a><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">V.concat</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><a href="#local-6989586621679412789"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679412787"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-589"></a><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-comment">-- &#26368;&#19979;&#23652;&#12395;&#34892;&#12387;&#12390;&#12418;,&#37325;&#35079;&#12364;&#12354;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-592"></a><span class="hs-identifier">f&#26368;&#19979;&#23652;&#26684;&#20184;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-593"></a><a name="f%6700%4E0B%5C64%683C%4ED8%51E6%7406"><a href="V.html#f%6700%4E0B%5C64%683C%4ED8%51E6%7406"><span class="hs-identifier">f&#26368;&#19979;&#23652;&#26684;&#20184;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412805"><a href="#local-6989586621679412805"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679412806"><a href="#local-6989586621679412806"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679412807"><a href="#local-6989586621679412807"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679412808"><a href="#local-6989586621679412808"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.null</span><span>   </span><a href="#local-6989586621679412805"><span class="hs-identifier hs-var">xs</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="V.html#generalCNC"><span class="hs-identifier hs-var">generalCNC</span></a><span>
</span><a name="line-594"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679412805"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.head</span><span> </span><a href="#local-6989586621679412805"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-595"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679412805"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412805"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679412807"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679412808"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-602"></a><span class="hs-comment">-- ** &#29305;&#27530;&#12394;&#26041;&#27861;</span><span>
</span><a name="line-603"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-604"></a><span class="hs-comment">{- | &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12395;&#24540;&#12376;&#12390;&#20197;&#19979;&#12398;&#20491;&#21029;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358; 

     * &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#21450;&#12403;&#65292;&#26684;&#20184;&#12369;&#19981;&#33021;&#12418;&#12381;&#12428;&#12382;&#12428;&#12398;&#20966;&#29702;&#12391;&#34892;&#12358;&#65294;
    
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12391;&#12399;&#65292;
     &#12418;&#12387;&#12401;&#12425;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#12381;&#12398;&#20869;&#23481;&#12395;&#38306;&#12375;&#12390;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#65292;&#35036;&#21161;&#30340;&#26989;&#21209;&#65292;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12363;&#12425;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;

     &#24403;&#35442;&#35519;&#26619;&#38917;&#30446;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#65292;
     &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#29987;&#26989;&#21306;&#20998;&#12392;&#26368;&#12418;&#36817;&#12356;&#21306;&#20998;&#12398;&#12300;&#20027;&#12392;&#12375;&#12390;&#31649;&#29702;&#20107;&#21209;&#12434;&#34892;&#12358;&#26412;&#31038;&#31561;&#12301;&#65292;
    &#12300;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12375;&#65292;
     &#21452;&#26041;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152; &#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#12301;&#12392;&#12377;&#12427;&#65294;

     &#12414;&#12383;&#65292;&#29305;&#27530;&#12394;&#26041;&#27861;&#21450;&#12403;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#32080;&#26524;&#65292;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12395;&#21306;&#20998;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12395;&#12362;&#12356;&#12390;&#65292;
     &#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#65292;&#26368;&#12418;&#36817;&#12356;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;

     &#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#20197;&#22806;&#12391;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;


    * &#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#25201;&#12356;

    &#12300;&#9675;&#9675; &#20869;&#26684;&#20184;&#19981;&#33021;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#12381;&#12398;&#23646;&#12377;&#12427;&#29987;&#26989;&#20998;&#39006;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#65292;
    &#20182;&#12398;&#20107;&#26989;&#25152;&#12398;&#24179;&#22343;&#30340;&#12394;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#22770;&#19978;&#39640;&#12391;&#65292;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12398;&#24403;&#35442;&#38917;&#30446;&#12398;&#38989;&#12434;&#25353;&#20998;&#12377;&#12427;&#65294;

    f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#20840;&#33324; &#12391;&#12399;&#65292;&#20491;&#21029;&#12398;&#20966;&#29702;&#12434;&#12377;&#12409;&#12390;&#32113;&#21512;&#12377;&#12427;&#65294;
    &#21508;&#35519;&#26619;&#31080;&#65292;&#29987;&#26989;&#12398;&#20966;&#29702;&#12399;&#20491;&#21029;&#12398;&#38306;&#25968; f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12295;&#12295;&#29987;&#26989; &#12434;&#35519;&#25972;&#12377;&#12427;&#12371;&#12392;&#65294;
    
-}</span><span>
</span><a name="line-631"></a><span>
</span><a name="line-632"></a><span>
</span><a name="line-633"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-634"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5"><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;</span></a></a><span> </span><a name="local-6989586621679412809"><a href="#local-6989586621679412809"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412810"><a href="#local-6989586621679412810"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-635"></a><span>    </span><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%88FD%9020%696D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#35069;&#36896;&#26989;</span></a><span>       </span><a href="#local-6989586621679412809"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-636"></a><span>    </span><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5546%696D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21830;&#26989;</span></a><span>         </span><a href="#local-6989586621679412809"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-637"></a><span>    </span><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%533B%7642%798F%7949"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21307;&#30274;&#31119;&#31049;</span></a><span>          </span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-638"></a><span>    </span><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%30B5B"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12469;B</span></a><span>          </span><a href="#local-6989586621679412809"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-639"></a><span>    </span><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5354%540C%7D44%5408"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21332;&#21516;&#32068;&#21512;</span></a><span>          </span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-640"></a><span>    </span><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5EFA%30B5A"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A</span></a><span>        </span><a href="#local-6989586621679412809"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-641"></a><span>
</span><a name="line-642"></a><span>
</span><a name="line-643"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-644"></a><span class="hs-comment">-- *** &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12395;&#23550;&#24540;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-645"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-646"></a><span>
</span><a name="line-647"></a><span class="hs-comment">-- | &#21830;&#26989;&#12363;&#21542;&#12363;</span><span>
</span><a name="line-648"></a><span class="hs-keyword">type</span><span> </span><a name="IsCommerce"><a href="V.html#IsCommerce"><span class="hs-identifier">IsCommerce</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-649"></a><span>
</span><a name="line-650"></a><span class="hs-comment">{- | E&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209; &#12395;&#24540;&#12376;&#12390;&#65292;&#23550;&#24540;&#12377;&#12427;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#32048;&#12363;&#12356;&#20998;&#39006;&#12434;&#36820;&#12377;&#38306;&#25968;&#12434;&#20316;&#25104;&#12377;&#12427;&#38306;&#25968;
    
    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12391;&#12399;&#65292;
    &#12418;&#12387;&#12401;&#12425;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#12381;&#12398;&#20869;&#23481;&#12395;&#38306;&#12375;&#12390;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#65292;&#35036;&#21161;&#30340;&#26989;&#21209;&#65292;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12363;&#12425;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;
    &#24403;&#35442;&#35519;&#26619;&#38917;&#30446;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#65292;
    &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#29987;&#26989;&#21306;&#20998;&#12392;&#26368;&#12418;&#36817;&#12356;&#21306;&#20998;&#12398;&#12300;&#20027;&#12392;&#12375;&#12390;&#31649;&#29702;&#20107;&#21209;&#12434;&#34892;&#12358;&#26412;&#31038;&#31561;&#12301;&#65292;
    &#12300;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;
    &#12414;&#12383;&#65292;&#29305;&#27530;&#12394;&#26041;&#27861;&#21450;&#12403;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#32080;&#26524;&#65292;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12395;&#21306;&#20998;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#65292;
    &#26368;&#12418;&#36817;&#12356;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;
    &#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#20197;&#22806;&#12391;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;


    * &#20027;&#12392;&#12375;&#12390;&#31649;&#29702;&#20107;&#21209;&#12434;&#34892;&#12358;&#26412;&#31038;&#31561;
    
        &gt; &#19979;&#20108;&#26689;&#12364;00

    * &#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;
    
        &gt; &#19979;&#20108;&#26689;&#12364;09

    * &#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152; &#20869;&#26684;&#20184;&#19981;&#33021;
        
        &gt; &#19979;&#65298;&#26689;&#12364;0Z
        &gt; &#12383;&#12384;&#12375;&#65292;&#12371;&#12428;&#12395;&#20998;&#39006;&#12373;&#12428;&#12427;&#26465;&#20214;&#12364;&#19981;&#26126;&#12394;&#12383;&#12417;&#20351;&#29992;&#12375;&#12394;&#12356;

    * &#33258;&#23478;&#29992;&#20489;&#24235;

        &gt; &#19979;&#65298;&#26689;&#12364;08

    * &#29987;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#22580;&#21512;

        &gt; &#29987;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#12399;&#19979;&#65298;&#26689;&#12364;ZZ 
        &gt; &#26684;&#20184;&#19981;&#33021;&#12399;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#12414;&#12414;&#20966;&#29702;&#12377;&#12427;&#65288;&#23455;&#38555;&#12395;&#12393;&#12398;&#12424;&#12358;&#12395;&#12375;&#12390;&#12356;&#12427;&#12398;&#12363;&#35519;&#12409;&#12427;&#24517;&#35201;&#12354;&#12426;&#65289;

-}</span><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-identifier">makeManagementClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span>
</span><a name="line-688"></a><a name="makeManagementClass"><a href="V.html#makeManagementClass"><span class="hs-identifier">makeManagementClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412812"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-689"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-690"></a><span>
</span><a name="line-691"></a><span>    </span><span class="hs-comment">-- &#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#23550;&#31574;</span><span>
</span><a name="line-692"></a><span>    </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span>
</span><a name="line-693"></a><span>    </span><a name="local-6989586621679412811"><a href="#local-6989586621679412811"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679412813"><a href="#local-6989586621679412813"><span class="hs-identifier">tx1</span></a></a><span> </span><a name="local-6989586621679412814"><a href="#local-6989586621679412814"><span class="hs-identifier">tx2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">TL.drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679412813"><span class="hs-identifier hs-var">tx1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;ZZ&quot;</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-694"></a><span>                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679412813"><span class="hs-identifier hs-var">tx1</span></a><span>
</span><a name="line-695"></a><span>                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">TL.append</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679412813"><span class="hs-identifier hs-var">tx1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412814"><span class="hs-identifier hs-var">tx2</span></a><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span>
</span><a name="line-698"></a><span>    </span><a name="local-6989586621679412812"><a href="#local-6989586621679412812"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                               </span><a name="local-6989586621679412815"><a href="#local-6989586621679412815"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412815"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-699"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">(</span><a href="VDS.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VDS.html#E%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">E&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span class="hs-special">)</span><span>   </span><a name="local-6989586621679412816"><a href="#local-6989586621679412816"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412811"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679412816"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;00&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-special">(</span><a href="VDS.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VDS.html#E%81EA%5BB6%7528%5009%5EAB"><span class="hs-identifier hs-var">E&#33258;&#23478;&#29992;&#20489;&#24235;</span></a><span>    </span><span class="hs-special">)</span><span>   </span><a name="local-6989586621679412817"><a href="#local-6989586621679412817"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412811"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679412817"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;08&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VDS.html#E%81EA%5BB6%7528%5009%5EAB"><span class="hs-identifier hs-var">E&#33258;&#23478;&#29992;&#20489;&#24235;</span></a><span>    </span><span class="hs-special">)</span><span>   </span><a name="local-6989586621679412818"><a href="#local-6989586621679412818"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412811"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679412818"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;09&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-702"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">(</span><a href="VDS.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VDS.html#E%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">E&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>    </span><span class="hs-special">)</span><span>   </span><a name="local-6989586621679412819"><a href="#local-6989586621679412819"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412811"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679412819"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;09&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span>
</span><a name="line-706"></a><span class="hs-comment">-- | H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640; &#12398;Cars &#12434; &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12395;&#22793;&#25563;&#12377;&#12427;</span><span>
</span><a name="line-707"></a><span class="hs-identifier">convMCinCars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-708"></a><a name="convMCinCars"><a href="V.html#convMCinCars"><span class="hs-identifier">convMCinCars</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412820"><a href="#local-6989586621679412820"><span class="hs-identifier">bl</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412821"><a href="#local-6989586621679412821"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412822"><a href="#local-6989586621679412822"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412825"><span class="hs-identifier hs-var">merge</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412823"><span class="hs-identifier hs-var">converted</span></a><span class="hs-special">)</span><span>
</span><a name="line-709"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-710"></a><span>    </span><a name="local-6989586621679412823"><a href="#local-6989586621679412823"><span class="hs-identifier">converted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412826"><a href="#local-6989586621679412826"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412827"><a href="#local-6989586621679412827"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412826"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679412826"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#makeManagementClass"><span class="hs-identifier hs-var">makeManagementClass</span></a><span> </span><a href="#local-6989586621679412820"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621679412821"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679412827"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412822"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-711"></a><span>
</span><a name="line-712"></a><span>    </span><span class="hs-identifier">part</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">)</span><span>
</span><a name="line-713"></a><span>    </span><a name="local-6989586621679412824"><a href="#local-6989586621679412824"><span class="hs-identifier">part</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679412828"><a href="#local-6989586621679412828"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span>   </span><a href="#local-6989586621679412828"><span class="hs-identifier hs-var">cs</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-714"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-6989586621679412828"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412828"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412833"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412832"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-716"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-717"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412829"><a href="#local-6989586621679412829"><span class="hs-identifier">hd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.head</span><span> </span><a href="#local-6989586621679412828"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-718"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412830"><a href="#local-6989586621679412830"><span class="hs-identifier">hdName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412829"><span class="hs-identifier hs-var">hd</span></a><span>
</span><a name="line-719"></a><span>        </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679412831"><a href="#local-6989586621679412831"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span class="hs-glyph">!</span><a name="local-6989586621679412832"><a href="#local-6989586621679412832"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.partition</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412834"><a href="#local-6989586621679412834"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412834"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679412830"><span class="hs-identifier hs-var">hdName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412828"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-720"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412833"><a href="#local-6989586621679412833"><span class="hs-identifier">l2</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412831"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412830"><span class="hs-identifier hs-var">hdName</span></a><span>
</span><a name="line-721"></a><span>
</span><a name="line-722"></a><span>
</span><a name="line-723"></a><span>    </span><span class="hs-identifier">merge</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-724"></a><span>    </span><a name="local-6989586621679412825"><a href="#local-6989586621679412825"><span class="hs-identifier">merge</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679412835"><a href="#local-6989586621679412835"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span class="hs-glyph">!</span><a name="local-6989586621679412836"><a href="#local-6989586621679412836"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679412836"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412835"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-725"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679412837"><a href="#local-6989586621679412837"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span class="hs-glyph">!</span><a name="local-6989586621679412838"><a href="#local-6989586621679412838"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412824"><span class="hs-identifier hs-var">part</span></a><span> </span><a href="#local-6989586621679412836"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-726"></a><span>                                 </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679412825"><span class="hs-identifier hs-var">merge</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412835"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679412837"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412838"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><span>
</span><a name="line-729"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-730"></a><span class="hs-comment">-- *** &#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-731"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-732"></a><span class="hs-comment">-- | &#26684;&#20184;&#12369;&#19981;&#33021;&#12394;&#20998;&#39006;&#21517; CNC : CanNotClassify</span><span>
</span><a name="line-733"></a><span class="hs-keyword">type</span><span> </span><a name="CNCName"><a href="V.html#CNCName"><span class="hs-identifier">CNCName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span class="hs-comment">-- | &#26684;&#20184;&#12369;&#19981;&#33021;&#12395;&#36969;&#29992;&#12377;&#12427;&#29983;&#29987;&#29289;&#21029;&#12398;&#25353;&#20998;&#27604;&#29575;</span><span>
</span><a name="line-736"></a><span class="hs-keyword">type</span><span> </span><a name="RateMap"><a href="V.html#RateMap"><span class="hs-identifier">RateMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-737"></a><span>
</span><a name="line-738"></a><span>
</span><a name="line-739"></a><span class="hs-comment">-- | &#19982;&#12360;&#12425;&#12428;&#12383;&#26684;&#20184;&#12369;&#19981;&#33021;&#20998;&#39006;&#21517;&#12434;&#12418;&#12388;Car&#12434;RateMap&#12395;&#24467;&#12387;&#12390;&#25353;&#20998;&#12377;&#12427;&#65294;</span><span>
</span><a name="line-740"></a><span class="hs-identifier">propDivCNC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="V.html#CNCName"><span class="hs-identifier hs-type">CNCName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#RateMap"><span class="hs-identifier hs-type">RateMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-741"></a><a name="propDivCNC"><a href="V.html#propDivCNC"><span class="hs-identifier">propDivCNC</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-742"></a><span class="hs-identifier">propDivCNC</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621679412839"><a href="#local-6989586621679412839"><span class="hs-identifier">vc</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412839"><span class="hs-identifier hs-var">vc</span></a><span>
</span><a name="line-743"></a><span class="hs-identifier">propDivCNC</span><span> </span><a name="local-6989586621679412840"><a href="#local-6989586621679412840"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679412841"><a href="#local-6989586621679412841"><span class="hs-identifier">rm</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412842"><a href="#local-6989586621679412842"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.foldl1</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412844"><span class="hs-identifier hs-var">propDiv</span></a><span> </span><a href="#local-6989586621679412840"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679412843"><span class="hs-identifier hs-var">rmList</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412842"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-744"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-745"></a><span>    </span><a name="local-6989586621679412843"><a href="#local-6989586621679412843"><span class="hs-identifier">rmList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.toList</span><span> </span><a href="#local-6989586621679412841"><span class="hs-identifier hs-var">rm</span></a><span>
</span><a name="line-746"></a><span>    </span><span class="hs-identifier">propDiv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="V.html#CNCName"><span class="hs-identifier hs-type">CNCName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-747"></a><span>    </span><a name="local-6989586621679412844"><a href="#local-6989586621679412844"><span class="hs-identifier">propDiv</span></a></a><span> </span><a name="local-6989586621679412845"><a href="#local-6989586621679412845"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679412846"><a href="#local-6989586621679412846"><span class="hs-identifier">rm</span></a></a><span> </span><a name="local-6989586621679412847"><a href="#local-6989586621679412847"><span class="hs-identifier">cr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412847"><span class="hs-identifier hs-var">cr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412845"><span class="hs-identifier hs-var">xs</span></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412848"><a href="#local-6989586621679412848"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412847"><span class="hs-identifier hs-var">cr</span></a><span>
</span><a name="line-748"></a><span>                                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span>
</span><a name="line-749"></a><span>                                            </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412849"><a href="#local-6989586621679412849"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412848"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679412849"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679412849"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412846"><span class="hs-identifier hs-var">rm</span></a><span>
</span><a name="line-750"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><a href="#local-6989586621679412847"><span class="hs-identifier hs-var">cr</span></a><span>
</span><a name="line-751"></a><span>
</span><a name="line-752"></a><span>
</span><a name="line-753"></a><span class="hs-comment">-- *** &#35069;&#36896;&#26989;</span><span>
</span><a name="line-754"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-755"></a><span class="hs-comment">{- | 
    &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12398;&#24460;&#65292;&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12392;&#12398;&#23550;&#24540;&#38306;&#20418;&#12395;&#22522;&#12389;&#12365;&#21697;&#30446;&#12434;&#32232;&#32386;&#12377;&#12427;&#65294;
    &#35069;&#36896;&#26989;&#12395;&#12362;&#12369;&#12427;&#29305;&#27530;&#12394;&#26041;&#27861;&#12399;&#65292;&#12300;&#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#20998;&#39006;&#38306;&#20418;&#36039;&#26009; &#29987;&#26989;&#26684;&#20184;&#12398;&#26041;&#27861;&#12301;
    &#12395;&#12362;&#12356;&#12390;&#35299;&#35500;&#12373;&#12428;&#12390;&#12356;&#12427;&#20197;&#19979;&#12398;&#35352;&#36848;&#20197;&#22806;&#12395;&#36039;&#26009;&#12434;&#35211;&#12388;&#12369;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12394;&#12363;&#12387;&#12383;&#65294;
    
    &#19978;&#35352;&#12398;&#26041;&#27861;&#20197;&#22806;&#12395;&#12289;&#21407;&#26448;&#26009;&#12289;&#20316;&#26989;&#24037;&#31243;&#12289;&#27231;&#26800;&#35373;&#20633;&#31561;&#12395;&#12424;&#12426;&#12289;
    &#29987;&#26989;&#12434;&#27770;&#23450;&#12375;&#12390;&#12356;&#12427;&#12418;&#12398;&#12364;&#12354;&#12427;&#12290;&#12381;&#12398;&#29987;&#26989;&#12392;&#12399;&#12289;&#12300;&#20013;&#20998;&#39006;22 &#37444;&#37628;&#26989;&#12301;&#12395;&#23646;&#12377;&#12427;&#12300;&#39640;&#28809;&#12395;&#12424;&#12427;&#35069;&#37444;&#26989;&#12301;&#12289;
    &#12300;&#35069;&#37628;&#12539;&#35069;&#37509;&#22311;&#24310;&#26989;&#65288;&#36578;&#28809;&#12539;&#38651;&#27671;&#28809;&#12434;&#21547;&#12416;&#65289;&#12301;&#12289;&#12300;&#29105;&#38291;&#22311;&#24310;&#26989;&#12301;&#12289;&#12300;&#20919;&#38291;&#22311;&#24310;&#26989;&#12301;&#12289;&#12300;&#20919;&#38291;&#12525;&#12540;&#12523;&#25104;&#22411;&#24418;&#37628;&#35069;&#36896;&#26989;&#12301;&#12289;
    &#12300;&#37628;&#31649;&#35069;&#36896;&#26989;&#12301;&#12289;&#12300;&#20280;&#37444;&#26989;&#12301;&#12289;&#12300;&#30952;&#26834;&#37509;&#35069;&#36896;&#26989;&#12301;&#12289;&#12300;&#24341;&#25244;&#37628;&#31649;&#35069;&#36896;&#26989;&#12301;&#12289;&#12300;&#20280;&#32218;&#26989;&#12301;&#21450;&#12403;&#12300;&#12381;&#12398;&#20182;&#12398;&#35069;&#37628;&#12434;&#34892;&#12431;&#12394;&#12356;&#37628;&#26448;&#35069;&#36896;&#26989;&#12301;
    &#12398;11 &#29987;&#26989;&#12391;&#12354;&#12427;&#12290;

    &#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#12395;&#12362;&#12356;&#12390;&#12399;&#21407;&#26448;&#26009;&#65292;&#20316;&#26989;&#24037;&#31243;&#65292;&#27231;&#26800;&#35373;&#20633;&#31561;&#12434;&#29992;&#12356;&#12390;&#29987;&#26989;&#12434;&#25226;&#25569;&#12375;&#12390;&#12356;&#12427;&#12364;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#35069;&#36896;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12395;&#12399;&#12300;&#20316;&#26989;&#24037;&#31243;&#12301;&#21450;&#12403;&#12300;&#20027;&#35201;&#21407;&#26448;&#26009;&#12301;&#12364;&#23384;&#22312;&#12375;&#65292;
    &#12381;&#12428;&#12382;&#12428;&#33258;&#30001;&#35352;&#36848;&#12395;&#12390;&#12381;&#12398;&#20869;&#23481;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;&#12371;&#12428;&#12425;&#12398;&#24773;&#22577;&#12434;&#29992;&#12356;&#12390;&#65292;&#29987;&#26989;&#12398;&#25226;&#25569;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12392;&#32771;&#12360;&#12425;&#12360;&#12427;&#65294;
    &#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#12391;&#12399;&#65292;&#20363;&#12392;&#12375;&#12390;&#65292;&#24418;&#37628;&#12434;&#35069;&#36896;&#12375;&#12390;&#12356;&#12390;&#12418;&#65292;&#37444;&#37489;&#30707;&#65292;&#30707;&#28845;&#65292;&#30707;&#28784;&#30707;&#12434;&#21407;&#26448;&#26009;&#65292;&#39640;&#28809;&#12434;&#27231;&#26800;&#35373;&#20633;&#12392;&#12375;&#12390;&#12356;&#12427;&#22580;&#21512;&#65292;
    &#12300;&#39640;&#28809;&#12395;&#12424;&#12427;&#35069;&#37444;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#65292;&#37521;&#37444;&#65292;&#37444;&#23633;&#12434;&#21407;&#26448;&#26009;&#12392;&#12375;&#65292;&#36578;&#28809;&#65292;&#38651;&#27671;&#28809;&#12434;&#27231;&#26800;&#35373;&#20633;&#12392;&#12375;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;
    &#12300;&#35069;&#37628;&#12539;&#35069;&#37628;&#22311;&#24310;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12427;&#12394;&#12393;&#12398;&#20966;&#29702;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#12371;&#12398;&#12424;&#12358;&#12394;&#20998;&#39006;&#12398;&#32068;&#12415;&#21512;&#12431;&#12379;&#12434;&#20840;&#12390;&#25226;&#25569;&#12377;&#12428;&#12400;&#65292;&#12381;&#12398;&#20877;&#29694;&#12399;&#21487;&#33021;&#12391;&#12354;&#12427;&#12392;&#24605;&#12431;&#12428;&#12427;&#12364;&#65292;
    &#12381;&#12398;&#35443;&#32048;&#12364;&#19981;&#26126;&#12391;&#12354;&#12427;&#12371;&#12392;&#12363;&#12425;&#65292;&#12381;&#12428;&#12425;&#12398;&#26684;&#20184;&#12369;&#12395;&#38306;&#12375;&#12390;&#12399;&#12354;&#12427;&#31243;&#24230;&#35069;&#36896;&#21697;&#12391;&#20505;&#35036;&#12434;&#36984;&#23450;&#12375;&#65292;
    &#26696;&#20998;&#12377;&#12427;&#31561;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;&#12418;&#12398;&#12392;&#12377;&#12427;&#65294;
    
    &#12414;&#12383;&#65292;&#35069;&#36896;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#21103;&#29987;&#29289;&#65292;&#29305;&#12395;&#33258;&#23478;&#29983;&#29987;&#12539;&#33258;&#23478;&#28040;&#36027;&#21697;&#12395;&#12418;&#27880;&#24847;&#12364;&#24517;&#35201;&#12392;&#12373;&#12428;&#12427;&#65294;
    &#29983;&#29987;&#36942;&#31243;&#12395;&#12362;&#12369;&#12427;&#20013;&#38291;&#35069;&#21697;&#12391;&#12354;&#12426;&#65292;&#33258;&#23478;&#29983;&#29987;&#12373;&#12428;&#12383;&#12418;&#12398;&#12364;&#20840;&#12390;&#33258;&#23478;&#28040;&#36027;&#12373;&#12428;&#12427;&#36001;&#12395;&#38306;&#12375;&#12390;&#12399;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31561;&#12398;&#20986;&#33655;&#12505;&#12540;&#12473;&#32113;&#35336;&#12391;&#12399;&#25226;&#25569;&#12373;&#12428;&#12394;&#12356;&#12383;&#12417;&#21407;&#21063;&#12392;&#12375;&#12390;&#35336;&#19978;&#12373;&#12428;&#12394;&#12356;&#12364;&#65292;&#37521;&#37444;&#12392;&#31895;&#37628;&#12394;&#12393;&#65292;
    &#25237;&#20837;&#12539;&#31639;&#20986;&#27083;&#36896;&#12364;&#30064;&#12394;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;&#12381;&#12428;&#12382;&#12428;&#25903;&#26609;&#12398;&#35069;&#21697;&#20385;&#26684;&#12434;&#22522;&#28310;&#12392;&#12375;&#12390;&#22269;&#20869;&#29983;&#29987;&#38989;&#12392;&#12375;&#12390;&#35336;&#19978;&#12373;&#12428;&#12427;&#65294;

    &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#12381;&#12428;&#12425;&#12398;&#25226;&#25569;&#12395;&#12399;&#65292;&#29983;&#29987;&#21205;&#24907;&#32113;&#35336;&#12394;&#12393;&#12398;&#29983;&#29987;&#39640;&#12505;&#12540;&#12473;&#12398;&#32113;&#35336;&#12434;&#36039;&#26009;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#12356;&#12427;&#12364;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#25226;&#25569;&#12377;&#12427;&#12383;&#12417;&#12395;&#12399;&#65292;&#25237;&#20837;&#27083;&#36896;&#12434;&#19968;&#23450;&#12392;&#20206;&#23450;&#12375;&#12390;&#65292;
    &#21407;&#26448;&#26009;&#20351;&#29992;&#38989;&#31561;&#12363;&#12425;&#25512;&#28204;&#12373;&#12428;&#12427;&#33258;&#23478;&#29983;&#29987;&#12539;&#33258;&#23478;&#28040;&#36027;&#20998;&#12434;&#25512;&#35336;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#65294;
    &#12375;&#12363;&#12375;&#65292;&#12381;&#12428;&#12425;&#12398;&#25237;&#20837;&#27083;&#36896;&#12398;&#25226;&#25569;&#65292;&#25512;&#35336;&#12364;&#22256;&#38627;&#12391;&#12354;&#12427;&#12371;&#12392;&#12363;&#12425;&#26412;&#31295;&#12391;&#12399;&#12371;&#12428;&#12434;&#25201;&#12431;&#12378;&#65292;
    &#33258;&#23478;&#29983;&#29987;&#12539;&#33258;&#23478;&#28040;&#36027;&#20998;&#12434;&#38500;&#12356;&#12383;&#29987;&#20986;&#37327;&#12392;&#12375;&#12390;&#25512;&#35336;&#12377;&#12427;&#65294; 

    &#21462;&#24341;&#22522;&#26412;&#34920;&#12391;&#12399;&#12289;&#21508;&#37096;&#38272;&#12398;&#29983;&#29987;&#29289;&#12395;&#12388;&#12356;&#12390;&#12289;&#33258;&#20027;&#30340;&#12394;&#29983;&#29987;&#12399;&#12418;&#12392;&#12424;&#12426;&#12289;
    &#20182;&#37096;&#38272;&#12363;&#12425;&#12398;&#21463;&#35351;&#12395;&#22522;&#12389;&#12367;&#29983;&#29987;&#12391;&#12354;&#12387;&#12390;&#12418;&#12289;&#24403;&#35442;&#29983;&#29987;&#29289;&#12398;&#37096;&#38272;&#12395;&#37329;&#38989;&#12434;&#35336; &#19978;&#12377;&#12427;&#12398;&#12364;&#21407;&#21063;&#12391;&#12354;&#12427;&#12290;&#12375;&#12363;&#12375;,
    &#12375;&#12363;&#12375;&#12289;&#22269;&#20869;&#29983;&#29987;&#38989;&#12434;&#25512; &#35336;&#12377;&#12427;&#22522;&#30990;&#36039;&#26009;&#12398;&#19968;&#12388;&#12391;&#12354;&#12427;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#8208;&#27963;&#21205; &#35519;&#26619;&#12391;&#12399;&#12289;&#21463;&#35351;&#29983;&#29987;&#20998;&#12395;&#20418;&#12427;&#37329;&#38989;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;
    &#12300;&#21152;&#24037;&#36035;&#21454;&#20837;&#12301;&#12375;&#12363;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12290;
    &#12381;&#12398;&#12383;&#12417;&#12289;&#21516; &#35519;&#26619;&#12434;&#21033;&#29992;&#12375;&#12390;&#22269;&#20869;&#29983;&#29987;&#38989;&#12434;&#25512;&#35336;&#12377;&#12427;&#37096;&#38272;&#12391;&#12399;&#12289; &#21463;&#35351;&#29983;&#29987;&#12395;&#20418;&#12427;&#21407;&#26448;&#26009;&#31561;&#12398;&#37329;&#38989;&#12364;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#12290;

    &#19968;&#26041;&#12289;&#21463;&#35351;&#29983;&#29987;&#12398;&#22996;&#35351;&#32773;&#12364;&#38750;&#35069;&#36896;&#26989;&#12398;&#22580;&#21512;&#12395;&#12354;&#12387;&#12390;&#12399;&#12289;&#21830;&#31038;&#12420;&#30334;&#36008;&#24215;&#12394;&#12393;&#12398;&#21830;&#26989;&#37096;&#38272;&#12391;&#12354;&#12427;&#22580;&#21512;&#12364;&#22810;&#12356;&#12364;&#12289;
    &#12371;&#12428;&#12425;&#21830;&#26989;&#37096;&#38272;&#12398;&#22269;&#20869;&#29983;&#29987;&#38989;&#12399;&#12289;&#22522;&#26412; &#30340;&#12395;&#12300;&#36009;&#22770;&#38989; - &#22770;&#19978;&#21407;&#20385; = &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#12301;
     (&#21830;&#26989;&#37096;&#38272;&#12398;&#22269;&#20869;&#29983;&#29987;&#38989;&#12395;&#12399;&#12289;&#12371;&#12398;&#12411;&#12363;&#12289;&#12467;&#12473;&#12488; &#21830;&#26989;&#12395;&#30456;&#24403;&#12377;&#12427;&#37329;&#38989;&#12418;&#21547;&#12414;&#12428;&#12427;&#12290;)&#12391;&#35336;&#31639;&#12373;&#12428;&#12427;&#12383;&#12417;&#12289;
     &#22996;&#35351;&#29983;&#29987;&#12398;&#12383;&#12417;&#12398;&#26448;&#26009;&#36092;&#20837;&#36027;&#12364;&#30330;&#29983;&#12375;&#12390;&#12356;&#12383; &#12392;&#12375;&#12390;&#12418;&#12289;&#21830;&#26989;&#37096;&#38272;&#12395;&#12399;&#35336;&#19978;&#12373;&#12428;&#12394;&#12356;&#12290;

    &#12381;&#12398;&#32080;&#26524;&#12289;&#20309;&#12418;&#20966;&#29702;&#12434;&#34892;&#12431;&#12394;&#12356;&#12392;&#12377;&#12428;&#12400;&#12289;&#21407;&#26448;&#26009;&#12434;&#29983;&#29987;&#12375;&#12383;&#37096;&#38272;&#12391;&#12399;&#12289;
    &#21830;&#26989;&#37096;&#38272;&#12395;&#36009;&#22770;&#12375;&#12383;&#22996;&#35351; &#29983;&#29987;&#29992;&#21407;&#26448;&#26009;&#12398;&#29987;&#20986;&#12434;&#35336;&#19978;&#12391;&#12365;&#12394;&#12367;&#12394;&#12427;&#19968;&#26041;&#12391;&#12289; 
    &#21463;&#35351;&#29983;&#29987;&#12434;&#34892;&#12387;&#12383;&#37096;&#38272;&#12391;&#12399;&#12289;&#22269;&#20869;&#29983;&#29987;&#38989;&#12364;&#36942;&#23567;&#35413; &#20385;&#12395;&#12394;&#12427;&#12392;&#12392;&#12418;&#12395;&#12289;&#20184;&#21152;&#20385;&#20516;&#29575;&#12364;&#36942;&#22823;&#35413;&#20385;&#12395;&#12394;&#12427;&#12290;

    &#12381;&#12371;&#12391;&#12289;&#38750;&#35069;&#36896;&#26989;&#12363;&#12425;&#12398;&#22996;&#35351;&#12434;&#21463;&#12369;&#12390;&#29983;&#29987;&#12377;&#12427; &#20998;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#27425;&#12395;&#25522;&#12370;&#12427;&#24335;&#12395;&#12424;&#12426;&#12289;
    &#21152;&#24037;&#36035;&#21454;&#20837; &#38989;&#12395;&#20184;&#21152;&#20385;&#20516;&#29575;&#12398;&#36870;&#25968;&#12434;&#20055;&#12378;&#12427;&#12371;&#12392;&#12395;&#12424;&#12426;&#12289;&#21407;&#26448; &#26009;&#36027;&#31561;&#12434;&#21547;&#12435;&#12384;&#22269;&#20869;&#29983;&#29987;&#38989;&#12434;&#25512;&#35336;&#12375;&#12390;&#12356;&#12427;&#12290;

    \[ &#22269;&#20869;&#29983;&#29987;&#38989; = &#21152;&#24037;&#36035;&#21454;&#20837;&#38989; \times \frac{&#35069;&#21697;&#20385;&#38989;}{&#35069;&#21697;&#38989;-&#21407;&#26448;&#26009;&#36027;}   \]-}</span><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-809"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%88FD%9020%696D"><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%88FD%9020%696D"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#35069;&#36896;&#26989;</span></a></a><span>  </span><a name="local-6989586621679412850"><a href="#local-6989586621679412850"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412851"><a href="#local-6989586621679412851"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-810"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-811"></a><span>    </span><a name="local-6989586621679412865"><a href="#local-6989586621679412865"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412851"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-812"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679412865"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-813"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412852"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679412850"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412851"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-814"></a><span>        </span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679412866"><a href="#local-6989586621679412866"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679412866"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%88FD%9020%696D"><span class="hs-identifier hs-var">E&#35069;&#36896;&#26989;</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412852"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679412850"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412851"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-815"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-816"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-819"></a><span>    </span><span class="hs-comment">-- &#35069;&#36896;&#26989;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-820"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-821"></a><span>    </span><a name="local-6989586621679412852"><a href="#local-6989586621679412852"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679412853"><a href="#local-6989586621679412853"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412854"><a href="#local-6989586621679412854"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-822"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412855"><a href="#local-6989586621679412855"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-823"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412856"><a href="#local-6989586621679412856"><span class="hs-identifier">tar</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-824"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412857"><a href="#local-6989586621679412857"><span class="hs-identifier">prod</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span>
</span><a name="line-825"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412858"><a href="#local-6989586621679412858"><span class="hs-identifier">process</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%53CE%5165%984D_%52A0%5DE5%8CC3"><span class="hs-identifier hs-var">H&#21454;&#20837;&#38989;_&#21152;&#24037;&#36035;</span></a><span>
</span><a name="line-826"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412859"><a href="#local-6989586621679412859"><span class="hs-identifier">oth</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%53CE%5165%984D_%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-var">H&#21454;&#20837;&#38989;_&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span>
</span><a name="line-827"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412860"><a href="#local-6989586621679412860"><span class="hs-identifier">cost</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-var">H&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span>
</span><a name="line-828"></a><span>
</span><a name="line-829"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-830"></a><span>        </span><span class="hs-comment">-- &#12371;&#12371;&#12391;,&#20197;&#21069;&#12395;&#20966;&#29702;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12398;&#23550;&#20966;&#12434;&#20998;&#23696;</span><span>
</span><a name="line-831"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412861"><a href="#local-6989586621679412861"><span class="hs-identifier">newCars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#getValCarsFromV%88FD%9020%696D"><span class="hs-identifier hs-var">getValCarsFromV&#35069;&#36896;&#26989;</span></a><span> </span><a href="#local-6989586621679412853"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412855"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679412857"><span class="hs-identifier hs-var">prod</span></a><span> </span><a href="#local-6989586621679412858"><span class="hs-identifier hs-var">process</span></a><span> </span><a href="#local-6989586621679412859"><span class="hs-identifier hs-var">oth</span></a><span> </span><a href="#local-6989586621679412860"><span class="hs-identifier hs-var">cost</span></a><span>
</span><a name="line-832"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412856"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412861"><span class="hs-identifier hs-var">newCars</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-833"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679412861"><span class="hs-identifier hs-var">newCars</span></a><span>
</span><a name="line-834"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412862"><a href="#local-6989586621679412862"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412863"><a href="#local-6989586621679412863"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412862"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679412863"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-835"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412864"><a href="#local-6989586621679412864"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-836"></a><span>
</span><a name="line-837"></a><span class="hs-identifier">getValCarsFromV&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Val&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%53CE%5165%984D_%52A0%5DE5%8CC3"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#21152;&#24037;&#36035;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%53CE%5165%984D_%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span>
</span><a name="line-838"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-type">Val&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-839"></a><a name="getValCarsFromV%88FD%9020%696D"><a href="V.html#getValCarsFromV%88FD%9020%696D"><span class="hs-identifier">getValCarsFromV&#35069;&#36896;&#26989;</span></a></a><span> </span><a name="local-6989586621679412867"><a href="#local-6989586621679412867"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412868"><a href="#local-6989586621679412868"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679412869"><a href="#local-6989586621679412869"><span class="hs-identifier">prod</span></a></a><span> </span><a name="local-6989586621679412870"><a href="#local-6989586621679412870"><span class="hs-identifier">process</span></a></a><span> </span><a name="local-6989586621679412871"><a href="#local-6989586621679412871"><span class="hs-identifier">oth</span></a></a><span>  </span><a name="local-6989586621679412872"><a href="#local-6989586621679412872"><span class="hs-identifier">cost</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412877"><span class="hs-identifier hs-var">merge</span></a><span> </span><a href="#local-6989586621679412873"><span class="hs-identifier hs-var">prodDetail</span></a><span> </span><a href="#local-6989586621679412875"><span class="hs-identifier hs-var">processDetail</span></a><span> </span><a href="#local-6989586621679412876"><span class="hs-identifier hs-var">othDetail</span></a><span>
</span><a name="line-840"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-841"></a><span>    </span><span class="hs-comment">-- &#35069;&#36896;&#26989;</span><span>
</span><a name="line-842"></a><span>    </span><a name="local-6989586621679412873"><a href="#local-6989586621679412873"><span class="hs-identifier">prodDetail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#prodToDetail"><span class="hs-identifier hs-var">prodToDetail</span></a><span> </span><a href="#local-6989586621679412867"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412869"><span class="hs-identifier hs-var">prod</span></a><span>
</span><a name="line-843"></a><span>    </span><span class="hs-comment">-- &#21152;&#24037;&#36035;&#12434;&#38500;&#12367;&#35069;&#36896;&#38989;</span><span>
</span><a name="line-844"></a><span>    </span><a name="local-6989586621679412874"><a href="#local-6989586621679412874"><span class="hs-identifier">totalProd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679412873"><span class="hs-identifier hs-var">prodDetail</span></a><span>
</span><a name="line-845"></a><span>    </span><a name="local-6989586621679412875"><a href="#local-6989586621679412875"><span class="hs-identifier">processDetail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#processToDetail"><span class="hs-identifier hs-var">processToDetail</span></a><span> </span><a href="#local-6989586621679412872"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679412874"><span class="hs-identifier hs-var">totalProd</span></a><span> </span><a href="#local-6989586621679412870"><span class="hs-identifier hs-var">process</span></a><span>
</span><a name="line-846"></a><span>    </span><span class="hs-comment">-- &#35069;&#36896;&#26989;&#20197;&#22806;</span><span>
</span><a name="line-847"></a><span>    </span><a name="local-6989586621679412876"><a href="#local-6989586621679412876"><span class="hs-identifier">othDetail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#othToDetail"><span class="hs-identifier hs-var">othToDetail</span></a><span> </span><a href="#local-6989586621679412871"><span class="hs-identifier hs-var">oth</span></a><span>
</span><a name="line-848"></a><span>    </span><span class="hs-comment">-- &#20966;&#29702;&#26041;&#37341; : &#12381;&#12428;&#12382;&#12428;,&#22793;&#25563;&#12375;&#12390;&#32080;&#21512;&#12377;&#12427;</span><span>
</span><a name="line-849"></a><span>    </span><span class="hs-comment">-- &#32080;&#21512; </span><span>
</span><a name="line-850"></a><span>    </span><span class="hs-identifier">merge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-851"></a><span>    </span><a name="local-6989586621679412877"><a href="#local-6989586621679412877"><span class="hs-identifier">merge</span></a></a><span> </span><a name="local-6989586621679412878"><a href="#local-6989586621679412878"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679412879"><a href="#local-6989586621679412879"><span class="hs-identifier">c2</span></a></a><span> </span><a name="local-6989586621679412880"><a href="#local-6989586621679412880"><span class="hs-identifier">c3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679412878"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">,</span><a href="#local-6989586621679412879"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">,</span><a href="#local-6989586621679412880"><span class="hs-identifier hs-var">c3</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-852"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679412868"><span class="hs-identifier hs-var">man</span></a><span>  </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679412878"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679412879"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679412880"><span class="hs-identifier hs-var">c3</span></a><span>
</span><a name="line-853"></a><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span class="hs-comment">-- | &#20986;&#33655;&#38989;</span><span>
</span><a name="line-856"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-857"></a><span class="hs-comment">-- &#20986;&#33655;&#38989;&#12399;&#22522;&#26412;&#30340;&#12395;,&#21069;&#22235;&#25991;&#23383;&#12395;&#20999;&#12427;&#12392;,&#32048;&#20998;&#39006;&#12395;&#12394;&#12427;</span><span>
</span><a name="line-858"></a><span class="hs-identifier">prodToDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Val&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-859"></a><a name="prodToDetail"><a href="V.html#prodToDetail"><span class="hs-identifier">prodToDetail</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-860"></a><span class="hs-identifier">prodToDetail</span><span> </span><span class="hs-number">28</span><span>    </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412881"><a href="#local-6989586621679412881"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412882"><a href="#local-6989586621679412882"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679412882"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412882"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412881"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-861"></a><span class="hs-identifier">prodToDetail</span><span> </span><span class="hs-number">24</span><span>    </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412883"><a href="#local-6989586621679412883"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412884"><a href="#local-6989586621679412884"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679412884"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412884"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412883"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-862"></a><span>
</span><a name="line-863"></a><span>
</span><a name="line-864"></a><span class="hs-comment">-- | &#36035;&#21152;&#24037;</span><span>
</span><a name="line-865"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-866"></a><span class="hs-comment">-- &#21069;&#22235;&#25991;&#23383;&#12391;&#20999;&#12387;&#12383;&#24460;&#12395;,&#36035;&#21152;&#24037;&#20197;&#22806;&#12398;&#35069;&#36896;&#21697;&#12398;&#21407;&#26448;&#26009;&#36027;</span><span>
</span><a name="line-867"></a><span class="hs-comment">-- &#21407;&#26448;&#26009;&#20351;&#29992;&#38989;&#12363;,&#35069;&#36896;&#21697;&#20385;&#38989;&#12364;&#12431;&#12363;&#12425;&#12394;&#12356;&#22580;&#21512;&#12399;&#12381;&#12398;&#12414;&#12414;&#36275;&#12377; </span><span>
</span><a name="line-868"></a><span class="hs-comment">-- &#36942;&#23569;&#12395;&#12394;&#12427;&#12383;&#12417;,&#20195;&#26367;&#26696;&#12399;&#24517;&#35201;</span><span>
</span><a name="line-869"></a><span>
</span><a name="line-870"></a><span class="hs-identifier">processToDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-type">Val&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%53CE%5165%984D_%52A0%5DE5%8CC3"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#21152;&#24037;&#36035;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-871"></a><a name="processToDetail"><a href="V.html#processToDetail"><span class="hs-identifier">processToDetail</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">_</span><span>          </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-872"></a><span class="hs-identifier">processToDetail</span><span> </span><a name="local-6989586621679412885"><a href="#local-6989586621679412885"><span class="hs-identifier">cost</span></a></a><span> </span><a name="local-6989586621679412886"><a href="#local-6989586621679412886"><span class="hs-identifier">totalProd</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412887"><a href="#local-6989586621679412887"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412891"><a href="#local-6989586621679412891"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412891"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412888"><span class="hs-identifier hs-var">getRate</span></a><span> </span><a href="#local-6989586621679412885"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679412886"><span class="hs-identifier hs-var">totalProd</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412891"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412887"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-873"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-874"></a><span>    </span><span class="hs-comment">-- &#20184;&#21152;&#20385;&#20516;&#29575;&#12398;&#36870;&#25968;&#12434;&#27714;&#12417;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-875"></a><span>    </span><span class="hs-identifier">getRate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-type">Val&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-876"></a><span>    </span><a name="local-6989586621679412888"><a href="#local-6989586621679412888"><span class="hs-identifier">getRate</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-877"></a><span>    </span><span class="hs-identifier">getRate</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679412889"><a href="#local-6989586621679412889"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679412890"><a href="#local-6989586621679412890"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412890"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412890"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679412889"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">)</span><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span>
</span><a name="line-880"></a><span class="hs-comment">-- | &#35069;&#36896;&#26989;&#20197;&#22806;</span><span>
</span><a name="line-881"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-882"></a><span class="hs-identifier">othToDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%53CE%5165%984D_%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-883"></a><a name="othToDetail"><a href="V.html#othToDetail"><span class="hs-identifier">othToDetail</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-884"></a><span class="hs-identifier">othToDetail</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412892"><a href="#local-6989586621679412892"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679412892"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VClass.html#gd%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-var">gd&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span>
</span><a name="line-885"></a><span>
</span><a name="line-886"></a><span>
</span><a name="line-887"></a><span>
</span><a name="line-888"></a><span>
</span><a name="line-889"></a><span>
</span><a name="line-890"></a><span>
</span><a name="line-891"></a><span>
</span><a name="line-892"></a><span class="hs-comment">-- *** &#21830;&#26989;</span><span>
</span><a name="line-893"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-894"></a><span>
</span><a name="line-895"></a><span class="hs-comment">{- | 
    &#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#65289;&#12364;&#12393;&#12398;&#12424;&#12358;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12390;&#12356;&#12427;&#12363;&#12395;&#38306;&#12377;&#12427;&#24773;&#22577;&#12399;&#65292;
    &#31558;&#32773;&#12398;&#30693;&#12427;&#38480;&#12426;&#20844;&#34920;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12364;&#65292;&#24179;&#25104;28&#24180;&#32080;&#26524;&#12398;&#27010;&#35201;&#12395;&#12362;&#12356;&#12390;&#65292;&#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#12300;&#29305;&#27530;&#12394;&#26041;&#27861;&#12301;&#12395;&#38306;&#12375;&#12390;&#35443;&#32048;&#12394;&#35352;&#36848;&#12364;&#23384;&#22312;&#12377;&#12427;&#65294;
    
    &#22312;&#24235;&#12395;&#38306;&#12377;&#12427;&#35519;&#26619;&#38917;&#30446;&#20197;&#22806;&#12395;&#12399;&#65292;&#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#21450;&#12403;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#21830;&#26989;&#37096;&#38272;&#12398;&#35519;&#26619;&#31080;&#12398;&#35373;&#35336;&#12395;&#22823;&#12365;&#12394;&#36949;&#12356;&#12399;&#12394;&#12356;&#12383;&#12417;&#65292;
    &#12371;&#12371;&#12391;&#12399;&#65292;&#24179;&#25104;28&#24180;&#12300;&#32080;&#26524;&#12398;&#27010;&#35201;&#12301;&#12395;&#35352;&#36848;&#12373;&#12428;&#12390;&#12356;&#12427;&#25163;&#27861;&#12395;&#21063;&#12387;&#12390;&#65292;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;&#65294;
    
    &#21516;&#36039;&#26009;&#12395;&#12424;&#12428;&#12400;&#65292;&#12302;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12362;&#12356;&#12390;&#65292;&#21368;&#22770;&#26989;&#12398;&#12358;&#12385;&#12300;&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#65288;&#24467;&#26989;&#32773;&#12364;&#24120;&#26178;100&#20154;&#20197;&#19978;&#12398;&#12418;&#12398;&#65289;&#12301;&#65292;
    &#12300;&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#12301;&#21450;&#12403;&#12300;&#20195;&#29702;&#21830;&#65292;&#20210;&#31435;&#26989;&#12301;&#65292;&#23567;&#22770;&#26989;&#12398;&#12358;&#12385;&#12300;&#30334;&#36008;&#24215;&#65292;&#32207;&#21512;&#12473;&#12540;&#12497;&#12540;&#12301;&#65292;
    &#12300;&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#23567;&#22770;&#26989;&#65288;&#24467;&#26989;&#21729;&#12364;&#24120;&#26178;50&#20154;&#26410;&#28288;&#12398;&#12418;&#12398;&#65289;&#12301;&#65292;&#12300;&#21508;&#31278;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#65292;
    &#12300;&#12467;&#12531;&#12499;&#12491;&#12456;&#12531;&#12473;&#12473;&#12488;&#12450;&#65288;&#26032;&#39135;&#26009;&#21697;&#12434;&#20013;&#24515;&#12392;&#12377;&#12427;&#12418;&#12398;&#12395;&#38480;&#12427;&#65289;&#12301;&#65292;
    &#12300;&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12301;&#65292;&#12300;&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#12301;&#65292;&#12300;&#12383;&#12400;&#12371;&#12539;&#21931;&#29017;&#20855;&#23554;&#38272;&#23567;&#22770;&#26989;&#12301;&#21450;&#12403;&#12300;&#28961;&#24215;&#33303;&#23567;&#22770;&#26989;&#12301;&#12303;&#12399;&#29305;&#27530;&#12394;&#26041;&#27861;&#12395;&#12424;&#12387;&#12390;&#26684;&#20184;&#12369;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
    
    &#32080;&#26524;&#12398;&#27010;&#35201;&#12395;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#20966;&#29702;&#12501;&#12525;&#12540;&#12434;&#12414;&#12392;&#12417;&#12383;&#12418;&#12398;&#12364;&#65292;&#12300;&#22259; 6&#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#29305;&#27530;&#12394;&#26041;&#27861;&#12398;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;&#12301;&#12391;&#12354;&#12427;&#65294;
    &#20197;&#19979;&#65292;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#12395;&#24467;&#12387;&#12390;&#20966;&#29702;&#12434;&#35373;&#35336;&#12375;&#12390;&#12356;&#12367;

    ![&#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#29305;&#27530;&#12394;&#26041;&#27861;&#12398;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;](commerceFlow.png)

    &#39006;&#20284;&#12510;&#12540;&#12472;&#12531;&#29575;&#21462;&#24471; &#12394;&#12393;&#12398;&#20966;&#29702;&#12399;&#65292;&#20182;&#12398;&#20966;&#29702;&#12364;&#32066;&#20102;&#12375;&#12383;&#24460;&#12395;&#20966;&#29702;&#12373;&#12428;&#12427;&#65294;


    * &#21830;&#26989;&#12399;,&#21830;&#21697;&#20998;&#39006;=&#29987;&#26989;&#20998;&#39006;&#32048;&#20998;&#39006;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#12398;&#12391;,&#22793;&#25563;&#12398;&#24517;&#35201;&#12394;&#12375;.
-}</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21830;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-920"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5546%696D"><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5546%696D"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21830;&#26989;</span></a></a><span> </span><a name="local-6989586621679412893"><a href="#local-6989586621679412893"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412894"><a href="#local-6989586621679412894"><span class="hs-identifier">scd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-921"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-922"></a><span>    </span><a name="local-6989586621679412915"><a href="#local-6989586621679412915"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412894"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-923"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679412915"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-924"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412895"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679412893"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412894"><span class="hs-identifier hs-var">scd</span></a><span>
</span><a name="line-925"></a><span>        </span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679412916"><a href="#local-6989586621679412916"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679412916"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5546%696D"><span class="hs-identifier hs-var">E&#21830;&#26989;</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412895"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679412893"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412894"><span class="hs-identifier hs-var">scd</span></a><span>
</span><a name="line-926"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-927"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-928"></a><span>
</span><a name="line-929"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-930"></a><span>    </span><span class="hs-comment">-- &#21830;&#26989;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-931"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-932"></a><span>    </span><a name="local-6989586621679412895"><a href="#local-6989586621679412895"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679412896"><a href="#local-6989586621679412896"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412897"><a href="#local-6989586621679412897"><span class="hs-identifier">scd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-933"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412898"><a href="#local-6989586621679412898"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-934"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412899"><a href="#local-6989586621679412899"><span class="hs-identifier">tar</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-935"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412900"><a href="#local-6989586621679412900"><span class="hs-identifier">retail</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-936"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412901"><a href="#local-6989586621679412901"><span class="hs-identifier">wholesale</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span>
</span><a name="line-937"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412902"><a href="#local-6989586621679412902"><span class="hs-identifier">area</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%58F2%5834%9762%7A4D"><span class="hs-identifier hs-var">H&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-938"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412903"><a href="#local-6989586621679412903"><span class="hs-identifier">self</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-var">H&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-939"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412904"><a href="#local-6989586621679412904"><span class="hs-identifier">sellType</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-var">H&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-940"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412905"><a href="#local-6989586621679412905"><span class="hs-identifier">goodsType</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%5546%54C1%5F62%614B"><span class="hs-identifier hs-var">H&#21830;&#21697;&#24418;&#24907;</span></a><span>
</span><a name="line-941"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412906"><a href="#local-6989586621679412906"><span class="hs-identifier">shopType</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-var">H&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-942"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412907"><a href="#local-6989586621679412907"><span class="hs-identifier">repair</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4FEE%7406%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-var">H&#20462;&#29702;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-943"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412908"><a href="#local-6989586621679412908"><span class="hs-identifier">middle</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-var">H&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-944"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412909"><a href="#local-6989586621679412909"><span class="hs-identifier">open</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-var">H&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-945"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679412910"><a href="#local-6989586621679412910"><span class="hs-identifier">worker</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-946"></a><span>
</span><a name="line-947"></a><span>
</span><a name="line-948"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-949"></a><span>        </span><span class="hs-comment">-- &#12371;&#12371;&#12391;,&#20197;&#21069;&#12395;&#20966;&#29702;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12398;&#23550;&#20966;&#12434;&#20998;&#23696;</span><span>
</span><a name="line-950"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412911"><a href="#local-6989586621679412911"><span class="hs-identifier">newCars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#getValCarsFromV%5546%696D"><span class="hs-identifier hs-var">getValCarsFromV&#21830;&#26989;</span></a><span> </span><a href="#local-6989586621679412896"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679412898"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679412900"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412901"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><a href="#local-6989586621679412907"><span class="hs-identifier hs-var">repair</span></a><span> </span><a href="#local-6989586621679412908"><span class="hs-identifier hs-var">middle</span></a><span> </span><a href="#local-6989586621679412902"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679412903"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679412904"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412905"><span class="hs-identifier hs-var">goodsType</span></a><span> </span><a href="#local-6989586621679412906"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679412909"><span class="hs-identifier hs-var">open</span></a><span> </span><a href="#local-6989586621679412910"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-951"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412899"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412911"><span class="hs-identifier hs-var">newCars</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-952"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679412911"><span class="hs-identifier hs-var">newCars</span></a><span>
</span><a name="line-953"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412912"><a href="#local-6989586621679412912"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412913"><a href="#local-6989586621679412913"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412912"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679412913"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-954"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412914"><a href="#local-6989586621679412914"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-955"></a><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span class="hs-identifier">getValCarsFromV&#21830;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-958"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-959"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-960"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span>
</span><a name="line-961"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4FEE%7406%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20462;&#29702;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-962"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-963"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-964"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-965"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-966"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5F62%614B"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#24418;&#24907;</span></a><span>
</span><a name="line-967"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-968"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-969"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-970"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-971"></a><a name="getValCarsFromV%5546%696D"><a href="V.html#getValCarsFromV%5546%696D"><span class="hs-identifier">getValCarsFromV&#21830;&#26989;</span></a></a><span> </span><a name="local-6989586621679412917"><a href="#local-6989586621679412917"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679412918"><a href="#local-6989586621679412918"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679412919"><a href="#local-6989586621679412919"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679412920"><a href="#local-6989586621679412920"><span class="hs-identifier">wholesale</span></a></a><span> </span><a name="local-6989586621679412921"><a href="#local-6989586621679412921"><span class="hs-identifier">repair</span></a></a><span> </span><a name="local-6989586621679412922"><a href="#local-6989586621679412922"><span class="hs-identifier">middle</span></a></a><span> </span><a name="local-6989586621679412923"><a href="#local-6989586621679412923"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679412924"><a href="#local-6989586621679412924"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679412925"><a href="#local-6989586621679412925"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679412926"><a href="#local-6989586621679412926"><span class="hs-identifier">goodsType</span></a></a><span> </span><a name="local-6989586621679412927"><a href="#local-6989586621679412927"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679412928"><a href="#local-6989586621679412928"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679412929"><a href="#local-6989586621679412929"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-972"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412919"><span class="hs-identifier hs-var">retail</span></a><span>    </span><span class="hs-operator hs-var">/=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412930"><span class="hs-identifier hs-var">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a><span> </span><a href="#local-6989586621679412917"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#f%5C0F%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#23567;&#22770;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412919"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412925"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412923"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679412924"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679412928"><span class="hs-identifier hs-var">open</span></a><span> </span><a href="#local-6989586621679412927"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679412929"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-973"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412920"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679412930"><span class="hs-identifier hs-var">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a><span> </span><a href="#local-6989586621679412917"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#f%5378%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#21368;&#22770;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412922"><span class="hs-identifier hs-var">middle</span></a><span> </span><a href="#local-6989586621679412920"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><a href="#local-6989586621679412929"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-974"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-975"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-976"></a><span>    </span><span class="hs-comment">-- CNC&#12398;&#23550;&#24540;&#12434;&#12375;&#12383;&#12354;&#12392;&#12395;,&#29987;&#26989;&#20998;&#39006;&#12408;&#25391;&#12426;&#36820;&#12427;</span><span>
</span><a name="line-977"></a><span>    </span><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-978"></a><span>    </span><a name="local-6989586621679412930"><a href="#local-6989586621679412930"><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-979"></a><span>    </span><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span><span> </span><span class="hs-number">24</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412931"><a href="#local-6989586621679412931"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679412918"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679412931"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-980"></a><span>    </span><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span><span> </span><span class="hs-number">28</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412932"><a href="#local-6989586621679412932"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679412918"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679412932"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-981"></a><span>
</span><a name="line-982"></a><span>
</span><a name="line-983"></a><span class="hs-comment">-- **** &#23567;&#22770;&#26989;</span><span>
</span><a name="line-984"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-985"></a><span class="hs-comment">{- |    &#23567;&#22770;&#26989;&#12398;&#20966;&#29702;

        * &#21931;&#29017;&#20855;&#20966;&#29702;
        &#12300;6092 &#12383;&#12400;&#12371;&#12539;&#21931;&#29017;&#20855;&#23554;&#38272;&#23567;&#22770;&#26989;&#12301;

        &#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12300;6092&#12301;&#65288;&#12383;&#12400;&#12371;&#12539;&#21931;&#29017;&#20855;&#23554;&#38272;&#23567;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#36009;&#22770;&#38989;&#12364;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;
        90&#65285;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

        &#21931;&#29017;&#20855;&#12395;&#38306;&#12375;&#12390;&#12399;,&#33258;&#21205;&#30340;&#12395;,&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12391;&#20966;&#29702;&#12373;&#12428;&#12427;&#12398;&#12391;&#12394;&#12395;&#12418;&#12375;&#12394;&#12356;.

-}</span><span>
</span><a name="line-996"></a><span>
</span><a name="line-997"></a><span class="hs-identifier">f&#23567;&#22770;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-998"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-999"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1000"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1001"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1002"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1003"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-1004"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1005"></a><a name="f%5C0F%58F2%51E6%7406"><a href="V.html#f%5C0F%58F2%51E6%7406"><span class="hs-identifier">f&#23567;&#22770;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412933"><a href="#local-6989586621679412933"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679412934"><a href="#local-6989586621679412934"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679412935"><a href="#local-6989586621679412935"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679412936"><a href="#local-6989586621679412936"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679412937"><a href="#local-6989586621679412937"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679412938"><a href="#local-6989586621679412938"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679412939"><a href="#local-6989586621679412939"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-1006"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#more50%5F93%696D%54E1"><span class="hs-identifier hs-var">more50&#24467;&#26989;&#21729;</span></a><span> </span><a href="#local-6989586621679412939"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><span class="hs-identifier hs-var">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412933"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412934"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412935"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1007"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%767E%8CA8%5E97%51E6%7406"><span class="hs-identifier hs-var">f&#30334;&#36008;&#24215;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412933"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412934"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412935"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679412936"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679412937"><span class="hs-identifier hs-var">open</span></a><span> </span><a href="#local-6989586621679412938"><span class="hs-identifier hs-var">shopType</span></a><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span class="hs-comment">-- | &#24467;&#26989;&#21729;&#25968;&#12364;50&#20197;&#19978;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1010"></a><span class="hs-identifier">more50&#24467;&#26989;&#21729;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1011"></a><a name="more50%5F93%696D%54E1"><a href="V.html#more50%5F93%696D%54E1"><span class="hs-identifier">more50&#24467;&#26989;&#21729;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1012"></a><span class="hs-identifier">more50&#24467;&#26989;&#21729;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679412940"><a href="#local-6989586621679412940"><span class="hs-identifier">em</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#20225;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679412940"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679412940"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1013"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1014"></a><span>
</span><a name="line-1015"></a><span class="hs-comment">{- |&#12450; &#12300;5611 &#30334;&#36008;&#24215;&#65292;&#32207;&#21512;&#12473;&#12540;&#12497;&#12540;&#12301;

    &#34920;3&#12398;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#23567;&#22770;&#12426;&#12375;&#12289;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12398;&#21508;&#36009;&#22770;
    &#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;10&#65285;&#20197;&#19978;70&#65285;&#26410;&#28288;&#12391;&#12289;&#24467;&#26989;&#32773;&#12364;50&#20154;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

    * &#34920;3 &#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12392;&#21830;&#21697;&#20998;&#39006;

    &#34915;&#12539;&#39135;&#12539;&#20182;&#21029; &#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;2&#26689; &#20197;&#19979;&#12398;&#29987;&#26989;&#20998;&#39006;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;

    &gt; &#34915; 57 &#32340;&#29289;&#12539;&#34915;&#26381;&#12539;&#36523;&#12398;&#22238;&#12426;&#21697;&#23567;&#22770;&#26989;
    &gt; &#39135; 58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;
    &gt; &#20182; 59 &#27231;&#26800;&#22120;&#20855;&#23567;&#22770;&#26989;
    &gt; &#20182; 60 &#12381;&#12398;&#20182;&#12398;&#23567;&#22770;&#26989;

    -}</span><span>
</span><a name="line-1030"></a><span class="hs-identifier">f&#30334;&#36008;&#24215;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1031"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1032"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1033"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1034"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1035"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1036"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1037"></a><a name="f%767E%8CA8%5E97%51E6%7406"><a href="V.html#f%767E%8CA8%5E97%51E6%7406"><span class="hs-identifier">f&#30334;&#36008;&#24215;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412941"><a href="#local-6989586621679412941"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679412942"><a href="#local-6989586621679412942"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679412943"><a href="#local-6989586621679412943"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679412944"><a href="#local-6989586621679412944"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679412945"><a href="#local-6989586621679412945"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679412946"><a href="#local-6989586621679412946"><span class="hs-identifier">shopType</span></a></a><span>
</span><a name="line-1038"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#more10Less70Every%88683"><span class="hs-identifier hs-var">more10Less70Every&#34920;3</span></a><span> </span><a href="#local-6989586621679412941"><span class="hs-identifier hs-var">retail</span></a><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1039"></a><span>                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1040"></a><span>                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679412941"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;5699&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1041"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1042"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="V.html#f%5C0F%58F2%4E2D%5C0F%5206%985E%683C%4ED8"><span class="hs-identifier hs-var">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679412941"><span class="hs-identifier hs-var">retail</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1043"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1044"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679412947"><a href="#local-6989586621679412947"><span class="hs-identifier">middle</span></a></a><span class="hs-special">,</span><a name="local-6989586621679412948"><a href="#local-6989586621679412948"><span class="hs-identifier">small</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1045"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412947"><span class="hs-identifier hs-var">middle</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;60&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><span class="hs-identifier hs-var">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412941"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412942"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412943"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1046"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412947"><span class="hs-identifier hs-var">middle</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#f%98F2%98DF%6599%54C1%5C0F%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#20966;&#29702;</span></a><span>           </span><a href="#local-6989586621679412941"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412942"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412943"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679412944"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679412945"><span class="hs-identifier hs-var">open</span></a><span>
</span><a name="line-1047"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412948"><span class="hs-identifier hs-var">small</span></a><span>  </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;603&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#f%30C9%30E9%30C3%30B0%30B9%30C8%30A2%51E6%7406"><span class="hs-identifier hs-var">f&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#20966;&#29702;</span></a><span>         </span><a href="#local-6989586621679412941"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412942"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412943"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679412944"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679412946"><span class="hs-identifier hs-var">shopType</span></a><span>
</span><a name="line-1048"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span>                 </span><a href="#local-6989586621679412941"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412942"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679412943"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1049"></a><span>
</span><a name="line-1050"></a><span>
</span><a name="line-1051"></a><span>
</span><a name="line-1052"></a><span class="hs-comment">-- | &#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12398;&#21508;&#36009;&#22770;</span><span>
</span><a name="line-1053"></a><span class="hs-comment">-- &#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;10&#65285;&#20197;&#19978;70&#65285;&#26410;&#28288;&#12398;&#21028;&#26029;</span><span>
</span><a name="line-1054"></a><span class="hs-identifier">more10Less70Every&#34920;3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1055"></a><a name="more10Less70Every%88683"><a href="V.html#more10Less70Every%88683"><span class="hs-identifier">more10Less70Every&#34920;3</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1056"></a><span class="hs-identifier">more10Less70Every&#34920;3</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412949"><a href="#local-6989586621679412949"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1057"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1058"></a><span>        </span><a name="local-6989586621679412958"><a href="#local-6989586621679412958"><span class="hs-identifier">cloth</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412957"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412957"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1059"></a><span>        </span><a name="local-6989586621679412960"><a href="#local-6989586621679412960"><span class="hs-identifier">food</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412959"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412959"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1060"></a><span>        </span><a name="local-6989586621679412962"><a href="#local-6989586621679412962"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412961"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412961"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1061"></a><span>
</span><a name="line-1062"></a><span>        </span><span class="hs-identifier hs-var">V.forM</span><span> </span><a href="#local-6989586621679412949"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679412950"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679412958"><span class="hs-identifier hs-var">cloth</span></a><span> </span><a href="#local-6989586621679412960"><span class="hs-identifier hs-var">food</span></a><span> </span><a href="#local-6989586621679412962"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-1063"></a><span>
</span><a name="line-1064"></a><span>        </span><a name="local-6989586621679412963"><a href="#local-6989586621679412963"><span class="hs-identifier">allC</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679412958"><span class="hs-identifier hs-var">cloth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412960"><span class="hs-identifier hs-var">food</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412962"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">]</span><span>
</span><a name="line-1065"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412964"><a href="#local-6989586621679412964"><span class="hs-identifier">more3Kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.filter</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412963"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1066"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412965"><a href="#local-6989586621679412965"><span class="hs-identifier">more10Less70P</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412966"><a href="#local-6989586621679412966"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679412949"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1067"></a><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412967"><a href="#local-6989586621679412967"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679412966"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679412967"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679412966"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.7</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679412967"><span class="hs-identifier hs-var">x</span></a><span>  </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412963"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span>
</span><a name="line-1068"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679412964"><span class="hs-identifier hs-var">more3Kind</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679412965"><span class="hs-identifier hs-var">more10Less70P</span></a><span>
</span><a name="line-1069"></a><span>
</span><a name="line-1070"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1071"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1072"></a><span>    </span><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412951"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412951"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412951"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1073"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412951"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1074"></a><span>    </span><a name="local-6989586621679412950"><a href="#local-6989586621679412950"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679412952"><a href="#local-6989586621679412952"><span class="hs-identifier">cloth</span></a></a><span> </span><a name="local-6989586621679412953"><a href="#local-6989586621679412953"><span class="hs-identifier">food</span></a></a><span> </span><a name="local-6989586621679412954"><a href="#local-6989586621679412954"><span class="hs-identifier">other</span></a></a><span> </span><a name="local-6989586621679412955"><a href="#local-6989586621679412955"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-1075"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412956"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;57&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679412952"><span class="hs-identifier hs-var">cloth</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412956"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679412953"><span class="hs-identifier hs-var">food</span></a><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1077"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412956"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;59&quot;</span><span>  </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679412956"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;60&quot;</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679412954"><span class="hs-identifier hs-var">other</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1078"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1079"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679412956"><a href="#local-6989586621679412956"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span>
</span><a name="line-1082"></a><span>
</span><a name="line-1083"></a><span class="hs-comment">{- | &#12452; &#12300;5699 &#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#65288;&#24467;&#26989;&#32773;&#12364;&#24120;&#26178;50&#20154;&#26410;&#28288;&#12398;&#12418;&#12398;&#65289;&#12301;

&#34920;3&#12398;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#23567;&#22770;&#12426;&#12375;&#12289;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12398;&#21508;&#36009;&#22770;
&#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;50&#65285;&#26410;&#28288;&#12391;&#12289;&#24467;&#26989;&#32773;&#12364;50&#20154;&#26410;&#28288;&#12398;&#20107;&#26989;&#25152;

-}</span><span>
</span><a name="line-1089"></a><span>
</span><a name="line-1090"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1091"></a><a name="f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><a href="V.html#f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412968"><a href="#local-6989586621679412968"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679412969"><a href="#local-6989586621679412969"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679412970"><a href="#local-6989586621679412970"><span class="hs-identifier">area</span></a></a><span>
</span><a name="line-1092"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#less50Every%88683"><span class="hs-identifier hs-var">less50Every&#34920;3</span></a><span> </span><a href="#local-6989586621679412968"><span class="hs-identifier hs-var">retail</span></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1093"></a><span>                             </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1094"></a><span>                             </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679412968"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;5699&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1095"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412968"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412969"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679412970"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1096"></a><span>
</span><a name="line-1097"></a><span class="hs-identifier">less50Every&#34920;3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1098"></a><a name="less50Every%88683"><a href="V.html#less50Every%88683"><span class="hs-identifier">less50Every&#34920;3</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1099"></a><span class="hs-identifier">less50Every&#34920;3</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412971"><a href="#local-6989586621679412971"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1100"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1101"></a><span>        </span><a name="local-6989586621679412980"><a href="#local-6989586621679412980"><span class="hs-identifier">cloth</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412979"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412979"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1102"></a><span>        </span><a name="local-6989586621679412982"><a href="#local-6989586621679412982"><span class="hs-identifier">food</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412981"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412981"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1103"></a><span>        </span><a name="local-6989586621679412984"><a href="#local-6989586621679412984"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412983"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412983"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1104"></a><span>
</span><a name="line-1105"></a><span>        </span><span class="hs-identifier hs-var">V.forM</span><span> </span><a href="#local-6989586621679412971"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679412972"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679412980"><span class="hs-identifier hs-var">cloth</span></a><span> </span><a href="#local-6989586621679412982"><span class="hs-identifier hs-var">food</span></a><span> </span><a href="#local-6989586621679412984"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-1106"></a><span>
</span><a name="line-1107"></a><span>        </span><a name="local-6989586621679412985"><a href="#local-6989586621679412985"><span class="hs-identifier">allC</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679412980"><span class="hs-identifier hs-var">cloth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412982"><span class="hs-identifier hs-var">food</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412984"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">]</span><span>
</span><a name="line-1108"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412986"><a href="#local-6989586621679412986"><span class="hs-identifier">more3Kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.filter</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412985"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1109"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679412987"><a href="#local-6989586621679412987"><span class="hs-identifier">less50P</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679412971"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412985"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span>
</span><a name="line-1110"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679412986"><span class="hs-identifier hs-var">more3Kind</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679412987"><span class="hs-identifier hs-var">less50P</span></a><span>
</span><a name="line-1111"></a><span>
</span><a name="line-1112"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1113"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1114"></a><span>    </span><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412973"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412973"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412973"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412973"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1116"></a><span>    </span><a name="local-6989586621679412972"><a href="#local-6989586621679412972"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679412974"><a href="#local-6989586621679412974"><span class="hs-identifier">cloth</span></a></a><span> </span><a name="local-6989586621679412975"><a href="#local-6989586621679412975"><span class="hs-identifier">food</span></a></a><span> </span><a name="local-6989586621679412976"><a href="#local-6989586621679412976"><span class="hs-identifier">other</span></a></a><span> </span><a name="local-6989586621679412977"><a href="#local-6989586621679412977"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-1117"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412978"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;57&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679412974"><span class="hs-identifier hs-var">cloth</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412977"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1118"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412978"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679412975"><span class="hs-identifier hs-var">food</span></a><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412977"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1119"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679412978"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;59&quot;</span><span>  </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679412978"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;60&quot;</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679412976"><span class="hs-identifier hs-var">other</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679412977"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1121"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679412978"><a href="#local-6989586621679412978"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412977"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1122"></a><span>
</span><a name="line-1123"></a><span class="hs-comment">{- | &#20197;&#19979;&#12398;,&#20966;&#29702;&#12398;&#12383;&#12417;&#12395;,&#20013;&#20998;&#39006;,&#23567;&#20998;&#39006;&#12391;&#19968;&#26086;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;.

&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#22580;&#21512;&#12399;,Nothing &#12434;&#36820;&#12377;
-}</span><span>
</span><a name="line-1127"></a><span>
</span><a name="line-1128"></a><span class="hs-identifier">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">)</span><span>
</span><a name="line-1129"></a><a name="f%5C0F%58F2%4E2D%5C0F%5206%985E%683C%4ED8"><a href="V.html#f%5C0F%58F2%4E2D%5C0F%5206%985E%683C%4ED8"><span class="hs-identifier">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1130"></a><span class="hs-identifier">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679412988"><a href="#local-6989586621679412988"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679412990"><span class="hs-identifier hs-var">middle</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679412989"><span class="hs-identifier hs-var">small</span></a><span class="hs-special">)</span><span>
</span><a name="line-1131"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1132"></a><span>    </span><a name="local-6989586621679412989"><a href="#local-6989586621679412989"><span class="hs-identifier">small</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#vmaximumNameWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNameWithoutErr</span></a><span>
</span><a name="line-1133"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span>
</span><a name="line-1134"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412991"><a href="#local-6989586621679412991"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412991"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412991"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412988"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1135"></a><span>    </span><a name="local-6989586621679412990"><a href="#local-6989586621679412990"><span class="hs-identifier">middle</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#vmaximumNameWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNameWithoutErr</span></a><span>
</span><a name="line-1136"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span>
</span><a name="line-1137"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679412992"><a href="#local-6989586621679412992"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679412992"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679412992"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679412988"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1138"></a><span>
</span><a name="line-1139"></a><span>
</span><a name="line-1140"></a><span>
</span><a name="line-1141"></a><span>
</span><a name="line-1142"></a><span class="hs-comment">{- | &#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12398;&#20966;&#29702; 
    * &#12458; &#12300;6031 &#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12301;

    &#23567;&#20998;&#39006;&#12300;603 &#21307;&#34220;&#21697;&#12539;&#21270;&#31911;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#20197;&#19979;&#12398;&#12356;&#12378;&#12428;&#12363;&#12398;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12390;&#12362;&#12426;&#12289;&#65378;6032 &#19968;&#33324;&#29992;&#21307;&#34220;&#21697;&#65379; &#12434;&#23567;&#22770;&#12426;&#12375;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12390;&#12362;&#12426;&#12289;&#12300;&#24215;&#33303;&#24418;&#24907;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12301;&#12434;&#36984;&#25246;&#12375;&#12383;&#20107;&#26989;&#25152;
-}</span><span>
</span><a name="line-1151"></a><span>
</span><a name="line-1152"></a><span class="hs-identifier">f&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1153"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1154"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1155"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1156"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1157"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1158"></a><a name="f%30C9%30E9%30C3%30B0%30B9%30C8%30A2%51E6%7406"><a href="V.html#f%30C9%30E9%30C3%30B0%30B9%30C8%30A2%51E6%7406"><span class="hs-identifier">f&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679412993"><a href="#local-6989586621679412993"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679412994"><a href="#local-6989586621679412994"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679412995"><a href="#local-6989586621679412995"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679412996"><a href="#local-6989586621679412996"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679412997"><a href="#local-6989586621679412997"><span class="hs-identifier">shopType</span></a></a><span>
</span><a name="line-1159"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="V.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679412996"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679412998"><span class="hs-identifier hs-var">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span></a><span> </span><a href="#local-6989586621679412997"><span class="hs-identifier hs-var">shopType</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6031&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1160"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="V.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679412996"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679413000"><span class="hs-identifier hs-var">include</span></a><span> </span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6031&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1161"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679412994"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679412995"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1162"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1163"></a><span>    </span><span class="hs-identifier">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1164"></a><span>    </span><a name="local-6989586621679412998"><a href="#local-6989586621679412998"><span class="hs-identifier">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1165"></a><span>    </span><span class="hs-identifier">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-var">V&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><a name="local-6989586621679413001"><a href="#local-6989586621679413001"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413001"><span class="hs-identifier hs-var">sk</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%30C9%30E9%30C3%30B0%30B9%30C8%30A2"><span class="hs-identifier hs-var">E&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1166"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1167"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1168"></a><span>    </span><span class="hs-identifier">included</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1169"></a><span>    </span><a name="local-6989586621679412999"><a href="#local-6989586621679412999"><span class="hs-identifier">included</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1170"></a><span>    </span><a name="local-6989586621679413000"><a href="#local-6989586621679413000"><span class="hs-identifier">include</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413002"><a href="#local-6989586621679413002"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679413003"><span class="hs-identifier hs-var">len</span></a><span>
</span><a name="line-1171"></a><span>                        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679413003"><a href="#local-6989586621679413003"><span class="hs-identifier">len</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.length</span><span>
</span><a name="line-1172"></a><span>                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413002"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1173"></a><span>                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413004"><a href="#local-6989586621679413004"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413004"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6032&quot;</span><span>
</span><a name="line-1174"></a><span>
</span><a name="line-1175"></a><span>
</span><a name="line-1176"></a><span class="hs-comment">{- | &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12398;&#12392;&#12365;&#12398;&#20966;&#29702;

    *&#12300;5891 &#12467;&#12531;&#12499;&#12491;&#12456;&#12531;&#12473;&#12473;&#12488;&#12450;&#65288;&#39154;&#39135;&#26009;&#21697;&#12434;&#20013;&#24515;&#12392;&#12377;&#12427;&#12418;&#12398;&#12395;&#38480;&#12427;&#65289;&#12301;

    &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12289;&#22770;
    &#22580;&#38754;&#31309;&#12364;30&#13217;&#20197;&#19978;250&#13217;&#26410;&#28288;&#12391;&#12289;&#21942;&#26989;&#26178;&#38291;&#12364;14&#26178;&#38291;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

    *&#12300;5811 &#21508;&#31278;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;

    &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#34920;4&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;3&#26689;&#12391;&#20998;&#39006;
    &#38598;&#35336;&#12375;&#12383;&#23567;&#22770;&#36009;&#22770;&#38989;&#12364;3&#12388;&#20197;&#19978;&#12354;&#12426;&#12289;&#12381;&#12398;&#12356;&#12378;&#12428;&#12418;&#12364;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12300;58&#12301;&#65288;&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12395;&#23646;&#12377;
    &#12427;&#21697;&#30446;&#65289;&#12398;&#32207;&#38989;&#12398;50&#65285;&#12395;&#28288;&#12383;&#12394;&#12356;&#20107;&#26989;&#25152;


    *&#34920;4 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12392;&#21830;&#21697;&#20998;&#39006;

    &#29987;&#26989;&#20998;&#39006; &#21830;&#21697;&#20998;&#39006;&#30058;&#21495;

    &#19978;&#20301;3&#26689; &#20197;&#19979;&#12398;&#29987;&#26989;&#20998;&#39006;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;

    &gt; 58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;
    &gt; 582 &#37326;&#33756;&#12539;&#26524;&#23455;&#23567;&#22770;&#26989;
    &gt; 583 &#39135;&#32905;&#23567;&#22770;&#26989;
    &gt; 584 &#39854;&#39770;&#23567;&#22770;&#26989;
    &gt; 585 &#37202;&#23567;&#22770;&#26989;
    &gt; 586 &#33747;&#23376;&#12539;&#12497;&#12531;&#23567;&#22770;&#26989;
    &gt; 589 &#12381;&#12398;&#20182;&#12398;&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;
-}</span><span>
</span><a name="line-1204"></a><span>
</span><a name="line-1205"></a><span class="hs-identifier">f&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#20966;&#29702;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1206"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1207"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1208"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1209"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1210"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1211"></a><a name="f%98F2%98DF%6599%54C1%5C0F%58F2%51E6%7406"><a href="V.html#f%98F2%98DF%6599%54C1%5C0F%58F2%51E6%7406"><span class="hs-identifier">f&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413005"><a href="#local-6989586621679413005"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679413006"><a href="#local-6989586621679413006"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679413007"><a href="#local-6989586621679413007"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679413008"><a href="#local-6989586621679413008"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679413009"><a href="#local-6989586621679413009"><span class="hs-identifier">open</span></a></a><span>
</span><a name="line-1212"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="V.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679413008"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413010"><span class="hs-identifier hs-var">more30Less250</span></a><span> </span><a href="#local-6989586621679413007"><span class="hs-identifier hs-var">area</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413011"><span class="hs-identifier hs-var">more14hour</span></a><span> </span><a href="#local-6989586621679413009"><span class="hs-identifier hs-var">open</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1213"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1214"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679413005"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6091&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1215"></a><span>
</span><a name="line-1216"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#less50Every%88684"><span class="hs-identifier hs-var">less50Every&#34920;4</span></a><span> </span><a href="#local-6989586621679413005"><span class="hs-identifier hs-var">retail</span></a><span>                                         </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1217"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1218"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679413005"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;5811&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1219"></a><span>
</span><a name="line-1220"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                     </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413005"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679413006"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679413007"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1221"></a><span>
</span><a name="line-1222"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1223"></a><span>    </span><span class="hs-comment">--  &#22770;&#22580;&#38754;&#31309;&#12364;30&#13217;&#20197;&#19978;250&#13217;&#26410;&#28288; &#12398;&#21028;&#23450;</span><span>
</span><a name="line-1224"></a><span>    </span><span class="hs-identifier">more30Less250</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1225"></a><span>    </span><a name="local-6989586621679413010"><a href="#local-6989586621679413010"><span class="hs-identifier">more30Less250</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1226"></a><span>    </span><span class="hs-identifier">more30Less250</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413012"><a href="#local-6989586621679413012"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413012"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">30</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-number">250</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679413012"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1227"></a><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1228"></a><span>    </span><span class="hs-comment">-- &#21942;&#26989;&#26178;&#38291;&#12364;14&#26178;&#38291;&#20197;&#19978;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-1229"></a><span>    </span><span class="hs-identifier">more14hour</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#ValInt"><span class="hs-identifier hs-type">ValInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1230"></a><span>    </span><a name="local-6989586621679413011"><a href="#local-6989586621679413011"><span class="hs-identifier">more14hour</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1231"></a><span>    </span><span class="hs-identifier">more14hour</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VInt"><span class="hs-identifier hs-var">VInt</span></a><span> </span><a name="local-6989586621679413013"><a href="#local-6989586621679413013"><span class="hs-identifier">num</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413013"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">14</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1232"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1233"></a><span>
</span><a name="line-1234"></a><span class="hs-comment">-- | &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#34920;4&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;3&#26689;&#12391;&#20998;&#39006;</span><span>
</span><a name="line-1235"></a><span class="hs-comment">--   &#38598;&#35336;&#12375;&#12383;&#23567;&#22770;&#36009;&#22770;&#38989;&#12364;3&#12388;&#20197;&#19978;&#12354;&#12426;&#12289;&#12381;&#12398;&#12356;&#12378;&#12428;&#12418;&#12364;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12300;58&#12301;&#65288;&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12395;&#23646;&#12377;</span><span>
</span><a name="line-1236"></a><span class="hs-comment">--   &#12427;&#21697;&#30446;&#65289;&#12398;&#32207;&#38989;&#12398;50&#65285;&#12395;&#28288;&#12383;&#12394;&#12356;&#20107;&#26989;&#25152;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-1237"></a><span>
</span><a name="line-1238"></a><span class="hs-identifier">less50Every&#34920;4</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1239"></a><a name="less50Every%88684"><a href="V.html#less50Every%88684"><span class="hs-identifier">less50Every&#34920;4</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1240"></a><span class="hs-identifier">less50Every&#34920;4</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413014"><a href="#local-6989586621679413014"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1241"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1242"></a><span>        </span><a name="local-6989586621679413028"><a href="#local-6989586621679413028"><span class="hs-identifier">c582</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413027"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413027"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1243"></a><span>        </span><a name="local-6989586621679413030"><a href="#local-6989586621679413030"><span class="hs-identifier">c583</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413029"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413029"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1244"></a><span>        </span><a name="local-6989586621679413032"><a href="#local-6989586621679413032"><span class="hs-identifier">c584</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413031"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413031"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1245"></a><span>        </span><a name="local-6989586621679413034"><a href="#local-6989586621679413034"><span class="hs-identifier">c585</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413033"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413033"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1246"></a><span>        </span><a name="local-6989586621679413036"><a href="#local-6989586621679413036"><span class="hs-identifier">c586</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413035"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413035"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1247"></a><span>        </span><a name="local-6989586621679413038"><a href="#local-6989586621679413038"><span class="hs-identifier">c589</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413037"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413037"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1248"></a><span>
</span><a name="line-1249"></a><span>        </span><span class="hs-identifier hs-var">V.forM</span><span> </span><a href="#local-6989586621679413014"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679413016"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679413028"><span class="hs-identifier hs-var">c582</span></a><span> </span><a href="#local-6989586621679413030"><span class="hs-identifier hs-var">c583</span></a><span> </span><a href="#local-6989586621679413032"><span class="hs-identifier hs-var">c584</span></a><span> </span><a href="#local-6989586621679413034"><span class="hs-identifier hs-var">c585</span></a><span> </span><a href="#local-6989586621679413036"><span class="hs-identifier hs-var">c586</span></a><span> </span><a href="#local-6989586621679413038"><span class="hs-identifier hs-var">c589</span></a><span>
</span><a name="line-1250"></a><span>
</span><a name="line-1251"></a><span>        </span><a name="local-6989586621679413039"><a href="#local-6989586621679413039"><span class="hs-identifier">allC</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679413028"><span class="hs-identifier hs-var">c582</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413030"><span class="hs-identifier hs-var">c583</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413032"><span class="hs-identifier hs-var">c584</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413034"><span class="hs-identifier hs-var">c585</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413036"><span class="hs-identifier hs-var">c586</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413038"><span class="hs-identifier hs-var">c589</span></a><span class="hs-special">]</span><span>
</span><a name="line-1252"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413040"><a href="#local-6989586621679413040"><span class="hs-identifier">more3Kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.filter</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413039"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1253"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413041"><a href="#local-6989586621679413041"><span class="hs-identifier">less50P</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413015"><span class="hs-identifier hs-var">totalTop58</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413039"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span>
</span><a name="line-1254"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679413040"><span class="hs-identifier hs-var">more3Kind</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679413041"><span class="hs-identifier hs-var">less50P</span></a><span>
</span><a name="line-1255"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1256"></a><span>    </span><a name="local-6989586621679413015"><a href="#local-6989586621679413015"><span class="hs-identifier">totalTop58</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span>
</span><a name="line-1257"></a><span>                </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413014"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1258"></a><span>                </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413018"><a href="#local-6989586621679413018"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413018"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>
</span><a name="line-1259"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1260"></a><span>    </span><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413017"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413017"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413017"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1261"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413017"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413017"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413017"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413017"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1263"></a><span>    </span><a name="local-6989586621679413016"><a href="#local-6989586621679413016"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679413019"><a href="#local-6989586621679413019"><span class="hs-identifier">c582</span></a></a><span> </span><a name="local-6989586621679413020"><a href="#local-6989586621679413020"><span class="hs-identifier">c583</span></a></a><span> </span><a name="local-6989586621679413021"><a href="#local-6989586621679413021"><span class="hs-identifier">c584</span></a></a><span> </span><a name="local-6989586621679413022"><a href="#local-6989586621679413022"><span class="hs-identifier">c585</span></a></a><span> </span><a name="local-6989586621679413023"><a href="#local-6989586621679413023"><span class="hs-identifier">c586</span></a></a><span> </span><a name="local-6989586621679413024"><a href="#local-6989586621679413024"><span class="hs-identifier">c589</span></a></a><span> </span><a name="local-6989586621679413025"><a href="#local-6989586621679413025"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-1264"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;582&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413019"><span class="hs-identifier hs-var">c582</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413025"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1265"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;583&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413020"><span class="hs-identifier hs-var">c583</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413025"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1266"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;584&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413021"><span class="hs-identifier hs-var">c584</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413025"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1267"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;585&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413022"><span class="hs-identifier hs-var">c585</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413025"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1268"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;586&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413023"><span class="hs-identifier hs-var">c586</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413025"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1269"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;589&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413024"><span class="hs-identifier hs-var">c589</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413025"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1270"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679413026"><a href="#local-6989586621679413026"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413025"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1272"></a><span>
</span><a name="line-1273"></a><span class="hs-comment">{- | &#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#20966;&#29702;
    &#20013;&#20998;&#39006;&#12300;60 &#12381;&#12398;&#20182;&#12398;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#20197;&#19979;&#12398;&#12356;&#12378;&#12428;&#12363;&#12398;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12289;&#22770;&#22580;&#38754;&#31309;&#12364;500&#13217;&#20197;&#19978;&#12391;&#12289;&#37329;&#29289;&#12289;&#33618;&#29289;&#12289;&#33495;&#12539;&#31278;&#23376;&#12398;&#12356;&#12378;&#12428;&#12363;&#12434;&#23567;&#22770;&#12426;&#12375;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12289;&#22770;&#22580;&#38754;&#31309;&#12364;500&#13217;&#20197;&#19978;&#12391;&#12289;&#12300;&#24215;&#33303;&#24418;&#24907;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#12301;&#12434;&#36984;&#25246;&#12375;&#12383;&#20107;&#26989;&#25152;

    &gt; 6021    &#37329;&#29289;&#23567;&#22770;&#26989;
    &gt; 6022    &#33618;&#29289;&#23567;&#22770;&#26989;
    &gt; 6042    &#33495;&#12539;&#31278;&#23376;&#23567;&#22770;&#26989;
    &gt; 6091    &#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;-}</span><span>
</span><a name="line-1284"></a><span>
</span><a name="line-1285"></a><span class="hs-identifier">f&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1286"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1287"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1288"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1289"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1290"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1291"></a><a name="f%30DB%30FC%30E0%30BB%30F3%30BF%30FC%51E6%7406"><a href="V.html#f%30DB%30FC%30E0%30BB%30F3%30BF%30FC%51E6%7406"><span class="hs-identifier">f&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413042"><a href="#local-6989586621679413042"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679413043"><a href="#local-6989586621679413043"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679413044"><a href="#local-6989586621679413044"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679413045"><a href="#local-6989586621679413045"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679413046"><a href="#local-6989586621679413046"><span class="hs-identifier">sellType</span></a></a><span>
</span><a name="line-1292"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413047"><span class="hs-identifier hs-var">tempBool</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cars</span><span> </span><a href="#local-6989586621679413045"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6091&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1293"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413045"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679413046"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679413043"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1294"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1295"></a><span>    </span><a name="local-6989586621679413047"><a href="#local-6989586621679413047"><span class="hs-identifier">tempBool</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="V.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679413042"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413049"><span class="hs-identifier hs-var">more500</span></a><span> </span><a href="#local-6989586621679413043"><span class="hs-identifier hs-var">area</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413048"><span class="hs-identifier hs-var">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span></a><span> </span><a href="#local-6989586621679413044"><span class="hs-identifier hs-var">shopType</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679413050"><span class="hs-identifier hs-var">inclued</span></a><span> </span><a href="#local-6989586621679413045"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span>
</span><a name="line-1296"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1297"></a><span>    </span><span class="hs-identifier">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1298"></a><span>    </span><a name="local-6989586621679413048"><a href="#local-6989586621679413048"><span class="hs-identifier">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1299"></a><span>    </span><span class="hs-identifier">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-var">V&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><a name="local-6989586621679413051"><a href="#local-6989586621679413051"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413051"><span class="hs-identifier hs-var">sk</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%30DB%30FC%30E0%30BB%30F3%30BF%30FC"><span class="hs-identifier hs-var">E&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1300"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1301"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1302"></a><span>    </span><span class="hs-identifier">more500</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1303"></a><span>    </span><a name="local-6989586621679413049"><a href="#local-6989586621679413049"><span class="hs-identifier">more500</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1304"></a><span>    </span><span class="hs-identifier">more500</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413052"><a href="#local-6989586621679413052"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413052"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span>  </span><span class="hs-number">500</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1305"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1306"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1307"></a><span>    </span><span class="hs-identifier">inclued</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1308"></a><span>    </span><a name="local-6989586621679413050"><a href="#local-6989586621679413050"><span class="hs-identifier">inclued</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1309"></a><span>    </span><span class="hs-identifier">inclued</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413053"><a href="#local-6989586621679413053"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413054"><a href="#local-6989586621679413054"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413053"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1310"></a><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">L.or</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413055"><a href="#local-6989586621679413055"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><a href="#local-6989586621679413055"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679413054"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span>
</span><a name="line-1311"></a><span>                       </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;6021&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;6022&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;6042&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1312"></a><span>
</span><a name="line-1313"></a><span>
</span><a name="line-1314"></a><span class="hs-comment">-- | &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#12363;&#21542;&#12363;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-1315"></a><span class="hs-identifier">is&#12475;&#12523;&#12501;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1316"></a><a name="is%30BB%30EB%30D5"><a href="V.html#is%30BB%30EB%30D5"><span class="hs-identifier">is&#12475;&#12523;&#12501;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1317"></a><span class="hs-identifier">is&#12475;&#12523;&#12501;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><a name="local-6989586621679413056"><a href="#local-6989586621679413056"><span class="hs-identifier">bl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413056"><span class="hs-identifier hs-var">bl</span></a><span>
</span><a name="line-1318"></a><span>
</span><a name="line-1319"></a><span>
</span><a name="line-1320"></a><span class="hs-comment">{- | &#28961;&#24215;&#33303;&#20966;&#29702;
    * &#12300;61 &#28961;&#24215;&#33303;&#23567;&#22770;&#26989;&#12301;
    &#36009;&#22770;&#24418;&#24907;&#12398;&#24215;&#38957;&#36009;&#22770;&#12398;&#21106;&#21512;&#12364;0&#65285;&#21450;&#12403;&#22770;&#22580;&#38754;&#31309;&#12364;0&#13217;&#12398;&#20107;&#26989;&#25152;

    &#33258;&#21205;&#36009;&#22770;&#27231;,&#12381;&#12398;&#20182;&#12395;&#38306;&#12375;&#12390;&#12399;,&#12381;&#12398;&#12414;&#12414;Car&#12395;&#36861;&#21152;&#12377;&#12427;

    6121    &#33258;&#21205;&#36009;&#22770;&#27231;&#12395;&#12424;&#12427;&#23567;&#22770;&#26989;

    6199    &#12381;&#12398;&#20182;&#12398;&#28961;&#24215;&#33303;&#23567;&#22770;&#26989;-}</span><span>
</span><a name="line-1329"></a><span>
</span><a name="line-1330"></a><span class="hs-identifier">f&#28961;&#24215;&#33303;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1331"></a><a name="f%7121%5E97%8217%51E6%7406"><a href="V.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>   </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1332"></a><span class="hs-identifier">f&#28961;&#24215;&#33303;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413057"><a href="#local-6989586621679413057"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679413058"><a href="#local-6989586621679413058"><span class="hs-identifier">sellType</span></a></a><span>  </span><a name="local-6989586621679413059"><a href="#local-6989586621679413059"><span class="hs-identifier">area</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1333"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413064"><span class="hs-identifier hs-var">is&#28961;&#24215;&#33303;</span></a><span> </span><a href="#local-6989586621679413058"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679413059"><span class="hs-identifier hs-var">area</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1334"></a><span>            </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413058"><span class="hs-identifier hs-var">sellType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413057"><span class="hs-identifier hs-var">retail</span></a><span>
</span><a name="line-1335"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#appendVCars"><span class="hs-identifier hs-var">appendVCars</span></a><span> </span><a href="#local-6989586621679413062"><span class="hs-identifier hs-var">outAndOth</span></a><span> </span><a href="#local-6989586621679413057"><span class="hs-identifier hs-var">retail</span></a><span>
</span><a name="line-1336"></a><span>
</span><a name="line-1337"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413058"><span class="hs-identifier hs-var">sellType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>                        </span><a href="#local-6989586621679413063"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span></a><span> </span><a href="#local-6989586621679413057"><span class="hs-identifier hs-var">retail</span></a><span>
</span><a name="line-1338"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#appendVCars"><span class="hs-identifier hs-var">appendVCars</span></a><span> </span><a href="#local-6989586621679413062"><span class="hs-identifier hs-var">outAndOth</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413063"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span></a><span> </span><a href="#local-6989586621679413057"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span>
</span><a name="line-1339"></a><span>
</span><a name="line-1340"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1341"></a><span>    </span><a name="local-6989586621679413060"><a href="#local-6989586621679413060"><span class="hs-identifier">outo</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_&#33258;&#21205;&#36009;&#22770;&#27231;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">_&#36009;&#22770;&#24418;&#24907;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413058"><span class="hs-identifier hs-var">sellType</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6121&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1342"></a><span>    </span><a name="local-6989586621679413061"><a href="#local-6989586621679413061"><span class="hs-identifier">oth</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_&#12381;&#12398;&#20182;&#36009;&#22770;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">_&#36009;&#22770;&#24418;&#24907;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413058"><span class="hs-identifier hs-var">sellType</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6199&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1343"></a><span>    </span><a name="local-6989586621679413062"><a href="#local-6989586621679413062"><span class="hs-identifier">outAndOth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679413060"><span class="hs-identifier hs-var">outo</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413061"><span class="hs-identifier hs-var">oth</span></a><span class="hs-special">]</span><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span>    </span><span class="hs-identifier">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1346"></a><span>    </span><a name="local-6989586621679413063"><a href="#local-6989586621679413063"><span class="hs-identifier">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1347"></a><span>    </span><span class="hs-identifier">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413065"><a href="#local-6989586621679413065"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679413065"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VClass.html#dd%7121%5E97%8217%5C0F%58F2%696D"><span class="hs-identifier hs-var">dd&#28961;&#24215;&#33303;&#23567;&#22770;&#26989;</span></a><span>
</span><a name="line-1348"></a><span>
</span><a name="line-1349"></a><span>    </span><span class="hs-comment">--  &#28961;&#24215;&#33303;&#12363;&#21542;&#12363;&#12398;&#21028;&#26029;</span><span>
</span><a name="line-1350"></a><span>    </span><span class="hs-identifier">is&#28961;&#24215;&#33303;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1351"></a><span>    </span><a name="local-6989586621679413064"><a href="#local-6989586621679413064"><span class="hs-identifier">is&#28961;&#24215;&#33303;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1352"></a><span>    </span><span class="hs-identifier">is&#28961;&#24215;&#33303;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-var">V&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><a name="local-6989586621679413066"><a href="#local-6989586621679413066"><span class="hs-identifier">sell</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#24215;&#38957;&#36009;&#22770;</span><span> </span><a href="#local-6989586621679413066"><span class="hs-identifier hs-var">sell</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1353"></a><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1354"></a><span>    </span><span class="hs-identifier">is&#28961;&#24215;&#33303;</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413067"><a href="#local-6989586621679413067"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413067"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1355"></a><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1356"></a><span>
</span><a name="line-1357"></a><span>
</span><a name="line-1358"></a><span>
</span><a name="line-1359"></a><span class="hs-comment">-- **** &#21368;&#22770;&#26989;</span><span>
</span><a name="line-1360"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1361"></a><span class="hs-comment">{- | &#21368;&#22770;&#26989;&#12398;&#20966;&#29702;
    * &#12454; &#12300;5598 &#20195;&#29702;&#21830;&#65292;&#20210;&#31435;&#26989;&#12301;

    &#21368;&#22770;&#12398;&#21830;&#21697;&#36009;&#22770;&#38989;&#65288;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#38500;&#12367;&#12290;&#65289;&#12392;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#27604;&#36611;&#12375;&#12289;&#20210;&#31435;&#25163;&#25968;&#26009;&#12364;&#22810;&#12356;&#22580;&#21512;&#12395;&#12300;&#20195;
&#29702;&#21830;&#65292;&#20210;&#31435;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#12290;
-}</span><span>
</span><a name="line-1367"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1368"></a><a name="f%5378%58F2%51E6%7406"><a href="V.html#f%5378%58F2%51E6%7406"><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>   </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1369"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413068"><a href="#local-6989586621679413068"><span class="hs-identifier">middle</span></a></a><span> </span><a name="local-6989586621679413069"><a href="#local-6989586621679413069"><span class="hs-identifier">wholesale</span></a></a><span> </span><a name="local-6989586621679413070"><a href="#local-6989586621679413070"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-1370"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#canBe%5404%7A2E%5546%54C1%5378%58F2%696D"><span class="hs-identifier hs-var">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span></a><span> </span><a href="#local-6989586621679413069"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#appendVCars"><span class="hs-identifier hs-var">VDS.appendVCars</span></a><span> </span><a href="#local-6989586621679413071"><span class="hs-identifier hs-var">mid</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#f%5378%58F2%51E6%74062"><span class="hs-identifier hs-var">f&#21368;&#22770;&#20966;&#29702;2</span></a><span> </span><a href="#local-6989586621679413069"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><a href="#local-6989586621679413070"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-1371"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413071"><span class="hs-identifier hs-var">mid</span></a><span>
</span><a name="line-1372"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679413071"><a href="#local-6989586621679413071"><span class="hs-identifier">mid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#make%4EE3%7406%5546"><span class="hs-identifier hs-var">make&#20195;&#29702;&#21830;</span></a><span> </span><a href="#local-6989586621679413068"><span class="hs-identifier hs-var">middle</span></a><span>
</span><a name="line-1373"></a><span>
</span><a name="line-1374"></a><span>
</span><a name="line-1375"></a><span>
</span><a name="line-1376"></a><span class="hs-comment">{- | 
    * &#12300;5011 &#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#65288;&#24467;&#26989;&#32773;&#12364;&#24120;&#26178;100&#20154;&#20197;&#19978;&#12398;&#12418;&#12398;&#65289;&#12301;
    &#34920;2&#12398;&#36001;&#21029;&#65288;&#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#65289;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#21368;&#22770;&#12426;&#12375;&#12289;&#21508;&#36001;&#12398;&#36009;&#22770;&#38989;&#12364;&#12356;&#12378;&#12428;
    &#12418;&#21368;&#22770;&#36009;&#22770;&#32207;&#38989;&#65288;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#38500;&#12367;&#12290;&#65289;&#12398;10&#65285;&#20197;&#19978;&#12391;&#12289;&#24467;&#26989;&#32773;&#12364;100&#20154;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

    * &#12300;5019 &#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#12301;
    &#34920;2&#12398;&#36001;&#21029;&#65288;&#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#65289;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#21368;&#22770;&#12426;&#12375;&#12289;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;3&#26689;
    &#12398;&#36009;&#22770;&#38989;&#12391;&#20998;&#39006;&#38598;&#35336;&#12375;&#12383;&#36009;&#22770;&#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#21368;&#22770;&#36009;&#22770;&#32207;&#38989;&#65288;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#38500;&#12367;&#12290;&#65289;&#12398;50&#65285;&#26410;&#28288;&#12391;&#12289;&#24467;
    &#26989;&#32773;&#12364;100&#20154;&#26410;&#28288;&#12398;&#20107;&#26989;&#25152;

    * &#34920;2 &#36001;&#21029;&#12392;&#21830;&#21697;&#20998;&#39006;

    +--------+--------------------+-----+
    | &#21830;&#21697;&#20998;&#39006;&#30058;&#21495; | &#20197;&#19979;&#12398;&#29987;&#26989;&#20998;&#39006;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;      | &#36001;&#21029;  |
    |   &#19978;&#20301;3&#26689; |                    |     |
    +========+====================+=====+
    | 511    | &#32330;&#32173;&#21697;&#21368;&#22770;&#26989;&#65288;&#34915;&#26381;&#65292;&#36523;&#12398;&#22238;&#12426;&#21697;&#12434;&#38500;&#12367;&#65289;| &#29983;&#29987;&#36001; |
    +--------+--------------------+     |
    | 532    | &#21270;&#23398;&#35069;&#21697;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+     |
    | 533    | &#30707;&#27833;&#12539;&#37489;&#29289;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 534    | &#37444;&#37628;&#35069;&#21697;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+     |
    | 535    | &#38750;&#37444;&#37329;&#23646;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+     |
    | 536    | &#20877;&#29983;&#36039;&#28304;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+-----+
    | 531    | &#24314;&#31689;&#26448;&#26009;&#21368;&#22770;&#26989;            | &#36039;&#26412;&#36001; |
    +--------+--------------------+     |
    | 541    | &#29987;&#26989;&#27231;&#26800;&#22120;&#20855;&#21368;&#22770;&#26989;          |     |
    +--------+--------------------+     |
    | 542    | &#33258;&#21205;&#36554;&#21368;&#22770;&#26989;             |     |
    +--------+--------------------+     |
    | 543    | &#38651;&#27671;&#27231;&#26800;&#22120;&#20855;&#21368;&#22770;&#26989;          |     |
    +--------+--------------------+     |
    | 549    | &#12381;&#12398;&#20182;&#12398;&#27231;&#26800;&#22120;&#20855;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+-----+
    | 512    | &#34915;&#26381;&#21368;&#22770;&#26989;              | &#28040;&#36027;&#36001; |
    +--------+--------------------+     |
    | 513    | &#36523;&#12398;&#22238;&#12426;&#21697;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 521    | &#36786;&#30044;&#29987;&#29289;&#12539;&#27700;&#29987;&#29289;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+     |
    | 522    | &#39135;&#26009;&#12539;&#39154;&#26009;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 551    | &#23478;&#20855;&#12539;&#24314;&#20855;&#12539;&#12376;&#12421;&#12358;&#22120;&#31561;&#21368;&#22770;&#26989;     |     |
    +--------+--------------------+     |
    | 552    | &#21307;&#34220;&#21697;&#12539;&#21270;&#31911;&#21697;&#31561;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+     |
    | 553    | &#32025;&#12539;&#32025;&#35069;&#21697;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 559    | &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+-----+
    
    
    &#12394;&#12362;&#12289;&#19978;&#35352;&#12450;&#12289;&#12452;&#12395;&#12388;&#12356;&#12390;&#12289;&#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#25201;&#12387;&#12390;&#12356;&#12390;&#12418;&#12289;&#29983;&#29987;
    &#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12364;&#12300;536&#12301;&#65288;&#20877;&#29983;&#36039;&#28304;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12289;&#12414;&#12383;&#12399;&#12289;&#28040;&#36027;&#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;
    &#12364;&#12300;559&#12301;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12398;&#22580;&#21512;&#12395;&#12399;&#12289;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12424;&#12427;&#21368;&#22770;&#26989;&#26684;
    &#20184;&#12369;&#12392;&#12377;&#12427;&#12290;
-}</span><span>
</span><a name="line-1437"></a><span>
</span><a name="line-1438"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1439"></a><a name="f%5378%58F2%51E6%74062"><a href="V.html#f%5378%58F2%51E6%74062"><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;2</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1440"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;2</span><span> </span><a name="local-6989586621679413072"><a href="#local-6989586621679413072"><span class="hs-identifier">wholesale</span></a></a><span> </span><a name="local-6989586621679413073"><a href="#local-6989586621679413073"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-1441"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="V.html#more100%5F93%696D%54E1"><span class="hs-identifier hs-var">more100&#24467;&#26989;&#21729;</span></a><span> </span><a href="#local-6989586621679413073"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1442"></a><span>        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="V.html#less50Every3%8CA1"><span class="hs-identifier hs-var">less50Every3&#36001;</span></a><span> </span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1443"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1444"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">wholesale</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;5019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1445"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">wholesale</span></a><span>
</span><a name="line-1446"></a><span>
</span><a name="line-1447"></a><span>        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="V.html#more10Every3%8CA1"><span class="hs-identifier hs-var">more10Every3&#36001;</span></a><span> </span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1448"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1449"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">wholesale</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;5011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1450"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">wholesale</span></a><span>
</span><a name="line-1451"></a><span>
</span><a name="line-1452"></a><span>
</span><a name="line-1453"></a><span class="hs-comment">-- &#20195;&#29702;&#21830;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1454"></a><span class="hs-comment">-- &#21028;&#23450;&#12375;&#12394;&#12367;&#12390;&#12418;&#21213;&#25163;&#12395;,&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12391;&#20195;&#29702;&#21830;&#12395;&#12394;&#12427;&#12398;&#12391;,&#20316;&#12427;</span><span>
</span><a name="line-1455"></a><span class="hs-identifier">make&#20195;&#29702;&#21830;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-1456"></a><a name="make%4EE3%7406%5546"><a href="V.html#make%4EE3%7406%5546"><span class="hs-identifier">make&#20195;&#29702;&#21830;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1457"></a><span class="hs-identifier">make&#20195;&#29702;&#21830;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413074"><a href="#local-6989586621679413074"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413074"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;5598&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1458"></a><span>
</span><a name="line-1459"></a><span class="hs-comment">{- | &#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#25201;&#12387;&#12390;&#12356;&#12427;&#12363;&#21028;&#23450;

    &#29983;&#29987;&#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12364;&#12300;536&#12301;&#65288;&#20877;&#29983;&#36039;&#28304;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12289;&#12414;&#12383;&#12399;&#12289;&#28040;&#36027;&#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;
    &#12364;&#12300;559&#12301;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12398;&#22580;&#21512;&#12395;&#12399;&#12289;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12424;&#12427;&#21368;&#22770;&#26989;&#26684;
    &#20184;&#12369;&#12392;&#12377;&#12427;&#12290;

&#29983;&#29987;&#36001;,&#36039;&#26412;&#36001;,&#28040;&#36027;&#36001;&#12381;&#12428;&#12382;&#12428;&#12434;&#32032;&#25968;&#12395;&#22793;&#25563;&#12375;,&#12381;&#12398;&#31309;&#12395;&#23550;&#12375;&#12390;,&#26368;&#23567;&#20844;&#20493;&#25968;&#12398;&#12354;&#12414;&#12426;&#12434;&#12392;&#12387;&#12390;0&#12394;&#12425;,3&#36001;&#20840;&#12390;&#21547;&#12414;&#12428;&#12427;&#12392;&#35328;&#12358;&#21028;&#23450;.
-}</span><span>
</span><a name="line-1467"></a><span class="hs-identifier">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1468"></a><a name="canBe%5404%7A2E%5546%54C1%5378%58F2%696D"><a href="V.html#canBe%5404%7A2E%5546%54C1%5378%58F2%696D"><span class="hs-identifier">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1469"></a><span class="hs-identifier">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413075"><a href="#local-6989586621679413075"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413076"><a href="#local-6989586621679413076"><span class="hs-identifier">cs2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413077"><a href="#local-6989586621679413077"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413077"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;536&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413077"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;559&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413075"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1471"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1472"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">mod</span><span class="hs-special">)</span><span> </span><span class="hs-number">30</span><span>
</span><a name="line-1473"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.foldl1</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span>
</span><a name="line-1474"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.map</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413076"><span class="hs-identifier hs-var">cs2</span></a><span>
</span><a name="line-1475"></a><span>    </span><span class="hs-operator hs-var">$</span><span>  </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413078"><a href="#local-6989586621679413078"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413078"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VClass.html#ge%5378%58F2%8CA1%5225%5546%54C1"><span class="hs-identifier hs-var">VClass.ge&#21368;&#22770;&#36001;&#21029;&#21830;&#21697;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1476"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1477"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413079"><a href="#local-6989586621679413079"><span class="hs-identifier">ez</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413079"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%751F%7523%8CA1"><span class="hs-identifier hs-var">E&#29983;&#29987;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1478"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413079"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%8CC7%672C%8CA1"><span class="hs-identifier hs-var">E&#36039;&#26412;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-1479"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413079"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%6D88%8CBB%8CA1"><span class="hs-identifier hs-var">E&#28040;&#36027;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">5</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-comment">-- | &#24467;&#26989;&#21729;(&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;)&#12364;100&#20154;&#20197;&#19978;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1482"></a><span class="hs-identifier">more100&#24467;&#26989;&#21729;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1483"></a><a name="more100%5F93%696D%54E1"><a href="V.html#more100%5F93%696D%54E1"><span class="hs-identifier">more100&#24467;&#26989;&#21729;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1484"></a><span class="hs-identifier">more100&#24467;&#26989;&#21729;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679413080"><a href="#local-6989586621679413080"><span class="hs-identifier">em</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#20225;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413080"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413080"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1485"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1486"></a><span>
</span><a name="line-1487"></a><span>
</span><a name="line-1488"></a><span class="hs-comment">-- | 3&#36001;&#12364;&#12381;&#12428;&#12382;&#12428;&#32207;&#38989;&#12398;10%&#20197;&#19978;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1489"></a><span class="hs-identifier">more10Every3&#36001;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1490"></a><a name="more10Every3%8CA1"><a href="V.html#more10Every3%8CA1"><span class="hs-identifier">more10Every3&#36001;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1491"></a><span class="hs-identifier">more10Every3&#36001;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413081"><a href="#local-6989586621679413081"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1492"></a><span>                         </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413082"><a href="#local-6989586621679413082"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413081"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1493"></a><span>                         </span><a name="local-6989586621679413084"><a href="#local-6989586621679413084"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413083"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413083"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1494"></a><span>                         </span><a name="local-6989586621679413086"><a href="#local-6989586621679413086"><span class="hs-identifier">cap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413085"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413085"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1495"></a><span>                         </span><a name="local-6989586621679413088"><a href="#local-6989586621679413088"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413087"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413087"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1496"></a><span>                         </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413081"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413089"><a href="#local-6989586621679413089"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1497"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413089"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VClass.html#ge%5378%58F2%8CA1%5225%5546%54C1"><span class="hs-identifier hs-var">VClass.ge&#21368;&#22770;&#36001;&#21029;&#21830;&#21697;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1498"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1499"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413090"><a href="#local-6989586621679413090"><span class="hs-identifier">ez</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413090"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%751F%7523%8CA1"><span class="hs-identifier hs-var">E&#29983;&#29987;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413084"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413089"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1500"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413090"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%8CC7%672C%8CA1"><span class="hs-identifier hs-var">E&#36039;&#26412;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413084"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413089"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1501"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413090"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%6D88%8CBB%8CA1"><span class="hs-identifier hs-var">E&#28040;&#36027;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413084"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413089"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1502"></a><span>                         </span><a name="local-6989586621679413091"><a href="#local-6989586621679413091"><span class="hs-identifier">inp'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413084"><span class="hs-identifier hs-var">inp</span></a><span>
</span><a name="line-1503"></a><span>                         </span><a name="local-6989586621679413092"><a href="#local-6989586621679413092"><span class="hs-identifier">cap'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413086"><span class="hs-identifier hs-var">cap</span></a><span>
</span><a name="line-1504"></a><span>                         </span><a name="local-6989586621679413093"><a href="#local-6989586621679413093"><span class="hs-identifier">con'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413088"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1505"></a><span>                         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413082"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679413091"><span class="hs-identifier hs-var">inp'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413092"><span class="hs-identifier hs-var">cap'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413093"><span class="hs-identifier hs-var">con'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1506"></a><span>
</span><a name="line-1507"></a><span>
</span><a name="line-1508"></a><span class="hs-comment">-- | 3&#36001;&#12364;&#12381;&#12428;&#12382;&#12428;&#32207;&#38989;&#12398;50%&#20197;&#19979;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1509"></a><span class="hs-comment">-- 24&#24180;&#12399;28&#24180;&#12424;&#12426;&#21830;&#21697;&#20998;&#39006;&#12398;&#26689;&#25968;&#12364;&#19968;&#12388;&#22823;&#12365;&#12356;&#12398;&#12391;,&#19977;&#26689;&#12395;&#22793;&#25563;&#12375;&#12390;,&#21516;&#27096;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;.</span><span>
</span><a name="line-1510"></a><span class="hs-identifier">less50Every3&#36001;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1511"></a><a name="less50Every3%8CA1"><a href="V.html#less50Every3%8CA1"><span class="hs-identifier">less50Every3&#36001;</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1512"></a><span class="hs-identifier">less50Every3&#36001;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413094"><a href="#local-6989586621679413094"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1513"></a><span>                         </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413095"><a href="#local-6989586621679413095"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413094"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1514"></a><span>                         </span><a name="local-6989586621679413097"><a href="#local-6989586621679413097"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413096"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413096"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1515"></a><span>                         </span><a name="local-6989586621679413099"><a href="#local-6989586621679413099"><span class="hs-identifier">cap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413098"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413098"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1516"></a><span>                         </span><a name="local-6989586621679413101"><a href="#local-6989586621679413101"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413100"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413100"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1517"></a><span>                         </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413094"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413102"><a href="#local-6989586621679413102"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1518"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413102"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VClass.html#ge%5378%58F2%8CA1%5225%5546%54C1"><span class="hs-identifier hs-var">VClass.ge&#21368;&#22770;&#36001;&#21029;&#21830;&#21697;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1519"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1520"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413103"><a href="#local-6989586621679413103"><span class="hs-identifier">ez</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413103"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%751F%7523%8CA1"><span class="hs-identifier hs-var">E&#29983;&#29987;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413097"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413102"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1521"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413103"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%8CC7%672C%8CA1"><span class="hs-identifier hs-var">E&#36039;&#26412;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413097"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413102"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1522"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413103"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VClass.html#E%6D88%8CBB%8CA1"><span class="hs-identifier hs-var">E&#28040;&#36027;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413097"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413102"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1523"></a><span>                         </span><a name="local-6989586621679413104"><a href="#local-6989586621679413104"><span class="hs-identifier">inp'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413097"><span class="hs-identifier hs-var">inp</span></a><span>
</span><a name="line-1524"></a><span>                         </span><a name="local-6989586621679413105"><a href="#local-6989586621679413105"><span class="hs-identifier">cap'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413099"><span class="hs-identifier hs-var">cap</span></a><span>
</span><a name="line-1525"></a><span>                         </span><a name="local-6989586621679413106"><a href="#local-6989586621679413106"><span class="hs-identifier">con'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413101"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1526"></a><span>                         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413095"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679413104"><span class="hs-identifier hs-var">inp'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413105"><span class="hs-identifier hs-var">cap'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413106"><span class="hs-identifier hs-var">con'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1527"></a><span>
</span><a name="line-1528"></a><span>
</span><a name="line-1529"></a><span>
</span><a name="line-1530"></a><span class="hs-comment">-- *** &#21307;&#30274;&#65292;&#31119;&#31049;</span><span>
</span><a name="line-1531"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1532"></a><span class="hs-comment">{- | 
    &#21307;&#30274;&#65292;&#31119;&#31049;&#29987;&#26989;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369;&#12399;&#24179;&#25104;24&#24180;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#20107;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#65292;
    &#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12434;&#29992;&#12356;&#12427;&#12290;

    &#12394;&#12362;&#65292;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#12418;&#35519;&#26619;&#31080;&#12398;&#27083;&#25104;&#12395;&#22823;&#12365;&#12394;&#22793;&#26356;&#12399;&#12394;&#12356;&#12371;&#12392;&#12363;&#12425;&#65292;&#20197;&#19979;&#21516;&#19968;&#12398;&#20966;&#29702;&#12434;&#24819;&#23450;&#12375;&#12390;&#35542;&#12376;&#12427;&#12290;
    &#12414;&#12383;&#65292;&#21508;&#35519;&#26619;&#31080;&#12398;&#21028;&#21029;&#12395;&#12399;&#12300;&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12301;&#12434;&#29992;&#12356;&#12427;&#12290;

    &#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#20107;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;7&#21306;&#20998;&#12373;&#12428;&#12383;&#35386;&#30274;&#21450;&#12403;&#20107;&#26989;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21448;&#12399;&#21106;&#21512;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;

    &#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12391;&#12399;,&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12392;&#23550;&#24540;&#12377;&#12427;32&#21306;&#20998;&#12398;&#20107;&#26989;&#20869;&#23481;&#12363;&#12425;&#19968;&#12388;&#12434;&#36984;&#25246;&#12377;&#12427;&#12290;

    &#20197;&#19979;&#12371;&#12398;&#31680;&#12395;&#38480;&#12426;&#65292;&#21069;&#32773;&#12434;&#12300;&#65303;&#21306;&#20998;&#12301;&#65292;&#24460;&#32773;&#12434;&#12300;32&#21306;&#20998;&#12301;&#12392;&#21628;&#31216;&#12377;&#12427;&#12290;

    &#12381;&#12428;&#12382;&#12428;&#65292;&#12487;&#12540;&#12479;&#12392;&#12375;&#12390;&#12399;,
    * 7&#21306;&#20998; E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;
    * 32&#21306;&#20998; E&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;

    &#12395;&#23550;&#24540;&#12377;&#12427;&#65294;


    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#26684;&#20184;&#12369;&#12391;&#12399;&#65292;&#21336;&#32020;&#12395;&#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12434;&#26684;&#20184;&#12369;&#12395;&#29992;&#12356;&#12390;&#12356;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12290;

    &#12371;&#12371;&#12391;&#12399;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12398;&#29983;&#29987;&#37327;&#12434;&#25226;&#25569;&#12377;&#12427;&#12383;&#12417;,&#12371;&#12371;&#12391;&#12399;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#20107;&#26989;&#12395;&#65292;
    &#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#20107;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12434;&#37197;&#20998;&#12375;&#65292;&#12300;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12301;&#12434;&#32076;&#12390;&#65292;&#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;
    &#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#29987;&#26989;&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12373;&#12428;&#12427;&#12424;&#12358;&#12487;&#12540;&#12479;&#12434;&#22793;&#25563;&#12377;&#12427;&#12290;

    &#12371;&#12398;&#37197;&#20998;&#20316;&#26989;&#12395;&#24403;&#12383;&#12387;&#12390;&#27880;&#24847;&#12377;&#12409;&#12365;&#20107;&#38917;&#12399;&#65292;&#20445;&#38522;&#21306;&#20998;&#12392;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#23550;&#24540;&#38306;&#20418;&#12391;&#12354;&#12427;&#12290;
    &#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920;&#32207;&#21512;&#35299;&#35500;&#32232; &#12391;&#12399;&#65292;
    &#12300;&#21307;&#30274;&#65288;&#20837;&#38498;&#35386;&#30274;&#65289;&#65292;&#21307;&#30274;&#65288;&#20837;&#38498;&#22806;&#35386;&#30274;&#65289;&#65292;&#21307;&#30274;&#65288;&#27503;&#31185;&#35386;&#30274;&#65289;&#65292;&#21307;&#30274;&#65288;&#35519;&#21092;&#65289; &#65292;&#21307;&#30274;&#65288;&#12381;&#12398;&#20182;&#12398;&#21307;&#30274;&#12469;&#12540;&#12499;&#12473;&#65289;&#65292;&#21307;&#30274;&#65288;&#12381;&#12398;&#20182;&#12398;&#21307;&#30274;&#12469;&#12540;&#12499;&#12473;&#65289;&#65292;
    &#31038;&#20250;&#31119;&#31049;&#65288;&#38750;&#21942;&#21033;&#65289;&#65292;&#31038;&#20250;&#31119;&#31049;&#65288;&#29987;&#26989;&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
    &#12300;&#30149;&#38498;&#21450;&#12403;&#19968;&#33324;&#35386;&#30274;&#25152;&#20869;&#12391;&#12398;&#27503;&#31185;&#35386;&#30274;&#12399;&#12300;&#21307;&#30274;&#65288;&#27503;&#31185;&#35386;&#30274;&#65289;&#12301;&#12395;&#21547;&#12417;&#12427;&#12301;&#65292;&#12300;&#20171;&#35703;&#20445;&#38522;&#12395;&#12424;&#12427;&#12469;&#12540;&#12499;&#12473;&#12399;&#12300;&#20171;&#35703;&#65288;&#26045;&#35373;&#12469;&#12540;&#12499;&#12473;&#65289;&#12301;&#65292;
    &#12300;&#20171;&#35703;&#65288;&#26045;&#35373;&#12469;&#12540;&#12499;&#12473;&#12434;&#38500;&#12367;&#65289;&#12301;&#12395;&#21547;&#12417;&#12427;&#12301;&#12392;&#35352;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#27503;&#31185;&#12392;&#12381;&#12428;&#20197;&#22806;&#12399;&#12450;&#12463;&#12486;&#12451;&#12499;&#12486;&#12451;&#12391;&#65292;&#20171;&#35703;&#12392;&#21307;&#30274;&#12399;&#20445;&#38522;&#21046;&#24230;&#12391;&#21306;&#20998;&#12364;&#12373;&#12428;&#12390;&#12356;&#12427;&#12290;

    &#20197;&#19979;&#65292;&#22522;&#26412;&#30340;&#12395;&#12371;&#12398;&#21306;&#20998;&#12395;&#24467;&#12387;&#12390;&#20197;&#19979;&#12398;&#25163;&#27861;&#12391;&#25353;&#20998;&#12434;&#34892;&#12358;&#12290; 

    7&#21306;&#20998;&#12398;&#22770;&#19978;&#12434;&#12381;&#12428;&#12382;&#12428;&#12395;&#35442;&#24403;&#12377;&#12427;32&#21306;&#20998;&#12395;&#26696;&#20998;&#12377;&#12427;&#31532;&#19968;&#27573;&#38542;&#12392;&#12375;&#12390;&#65292;32&#21306;&#20998;&#12381;&#12428;&#12382;&#12428;&#12395;&#38306;&#12375;&#12390;&#12381;&#12398;&#22770;&#19978;&#12398;&#23550;&#35937;&#12392;&#12394;&#12426;&#12358;&#12427;7&#21306;&#20998;&#12398;&#23550;&#24540;&#38306;&#20418;&#12434;&#31574;&#23450;&#12375;&#65292;
    &#36984;&#25246;&#12373;&#12428;&#12383;32&#21306;&#20998;&#12395;,&#23550;&#24540;&#12398;&#12354;&#12427;7&#21306;&#20998;&#12398;&#21454;&#20837;&#12434;&#20840;&#38989;&#35336;&#19978;&#12371;&#12392;&#12392;&#12377;&#12427;&#12290;
    &#12394;&#12362;,&#23550;&#24540;&#38306;&#20418;&#12399;&#12300;&#34920; 1&#21307;&#30274;,&#31119;&#31049;&#20998;&#37326;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#21306;&#20998;&#12392;&#20107;&#26989;&#21306;&#20998;&#12398;&#23550;&#24540;&#12301;&#12395;&#24467;&#12358;&#12290;
    &#23550;&#24540;&#38306;&#20418;&#12398;&#12394;&#12356;&#12418;&#12398;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;7&#21306;&#20998;&#12363;&#12425;&#12394;&#12427;&#37096;&#38272;&#20998;&#39006;&#12434;&#19968;&#26178;&#30340;&#12395;&#20316;&#25104;&#12375;&#65292;&#12381;&#12371;&#12395;&#20840;&#38989;&#35336;&#19978;&#12377;&#12427;&#12290;
    &#12381;&#12398;&#24460;&#65292;&#21508;32&#21306;&#20998;&#12398;&#22770;&#19978;&#12398;&#27604;&#29575;&#12391;&#65292;&#19968;&#26178;&#30340;&#12395;&#35336;&#19978;&#12373;&#12428;&#12383;7&#21306;&#20998;&#12434;32&#21306;&#20998;&#12395;&#25353;&#20998;&#12377;&#12427;&#12290;
-}</span><span>
</span><a name="line-1573"></a><span>
</span><a name="line-1574"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1575"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%533B%7642%798F%7949"><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%533B%7642%798F%7949"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21307;&#30274;&#31119;&#31049;</span></a></a><span> </span><a name="local-6989586621679413107"><a href="#local-6989586621679413107"><span class="hs-identifier">scd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-1576"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1577"></a><span>    </span><a name="local-6989586621679413118"><a href="#local-6989586621679413118"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413107"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-1578"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413118"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1579"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413108"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413107"><span class="hs-identifier hs-var">scd</span></a><span>
</span><a name="line-1580"></a><span>        </span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413119"><a href="#local-6989586621679413119"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679413119"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span>  </span><a href="VDS.html#E%533B%7642%798F%7949"><span class="hs-identifier hs-var">E&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413108"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413107"><span class="hs-identifier hs-var">scd</span></a><span>
</span><a name="line-1581"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1582"></a><span>        </span><span class="hs-identifier">_</span><span>                                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1583"></a><span>
</span><a name="line-1584"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1585"></a><span>    </span><span class="hs-comment">-- &#21307;&#30274;&#31119;&#31049;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1586"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1587"></a><span>    </span><a name="local-6989586621679413108"><a href="#local-6989586621679413108"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679413109"><a href="#local-6989586621679413109"><span class="hs-identifier">scd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1588"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413110"><a href="#local-6989586621679413110"><span class="hs-identifier">man</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413109"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1589"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413111"><a href="#local-6989586621679413111"><span class="hs-identifier">tar</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413109"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1590"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413112"><a href="#local-6989586621679413112"><span class="hs-identifier">e1</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413109"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span>
</span><a name="line-1591"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413113"><a href="#local-6989586621679413113"><span class="hs-identifier">e2</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413109"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span>
</span><a name="line-1592"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-1593"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413114"><a href="#local-6989586621679413114"><span class="hs-identifier">newCars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#getValCarsFromV%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="#local-6989586621679413110"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679413112"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679413113"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1594"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413111"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413114"><span class="hs-identifier hs-var">newCars</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1595"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413109"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679413114"><span class="hs-identifier hs-var">newCars</span></a><span>
</span><a name="line-1596"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413115"><a href="#local-6989586621679413115"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413116"><a href="#local-6989586621679413116"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413109"><span class="hs-identifier hs-var">scd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413115"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679413116"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1597"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413117"><a href="#local-6989586621679413117"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1598"></a><span>
</span><a name="line-1599"></a><span>
</span><a name="line-1600"></a><span class="hs-comment">-- | &#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049; &#12392; &#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; &#12398;&#23550;&#24540;&#38306;&#20418;&#12395;&#22522;&#12389;&#12356;&#12390;Car&#12434;&#36820;&#12377;&#65294;</span><span>
</span><a name="line-1601"></a><span class="hs-comment">--</span><span>
</span><a name="line-1602"></a><span class="hs-comment">--   V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; == Null &#12398;&#22580;&#21512;&#12399;&#65292;&#26684;&#20184;&#12369;&#19981;&#33021; &quot;PZZZ&quot; &#12434;&#36820;&#12377;&#65294;</span><span>
</span><a name="line-1603"></a><span class="hs-identifier">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1604"></a><a name="getValCarsFromV%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><a href="V.html#getValCarsFromV%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a></a><span> </span><a name="local-6989586621679413120"><a href="#local-6989586621679413120"><span class="hs-identifier">man</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1605"></a><span class="hs-identifier">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><a name="local-6989586621679413121"><a href="#local-6989586621679413121"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679413122"><a href="#local-6989586621679413122"><span class="hs-identifier">e1</span></a></a><span>   </span><a name="local-6989586621679413123"><a href="#local-6989586621679413123"><span class="hs-identifier">e2</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1606"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679413121"><span class="hs-identifier hs-var">man</span></a><span> </span><span class="hs-comment">{- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#20966;&#29702; -}</span><span>
</span><a name="line-1607"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1608"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413124"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1609"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413125"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679413122"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1610"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1611"></a><span>    </span><a name="local-6989586621679413124"><a href="#local-6989586621679413124"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#getIncomeE%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-var">getIncomeE&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="#local-6989586621679413123"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679413122"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1612"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span>
</span><a name="line-1613"></a><span>    </span><a name="local-6989586621679413125"><a href="#local-6989586621679413125"><span class="hs-identifier">getName</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;PZZZ&quot;</span><span> </span><span class="hs-comment">-- &#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-1614"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><a name="local-6989586621679413126"><a href="#local-6989586621679413126"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><a href="#local-6989586621679413126"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="VClass.html#edE%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">edE&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1615"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413127"><a href="#local-6989586621679413127"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413127"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1616"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;can Not find in edE&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;&quot;</span><span>
</span><a name="line-1617"></a><span>
</span><a name="line-1618"></a><span>
</span><a name="line-1619"></a><span class="hs-comment">-- | E&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; &#12395;&#23550;&#24540;&#12377;&#12427; E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049; &#12398;&#12501;&#12451;&#12540;&#12523;&#12489;&#21517;&#65288;&#38306;&#25968;&#65289;&#12434;&#36820;&#12377;</span><span>
</span><a name="line-1620"></a><span class="hs-identifier">getIncomeE&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-1621"></a><a name="getIncomeE%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><a href="V.html#getIncomeE%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier">getIncomeE&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413129"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1622"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1623"></a><span>    </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="VDS.html#E%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-1624"></a><span>    </span><a name="local-6989586621679413128"><a href="#local-6989586621679413128"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679413130"><a href="#local-6989586621679413130"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413131"><a href="#local-6989586621679413131"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413131"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><a href="#local-6989586621679413130"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1625"></a><span>    </span><a name="local-6989586621679413129"><a href="#local-6989586621679413129"><span class="hs-identifier">f</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-identifier">_</span><span>                                                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1626"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413132"><a href="#local-6989586621679413132"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%4E00%822C%75C5%9662"><span class="hs-identifier hs-var">E&#19968;&#33324;&#30149;&#38498;</span></a><span>                          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413132"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1627"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413133"><a href="#local-6989586621679413133"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%7CBE%795E%79D1%75C5%9662"><span class="hs-identifier hs-var">E&#31934;&#31070;&#31185;&#30149;&#38498;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413133"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1628"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413134"><a href="#local-6989586621679413134"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%6709%5E8A%8A3A%7642%6240"><span class="hs-identifier hs-var">E&#26377;&#24202;&#35386;&#30274;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413134"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1629"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413135"><a href="#local-6989586621679413135"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%7121%5E8A%8A3A%7642%6240"><span class="hs-identifier hs-var">E&#28961;&#24202;&#35386;&#30274;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413135"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1630"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413136"><a href="#local-6989586621679413136"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%6B6F%79D1%8A3A%7642%6240"><span class="hs-identifier hs-var">E&#27503;&#31185;&#35386;&#30274;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413136"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1631"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413137"><a href="#local-6989586621679413137"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%52A9%7523%6240%52A9%7523%5E2B%696D"><span class="hs-identifier hs-var">E&#21161;&#29987;&#25152;&#21161;&#29987;&#24107;&#26989;</span></a><span>                    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413137"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1632"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413138"><a href="#local-6989586621679413138"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%770B%8B77%696D"><span class="hs-identifier hs-var">E&#30475;&#35703;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413138"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1633"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413139"><a href="#local-6989586621679413139"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%65BD%8853%696D"><span class="hs-identifier hs-var">E&#26045;&#34899;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413139"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1634"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413140"><a href="#local-6989586621679413140"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%7642%990A%6240"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#30274;&#39178;&#25152;</span></a><span>                    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413140"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1635"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413141"><a href="#local-6989586621679413141"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%6B6F%79D1%6280%5DE5%6240"><span class="hs-identifier hs-var">E&#27503;&#31185;&#25216;&#24037;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413141"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1636"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413142"><a href="#local-6989586621679413142"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%533B%7642%306B%9644%5E2F%3059%308B%30B5%30FC%30D3%30B9%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#21307;&#30274;&#12395;&#38468;&#24111;&#12377;&#12427;&#12469;&#12540;&#12499;&#12473;&#26989;</span></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413142"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1637"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413143"><a href="#local-6989586621679413143"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%7D50%6838%5065%5EB7%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#32080;&#26680;&#20581;&#24247;&#30456;&#35527;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413143"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1638"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413144"><a href="#local-6989586621679413144"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%7CBE%795E%4FDD%5065%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#31934;&#31070;&#20445;&#20581;&#30456;&#35527;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413144"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1639"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413145"><a href="#local-6989586621679413145"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%6BCD%5B50%5065%5EB7%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#27597;&#23376;&#20581;&#24247;&#30456;&#35527;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413145"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1640"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413146"><a href="#local-6989586621679413146"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%5065%5EB7%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#20581;&#24247;&#30456;&#35527;&#26045;&#35373;</span></a><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413146"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1641"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413147"><a href="#local-6989586621679413147"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%691C%67FB%696D"><span class="hs-identifier hs-var">E&#26908;&#26619;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413147"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1642"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413148"><a href="#local-6989586621679413148"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%6D88%6BD2%696D"><span class="hs-identifier hs-var">E&#28040;&#27602;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413148"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1643"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413149"><a href="#local-6989586621679413149"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%4FDD%5065%885B%751F"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#20445;&#20581;&#34907;&#29983;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413149"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1644"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413150"><a href="#local-6989586621679413150"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%793E%4F1A%4FDD%967A%4E8B%696D%56E3%4F53"><span class="hs-identifier hs-var">E&#31038;&#20250;&#20445;&#38522;&#20107;&#26989;&#22243;&#20307;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413150"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1645"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413151"><a href="#local-6989586621679413151"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%4FDD%80B2%6240"><span class="hs-identifier hs-var">E&#20445;&#32946;&#25152;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413151"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1646"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413152"><a href="#local-6989586621679413152"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%5150%7AE5%798F%7949%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#20816;&#31461;&#31119;&#31049;&#20107;&#26989;</span></a><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413152"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1647"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413153"><a href="#local-6989586621679413153"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%7279%5225%990A%8B77%8001%4EBA%30DB%30FC%30E0"><span class="hs-identifier hs-var">E&#29305;&#21029;&#39178;&#35703;&#32769;&#20154;&#12507;&#12540;&#12512;</span></a><span>                </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413153"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1648"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413154"><a href="#local-6989586621679413154"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%4ECB%8B77%8001%4EBA%4FDD%5065%65BD%8A2D"><span class="hs-identifier hs-var">E&#20171;&#35703;&#32769;&#20154;&#20445;&#20581;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413154"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1649"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413155"><a href="#local-6989586621679413155"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%901A%6240%77ED%671F%5165%6240%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#36890;&#25152;&#30701;&#26399;&#20837;&#25152;&#20171;&#35703;&#20107;&#26989;</span></a><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413155"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1650"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413156"><a href="#local-6989586621679413156"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%8A2A%554F%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#35370;&#21839;&#20171;&#35703;&#20107;&#26989;</span></a><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413156"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1651"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413157"><a href="#local-6989586621679413157"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%8A8D%77E5%75C7%8001%4EBA%30B0%30EB%30FC%30D7%30DB%30FC%30E0"><span class="hs-identifier hs-var">E&#35469;&#30693;&#30151;&#32769;&#20154;&#12464;&#12523;&#12540;&#12503;&#12507;&#12540;&#12512;</span></a><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413157"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1652"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413158"><a href="#local-6989586621679413158"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%8001%4EBA%798F%7949%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#32769;&#20154;&#31119;&#31049;&#20171;&#35703;&#20107;&#26989;</span></a><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413158"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1653"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413159"><a href="#local-6989586621679413159"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%5C45%4F4F%652F%63F4%4E8B%696D"><span class="hs-identifier hs-var">E&#23621;&#20303;&#25903;&#25588;&#20107;&#26989;</span></a><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413159"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">,</span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1654"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413160"><a href="#local-6989586621679413160"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%6709%6599%8001%4EBA%30DB%30FC%30E0"><span class="hs-identifier hs-var">E&#26377;&#26009;&#32769;&#20154;&#12507;&#12540;&#12512;</span></a><span>                    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413160"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1655"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413161"><a href="#local-6989586621679413161"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%66F4%751F%4FDD%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#26356;&#29983;&#20445;&#35703;&#20107;&#26989;</span></a><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413161"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1656"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413162"><a href="#local-6989586621679413162"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%793E%4F1A%4FDD%967A%793E%4F1A%798F%7949%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#31038;&#20250;&#20445;&#38522;&#31038;&#20250;&#31119;&#31049;&#20171;&#35703;&#20107;&#26989;</span></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413162"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1657"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413163"><a href="#local-6989586621679413163"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VDS.html#E%305D%306E%4ED6%306E%969C%788D%8005%798F%7949%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#38556;&#30861;&#32773;&#31119;&#31049;&#20107;&#26989;</span></a><span>            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413163"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1658"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413164"><a href="#local-6989586621679413164"><span class="hs-identifier">e2</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413128"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679413164"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span>
</span><a name="line-1659"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span>
</span><a name="line-1660"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span>
</span><a name="line-1661"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span>
</span><a name="line-1662"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#20445;&#38522;&#20107;&#26989;&#21454;&#20837;</span><span>
</span><a name="line-1663"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span>
</span><a name="line-1664"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1665"></a><span>
</span><a name="line-1666"></a><span>
</span><a name="line-1667"></a><span class="hs-comment">-- *** &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B</span><span>
</span><a name="line-1668"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1669"></a><span class="hs-comment">{- |
     &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#20027;&#26989;&#21450;&#12403;&#24467;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12398;&#25226;&#25569;&#12399;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;
     &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#65289;&#31561;&#12395;&#12362;&#12369;&#12427;&#31532;&#65298;&#38754;&#35519;&#26619;&#38917;&#30446;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#20107;&#26989;&#21454;&#20837;&#20869;&#35379;&#12301;&#65292;
     &#12300;&#26045;&#35373;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#65292;&#21450;&#12403;&#12300;&#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22770;&#19978;&#39640;&#21450;&#12403;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#12301;&#12434;&#20027;&#12395;&#29992;&#12356;&#12390;&#34892;&#12431;&#12428;&#12427;&#12290;

     &#20197;&#19979;&#65292;&#26412;&#35373;&#12395;&#38480;&#12426;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#20107;&#26989;&#21454;&#20837;&#20869;&#35379;&#12301;&#12434;&#38917;&#30446;&#65297;&#65292;
     &#12300;&#26045;&#35373;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#12434;&#38917;&#30446;&#65298;&#65292;&#12300;&#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22770;&#19978;&#39640;&#21450;&#12403;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#12301;&#12434;&#38917;&#30446;&#65299;&#12392;&#21628;&#31216;&#12377;&#12427;&#12290;

     &#38917;&#30446;&#65297;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#12300;&#39154;&#39135;&#26989;&#65292;&#23487;&#27850;&#12469;&#12540;&#12499;&#12473;&#26989;&#65292;&#29289;&#21697;&#36035;&#36024;&#26989;&#65292;&#12381;&#12398;&#20182;&#12398;&#29983;&#27963;&#38306;&#36899;&#12469;&#12540;&#12499;&#12473;&#65292;&#12473;&#12509;&#12540;&#12484;&#26045;&#35373;&#25552;&#20379;&#26989;&#12301;&#31561;&#12398;
     &#29987;&#26989;&#20013;&#20998;&#39006;&#31243;&#24230;&#12398;&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12392;&#65292;
     &#12381;&#12428;&#20197;&#22806;&#12398;&#12469;&#12540;&#12499;&#12473;&#26989;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#32048;&#20998;&#39006;&#31243;&#24230;&#12398;&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;
     &#38917;&#30446;&#65298;&#12391;&#12399;&#65292;&#29987;&#26989;&#32048;&#20998;&#39006;&#31243;&#24230;&#12398;&#21306;&#20998;&#20027;&#21147;&#20107;&#26989;&#12398;&#24418;&#24907;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#12290;&#29289;&#21697;&#36035;&#36024;&#26989;&#12434;&#38500;&#12367;&#65292;
     &#29987;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#38917;&#30446;1&#12395;&#12362;&#12369;&#12427;&#21306;&#20998;&#12364;&#65292;&#12300;&#26045;&#35373;&#12539;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#12398;&#21306;&#20998;&#31684;&#22258;&#12398;&#22580;&#21512;&#12399;&#12300;&#26045;&#35373;&#12539;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#12398;&#21306;&#20998;&#12434;&#25505;&#29992;&#12375;&#65292;
     &#12381;&#12428;&#20197;&#22806;&#12398;&#22580;&#21512;&#12399;&#65292;&#12381;&#12398;&#12414;&#12414;&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#65292;&#21103;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12373;&#12428;&#12427;&#12290;
     
     &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#24179;&#25104;24&#65292;28&#24180;&#12381;&#12428;&#12382;&#12428;&#12391;&#20966;&#29702;&#12364;&#30064;&#12394;&#12426;&#65292;&#24179;&#25104;24&#24180;&#12391;&#12399;&#65292;
     &#38917;&#30446;&#65297;&#12398;&#22238;&#31572;&#20869;&#23481;&#12395;&#12362;&#12356;&#12390;&#29987;&#26989;&#21306;&#20998;&#12364;&#12300;&#29987;&#26989;&#27231;&#26800;&#65292;&#20107;&#21209;&#29992;&#27231;&#26800;&#65292;&#33258;&#21205;&#36554;&#65292;&#12473;&#12509;&#12540;&#12484;&#12539;&#23087;&#27005;&#29992;&#21697;&#65292;
     &#12381;&#12398;&#20182;&#65288;&#26144;&#30011;&#12539;&#28436;&#21127;&#29992;&#21697;&#65292;&#38899;&#27005;&#12539;&#26144;&#20687;&#35352;&#37682;&#29289;&#65292;&#36024;&#34915;&#12375;&#12423;&#12358;&#31561;&#65289;&#12301;&#12398;&#20869;&#65299;&#21306;&#20998;&#20197;&#19978;&#12434;&#21547;&#12435;&#12391;&#12362;&#12426;&#65292;
     &#19988;&#12388;&#65292;&#24403;&#35442;&#37096;&#38272;&#12398;&#38917;&#30446;&#65299;&#12395;&#12362;&#12369;&#12427;&#12300;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22770;&#19978;&#39640;&#21106;&#21512;&#12301;&#12398;&#21512;&#35336;&#12434;&#12300;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#21106;&#21512;&#12301;&#12364;&#19978;&#22238;&#12387;&#12383;&#22580;&#21512;&#65292;
     &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#37096;&#38272;&#12398;&#22770;&#12426;&#19978;&#12370;&#12434;&#20840;&#12390;&#12300;&#32207;&#21512;&#12522;&#12540;&#12473;&#26989;&#12301;&#12398;&#22770;&#19978;&#65292;
     &#19979;&#22238;&#12387;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#22770;&#19978;&#12392;&#12377;&#12427;&#12290;

     &#19978;&#35352;&#12398;&#26465;&#20214;&#12434;&#28288;&#12383;&#12373;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#38917;&#30446;&#12434;&#29420;&#31435;&#12375;&#12390;&#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#12290;
     &#38917;&#30446;&#65297;&#12364;&#26410;&#35352;&#20837;&#19988;&#12388;&#65292;&#38917;&#30446;&#65299;&#12364;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#22580;&#21512;&#12399;&#65292;&#24460;&#32773;&#12398;&#21106;&#21512;&#12363;&#12425;&#37329;&#38989;&#12434;&#31639;&#23450;&#12375;&#65292;&#21516;&#27096;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;&#12290;
     &#24179;&#25104;28&#24180;&#12391;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12398;&#26465;&#20214;&#12395;&#21152;&#12360;&#12390;&#65292;&#38917;&#30446;&#65298;&#12398;&#24773;&#22577;&#12395;&#12362;&#12356;&#12390;
     &#12300;&#32207;&#21512;&#12522;&#12540;&#12473;&#26989;&#65292;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#65292;&#12381;&#12398;&#20182;&#12398;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#21029;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;
     &#12381;&#12398;&#22238;&#31572;&#12364;&#12300;&#32207;&#21512;&#12522;&#12540;&#12473;&#26989;&#65292;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#22580;&#21512;&#12399;&#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#38917;&#30446;&#65297;&#12398;&#22770;&#19978;&#39640;&#12434;&#65292;
     &#20840;&#38989;&#12381;&#12428;&#12425;&#12395;&#20998;&#37197;&#12375;&#65292;&#12300;&#12381;&#12398;&#20182;&#12398;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#22580;&#21512;&#12399;&#65292;&#12381;&#12398;&#12414;&#12414;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#12290;

     &#20027;&#21147;&#20107;&#26989;&#12364;&#20182;&#12398;&#29987;&#26989;&#12391;&#12354;&#12426;&#65292;&#38917;&#30446;&#65298;&#12364;&#29289;&#21697;&#36035;&#36024;&#26989;&#12391;&#12394;&#12356;&#22580;&#21512;&#65292;24&#24180;&#12392;&#21516;&#31561;&#12398;&#26465;&#20214;&#12391;
     &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#38917;&#30446;&#65297;&#12434;&#20966;&#29702;&#12375;&#65292;&#21103;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#12290;

-}</span><span>
</span><a name="line-1702"></a><span>
</span><a name="line-1703"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12469;B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1704"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%30B5B"><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%30B5B"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12469;B</span></a></a><span> </span><a name="local-6989586621679413165"><a href="#local-6989586621679413165"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413166"><a href="#local-6989586621679413166"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1705"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1706"></a><span>    </span><a name="local-6989586621679413182"><a href="#local-6989586621679413182"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413166"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-1707"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413182"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1708"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413167"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413165"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413166"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-1709"></a><span>        </span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413183"><a href="#local-6989586621679413183"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679413183"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%30B5%30FC%30D3%30B9B"><span class="hs-identifier hs-var">E&#12469;&#12540;&#12499;&#12473;B</span></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413167"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413165"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413166"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-1710"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1711"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1712"></a><span>
</span><a name="line-1713"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1714"></a><span>    </span><span class="hs-comment">-- &#12469;B&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1715"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1716"></a><span>    </span><a name="local-6989586621679413167"><a href="#local-6989586621679413167"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679413168"><a href="#local-6989586621679413168"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413169"><a href="#local-6989586621679413169"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1717"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413170"><a href="#local-6989586621679413170"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1718"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413171"><a href="#local-6989586621679413171"><span class="hs-identifier">tar</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1719"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413172"><a href="#local-6989586621679413172"><span class="hs-identifier">shopType</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5E97%8217%5F62%614B_%30B5B"><span class="hs-identifier hs-var">H&#24215;&#33303;&#24418;&#24907;_&#12469;B</span></a><span>
</span><a name="line-1720"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413173"><a href="#local-6989586621679413173"><span class="hs-identifier">sal</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%53CE%5165_%30B5B"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21454;&#20837;_&#12469;B</span></a><span>
</span><a name="line-1721"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413174"><a href="#local-6989586621679413174"><span class="hs-identifier">rTotal</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1722"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413175"><a href="#local-6989586621679413175"><span class="hs-identifier">lTotal</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-var">H&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1723"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413176"><a href="#local-6989586621679413176"><span class="hs-identifier">rSev</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5546%54C1%5225%30EC%30F3%30BF%30EB%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1724"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413177"><a href="#local-6989586621679413177"><span class="hs-identifier">lSev</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5546%54C1%5225%30EA%30FC%30B9%5951%7D04%9AD8"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1725"></a><span>
</span><a name="line-1726"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-1727"></a><span>        </span><span class="hs-comment">-- &#12371;&#12371;&#12391;,&#20197;&#21069;&#12395;&#20966;&#29702;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12398;&#23550;&#20966;&#12434;&#20998;&#23696;</span><span>
</span><a name="line-1728"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413178"><a href="#local-6989586621679413178"><span class="hs-identifier">newCars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#getValCarsFromV%30B5B"><span class="hs-identifier hs-var">getValCarsFromV&#12469;B</span></a><span> </span><a href="#local-6989586621679413168"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413170"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679413173"><span class="hs-identifier hs-var">sal</span></a><span> </span><a href="#local-6989586621679413172"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679413174"><span class="hs-identifier hs-var">rTotal</span></a><span> </span><a href="#local-6989586621679413175"><span class="hs-identifier hs-var">lTotal</span></a><span> </span><a href="#local-6989586621679413176"><span class="hs-identifier hs-var">rSev</span></a><span> </span><a href="#local-6989586621679413177"><span class="hs-identifier hs-var">lSev</span></a><span>
</span><a name="line-1729"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413171"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413178"><span class="hs-identifier hs-var">newCars</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1730"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679413178"><span class="hs-identifier hs-var">newCars</span></a><span>
</span><a name="line-1731"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413179"><a href="#local-6989586621679413179"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413180"><a href="#local-6989586621679413180"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413169"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413179"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679413180"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1732"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413181"><a href="#local-6989586621679413181"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1733"></a><span>
</span><a name="line-1734"></a><span>
</span><a name="line-1735"></a><span class="hs-identifier">getValCarsFromV&#12469;B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%30B5B"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#12469;B</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%30B5B"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#12469;B</span></a><span>
</span><a name="line-1736"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%30EC%30F3%30BF%30EB%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1737"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%30EA%30FC%30B9%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640;</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1738"></a><a name="getValCarsFromV%30B5B"><a href="V.html#getValCarsFromV%30B5B"><span class="hs-identifier">getValCarsFromV&#12469;B</span></a></a><span> </span><a name="local-6989586621679413184"><a href="#local-6989586621679413184"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413185"><a href="#local-6989586621679413185"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679413186"><a href="#local-6989586621679413186"><span class="hs-identifier">sal</span></a></a><span> </span><a name="local-6989586621679413187"><a href="#local-6989586621679413187"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679413188"><a href="#local-6989586621679413188"><span class="hs-identifier">rTotal</span></a></a><span> </span><a name="local-6989586621679413189"><a href="#local-6989586621679413189"><span class="hs-identifier">lTotal</span></a></a><span> </span><a name="local-6989586621679413190"><a href="#local-6989586621679413190"><span class="hs-identifier">rSev</span></a></a><span> </span><a name="local-6989586621679413191"><a href="#local-6989586621679413191"><span class="hs-identifier">lSev</span></a></a><span>
</span><a name="line-1739"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="V.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679413185"><span class="hs-identifier hs-var">man</span></a><span>
</span><a name="line-1740"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413196"><span class="hs-identifier hs-var">convertOthers</span></a><span> </span><a href="#local-6989586621679413184"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413186"><span class="hs-identifier hs-var">sal</span></a><span> </span><a href="#local-6989586621679413187"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679413192"><span class="hs-identifier hs-var">rentalAndLease</span></a><span>
</span><a name="line-1741"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1742"></a><span>    </span><span class="hs-comment">-- &#29289;&#21697;&#36035;&#36024;&#26989;&#37096;&#20998;</span><span>
</span><a name="line-1743"></a><span>    </span><span class="hs-identifier">rentalAndLease</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-1744"></a><span>    </span><a name="local-6989586621679413192"><a href="#local-6989586621679413192"><span class="hs-identifier">rentalAndLease</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413194"><span class="hs-identifier hs-var">convertToMulti</span></a><span> </span><a href="#local-6989586621679413188"><span class="hs-identifier hs-var">rTotal</span></a><span> </span><a href="#local-6989586621679413189"><span class="hs-identifier hs-var">lTotal</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413193"><span class="hs-identifier hs-var">rateToManey</span></a><span> </span><a href="#local-6989586621679413188"><span class="hs-identifier hs-var">rTotal</span></a><span> </span><a href="#local-6989586621679413190"><span class="hs-identifier hs-var">rSev</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413193"><span class="hs-identifier hs-var">rateToManey</span></a><span> </span><a href="#local-6989586621679413189"><span class="hs-identifier hs-var">lTotal</span></a><span> </span><a href="#local-6989586621679413191"><span class="hs-identifier hs-var">lSev</span></a><span class="hs-special">)</span><span>
</span><a name="line-1745"></a><span>
</span><a name="line-1746"></a><span>
</span><a name="line-1747"></a><span>    </span><span class="hs-comment">-- &#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22865;&#32004;&#39640;&#21450;&#12403;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#12395;&#22522;&#12389;&#12356;&#12390;Cars&#12434;&#20316;&#12427;</span><span>
</span><a name="line-1748"></a><span>    </span><span class="hs-comment">-- &#12354;&#12392;&#12391;&#20107;&#26989;&#21454;&#20837;_&#12469;B&#12398;&#12392;&#12371;&#12429;&#12392;&#12510;&#12540;&#12472;(&#12371;&#12387;&#12385;&#12395;&#24773;&#22577;&#12364;&#12354;&#12428;&#12400;,&#20107;&#26989;&#21454;&#20837;&#12398;&#29289;&#21697;&#36035;&#36024;&#26989;&#37096;&#20998;&#12399;&#30772;&#26820;)</span><span>
</span><a name="line-1749"></a><span>
</span><a name="line-1750"></a><span>    </span><span class="hs-comment">-- &#21106;&#21512;&#12398;&#37329;&#38989;&#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-1751"></a><span>    </span><span class="hs-identifier">rateToManey</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#ValDouble"><span class="hs-identifier hs-type">ValDouble</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1752"></a><span>    </span><a name="local-6989586621679413193"><a href="#local-6989586621679413193"><span class="hs-identifier">rateToManey</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1753"></a><span>    </span><span class="hs-identifier">rateToManey</span><span> </span><span class="hs-identifier">_</span><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1754"></a><span>    </span><span class="hs-identifier">rateToManey</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413198"><a href="#local-6989586621679413198"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413199"><a href="#local-6989586621679413199"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413200"><a href="#local-6989586621679413200"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413200"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413198"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413200"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413199"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1755"></a><span>
</span><a name="line-1756"></a><span>
</span><a name="line-1757"></a><span>    </span><span class="hs-comment">-- &#32207;&#21512;&#12522;&#12540;&#12473;&#26989;(7011), &#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;(7019)&#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-1758"></a><span>    </span><span class="hs-comment">-- &#19977;&#31278;&#20197;&#19978;&#21547;&#12414;&#12428;&#12390;&#12356;&#12428;&#12400;,&#32207;&#21512;&#12414;&#12383;&#12399;&#21508;&#31278;</span><span>
</span><a name="line-1759"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1760"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%30EC%30F3%30BF%30EB%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5546%54C1%5225%30EA%30FC%30B9%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1761"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-1762"></a><span>
</span><a name="line-1763"></a><span>    </span><a name="local-6989586621679413194"><a href="#local-6989586621679413194"><span class="hs-identifier">convertToMulti</span></a></a><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>             </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1764"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>             </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413201"><a href="#local-6989586621679413201"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">isMulti</span></a><span> </span><a href="#local-6989586621679413201"><span class="hs-identifier hs-var">ls</span></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1765"></a><span>                                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413201"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1766"></a><span>                                                                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679413201"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1767"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>             </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413202"><a href="#local-6989586621679413202"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">isMulti</span></a><span> </span><a href="#local-6989586621679413202"><span class="hs-identifier hs-var">rs</span></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1768"></a><span>                                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413202"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1769"></a><span>                                                                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679413202"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1770"></a><span>
</span><a name="line-1771"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413203"><a href="#local-6989586621679413203"><span class="hs-identifier">rd</span></a></a><span class="hs-special">)</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413204"><a href="#local-6989586621679413204"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413205"><a href="#local-6989586621679413205"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">isMulti</span></a><span> </span><a href="#local-6989586621679413204"><span class="hs-identifier hs-var">rs</span></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1772"></a><span>                                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413204"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1773"></a><span>                                                                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413204"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1774"></a><span>
</span><a name="line-1775"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413206"><a href="#local-6989586621679413206"><span class="hs-identifier">ld</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413207"><a href="#local-6989586621679413207"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413208"><a href="#local-6989586621679413208"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">isMulti</span></a><span> </span><a href="#local-6989586621679413208"><span class="hs-identifier hs-var">ls</span></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1776"></a><span>                                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413208"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1777"></a><span>                                                                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679413208"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1778"></a><span>
</span><a name="line-1779"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413209"><a href="#local-6989586621679413209"><span class="hs-identifier">rd</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413210"><a href="#local-6989586621679413210"><span class="hs-identifier">ld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413211"><a href="#local-6989586621679413211"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413212"><a href="#local-6989586621679413212"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1780"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">isMulti</span></a><span> </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">isMulti</span></a><span> </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1781"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1782"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413209"><span class="hs-identifier hs-var">rd</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679413210"><span class="hs-identifier hs-var">ld</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1783"></a><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1784"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413209"><span class="hs-identifier hs-var">rd</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679413210"><span class="hs-identifier hs-var">ld</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1785"></a><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1786"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413209"><span class="hs-identifier hs-var">rd</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679413210"><span class="hs-identifier hs-var">ld</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1787"></a><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-1788"></a><span>
</span><a name="line-1789"></a><span>    </span><span class="hs-comment">-- &#19977;&#31278;&#20197;&#19978;&#20837;&#12387;&#12390;&#12356;&#12427;&#12392;True</span><span>
</span><a name="line-1790"></a><span>    </span><span class="hs-comment">-- VIO &#12398;&#26178;&#28857;&#12391;,&#12381;&#12428;&#12382;&#12428;&#12414;&#12392;&#12417;&#12425;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;&#38263;&#12373;&#12384;&#12369;&#12391;&#12356;&#12356;.</span><span>
</span><a name="line-1791"></a><span>    </span><span class="hs-identifier">isMulti</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1792"></a><span>    </span><a name="local-6989586621679413195"><a href="#local-6989586621679413195"><span class="hs-identifier">isMulti</span></a></a><span> </span><a name="local-6989586621679413213"><a href="#local-6989586621679413213"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-6989586621679413213"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1793"></a><span>               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1794"></a><span>
</span><a name="line-1795"></a><span>
</span><a name="line-1796"></a><span>    </span><span class="hs-comment">-- &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#38306;&#12375;&#12390;,&#37329;&#38989;&#22793;&#25563;&#12375;&#12383;&#12418;&#12398;&#12364;Null&#12394;&#12425;,&#20107;&#26989;&#21454;&#20837;&#12434;&#29992;&#12356;&#12427;,&#12371;&#12398;&#22580;&#21512;,&#32207;&#21512;&#12522;&#12540;&#12473;&#12420;&#21508;&#31278;&#12408;&#12398;&#23550;&#24540;&#12399;&#30465;&#30053;</span><span>
</span><a name="line-1797"></a><span>    </span><span class="hs-comment">-- &#19978;&#12364;Not Null &#12394;&#12425;,</span><span>
</span><a name="line-1798"></a><span>    </span><span class="hs-comment">-- &#19978;&#12398;&#20516;&#12434;&#29992;&#12356;&#12427;.</span><span>
</span><a name="line-1799"></a><span>    </span><span class="hs-comment">-- &#24215;&#33303;&#24418;&#24907;&#31684;&#22258;&#22806;&#12394;&#12425;&#12381;&#12398;&#12414;&#12414;&#22793;&#25563;, &#31684;&#22258;&#20869;&#12394;&#12425;&#24418;&#24907;&#30058;&#21495;&#12434;&#21442;&#29031;&#12375;&#12390;&#12510;&#12483;&#12481;&#12531;&#12464;&#12377;&#12428;&#12400;&#22793;&#25563;</span><span>
</span><a name="line-1800"></a><span>    </span><span class="hs-comment">-- &#24215;&#33303;&#24418;&#24907;&#12392;&#12510;&#12483;&#12481;&#12531;&#12464;&#12375;&#12394;&#12356;,&#24215;&#33303;&#24418;&#24907;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;,&#31684;&#22258;&#20869;&#26684;&#20184;&#12369;&#19981;&#26126;</span><span>
</span><a name="line-1801"></a><span>
</span><a name="line-1802"></a><span>    </span><span class="hs-identifier">convertOthers</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%30B5B"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5E97%8217%5F62%614B_%30B5B"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-1803"></a><span>    </span><a name="local-6989586621679413196"><a href="#local-6989586621679413196"><span class="hs-identifier">convertOthers</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-identifier">_</span><span>     </span><a name="local-6989586621679413214"><a href="#local-6989586621679413214"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413214"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1804"></a><span>
</span><a name="line-1805"></a><span>    </span><span class="hs-identifier">convertOthers</span><span> </span><span class="hs-number">24</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413215"><a href="#local-6989586621679413215"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a name="local-6989586621679413216"><a href="#local-6989586621679413216"><span class="hs-identifier">cs</span></a></a><span>
</span><a name="line-1806"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679413216"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413217"><a href="#local-6989586621679413217"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#lookupCarNameErr"><span class="hs-identifier hs-var">lookupCarNameErr</span></a><span> </span><a href="#local-6989586621679413217"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-1807"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413215"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1808"></a><span>
</span><a name="line-1809"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413216"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1810"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413218"><a href="#local-6989586621679413218"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#lookupCarNameErr"><span class="hs-identifier hs-var">lookupCarNameErr</span></a><span> </span><a href="#local-6989586621679413218"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-1811"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413215"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1812"></a><span>
</span><a name="line-1813"></a><span>    </span><span class="hs-identifier">convertOthers</span><span> </span><span class="hs-number">28</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413219"><a href="#local-6989586621679413219"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a name="local-6989586621679413220"><a href="#local-6989586621679413220"><span class="hs-identifier">cs</span></a></a><span>
</span><a name="line-1814"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679413220"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413221"><a href="#local-6989586621679413221"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#lookupCarNameErr"><span class="hs-identifier hs-var">lookupCarNameErr</span></a><span> </span><a href="#local-6989586621679413221"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span>
</span><a name="line-1815"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413219"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1816"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413220"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1817"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413222"><a href="#local-6989586621679413222"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#lookupCarNameErr"><span class="hs-identifier hs-var">lookupCarNameErr</span></a><span> </span><a href="#local-6989586621679413222"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span>
</span><a name="line-1818"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413219"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1819"></a><span>
</span><a name="line-1820"></a><span>    </span><span class="hs-identifier">convertOthers</span><span> </span><span class="hs-number">24</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413223"><a href="#local-6989586621679413223"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413224"><a href="#local-6989586621679413224"><span class="hs-identifier">tx</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679413225"><a href="#local-6989586621679413225"><span class="hs-identifier">cs</span></a></a><span>
</span><a name="line-1821"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679413225"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413226"><a href="#local-6989586621679413226"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413197"><span class="hs-identifier hs-var">lookupCarTupleErr</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679413226"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679413224"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-1822"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413223"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1823"></a><span>
</span><a name="line-1824"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413225"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1825"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413227"><a href="#local-6989586621679413227"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413197"><span class="hs-identifier hs-var">lookupCarTupleErr</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679413227"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679413224"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-1826"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413223"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1827"></a><span>
</span><a name="line-1828"></a><span>    </span><span class="hs-identifier">convertOthers</span><span> </span><span class="hs-number">28</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413228"><a href="#local-6989586621679413228"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413229"><a href="#local-6989586621679413229"><span class="hs-identifier">tx</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679413230"><a href="#local-6989586621679413230"><span class="hs-identifier">cs</span></a></a><span>
</span><a name="line-1829"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679413230"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413231"><a href="#local-6989586621679413231"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413197"><span class="hs-identifier hs-var">lookupCarTupleErr</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679413231"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679413229"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span>
</span><a name="line-1830"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413228"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1831"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413230"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1832"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413232"><a href="#local-6989586621679413232"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413197"><span class="hs-identifier hs-var">lookupCarTupleErr</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679413232"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679413229"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VClass.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span>
</span><a name="line-1833"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VClass.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413228"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-1834"></a><span>
</span><a name="line-1835"></a><span>
</span><a name="line-1836"></a><span>
</span><a name="line-1837"></a><span>
</span><a name="line-1838"></a><span>
</span><a name="line-1839"></a><span>    </span><span class="hs-identifier">lookupCarTupleErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-1840"></a><span>    </span><a name="local-6989586621679413197"><a href="#local-6989586621679413197"><span class="hs-identifier">lookupCarTupleErr</span></a></a><span> </span><a name="local-6989586621679413233"><a href="#local-6989586621679413233"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413234"><a href="#local-6989586621679413234"><span class="hs-identifier">ca</span></a></a><span> </span><a name="local-6989586621679413235"><a href="#local-6989586621679413235"><span class="hs-identifier">tx</span></a></a><span> </span><a name="local-6989586621679413236"><a href="#local-6989586621679413236"><span class="hs-identifier">mp1</span></a></a><span> </span><a name="local-6989586621679413237"><a href="#local-6989586621679413237"><span class="hs-identifier">mp2</span></a></a><span>
</span><a name="line-1841"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="VClass.html#is%5E97%8217%7BC4%56F2"><span class="hs-identifier hs-var">is&#24215;&#33303;&#31684;&#22258;</span></a><span> </span><a href="#local-6989586621679413233"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413235"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679413235"><span class="hs-identifier hs-var">tx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413236"><span class="hs-identifier hs-var">mp1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1842"></a><span>                                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413238"><a href="#local-6989586621679413238"><span class="hs-identifier">newName</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413238"><span class="hs-identifier hs-var">newName</span></a><span>
</span><a name="line-1843"></a><span>                                        </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413237"><span class="hs-identifier hs-var">mp2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1844"></a><span>                                                          </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413239"><a href="#local-6989586621679413239"><span class="hs-identifier">newName2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413239"><span class="hs-identifier hs-var">newName2</span></a><span>
</span><a name="line-1845"></a><span>                                                          </span><span class="hs-identifier hs-var">Nothing</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;R2ZZ&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1846"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413237"><span class="hs-identifier hs-var">mp2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1847"></a><span>                                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413240"><a href="#local-6989586621679413240"><span class="hs-identifier">newName</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413240"><span class="hs-identifier hs-var">newName</span></a><span>
</span><a name="line-1848"></a><span>                                        </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;R2ZZ&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1849"></a><span>
</span><a name="line-1850"></a><span>
</span><a name="line-1851"></a><span class="hs-comment">-- *** &#21332;&#21516;&#32068;&#21512;</span><span>
</span><a name="line-1852"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1853"></a><span class="hs-comment">{- | 
     &#21332;&#21516;&#32068;&#21512;&#12399;&#65292;&#24179;&#25104;24&#65292;28&#24180;&#20849;&#12395;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#21450;&#12403;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21332;&#21516;&#32068;&#21512;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
     &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;
     &#12300;&#36786;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#34892;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#27700;&#29987;&#21152;&#24037;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#26862;&#26519;&#32068;&#21512;&#65292;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#12381;&#12398;&#20182;&#12398;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#65288;1~5&#12398;&#21332;&#21516;&#32068;&#21512;&#20197;&#22806;&#65289;&#12301;
     &#12398;&#12358;&#12385;&#19968;&#12388;&#12434;&#22238;&#31572;&#12377;&#12427;&#24418;&#24335;&#12398;&#35519;&#26619;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;
     
     &#12414;&#12383;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#12381;&#12428;&#12395;&#36861;&#21152;&#12375;&#12390;&#65292;&#12300;&#20449;&#29992;&#20107;&#26989;&#21448;&#12399;&#20849;&#28168;&#20107;&#26989;&#12398;&#23455;&#26045;&#12398;&#26377;&#28961;&#12301;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#29987;&#26989;&#36899;&#38306;&#34920;&#12391;&#12399;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#21454;&#30410;&#12398;&#37197;&#20998;&#20808;&#12399;&#65292;
     &#12300;&#36786;&#26519;&#27700;&#29987;&#37329;&#34701;&#26989;&#65292;&#21368;&#22770;&#65292;&#23567;&#22770;&#65292;&#20489;&#24235;&#65292;&#23550;&#20225;&#26989;&#27665;&#38291;&#38750;&#21942;&#21033;&#22243;&#20307;&#12301;&#12398;&#65301;&#29987;&#26989;&#12391;&#12354;&#12426;&#65292;
     &#21332;&#21516;&#32068;&#21512;&#12381;&#12428;&#33258;&#20307;&#12398;&#29987;&#26989;&#21306;&#20998;&#12399;&#23384;&#22312;&#12375;&#12394;&#12356;&#65294;
     &#12381;&#12428;&#12395;&#28310;&#12376;&#12390;&#65292;&#32068;&#26367;&#38598;&#35336;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#21454;&#30410;&#12434;&#12371;&#12428;&#12425;&#12398;&#29987;&#26989;&#12395;&#21306;&#20998;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#65294;

     &#12300;&#35519;&#26619;&#31080;&#12398;&#35352;&#20837;&#12398;&#20181;&#26041;&#12301;&#12395;&#24467;&#12360;&#12400;&#65292;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12395;&#12362;&#12356;&#12390;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#36070;&#35506;&#37329;&#12399;&#65292;&#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#12398;&#27963;&#21205;&#21454;&#20837;&#12301;&#12395;&#21547;&#12414;&#12428;&#12427;&#12383;&#12417;&#65292;
     &#20998;&#39006;&#12373;&#12428;&#12383;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12395;&#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#12398;&#27963;&#21205;&#21454;&#20837;&#12301;&#12398;&#21454;&#20837;&#37329;&#38989;&#12434;&#20840;&#38989;&#35336;&#19978;&#12377;&#12427;&#65294;
     
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#65292;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#36786;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#28417;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#27700;&#29987;&#21152;&#24037;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#26862;&#26519;&#32068;&#21512;&#12301;&#12398;&#20309;&#12428;&#12363;&#12364;&#36984;&#25246;&#12373;&#12428;&#65292;
    
     &#12414;&#12383;&#65292;&#12300;&#20449;&#29992;&#20107;&#26989;&#21448;&#12399;&#20849;&#28168;&#20107;&#26989;&#12398;&#23455;&#26045;&#12398;&#26377;&#28961;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#34892;&#12387;&#12390;&#12356;&#12427;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#65292;
     &#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12434;&#20840;&#38989;&#12300;&#36786;&#26519;&#27700;&#29987;&#37329;&#34701;&#26989;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;
    
    &#12300;&#34892;&#12387;&#12390;&#12356;&#12394;&#12356;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#22580;&#21512;&#12399;&#65292;&#12300;&#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;
    
     &#12414;&#12383;&#65292;&#12300;&#21368;&#22770;&#12398;&#21830;&#21697;&#36009;&#22770;&#38989;&#65288;&#20195;&#29702;&#12539;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#21547;&#12416;&#65289;&#12301;&#12434;&#20840;&#12390;&#21368;&#22770;&#26989;&#65292;&#12300;&#23567;&#22770;&#12426;&#12398;&#21830;&#21697;&#36009;&#22770;&#38989;&#12301;&#12434;&#20840;&#12390;&#23567;&#22770;&#26989;&#12395;&#35352;&#37682;&#12375;&#65292;
     &#12300;&#36939;&#36664;&#12539;&#37109;&#20415;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12434;&#20840;&#12390;&#12300;&#20489;&#24235;&#26989;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;
    
     &#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#12381;&#12398;&#20182;&#12398;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12383;&#22580;&#21512;&#12399;&#65292;
     &#12300;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#21448;&#12399;&#65292;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12398;&#21512;&#35336;&#38989;&#12434;&#12300;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12418;&#12398;&#65289;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;
    
     &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#65292;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12398;&#22238;&#31572;&#12364;&#31561;&#12375;&#12356;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12364;&#31561;&#12375;&#12356;&#20107;&#26989;&#25152;&#12398;&#26696;&#20998;&#27604;&#29575;&#12434;&#29992;&#12356;&#12390;&#65292;
     &#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12398;&#20516;&#12434;&#25353;&#20998;&#12377;&#12427;&#65294;
    
     &#21452;&#26041;&#12395;&#12362;&#12356;&#12390;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12398;&#22238;&#31572;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;
     &#12300;&#21332;&#21516;&#32068;&#21512;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12418;&#12398;&#65289; &#20869;&#26684;&#20184;&#19981;&#33021;&#12301;&#12395;&#20840;&#38989;&#12434;&#35352;&#37682;&#12375;&#65292;&#20182;&#12398;&#20107;&#26989;&#25152;&#12398;&#20027;&#26989;&#21103;&#26989;&#21103;&#29987;&#29289;&#20027;&#29983;&#29987;&#29289;&#12398;&#27604;&#29575;&#12434;&#29992;&#12356;&#12390;&#65292;&#22770;&#19978;&#39640;&#12434;&#25353;&#20998;&#12377;&#12427;&#65294;
    
-}</span><span>
</span><a name="line-1889"></a><span>
</span><a name="line-1890"></a><span>
</span><a name="line-1891"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21332;&#21516;&#32068;&#21512;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1892"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5354%540C%7D44%5408"><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5354%540C%7D44%5408"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21332;&#21516;&#32068;&#21512;</span></a></a><span> </span><a name="local-6989586621679413241"><a href="#local-6989586621679413241"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1893"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1894"></a><span>    </span><a name="local-6989586621679413253"><a href="#local-6989586621679413253"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413241"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-1895"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413253"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1896"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413242"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413241"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-1897"></a><span>        </span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413254"><a href="#local-6989586621679413254"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679413254"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5354%540C%7D44%5408"><span class="hs-identifier hs-var">E&#21332;&#21516;&#32068;&#21512;</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413242"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413241"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-1898"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1899"></a><span>        </span><span class="hs-identifier">_</span><span>                                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1900"></a><span>
</span><a name="line-1901"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1902"></a><span>    </span><span class="hs-comment">-- &#21307;&#30274;&#31119;&#31049;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1903"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1904"></a><span>    </span><a name="local-6989586621679413242"><a href="#local-6989586621679413242"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679413243"><a href="#local-6989586621679413243"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1905"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413244"><a href="#local-6989586621679413244"><span class="hs-identifier">man</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1906"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413245"><a href="#local-6989586621679413245"><span class="hs-identifier">tar</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1907"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413246"><a href="#local-6989586621679413246"><span class="hs-identifier">kind</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-1908"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413247"><a href="#local-6989586621679413247"><span class="hs-identifier">bl</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4FE1%7528%5171%6E08%4E8B%696D%306E%6709%7121"><span class="hs-identifier hs-var">H&#20449;&#29992;&#20849;&#28168;&#20107;&#26989;&#12398;&#26377;&#28961;</span></a><span>
</span><a name="line-1909"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413248"><a href="#local-6989586621679413248"><span class="hs-identifier">sales</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1910"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-1911"></a><span>
</span><a name="line-1912"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413249"><a href="#local-6989586621679413249"><span class="hs-identifier">newCars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#getValCarsFromV%5354%540C%7D44%5408"><span class="hs-identifier hs-var">getValCarsFromV&#21332;&#21516;&#32068;&#21512;</span></a><span> </span><a href="#local-6989586621679413244"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679413246"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679413247"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621679413248"><span class="hs-identifier hs-var">sales</span></a><span>
</span><a name="line-1913"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413245"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413249"><span class="hs-identifier hs-var">newCars</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1914"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679413249"><span class="hs-identifier hs-var">newCars</span></a><span>
</span><a name="line-1915"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413250"><a href="#local-6989586621679413250"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413251"><a href="#local-6989586621679413251"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413250"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679413251"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1916"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413252"><a href="#local-6989586621679413252"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1917"></a><span>
</span><a name="line-1918"></a><span>
</span><a name="line-1919"></a><span class="hs-comment">{- | E&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; &#12395;&#23550;&#24540;&#12377;&#12427; E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049; &#12398;&#12501;&#12451;&#12540;&#12523;&#12489;&#21517;&#65288;&#38306;&#25968;&#65289;&#12434;&#36820;&#12377;

    &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12398; 
    
    &#36939;&#36664;&#26989; -&gt; &#20489;&#24235;

    &#37329;&#34701;&#26989; -&gt; &#36786;&#26519;&#27700;&#29987;&#37329;&#34701;&#26989;

    &#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307; -&gt; &#21332;&#21516;&#32068;&#21512;

    &#12395;&#12381;&#12428;&#12382;&#12428;&#37197;&#20998;(&#21368;&#22770;&#12426;&#23567;&#22770;&#12426;&#12399;&#65292;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12391;&#20998;&#35299;&#12373;&#12428;&#12427;&#12398;&#12391;&#20309;&#12418;&#12375;&#12394;&#12356;)

 -}</span><span>
</span><a name="line-1932"></a><span>
</span><a name="line-1933"></a><span class="hs-identifier">getValCarsFromV&#21332;&#21516;&#32068;&#21512;</span><span> </span><span class="hs-glyph">::</span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%4FE1%7528%5171%6E08%4E8B%696D%306E%6709%7121"><span class="hs-identifier hs-type">Val&#20449;&#29992;&#20849;&#28168;&#20107;&#26989;&#12398;&#26377;&#28961;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1934"></a><a name="getValCarsFromV%5354%540C%7D44%5408"><a href="V.html#getValCarsFromV%5354%540C%7D44%5408"><span class="hs-identifier">getValCarsFromV&#21332;&#21516;&#32068;&#21512;</span></a></a><span> </span><a name="local-6989586621679413255"><a href="#local-6989586621679413255"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679413256"><a href="#local-6989586621679413256"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679413257"><a href="#local-6989586621679413257"><span class="hs-identifier">bl</span></a></a><span> </span><a name="local-6989586621679413258"><a href="#local-6989586621679413258"><span class="hs-identifier">sales</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413264"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679413256"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679413257"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621679413258"><span class="hs-identifier hs-var">sales</span></a><span>
</span><a name="line-1935"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1936"></a><span>    </span><span class="hs-comment">-- &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12363;&#12425;&#20516;&#12434;&#25277;&#20986;</span><span>
</span><a name="line-1937"></a><span>    </span><span class="hs-identifier">projSales</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-1938"></a><span>    </span><a name="local-6989586621679413259"><a href="#local-6989586621679413259"><span class="hs-identifier">projSales</span></a></a><span> </span><a name="local-6989586621679413266"><a href="#local-6989586621679413266"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621679413267"><a href="#local-6989586621679413267"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413268"><a href="#local-6989586621679413268"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413268"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><a href="#local-6989586621679413266"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679413267"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1939"></a><span>    </span><span class="hs-comment">-- &#36939;&#36664;</span><span>
</span><a name="line-1940"></a><span>    </span><a name="local-6989586621679413260"><a href="#local-6989586621679413260"><span class="hs-identifier">trans</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413259"><span class="hs-identifier hs-var">projSales</span></a><span> </span><span class="hs-string">&quot;T9&quot;</span><span>
</span><a name="line-1941"></a><span>    </span><span class="hs-comment">-- &#37329;&#34701;&#26989;</span><span>
</span><a name="line-1942"></a><span>    </span><a name="local-6989586621679413261"><a href="#local-6989586621679413261"><span class="hs-identifier">fns</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413259"><span class="hs-identifier hs-var">projSales</span></a><span> </span><span class="hs-string">&quot;T10&quot;</span><span>
</span><a name="line-1943"></a><span>    </span><span class="hs-comment">-- &#21332;&#21516;&#32068;&#21512;</span><span>
</span><a name="line-1944"></a><span>    </span><a name="local-6989586621679413262"><a href="#local-6989586621679413262"><span class="hs-identifier">coop</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413259"><span class="hs-identifier hs-var">projSales</span></a><span> </span><span class="hs-string">&quot;T11&quot;</span><span>
</span><a name="line-1945"></a><span>
</span><a name="line-1946"></a><span>    </span><span class="hs-comment">-- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-1947"></a><span>    </span><a name="local-6989586621679413263"><a href="#local-6989586621679413263"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="V.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679413255"><span class="hs-identifier hs-var">man</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span>
</span><a name="line-1948"></a><span>
</span><a name="line-1949"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VDS.html#Val%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%4FE1%7528%5171%6E08%4E8B%696D%306E%6709%7121"><span class="hs-identifier hs-type">Val&#20449;&#29992;&#20849;&#28168;&#20107;&#26989;&#12398;&#26377;&#28961;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1950"></a><span>    </span><a name="local-6989586621679413264"><a href="#local-6989586621679413264"><span class="hs-identifier">f</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1951"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413269"><a href="#local-6989586621679413269"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">coop</span></a><span> </span><a href="#local-6989586621679413269"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1952"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1953"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1954"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413270"><a href="#local-6989586621679413270"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413260"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679413270"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679413270"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413261"><span class="hs-identifier hs-var">fns</span></a><span> </span><a href="#local-6989586621679413270"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1955"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413271"><a href="#local-6989586621679413271"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413260"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679413271"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679413271"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1956"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413272"><a href="#local-6989586621679413272"><span class="hs-identifier">k</span></a></a><span>     </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413265"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679413272"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1957"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413273"><a href="#local-6989586621679413273"><span class="hs-identifier">k</span></a></a><span>     </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413274"><a href="#local-6989586621679413274"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413260"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679413274"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679413274"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413265"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679413273"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1958"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413275"><a href="#local-6989586621679413275"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413265"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679413275"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1959"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413276"><a href="#local-6989586621679413276"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413265"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679413276"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1960"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413277"><a href="#local-6989586621679413277"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413278"><a href="#local-6989586621679413278"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413260"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679413278"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679413278"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413265"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679413277"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413261"><span class="hs-identifier hs-var">fns</span></a><span> </span><a href="#local-6989586621679413278"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1961"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679413279"><a href="#local-6989586621679413279"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413280"><a href="#local-6989586621679413280"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413260"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679413280"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679413280"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413265"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679413279"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1962"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-identifier">_</span><span>               </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1963"></a><span>
</span><a name="line-1964"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span>
</span><a name="line-1965"></a><span>    </span><a name="local-6989586621679413265"><a href="#local-6989586621679413265"><span class="hs-identifier">getName</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span>
</span><a name="line-1966"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413281"><a href="#local-6989586621679413281"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413281"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#edE%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-var">edE&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1967"></a><span>                                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413282"><a href="#local-6989586621679413282"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413282"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1968"></a><span>                                        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;can Not find in edE&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&quot;</span><span>
</span><a name="line-1969"></a><span>
</span><a name="line-1970"></a><span>
</span><a name="line-1971"></a><span class="hs-comment">-- *** &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65306;&#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#65292;&#37109;&#20415;&#23616;&#21463;&#35351;&#34892;&#65292;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;</span><span>
</span><a name="line-1972"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1973"></a><span class="hs-comment">{- | &#12469;&#12540;&#12499;&#12473;A&#12392;&#24314;&#35373;&#12399;&#21516;&#19968;&#12398;&#35519;&#26619;&#38917;&#30446;&#12395;&#38306;&#12431;&#12427;&#12398;&#12391;&#21516;&#26178;&#12395;&#20966;&#29702;&#12377;&#12427;.

    * &#12469;&#12540;&#12499;&#12473;A
     &#38651;&#27671;&#65292;&#12460;&#12473;&#65292;&#29105;&#20379;&#32102;&#65292;&#27700;&#36947;&#26989;&#65292;&#36939;&#36664;&#26989;&#65292;&#37109;&#20415;&#26989;&#65292;&#36890;&#20449;&#65292;&#25918;&#36865;&#65292;&#26144;&#20687;&#12539;&#38899;&#22768;&#12539;&#25991;&#23383;&#24773;&#22577;&#21046;&#20316;&#26989;&#12399;&#65292;
    &#24179;&#25104;24&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#65292;
    &#24179;&#25104;28&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65292;&#23398;&#26657;&#25945;&#32946;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;

    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#12434;&#36984;&#25246;&#12375;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#21450;&#12403;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#20027;&#12394;&#20107;&#26989;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12395;&#12390;&#65292;
    &#31532;10&#20301;&#12414;&#12391;&#12398;&#32048;&#20998;&#39006;&#30456;&#24403;&#12398;&#12300;&#20107;&#26989;&#20869;&#23481;&#21450;&#12403;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21448;&#12399;&#21106;&#21512;&#12301;&#12434;&#25226;&#25569;&#12375;&#12390;&#12356;&#12427;&#65294;

    &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12354;&#12426;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12399;&#38598;&#35336;&#23550;&#35937;&#12392;&#12394;&#12425;&#12394;&#12356;&#12383;&#12417;&#65292;&#12300;&#20027;&#12394;&#20107;&#26989;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12398;&#20516;&#12434;&#30452;&#25509;&#20225;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12392;&#12375;&#12390;&#21033;&#29992;&#12377;&#12427;&#65294;


    * &#24314;&#35373;
    &#24179;&#25104;24&#65292;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#12395;&#12362;&#12369;&#12427;&#24314;&#35373;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
    &#35519;&#26619;&#31080;&#35023;&#38754;&#12300;15 &#20027;&#12394;&#20107;&#26989;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12391;
    &#12300;&#22303;&#26408;&#24037;&#20107;&#65292;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#65292;&#38750;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#65292;&#27231;&#26800;&#35373;&#20633;&#24037;&#20107;&#12301;&#12398;&#12381;&#12428;&#12382;&#12428;
    &#12300;&#20803;&#35531;&#65292;&#19979;&#35531;&#12369;&#12301;&#21029;&#65288;&#20197;&#19979;&#65292;&#24314;&#31689;8&#21306;&#20998;&#12392;&#21628;&#31216;&#65289;&#12395;&#35442;&#24403;&#12377;&#12427;&#22770;&#19978;&#21454;&#20837;&#37329;&#38989;&#12414;&#12383;&#12399;&#21106;&#21512;&#12434;&#35352;&#20837;&#12377;&#12427;&#65294;

    &#12414;&#12383;&#65292;&#12300;16 &#26989;&#24907;&#21029;&#24037;&#20107;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
    &#24314;&#31689;&#26989;&#27861;&#12398;&#24037;&#31278;&#21306;&#20998;&#12434;&#19968;&#37096;&#32048;&#20998;&#21270;&#12375;&#12383;33&#31278;&#39006;&#12398;&#26989;&#24907;&#12398;&#20869;&#24180;&#38291;&#12395;&#12362;&#12369;&#12427;&#23436;&#25104;&#24037;&#20107;&#39640;&#19978;&#20301;&#65298;&#31278;&#12434;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;
    &#19968;&#26041;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
    &#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#21069;&#36848;&#12398;33&#21306;&#20998;&#24037;&#31278;&#12395;&#65292;&#12300;&#19968;&#33324;&#22303;&#26408;&#24314;&#31689;&#24037;&#20107;&#12301;&#12434;&#21152;&#12360;&#12383;34&#21306;&#20998;&#12363;&#12425;&#12398;&#36984;&#25246;&#24335;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;
     
     &#32068;&#26367;&#38598;&#35336;&#12398;&#12383;&#12417;&#12395;&#24517;&#35201;&#12392;&#12394;&#12427;&#20316;&#26989;&#12399;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#65298;&#12388;&#12363;&#12425;&#65292;
     &#24314;&#35373;&#26989;&#12395;&#12362;&#12369;&#12427;&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12434;&#26126;&#12425;&#12363;&#12395;&#12375;&#65292;&#12381;&#12398;&#27604;&#29575;&#12434;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;A&#65289;&#21450;&#12403;&#65292;
     &#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
     &#12300;&#24314;&#35373;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12395;&#35352;&#36617;&#12398;&#12354;&#12387;&#12383;&#20107;&#26989;&#25152;&#12398;&#21103;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#27604;&#29575;&#12434;&#25226;&#25569;&#12377;&#12427;&#12371;&#12392;&#12391;&#12354;&#12427;&#65294;
     &#12371;&#12371;&#12391;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#38598;&#35336;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#12300;&#29305;&#27530;&#12394;&#26041;&#27861;&#12301;&#12395;&#21063;&#12426;&#12394;&#12364;&#12425;&#65292;&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12398;&#22770;&#19978;&#39640;&#12434;&#25226;&#25569;&#12377;&#12427;&#65294;

     &#23550;&#20966;&#26041;&#37341;&#12392;&#12375;&#12390;&#65292;&#24314;&#31689;8&#21306;&#20998;&#12398;&#22770;&#19978;&#38989;&#12434;&#24037;&#31278;&#21306;&#20998;&#12391;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#32887;&#31278;&#12395;&#37197;&#20998;&#12375;&#65292;
     &#12381;&#12398;&#24460;&#65292;&#24037;&#31278;&#21306;&#20998;&#12392;&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12398;&#23550;&#24540;&#34920;&#12434;&#21033;&#29992;&#12375;&#12390;&#12475;&#12531;&#12469;&#12473;&#23567;&#20998;&#39006;&#12395;&#37197;&#20998;&#12377;&#12427;&#65294;
     &#12394;&#12362;&#65292;&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12395;&#12362;&#12369;&#12427;&#12300;&#19968;&#33324;&#22303;&#26408;&#24314;&#31689;&#24037;&#20107;&#26989;&#12301;&#12395;&#12399;&#65292;&#24314;&#31689;8&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#12300;&#22303;&#26408;&#24037;&#20107;&#12301;&#65292;
     &#12300;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#21448;&#12399;&#38750;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#12301;&#12364;&#20849;&#12395;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;&#65292;&#12354;&#12427;&#12356;&#12399;&#65292;&#24037;&#31278;&#21306;&#20998;&#12395;&#12362;&#12356;&#12390;&#65292;
     &#12300;&#22303;&#26408;&#19968;&#24335;&#24037;&#20107;&#12301;&#21450;&#12403;&#12300;&#24314;&#31689;&#19968;&#24335;&#24037;&#20107;&#65292;&#21448;&#12399;&#26408;&#36896;&#24314;&#31689;&#19968;&#24335;&#24037;&#20107;&#12301;&#12398;&#21452;&#26041;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;&#12363;&#12425;&#65292;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35352;&#36617;&#12300;&#19968;&#33324;&#22303;&#26408;&#24314;&#31689;&#24037;&#20107;&#65288;&#23436;&#25104;&#24037;&#20107;&#39640;&#12395;&#12362;&#12356;&#12390;&#24314;&#31689;&#24037;&#20107;&#12398;&#21344;&#12417;&#12427;&#21106;&#21512;&#12364;&#65298;&#21106;&#20197;&#19978;&#65292;8&#21106;&#26410;&#28288;&#65289;&#12301;&#65292;
     &#12300;&#22303;&#26408;&#19968;&#24335;&#24037;&#20107;&#65288;&#23436;&#25104;&#24037;&#20107;&#39640;&#12395;&#12362;&#12356;&#12390;&#24314;&#31689;&#24037;&#20107;&#12398;&#21344;&#12417;&#12427;&#21106;&#21512;&#12364;&#65298;&#21106;&#26410;&#28288;&#65289;&#12301;&#65292;
     &#12300;&#24314;&#31689;&#19968;&#24335;&#24037;&#20107;&#65288;&#23436;&#25104;&#24037;&#20107;&#39640;&#12395;&#12362;&#12356;&#12390;&#24314;&#31689;&#24037;&#20107;&#12398;&#21344;&#12417;&#12427;&#21106;&#21512;&#12364;8&#21106;&#20197;&#19978;&#65289;&#12301;&#12395;&#24467;&#12387;&#12390;&#65292;&#20998;&#39006;&#12377;&#12427;&#65294;

    &#12394;&#12362;,&#20107;&#26989;&#21029;&#22770;&#19978;(&#21454;&#20837;)&#37329;&#38989;&#12398;&#20869;&#35379;&#12395;&#12362;&#12369;&#12427;,&#19979;&#35531;&#12369;&#24037;&#20107;&#37096;&#20998;&#12399;,&#20108;&#37325;&#35336;&#19978;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;,&#24460;&#12395;&#21066;&#38500;&#12377;&#12427;&#12364;,&#21508;&#20107;&#26989;&#25152;&#21336;&#20301;&#12391;&#12399;&#21066;&#38500;&#12375;&#12394;&#12356;.


    * &#37329;&#34701;&#26989;,&#20445;&#38522;&#26989;
    &#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12391;&#12399;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#65292;
    &#24179;&#25104;28&#24180;&#12391;&#12399;&#65292;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65292;&#23398;&#26657;&#25945;&#32946;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
    &#12356;&#12378;&#12428;&#12398;&#22580;&#21512;&#12391;&#12418;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;&#35442;&#24403;&#12377;&#12427;&#20107;&#26989;&#31278;&#39006;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

    &#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#20225;&#26989;&#21450;&#12403;&#21336;&#29420;&#20107;&#26989;&#25152;&#12434;&#38598;&#35336;&#23550;&#35937;&#12392;&#12375;&#65292;
    &#35079;&#25968;&#20107;&#26989;&#25152;&#12363;&#12425;&#12394;&#12427;&#20225;&#26989;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#21336;&#20301;&#12391;&#12398;&#38598;&#35336;&#12399;&#34892;&#12431;&#12394;&#12356;&#65294;  
     &#20225;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#25226;&#25569;&#12395;&#24403;&#12383;&#12387;&#12390;&#12399;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;
     &#22243;&#20307;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#31278;&#39006;&#12395;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#26989;&#12398;&#21454;&#20837;&#12301;&#12398;&#22238;&#31572;&#37329;&#38989;&#12434;&#20840;&#38989;&#36617;&#12379;&#12427;&#65294;
     &#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35299;&#31572;&#27396;&#12395;&#12362;&#12356;&#12390;&#35079;&#25968;&#12398;&#22238;&#31572;&#12364;&#12354;&#12387;&#12383;&#22580;&#21512;&#65292;
     &#20632;&#19979;&#20107;&#26989;&#25152;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#21029;&#12395;&#20107;&#26989;&#25152;&#21029;&#24467;&#26989;&#21729;&#25968;&#12398;&#27604;&#29575;&#12434;&#25499;&#12369;&#12390;&#20225;&#26989;&#21029;&#26989;&#31278;&#21029;&#22770;&#19978;&#39640;&#12434;&#20986;&#12377;&#65294;
     &#26696;&#20998;&#24460;&#12418;&#24046;&#12364;&#20986;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;&#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294; &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#22238;&#31572;&#12364;&#35079;&#25968;&#12392;&#12394;&#12387;&#12383;&#22580;&#21512;&#12395;&#12399;&#65292;&#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294;


    *&#23398;&#26657;&#25945;&#32946;
    &#23398;&#26657;&#25945;&#32946;&#12399;&#65292;&#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#65292;&#23398;&#26657;&#25945;&#32946;&#12399;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#23398;&#26657;&#25945;&#32946;&#65289;&#65292;
    &#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#23398;&#26657;&#25945;&#32946;&#65289;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#23398;&#26657;&#25945;&#32946;&#65289;&#12398;&#19977;&#12388;&#12398;&#35519;&#26619;&#31080;&#12395;&#12424;&#12387;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
    &#12371;&#12398;&#12358;&#12385;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#21454;&#20837;&#20869;&#35379;&#12301;&#12395;&#12362;&#12356;&#12390;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#65292;
    &#12414;&#12383;&#12399;&#21106;&#21512;&#12434;&#35519;&#26619;&#12375;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#20197;&#22806;&#12391;&#12399;&#65292;
    &#35519;&#26619;&#38917;&#30446;&#12300;&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#20107;&#26989;&#25152;&#12398;&#20027;&#12394;&#20107;&#26989;&#12392;&#12375;&#12390;&#35442;&#24403;&#12377;&#12427;&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;&#12398;&#12415;&#12434;&#25226;&#25569;&#12375;&#12390;&#12356;&#12427;&#65294; 
     
     &#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#65292;&#23398;&#26657;&#25945;&#32946;&#12399;&#65292;&#21336;&#29420;&#20107;&#26989;&#33879;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65292;&#23398;&#26657;&#25945;&#32946;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
     &#12381;&#12398;&#12358;&#12385;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#35519;&#26619;&#38917;&#30446;&#12300;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#21454;&#20837;&#20869;&#35379;&#12301;&#12395;&#12362;&#12356;&#12390;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#12398;&#65292;
     &#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21448;&#12399;&#21106;&#21512;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;&#12381;&#12398;&#20182;&#12398;&#35519;&#26619;&#31080;&#12391;&#12399;&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;&#12398;&#12415;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#12356;&#12378;&#12428;&#12398;&#24180;&#24230;&#12395;&#12362;&#12356;&#12390;&#12418;&#65292;&#23398;&#26657;&#25945;&#32946;&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#22411;&#29987;&#26989;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#20197;&#38477;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#20516;&#12434;&#29992;&#12356;&#12394;&#12356;&#65294;
     &#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#20516;&#12399;&#65292;&#12381;&#12398;&#12414;&#12414;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#65292;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#12399;&#65292;
     &#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#23398;&#26657;&#12398;&#31278;&#39006;&#12395;&#65292;22&#21306;&#20998;&#12398;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12395;&#12362;&#12369;&#12427;&#65292;&#12300;&#23398;&#26657;&#25945;&#32946;&#12301;&#12398;&#38989;&#12434;&#20840;&#38989;&#36617;&#12379;&#12390;&#65292;
     &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12392;&#12375;&#12390;&#29992;&#12356;&#12427;&#65294;


    * &#22243;&#20307;
    &#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#12399;&#65292;&#24179;&#25104;24&#24180;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#65292;
    &#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#65292;
    &#24179;&#25104;28&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#22243;&#20307;&#35519;&#26619;&#31080;&#65292;
    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#65289;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
    9&#12388;&#12398;&#24418;&#24907;&#12363;&#12425;&#19968;&#12388;&#12434;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12391;&#35519;&#26619;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;
    &#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#12301;&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;
    &#20225;&#26989;&#21450;&#12403;&#22243;&#20307;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#12434;&#38598;&#35336;&#23550;&#35937;&#12392;&#12375;&#65292;&#35079;&#25968;&#20107;&#26989;&#25152;&#12363;&#12425;&#12394;&#12427;&#20225;&#26989;&#65292;
    &#22243;&#20307;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#21336;&#20301;&#12391;&#12398;&#38598;&#35336;&#12399;&#34892;&#12431;&#12394;&#12356;&#65294;  
     &#20225;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#25226;&#25569;&#12395;&#24403;&#12383;&#12387;&#12390;&#12399;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;
     &#22243;&#20307;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#31278;&#39006;&#12395;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;
     &#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#65288;&#22243;&#20307;&#65289;&#12301;&#12398;&#22238;&#31572;&#37329;&#38989;&#12434;&#20840;&#38989;&#36617;&#12379;&#12427;&#65294;
     &#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#22243;&#20307;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35299;&#31572;&#27396;&#12395;&#12362;&#12356;&#12390;&#35079;&#25968;&#12398;&#22238;&#31572;&#12364;&#12354;&#12387;&#12383;&#22580;&#21512;&#65292;
     &#20632;&#19979;&#20107;&#26989;&#25152;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#21029;&#12395;&#20107;&#26989;&#25152;&#21029;&#24467;&#26989;&#21729;&#25968;&#12398;&#27604;&#29575;&#12434;&#25499;&#12369;&#12390;&#20225;&#26989;&#21029;&#26989;&#31278;&#21029;&#22770;&#19978;&#39640;&#12434;&#20986;&#12377;&#65294;
     &#26696;&#20998;&#24460;&#12418;&#24046;&#12364;&#20986;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;&#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294; &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#22238;&#31572;&#12364;&#35079;&#25968;&#12392;&#12394;&#12387;&#12383;&#22580;&#21512;&#12395;&#12399;&#65292;
     &#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294;
-}</span><span>
</span><a name="line-2064"></a><span>
</span><a name="line-2065"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2066"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5EFA%30B5A"><a href="V.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5EFA%30B5A"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A</span></a></a><span> </span><a name="local-6989586621679413283"><a href="#local-6989586621679413283"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413284"><a href="#local-6989586621679413284"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-2067"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-2068"></a><span>    </span><a name="local-6989586621679413302"><a href="#local-6989586621679413302"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2069"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413302"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2070"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413285"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413283"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2071"></a><span>        </span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413303"><a href="#local-6989586621679413303"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679413303"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413285"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413283"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2072"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679413303"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A%5B66%6821"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A&#23398;&#26657;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413285"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413283"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2073"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679413303"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%56E3%4F53"><span class="hs-identifier hs-var">E&#22243;&#20307;</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413285"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413283"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2074"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679413303"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5B66%6821%6559%80B2"><span class="hs-identifier hs-var">E&#23398;&#26657;&#25945;&#32946;</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413285"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679413283"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2075"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2076"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2077"></a><span>
</span><a name="line-2078"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2079"></a><span>    </span><span class="hs-comment">-- &#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-2080"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2081"></a><span>    </span><a name="local-6989586621679413285"><a href="#local-6989586621679413285"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679413286"><a href="#local-6989586621679413286"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413287"><a href="#local-6989586621679413287"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2082"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413288"><a href="#local-6989586621679413288"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-2083"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413289"><a href="#local-6989586621679413289"><span class="hs-identifier">tar</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2084"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413290"><a href="#local-6989586621679413290"><span class="hs-identifier">consKind</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">H&#24037;&#20107;&#31278;&#39006;</span></a><span>
</span><a name="line-2085"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413291"><a href="#local-6989586621679413291"><span class="hs-identifier">sal</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span>
</span><a name="line-2086"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413292"><a href="#local-6989586621679413292"><span class="hs-identifier">sev</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2087"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413293"><a href="#local-6989586621679413293"><span class="hs-identifier">orgKind</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2088"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413294"><a href="#local-6989586621679413294"><span class="hs-identifier">finKind</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%91D1%878D%696D%4FDD%967A%696D%306E%4E8B%696D%7A2E%985E"><span class="hs-identifier hs-var">H&#37329;&#34701;&#26989;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;</span></a><span>
</span><a name="line-2089"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413295"><a href="#local-6989586621679413295"><span class="hs-identifier">schKind</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5B66%6821%7B49%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2090"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413296"><a href="#local-6989586621679413296"><span class="hs-identifier">schIncome</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%53CE%5165%5185%8A33_%5B66%6821"><span class="hs-identifier hs-var">H&#21454;&#20837;&#20869;&#35379;_&#23398;&#26657;</span></a><span>
</span><a name="line-2091"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679413297"><a href="#local-6989586621679413297"><span class="hs-identifier">mainKind</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E3B%306A%4E8B%696D%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2092"></a><span>
</span><a name="line-2093"></a><span>
</span><a name="line-2094"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-2095"></a><span>        </span><span class="hs-comment">-- &#12371;&#12371;&#12391;,&#20197;&#21069;&#12395;&#20966;&#29702;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12398;&#23550;&#20966;&#12434;&#20998;&#23696;</span><span>
</span><a name="line-2096"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413298"><a href="#local-6989586621679413298"><span class="hs-identifier">newCars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#getValCarsFromV%5EFA%30B5A"><span class="hs-identifier hs-var">getValCarsFromV&#24314;&#12469;A</span></a><span> </span><a href="#local-6989586621679413286"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413288"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679413290"><span class="hs-identifier hs-var">consKind</span></a><span> </span><a href="#local-6989586621679413291"><span class="hs-identifier hs-var">sal</span></a><span> </span><a href="#local-6989586621679413292"><span class="hs-identifier hs-var">sev</span></a><span> </span><a href="#local-6989586621679413293"><span class="hs-identifier hs-var">orgKind</span></a><span> </span><a href="#local-6989586621679413294"><span class="hs-identifier hs-var">finKind</span></a><span> </span><a href="#local-6989586621679413295"><span class="hs-identifier hs-var">schKind</span></a><span> </span><a href="#local-6989586621679413296"><span class="hs-identifier hs-var">schIncome</span></a><span> </span><a href="#local-6989586621679413297"><span class="hs-identifier hs-var">mainKind</span></a><span>
</span><a name="line-2097"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413289"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413298"><span class="hs-identifier hs-var">newCars</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2098"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679413298"><span class="hs-identifier hs-var">newCars</span></a><span>
</span><a name="line-2099"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413299"><a href="#local-6989586621679413299"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413300"><a href="#local-6989586621679413300"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413299"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679413300"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2100"></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413301"><a href="#local-6989586621679413301"><span class="hs-identifier">old</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2101"></a><span>
</span><a name="line-2102"></a><span>
</span><a name="line-2103"></a><span class="hs-comment">-- | f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A &#12398;&#20869;&#37096;&#38306;&#25968;</span><span>
</span><a name="line-2104"></a><span class="hs-comment">-- </span><span>
</span><a name="line-2105"></a><span class="hs-comment">-- H&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A  &#12399;&#24314;&#35373;&#12392;&#12469;A&#12434;&#20966;&#29702;,&#12381;&#12428;&#20197;&#22806;&#12398;&#38917;&#30446;&#12399;&#29420;&#33258;&#12395;&#20966;&#29702;&#12375;&#12390;&#26368;&#24460;&#12395;&#32080;&#21512;</span><span>
</span><a name="line-2106"></a><span class="hs-comment">-- </span><span>
</span><a name="line-2107"></a><span class="hs-comment">-- &#38306;&#25968;&#12372;&#12392;&#12395;&#20998;&#21106;&#12377;&#12427;&#12409;&#12365;&#65288;&#35506;&#38988;&#65289;</span><span>
</span><a name="line-2108"></a><span>
</span><a name="line-2109"></a><span>
</span><a name="line-2110"></a><span class="hs-identifier">getValCarsFromV&#24314;&#12469;A</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-type">Val&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span>
</span><a name="line-2111"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%91D1%878D%696D%4FDD%967A%696D%306E%4E8B%696D%7A2E%985E"><span class="hs-identifier hs-type">Val&#37329;&#34701;&#26989;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;</span></a><span>
</span><a name="line-2112"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5B66%6821%7B49%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%53CE%5165%5185%8A33_%5B66%6821"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#20869;&#35379;_&#23398;&#26657;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E3B%306A%4E8B%696D%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-2113"></a><span>
</span><a name="line-2114"></a><a name="getValCarsFromV%5EFA%30B5A"><a href="V.html#getValCarsFromV%5EFA%30B5A"><span class="hs-identifier">getValCarsFromV&#24314;&#12469;A</span></a></a><span> </span><a name="local-6989586621679413304"><a href="#local-6989586621679413304"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413305"><a href="#local-6989586621679413305"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679413306"><a href="#local-6989586621679413306"><span class="hs-identifier">consKind</span></a></a><span> </span><a name="local-6989586621679413307"><a href="#local-6989586621679413307"><span class="hs-identifier">sal</span></a></a><span> </span><a name="local-6989586621679413308"><a href="#local-6989586621679413308"><span class="hs-identifier">sev</span></a></a><span> </span><a name="local-6989586621679413309"><a href="#local-6989586621679413309"><span class="hs-identifier">orgKind</span></a></a><span> </span><a name="local-6989586621679413310"><a href="#local-6989586621679413310"><span class="hs-identifier">finKind</span></a></a><span> </span><a name="local-6989586621679413311"><a href="#local-6989586621679413311"><span class="hs-identifier">schKind</span></a></a><span> </span><a name="local-6989586621679413312"><a href="#local-6989586621679413312"><span class="hs-identifier">schIncome</span></a></a><span> </span><a name="local-6989586621679413313"><a href="#local-6989586621679413313"><span class="hs-identifier">mainKind</span></a></a><span>
</span><a name="line-2115"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413316"><span class="hs-identifier hs-var">seARes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413317"><span class="hs-identifier hs-var">cnsRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413318"><span class="hs-identifier hs-var">orgRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413319"><span class="hs-identifier hs-var">finRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413320"><span class="hs-identifier hs-var">schRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679413321"><span class="hs-identifier hs-var">sinRes</span></a><span>
</span><a name="line-2116"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2117"></a><span>    </span><span class="hs-comment">-- &#24314;&#35373;&#20998;&#12384;&#12369;&#12434;&#25244;&#12365;&#20986;&#12377;</span><span>
</span><a name="line-2118"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679413314"><a href="#local-6989586621679413314"><span class="hs-identifier">cns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679413315"><a href="#local-6989586621679413315"><span class="hs-identifier">seA</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413323"><span class="hs-identifier hs-var">partCns</span></a><span> </span><a href="#local-6989586621679413304"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413307"><span class="hs-identifier hs-var">sal</span></a><span>
</span><a name="line-2119"></a><span>    </span><span class="hs-comment">-- &#12469;A&#37096;&#20998;</span><span>
</span><a name="line-2120"></a><span>    </span><a name="local-6989586621679413316"><a href="#local-6989586621679413316"><span class="hs-identifier">seARes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413324"><span class="hs-identifier hs-var">convOther</span></a><span> </span><a href="#local-6989586621679413304"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413315"><span class="hs-identifier hs-var">seA</span></a><span>
</span><a name="line-2121"></a><span>    </span><span class="hs-comment">-- &#24314;&#35373;&#37096;&#20998; </span><span>
</span><a name="line-2122"></a><span>    </span><a name="local-6989586621679413317"><a href="#local-6989586621679413317"><span class="hs-identifier">cnsRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413326"><span class="hs-identifier hs-var">convCns</span></a><span> </span><a href="#local-6989586621679413304"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413306"><span class="hs-identifier hs-var">consKind</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413314"><span class="hs-identifier hs-var">cns</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413308"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2123"></a><span>    </span><span class="hs-comment">-- &#22243;&#20307;&#12398;&#31278;&#39006;&#37096;&#20998;</span><span>
</span><a name="line-2124"></a><span>    </span><a name="local-6989586621679413318"><a href="#local-6989586621679413318"><span class="hs-identifier">orgRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413329"><span class="hs-identifier hs-var">convOrg</span></a><span> </span><a href="#local-6989586621679413309"><span class="hs-identifier hs-var">orgKind</span></a><span> </span><a href="#local-6989586621679413308"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2125"></a><span>    </span><span class="hs-comment">-- &#37329;&#34701;&#20445;&#38522;&#26989;&#37096;&#20998;</span><span>
</span><a name="line-2126"></a><span>    </span><a name="local-6989586621679413319"><a href="#local-6989586621679413319"><span class="hs-identifier">finRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413331"><span class="hs-identifier hs-var">convFin</span></a><span> </span><a href="#local-6989586621679413310"><span class="hs-identifier hs-var">finKind</span></a><span> </span><a href="#local-6989586621679413308"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2127"></a><span>    </span><span class="hs-comment">-- &#23398;&#26657;&#25945;&#32946;&#12398;&#37096;&#20998;</span><span>
</span><a name="line-2128"></a><span>    </span><a name="local-6989586621679413320"><a href="#local-6989586621679413320"><span class="hs-identifier">schRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413333"><span class="hs-identifier hs-var">convSch</span></a><span> </span><a href="#local-6989586621679413312"><span class="hs-identifier hs-var">schIncome</span></a><span> </span><a href="#local-6989586621679413308"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2129"></a><span>    </span><span class="hs-comment">-- &#12381;&#12398;&#20182;</span><span>
</span><a name="line-2130"></a><span>    </span><a name="local-6989586621679413321"><a href="#local-6989586621679413321"><span class="hs-identifier">sinRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413334"><span class="hs-identifier hs-var">convForSingles</span></a><span> </span><a href="#local-6989586621679413304"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413311"><span class="hs-identifier hs-var">schKind</span></a><span> </span><a href="#local-6989586621679413313"><span class="hs-identifier hs-var">mainKind</span></a><span>
</span><a name="line-2131"></a><span>
</span><a name="line-2132"></a><span>    </span><span class="hs-comment">-- &#20197;&#19979;, &#38306;&#25968; -----------------------------------------------------</span><span>
</span><a name="line-2133"></a><span>    </span><span class="hs-comment">-- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2134"></a><span>    </span><a name="local-6989586621679413322"><a href="#local-6989586621679413322"><span class="hs-identifier">forMC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679413305"><span class="hs-identifier hs-var">man</span></a><span>
</span><a name="line-2135"></a><span>
</span><a name="line-2136"></a><span>    </span><span class="hs-comment">-- &#24314;&#35373;&#26989;&#12392;&#12381;&#12428;&#20197;&#22806;&#12391;&#20998;&#38626;&#12377;&#12427;</span><span>
</span><a name="line-2137"></a><span>    </span><span class="hs-identifier">partCns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2138"></a><span>    </span><a name="local-6989586621679413323"><a href="#local-6989586621679413323"><span class="hs-identifier">partCns</span></a></a><span> </span><a name="local-6989586621679413335"><a href="#local-6989586621679413335"><span class="hs-identifier">year</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-2139"></a><span>    </span><span class="hs-identifier">partCns</span><span> </span><a name="local-6989586621679413336"><a href="#local-6989586621679413336"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413337"><a href="#local-6989586621679413337"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413338"><a href="#local-6989586621679413338"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679413339"><a href="#local-6989586621679413339"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VClass.html#is%5EFA%8A2D"><span class="hs-identifier hs-var">is&#24314;&#35373;</span></a><span> </span><a href="#local-6989586621679413336"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413339"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><a href="#local-6989586621679413338"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679413337"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679413338"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413337"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2140"></a><span>    </span><span class="hs-identifier">partCns</span><span> </span><a name="local-6989586621679413340"><a href="#local-6989586621679413340"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-2141"></a><span>
</span><a name="line-2142"></a><span>
</span><a name="line-2143"></a><span>    </span><span class="hs-comment">-- &#24314;&#35373;&#20197;&#22806;&#12398;&#37096;&#20998;&#12398;&#22793;&#25563; (seA&#12395;&#36969;&#29992;&#12377;&#12427;)</span><span>
</span><a name="line-2144"></a><span>    </span><span class="hs-identifier">convOther</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2145"></a><span>    </span><a name="local-6989586621679413324"><a href="#local-6989586621679413324"><span class="hs-identifier">convOther</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413341"><a href="#local-6989586621679413341"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679413341"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VClass.html#gd%30B5%30FC%30D3%30B9A24"><span class="hs-identifier hs-var">gd&#12469;&#12540;&#12499;&#12473;A24</span></a><span>
</span><a name="line-2146"></a><span>    </span><span class="hs-identifier">convOther</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679413342"><a href="#local-6989586621679413342"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679413342"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VClass.html#gd%30B5%30FC%30D3%30B9A28"><span class="hs-identifier hs-var">gd&#12469;&#12540;&#12499;&#12473;A28</span></a><span>
</span><a name="line-2147"></a><span>
</span><a name="line-2148"></a><span>
</span><a name="line-2149"></a><span>
</span><a name="line-2150"></a><span>    </span><span class="hs-comment">-- &#24314;&#35373;&#12384;&#12369;&#12398;Cars&#12434;&#20316;&#12427; &gt;&gt; &#12469;A&#12384;&#12369;&#12398;Cars&#12392;&#32080;&#21512;&#12375;&#12383;&#19978;&#12391;,convMCinCars&#12434;&#36969;&#29992;&#12375;&#12390;&#32080;&#26524;&#12395;&#12377;&#12427;.</span><span>
</span><a name="line-2151"></a><span>    </span><span class="hs-comment">-- 33&#21306;&#20998;&#12395;8&#21306;&#20998;&#12434;&#37197;&#20998;&#12377;&#12427;.</span><span>
</span><a name="line-2152"></a><span>    </span><span class="hs-comment">-- 8&#21306;&#20998;&#12372;&#12392;&#12395;,1&#30058;&#30446;&#12392;2&#30058;&#30446;&#12395;&#12394;&#12428;&#12427;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-2153"></a><span>    </span><span class="hs-comment">-- &#29255;&#26041;&#12395;&#12398;&#12415;&#12394;&#12428;&#12427;&#22580;&#21512;&#12399;&#20840;&#38989;&#12381;&#12385;&#12425;&#12395;&#37197;&#20998;</span><span>
</span><a name="line-2154"></a><span>    </span><span class="hs-comment">-- &#20001;&#26041;&#12395;&#12394;&#12428;&#12427;&#22580;&#21512;&#12399;1&#30058;&#12417;&#12395;60%,&#20108;&#30058;&#30446;&#12395;40%&#12434;&#37197;&#20998;&#12377;&#12427;</span><span>
</span><a name="line-2155"></a><span>    </span><span class="hs-comment">-- &#12356;&#12378;&#12428;&#12395;&#12418;&#12394;&#12428;&#12394;&#12356;&#22580;&#21512;&#12399;,&#26684;&#20184;&#12369;&#19981;&#33021;&#12395;&#37197;&#20998;</span><span>
</span><a name="line-2156"></a><span>    </span><a name="local-6989586621679413325"><a href="#local-6989586621679413325"><span class="hs-identifier">cnsCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;DZZ0&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2157"></a><span>
</span><a name="line-2158"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-type">Val&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2159"></a><span>    </span><a name="local-6989586621679413326"><a href="#local-6989586621679413326"><span class="hs-identifier">convCns</span></a></a><span> </span><a name="local-6989586621679413343"><a href="#local-6989586621679413343"><span class="hs-identifier">year</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                             </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2160"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679413344"><a href="#local-6989586621679413344"><span class="hs-identifier">year</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                             </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413345"><a href="#local-6989586621679413345"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#sumCars"><span class="hs-identifier hs-var">VDS.sumCars</span></a><span> </span><a href="#local-6989586621679413345"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;DZZ0&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2161"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679413346"><a href="#local-6989586621679413346"><span class="hs-identifier">year</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                             </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413347"><a href="#local-6989586621679413347"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413348"><a href="#local-6989586621679413348"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T6&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413347"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2162"></a><span>                                                                     </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413348"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;DZZ0&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2163"></a><span>
</span><a name="line-2164"></a><span>
</span><a name="line-2165"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679413349"><a href="#local-6989586621679413349"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">V&#24037;&#20107;&#31278;&#39006;</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#E%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">E&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413350"><a href="#local-6989586621679413350"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679413351"><a href="#local-6989586621679413351"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413350"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="VClass.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413351"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="VClass.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2166"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413352"><a href="#local-6989586621679413352"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413353"><a href="#local-6989586621679413353"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413352"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2167"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413354"><a href="#local-6989586621679413354"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413354"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2168"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413355"><a href="#local-6989586621679413355"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413355"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-2169"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><a href="#local-6989586621679413325"><span class="hs-identifier hs-var">cnsCNC</span></a><span>
</span><a name="line-2170"></a><span>
</span><a name="line-2171"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679413356"><a href="#local-6989586621679413356"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">V&#24037;&#20107;&#31278;&#39006;</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#E%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">E&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413357"><a href="#local-6989586621679413357"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679413358"><a href="#local-6989586621679413358"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413359"><a href="#local-6989586621679413359"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413360"><a href="#local-6989586621679413360"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T6&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413359"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-2172"></a><span>                                                                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413357"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="VClass.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413358"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="VClass.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2173"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413361"><a href="#local-6989586621679413361"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413362"><a href="#local-6989586621679413362"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.6</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413360"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413361"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.4</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413360"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413362"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2174"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413363"><a href="#local-6989586621679413363"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413360"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413363"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2175"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413364"><a href="#local-6989586621679413364"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413360"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413364"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-2176"></a><span>                                                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><a href="#local-6989586621679413325"><span class="hs-identifier hs-var">cnsCNC</span></a><span>
</span><a name="line-2177"></a><span>
</span><a name="line-2178"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679413365"><a href="#local-6989586621679413365"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">V&#24037;&#20107;&#31278;&#39006;</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#E%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">E&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413366"><a href="#local-6989586621679413366"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679413367"><a href="#local-6989586621679413367"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413368"><a href="#local-6989586621679413368"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2179"></a><span>                                                                        </span><a name="local-6989586621679413370"><a href="#local-6989586621679413370"><span class="hs-identifier">car1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413366"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413369"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413369"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2180"></a><span>                                                                        </span><a name="local-6989586621679413372"><a href="#local-6989586621679413372"><span class="hs-identifier">car2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413367"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413371"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413371"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2181"></a><span>                                                                        </span><a name="local-6989586621679413374"><a href="#local-6989586621679413374"><span class="hs-identifier">cnc</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><a href="#local-6989586621679413325"><span class="hs-identifier hs-var">cnsCNC</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413373"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413373"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2182"></a><span>
</span><a name="line-2183"></a><span>                                                                        </span><span class="hs-identifier hs-var">forM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.toList</span><span> </span><a href="#local-6989586621679413368"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413375"><a href="#local-6989586621679413375"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2184"></a><span>                                                                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413376"><a href="#local-6989586621679413376"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413375"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2185"></a><span>                                                                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413377"><a href="#local-6989586621679413377"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span>  </span><a href="#local-6989586621679413375"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2186"></a><span>                                                                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413327"><span class="hs-identifier hs-var">canBe33</span></a><span> </span><a href="#local-6989586621679413365"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413377"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679413366"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413327"><span class="hs-identifier hs-var">canBe33</span></a><span> </span><a href="#local-6989586621679413365"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413377"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679413367"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2187"></a><span>                                                                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413374"><span class="hs-identifier hs-var">cnc</span></a><span>  </span><span class="hs-special">(</span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679413376"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2188"></a><span>                                                                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413370"><span class="hs-identifier hs-var">car1</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679413376"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2189"></a><span>                                                                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413372"><span class="hs-identifier hs-var">car2</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679413376"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2190"></a><span>                                                                                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413370"><span class="hs-identifier hs-var">car1</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.6</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413376"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2191"></a><span>                                                                                               </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413372"><span class="hs-identifier hs-var">car2</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.4</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413376"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2192"></a><span>
</span><a name="line-2193"></a><span>                                                                        </span><a name="local-6989586621679413378"><a href="#local-6989586621679413378"><span class="hs-identifier">res1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413370"><span class="hs-identifier hs-var">car1</span></a><span>
</span><a name="line-2194"></a><span>                                                                        </span><a name="local-6989586621679413379"><a href="#local-6989586621679413379"><span class="hs-identifier">res2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413372"><span class="hs-identifier hs-var">car2</span></a><span>
</span><a name="line-2195"></a><span>                                                                        </span><a name="local-6989586621679413380"><a href="#local-6989586621679413380"><span class="hs-identifier">res3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413374"><span class="hs-identifier hs-var">cnc</span></a><span>
</span><a name="line-2196"></a><span>
</span><a name="line-2197"></a><span>                                                                        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679413378"><span class="hs-identifier hs-var">res1</span></a><span class="hs-special">,</span><a href="#local-6989586621679413379"><span class="hs-identifier hs-var">res2</span></a><span class="hs-special">,</span><a href="#local-6989586621679413380"><span class="hs-identifier hs-var">res3</span></a><span class="hs-special">]</span><span>
</span><a name="line-2198"></a><span>
</span><a name="line-2199"></a><span>    </span><span class="hs-comment">--                 8&#21306;&#20998;      33&#21306;&#20998;</span><span>
</span><a name="line-2200"></a><span>    </span><span class="hs-identifier">canBe33</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2201"></a><span>    </span><a name="local-6989586621679413327"><a href="#local-6989586621679413327"><span class="hs-identifier">canBe33</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413381"><a href="#local-6989586621679413381"><span class="hs-identifier">c8</span></a></a><span> </span><a name="local-6989586621679413382"><a href="#local-6989586621679413382"><span class="hs-identifier">c33</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679413383"><a href="#local-6989586621679413383"><span class="hs-identifier">looked</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413381"><span class="hs-identifier hs-var">c8</span></a><span> </span><a href="VClass.html#ss%5EFA%8A2D%5206%914D24"><span class="hs-identifier hs-var">ss&#24314;&#35373;&#20998;&#37197;24</span></a><span>
</span><a name="line-2202"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413383"><span class="hs-identifier hs-var">looked</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2203"></a><span>                         </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413384"><a href="#local-6989586621679413384"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><a href="#local-6989586621679413382"><span class="hs-identifier hs-var">c33</span></a><span> </span><a href="#local-6989586621679413384"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2204"></a><span>                         </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-string">&quot;error :&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679413381"><span class="hs-identifier hs-var">c8</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;is not a correct value&quot;</span><span>
</span><a name="line-2205"></a><span>    </span><span class="hs-identifier">canBe33</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679413385"><a href="#local-6989586621679413385"><span class="hs-identifier">c8</span></a></a><span> </span><a name="local-6989586621679413386"><a href="#local-6989586621679413386"><span class="hs-identifier">c33</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679413387"><a href="#local-6989586621679413387"><span class="hs-identifier">looked</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413385"><span class="hs-identifier hs-var">c8</span></a><span> </span><a href="VClass.html#ss%5EFA%8A2D%5206%914D28"><span class="hs-identifier hs-var">ss&#24314;&#35373;&#20998;&#37197;28</span></a><span>
</span><a name="line-2206"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413387"><span class="hs-identifier hs-var">looked</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2207"></a><span>                         </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413388"><a href="#local-6989586621679413388"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><a href="#local-6989586621679413386"><span class="hs-identifier hs-var">c33</span></a><span> </span><a href="#local-6989586621679413388"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2208"></a><span>                         </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-string">&quot;error :&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679413385"><span class="hs-identifier hs-var">c8</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;is not a correct value&quot;</span><span>
</span><a name="line-2209"></a><span>
</span><a name="line-2210"></a><span>
</span><a name="line-2211"></a><span>
</span><a name="line-2212"></a><span>    </span><span class="hs-comment">-- &#22243;&#20307;&#12398;&#31278;&#39006;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2213"></a><span>    </span><span class="hs-comment">-- &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12434;&#20837;&#12428;&#12427;&#12384;&#12369;</span><span>
</span><a name="line-2214"></a><span>    </span><a name="local-6989586621679413328"><a href="#local-6989586621679413328"><span class="hs-identifier">orgCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;9390&quot;</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#38750;&#21942;&#21033;&#30340;&#22243;&#20307;</span><span>
</span><a name="line-2215"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2216"></a><span>    </span><a name="local-6989586621679413329"><a href="#local-6989586621679413329"><span class="hs-identifier">convOrg</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2217"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413389"><a href="#local-6989586621679413389"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413389"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413328"><span class="hs-identifier hs-var">orgCNC</span></a><span>
</span><a name="line-2218"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413390"><a href="#local-6989586621679413390"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413390"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#edE%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">edE&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2219"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413391"><a href="#local-6989586621679413391"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413391"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2220"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413328"><span class="hs-identifier hs-var">orgCNC</span></a><span>
</span><a name="line-2221"></a><span>
</span><a name="line-2222"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413392"><a href="#local-6989586621679413392"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413393"><a href="#local-6989586621679413393"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413392"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#edE%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">edE&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2223"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413394"><a href="#local-6989586621679413394"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413393"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413394"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2224"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413393"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413328"><span class="hs-identifier hs-var">orgCNC</span></a><span>
</span><a name="line-2225"></a><span>
</span><a name="line-2226"></a><span>    </span><span class="hs-comment">-- &#37329;&#34701;&#20445;&#38522;&#26989;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2227"></a><span>    </span><a name="local-6989586621679413330"><a href="#local-6989586621679413330"><span class="hs-identifier">finCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;JZZ0&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-comment">--  &#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989; &#20869;&#26684;&#20184;&#19981;&#33021;</span><span>
</span><a name="line-2228"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%91D1%878D%696D%4FDD%967A%696D%306E%4E8B%696D%7A2E%985E"><span class="hs-identifier hs-type">Val&#37329;&#34701;&#26989;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2229"></a><span>    </span><a name="local-6989586621679413331"><a href="#local-6989586621679413331"><span class="hs-identifier">convFin</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2230"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413395"><a href="#local-6989586621679413395"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413395"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413330"><span class="hs-identifier hs-var">finCNC</span></a><span>
</span><a name="line-2231"></a><span>
</span><a name="line-2232"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413396"><a href="#local-6989586621679413396"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>   </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413396"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%91D1%878D%4FDD%967A"><span class="hs-identifier hs-var">gd&#37329;&#34701;&#20445;&#38522;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2233"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413397"><a href="#local-6989586621679413397"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413397"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2234"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413330"><span class="hs-identifier hs-var">finCNC</span></a><span>
</span><a name="line-2235"></a><span>
</span><a name="line-2236"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413398"><a href="#local-6989586621679413398"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413399"><a href="#local-6989586621679413399"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413398"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%91D1%878D%4FDD%967A"><span class="hs-identifier hs-var">gd&#37329;&#34701;&#20445;&#38522;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2237"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413400"><a href="#local-6989586621679413400"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413399"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413400"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2238"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413399"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413330"><span class="hs-identifier hs-var">finCNC</span></a><span>
</span><a name="line-2239"></a><span>
</span><a name="line-2240"></a><span>    </span><span class="hs-comment">-- &#23398;&#26657;&#25945;&#32946;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2241"></a><span>    </span><a name="local-6989586621679413332"><a href="#local-6989586621679413332"><span class="hs-identifier">schCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;81ZZ&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#23398;&#26657;&#25945;&#32946; &#20869;&#26684;&#20184;&#19981;&#33021;</span><span>
</span><a name="line-2242"></a><span>    </span><span class="hs-comment">-- &#20107;&#26989;&#21029;&#21454;&#20837;_&#23398;&#26657;&#25945;&#32946;&#12399;&#12381;&#12398;&#12414;&#12414;&#20351;&#12360;&#12427;.</span><span>
</span><a name="line-2243"></a><span>    </span><span class="hs-identifier">convSch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%53CE%5165%5185%8A33_%5B66%6821"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#20869;&#35379;_&#23398;&#26657;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2244"></a><span>    </span><a name="local-6989586621679413333"><a href="#local-6989586621679413333"><span class="hs-identifier">convSch</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413332"><span class="hs-identifier hs-var">schCNC</span></a><span>
</span><a name="line-2245"></a><span>    </span><span class="hs-identifier">convSch</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413401"><a href="#local-6989586621679413401"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T21&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413401"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413332"><span class="hs-identifier hs-var">schCNC</span></a><span>
</span><a name="line-2246"></a><span>    </span><span class="hs-identifier">convSch</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413402"><a href="#local-6989586621679413402"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679413402"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2247"></a><span>
</span><a name="line-2248"></a><span>
</span><a name="line-2249"></a><span>    </span><span class="hs-comment">-- &#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;&#23550;&#24540;, &#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span><span>
</span><a name="line-2250"></a><span>    </span><span class="hs-comment">--  (&#12371;&#12428;&#12364;Null&#12391;&#12394;&#12356; = &#20107;&#26989;&#25152;&#35519;&#26619;&#31080; &#20516;&#12364;&#25163;&#12395;&#20837;&#12425;&#12394;&#12356;&#12398;&#12391;&#12381;&#12398;&#12414;&#12414;,&#20516;&#12476;&#12525;&#12398;&#12418;&#12398;&#12434;&#20316;&#12427;</span><span>
</span><a name="line-2251"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5B66%6821%7B49%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E3B%306A%4E8B%696D%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2252"></a><span>    </span><a name="local-6989586621679413334"><a href="#local-6989586621679413334"><span class="hs-identifier">convForSingles</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413403"><a href="#local-6989586621679413403"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413403"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VClass.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2253"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413404"><a href="#local-6989586621679413404"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413404"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2254"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2255"></a><span>
</span><a name="line-2256"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-number">28</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413405"><a href="#local-6989586621679413405"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413405"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VClass.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2257"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413406"><a href="#local-6989586621679413406"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413406"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2258"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2259"></a><span>
</span><a name="line-2260"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-number">24</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413407"><a href="#local-6989586621679413407"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413408"><a href="#local-6989586621679413408"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413407"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%5B66%6821%6559%80B224"><span class="hs-identifier hs-var">gd&#23398;&#26657;&#25945;&#32946;24</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413408"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VClass.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2261"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413409"><a href="#local-6989586621679413409"><span class="hs-identifier">xn</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413410"><a href="#local-6989586621679413410"><span class="hs-identifier">yn</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">[</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413409"><span class="hs-identifier hs-var">xn</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413410"><span class="hs-identifier hs-var">yn</span></a><span class="hs-special">]</span><span>
</span><a name="line-2262"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413411"><a href="#local-6989586621679413411"><span class="hs-identifier">xn</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413411"><span class="hs-identifier hs-var">xn</span></a><span>
</span><a name="line-2263"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413412"><a href="#local-6989586621679413412"><span class="hs-identifier">yn</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413412"><span class="hs-identifier hs-var">yn</span></a><span>
</span><a name="line-2264"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2265"></a><span>
</span><a name="line-2266"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-number">28</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413413"><a href="#local-6989586621679413413"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413414"><a href="#local-6989586621679413414"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413414"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VClass.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2267"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413415"><a href="#local-6989586621679413415"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413415"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2268"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2269"></a><span>
</span><a name="line-2270"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413416"><a href="#local-6989586621679413416"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413416"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VClass.html#gd%5B66%6821%6559%80B224"><span class="hs-identifier hs-var">gd&#23398;&#26657;&#25945;&#32946;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2271"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413417"><a href="#local-6989586621679413417"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413417"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2272"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2273"></a><span>
</span><a name="line-2274"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2275"></a><span>
</span><a name="line-2276"></a><span>
</span><a name="line-2277"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2278"></a><span class="hs-comment">-- *  &#20385;&#26684;&#22793;&#25563;</span><span>
</span><a name="line-2279"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2280"></a><span class="hs-comment">-- | &#24179;&#25104;24&#24180;&#28040;&#36027;&#31246;&#29575; </span><span>
</span><a name="line-2281"></a><a name="ctr24"><a href="V.html#ctr24"><span class="hs-identifier">ctr24</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1.05</span><span>
</span><a name="line-2282"></a><span>
</span><a name="line-2283"></a><span class="hs-comment">{-| *&#12300;&#32113;&#35336;&#35519;&#26619;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#39640;&#31561;&#12398;&#38598;&#35336;&#12395;&#20418;&#12427;&#28040;&#36027;&#31246;&#12398;&#21462;&#12426;&#25201;&#12356;&#12395;&#38306;&#12377;&#12427;&#12460;&#12452;&#12489;&#12521;&#12452;&#12531;&#65288;
    &#24179;&#25104;27&#24180;&#65301;&#26376;19&#26085; &#21508;&#24220;&#30465;&#32113;&#35336;&#20027;&#31649;&#35506;&#38263;&#31561;&#20250;&#35696;&#30003;&#12375;&#21512;&#12379;&#65289;&#12301;&#12395;&#22522;&#12389;&#12365;&#20966;&#29702;&#12434;&#34892;&#12358;
    -}</span><span>
</span><a name="line-2286"></a><span>
</span><a name="line-2287"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412650"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412650"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2288"></a><a name="f%4FA1%683C%5909%63DB"><a href="V.html#f%4FA1%683C%5909%63DB"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;</span></a></a><span> </span><span class="hs-number">28</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413418"><a href="#local-6989586621679413418"><span class="hs-identifier">maybeIcd</span></a></a><span>
</span><a name="line-2289"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413418"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2290"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2291"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413419"><a href="#local-6989586621679413419"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679413419"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%4FA1%683C%5909%63DB"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;</span></a><span> </span><span class="hs-number">28</span><span>
</span><a name="line-2292"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;</span><span> </span><span class="hs-number">24</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413420"><a href="#local-6989586621679413420"><span class="hs-identifier">maybeIcd</span></a></a><span>
</span><a name="line-2293"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413420"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2294"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2295"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413421"><a href="#local-6989586621679413421"><span class="hs-identifier">icr</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%4FA1%683C%5909%63DB_%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>              </span><a href="V.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679413421"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2296"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%4FA1%683C%5909%63DB_%7DCF%58F2%4E0A"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#32207;&#22770;&#19978;</span></a><span>                    </span><a href="V.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679413421"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2297"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%4FA1%683C%5909%63DB_%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span>              </span><a href="V.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679413421"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2298"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%4FA1%683C%5909%63DB_%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="V.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679413421"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2299"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679413421"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-2300"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%4FA1%683C%5909%63DB"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;</span></a><span> </span><span class="hs-number">24</span><span>
</span><a name="line-2301"></a><span>
</span><a name="line-2302"></a><span>
</span><a name="line-2303"></a><span class="hs-comment">-- | &#28040;&#36027;&#31246;&#29575;</span><span>
</span><a name="line-2304"></a><span class="hs-keyword">type</span><span> </span><a name="ConsumeTaxRate"><a href="V.html#ConsumeTaxRate"><span class="hs-identifier">ConsumeTaxRate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2305"></a><span>
</span><a name="line-2306"></a><span>
</span><a name="line-2307"></a><span class="hs-comment">-- ** H&#32207;&#22770;&#19978;&#65292;H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span><span>
</span><a name="line-2308"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2309"></a><span class="hs-comment">{- | H&#32207;&#22770;&#19978;&#65292;H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;
    *&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#26989;&#65292;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#22243;&#20307;&#12398;&#27963;&#21205;&#65292;&#19981;&#21205;&#29987;&#20107;&#26989;&#12301;
    &#12434;&#38500;&#12356;&#12383;&#20107;&#26989;&#12398;&#22770;&#19978;&#12395;&#12399;&#65292;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#215;&#31246;&#29575;&#12434;&#36275;&#12377;&#65294;
    
    *&#12377;&#12409;&#12390;&#12398;&#22770;&#12426;&#19978;&#12370;&#12364;&#28040;&#36027;&#31246;&#12398;&#35506;&#31246;&#23550;&#35937;&#12391;&#12354;&#12427;&#12431;&#12369;&#12391;&#12399;&#12394;&#12356;&#12398;&#12391;&#65292;
    &#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12364;&#26410;&#35352;&#20837;&#12398;&#22580;&#21512;&#12399;&#65292;
    &#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#215;&#31246;&#29575;&#12434;&#21152;&#31639;&#65294;
    &#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12364;&#35352;&#20837;&#12373;&#12428;&#12390;&#12356;&#12390;&#19988;&#12388;
    &#12381;&#12398;&#32207;&#21644;&#12364;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12424;&#12426;&#22823;&#12365;&#12356;&#22580;&#21512;&#12399;&#65292;
    &#28040;&#36027;&#31246;&#21152;&#31639;&#24460;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12398;&#21644;&#12391;&#20837;&#12428;&#26367;&#12360;&#12427;&#65294;
-}</span><span>
</span><a name="line-2320"></a><span>
</span><a name="line-2321"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2322"></a><a name="f%4FA1%683C%5909%63DB_%4E8B%696D%5225%58F2%4E0A%9AD8"><a href="V.html#f%4FA1%683C%5909%63DB_%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a></a><span> </span><a name="local-6989586621679413422"><a href="#local-6989586621679413422"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679413423"><a href="#local-6989586621679413423"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2323"></a><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413423"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413424"><a href="#local-6989586621679413424"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2324"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413424"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2325"></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2326"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2327"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413423"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413425"><a href="#local-6989586621679413425"><span class="hs-identifier">sev</span></a></a><span>
</span><a name="line-2328"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413426"><a href="#local-6989586621679413426"><span class="hs-identifier">addedSev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%4E8B%696D%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97"><span class="hs-identifier hs-var">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span></a><span> </span><a href="#local-6989586621679413422"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413425"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2329"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413423"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679413426"><span class="hs-identifier hs-var">addedSev</span></a><span>
</span><a name="line-2330"></a><span>
</span><a name="line-2331"></a><span class="hs-comment">-- | &#31246;&#29575;&#12434;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-2332"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2333"></a><a name="f%4E8B%696D%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97"><a href="V.html#f%4E8B%696D%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97"><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span></a></a><span> </span><a name="local-6989586621679413427"><a href="#local-6989586621679413427"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2334"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span><span> </span><a name="local-6989586621679413428"><a href="#local-6989586621679413428"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413429"><a href="#local-6989586621679413429"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413430"><span class="hs-identifier hs-var">multipleCar</span></a><span> </span><a href="#local-6989586621679413428"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413429"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2335"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2336"></a><span>    </span><a name="local-6989586621679413430"><a href="#local-6989586621679413430"><span class="hs-identifier">multipleCar</span></a></a><span> </span><a name="local-6989586621679413432"><a href="#local-6989586621679413432"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679413433"><a href="#local-6989586621679413433"><span class="hs-identifier">car</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413431"><span class="hs-identifier hs-var">shouldConvert</span></a><span> </span><a href="#local-6989586621679413433"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413433"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413433"><span class="hs-identifier hs-var">car</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413432"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">}</span><span>
</span><a name="line-2337"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413433"><span class="hs-identifier hs-var">car</span></a><span>
</span><a name="line-2338"></a><span>
</span><a name="line-2339"></a><span>    </span><span class="hs-comment">-- &#37329;&#34701;&#65292;&#20445;&#38522;&#26989;&#65292;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#22243;&#20307;&#12398;&#27963;&#21205;&#65292;&#19981;&#21205;&#29987;&#20107;&#26989; &#12391;&#12399;&#12394;&#12356;&#12371;&#12392;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-2340"></a><span>    </span><span class="hs-identifier">shouldConvert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2341"></a><span>    </span><a name="local-6989586621679413431"><a href="#local-6989586621679413431"><span class="hs-identifier">shouldConvert</span></a></a><span> </span><a name="local-6989586621679413434"><a href="#local-6989586621679413434"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413434"><span class="hs-identifier hs-var">tx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;T13&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2342"></a><span>
</span><a name="line-2343"></a><span class="hs-comment">-- | &#32207;&#22770;&#19978;&#12395;&#28040;&#36027;&#31246;&#12434;&#21152;&#31639;</span><span>
</span><a name="line-2344"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#32207;&#22770;&#19978;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2345"></a><a name="f%4FA1%683C%5909%63DB_%7DCF%58F2%4E0A"><a href="V.html#f%4FA1%683C%5909%63DB_%7DCF%58F2%4E0A"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#32207;&#22770;&#19978;</span></a></a><span> </span><a name="local-6989586621679413435"><a href="#local-6989586621679413435"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679413436"><a href="#local-6989586621679413436"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2346"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413436"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413437"><a href="#local-6989586621679413437"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2347"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413437"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2348"></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2349"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2350"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679413436"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%7DCF%58F2%4E0A"><span class="hs-identifier hs-var">H&#32207;&#22770;&#19978;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413438"><a href="#local-6989586621679413438"><span class="hs-identifier">sales</span></a></a><span>
</span><a name="line-2351"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413438"><span class="hs-identifier hs-var">sales</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2352"></a><span>                                </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2353"></a><span>                                </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413439"><a href="#local-6989586621679413439"><span class="hs-identifier">bl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413436"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%7DCF%58F2%4E0A"><span class="hs-identifier hs-var">H&#32207;&#22770;&#19978;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413439"><span class="hs-identifier hs-var">bl</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413435"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2354"></a><span>
</span><a name="line-2355"></a><span class="hs-comment">-- ** H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span><span>
</span><a name="line-2356"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2357"></a><span class="hs-comment">{- | H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;

![&#36027;&#29992;&#31561;&#12398;&#28040;&#36027;&#31246;&#21152;&#31639;&#20966;&#29702;&#22259;](consumeTaxCoset.png)

&#65288;&#12300;&#32113;&#35336;&#35519;&#26619;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#39640;&#31561;&#12398;&#38598;&#35336;&#12395;&#20418;&#12427;&#28040;&#36027;&#31246;&#12398;&#21462;&#12426;&#25201;&#12356;&#12395;&#38306;&#12377;&#12427;&#12460;&#12452;&#12489;&#12521;&#12452;&#12531; 
&#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12434;&#12514;&#12487;&#12523;&#12392;&#12375;&#12383;&#28040;&#36027;&#31246;&#21152;&#31639;&#20966;&#29702;&#65288;&#35519;&#26619;&#21697;&#30446;&#20197;&#22806;&#65289;&#12301;&#12424;&#12426;&#65292;&#25244;&#31883;&#65288;&#19968;&#37096;&#31558;&#32773;&#32232;&#38598;&#65289;

-}</span><span>
</span><a name="line-2365"></a><span>
</span><a name="line-2366"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2367"></a><a name="f%4FA1%683C%5909%63DB_%8CBB%7528%7B49%306E%5185%8A33"><a href="V.html#f%4FA1%683C%5909%63DB_%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a></a><span> </span><a name="local-6989586621679413440"><a href="#local-6989586621679413440"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679413441"><a href="#local-6989586621679413441"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2368"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413445"><a href="#local-6989586621679413445"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2369"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413445"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2370"></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2371"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2372"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-var">H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413446"><a href="#local-6989586621679413446"><span class="hs-identifier">costsDetail</span></a></a><span>
</span><a name="line-2373"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span>       </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413447"><a href="#local-6989586621679413447"><span class="hs-identifier">kind</span></a></a><span>
</span><a name="line-2374"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413448"><a href="#local-6989586621679413448"><span class="hs-identifier">newCost</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%8CBB%7528%7B49%306E%5185%8A33%7A0E%52A0%7B97"><span class="hs-identifier hs-var">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413442"><span class="hs-identifier hs-var">isCommerce</span></a><span> </span><a href="#local-6989586621679413447"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413440"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413446"><span class="hs-identifier hs-var">costsDetail</span></a><span>
</span><a name="line-2375"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-var">H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span> </span><a href="#local-6989586621679413448"><span class="hs-identifier hs-var">newCost</span></a><span>
</span><a name="line-2376"></a><span>
</span><a name="line-2377"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2378"></a><span>    </span><span class="hs-identifier">isCommerce</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2379"></a><span>    </span><a name="local-6989586621679413442"><a href="#local-6989586621679413442"><span class="hs-identifier">isCommerce</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2380"></a><span>    </span><span class="hs-identifier">isCommerce</span><span> </span><a name="local-6989586621679413443"><a href="#local-6989586621679413443"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413444"><a href="#local-6989586621679413444"><span class="hs-identifier">lClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-identifier">_&#29987;&#26989;&#26684;&#20184;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413443"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-2381"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413444"><span class="hs-identifier hs-var">lClass</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T4&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679413444"><span class="hs-identifier hs-var">lClass</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T5&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2382"></a><span>
</span><a name="line-2383"></a><span class="hs-identifier">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-type">Val&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-type">Val&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span>
</span><a name="line-2384"></a><a name="f%8CBB%7528%7B49%306E%5185%8A33%7A0E%52A0%7B97"><a href="V.html#f%8CBB%7528%7B49%306E%5185%8A33%7A0E%52A0%7B97"><span class="hs-identifier">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span></a></a><span> </span><a name="local-6989586621679413449"><a href="#local-6989586621679413449"><span class="hs-identifier">bl</span></a></a><span> </span><a name="local-6989586621679413450"><a href="#local-6989586621679413450"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2385"></a><span class="hs-identifier">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span><span> </span><a name="local-6989586621679413451"><a href="#local-6989586621679413451"><span class="hs-identifier">bl</span></a></a><span> </span><a name="local-6989586621679413452"><a href="#local-6989586621679413452"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413453"><a href="#local-6989586621679413453"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2386"></a><span>                                </span><a name="local-6989586621679413454"><a href="#local-6989586621679413454"><span class="hs-identifier">stResult</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2387"></a><span>                                </span><a name="local-6989586621679413456"><a href="#local-6989586621679413456"><span class="hs-identifier">stTotal</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413455"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413455"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-2388"></a><span>                                </span><a name="local-6989586621679413458"><a href="#local-6989586621679413458"><span class="hs-identifier">stSCost</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413457"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413457"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-2389"></a><span>                                </span><a name="local-6989586621679413460"><a href="#local-6989586621679413460"><span class="hs-identifier">stToMinus</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679413459"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679413459"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-2390"></a><span>                                </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413453"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-special">(</span><a href="V.html#f%8CBB%7528%5225%51E6%7406"><span class="hs-identifier hs-var">f&#36027;&#29992;&#21029;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413454"><span class="hs-identifier hs-var">stResult</span></a><span> </span><a href="#local-6989586621679413456"><span class="hs-identifier hs-var">stTotal</span></a><span> </span><a href="#local-6989586621679413458"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><a href="#local-6989586621679413460"><span class="hs-identifier hs-var">stToMinus</span></a><span> </span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2391"></a><span>
</span><a name="line-2392"></a><span>                                </span><a name="local-6989586621679413461"><a href="#local-6989586621679413461"><span class="hs-identifier">result</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413454"><span class="hs-identifier hs-var">stResult</span></a><span>
</span><a name="line-2393"></a><span>                                </span><a name="local-6989586621679413462"><a href="#local-6989586621679413462"><span class="hs-identifier">total</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413456"><span class="hs-identifier hs-var">stTotal</span></a><span>
</span><a name="line-2394"></a><span>                                </span><a name="local-6989586621679413463"><a href="#local-6989586621679413463"><span class="hs-identifier">sCost</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413458"><span class="hs-identifier hs-var">stSCost</span></a><span>
</span><a name="line-2395"></a><span>                                </span><a name="local-6989586621679413464"><a href="#local-6989586621679413464"><span class="hs-identifier">toMinus</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413460"><span class="hs-identifier hs-var">stToMinus</span></a><span>
</span><a name="line-2396"></a><span>                                </span><a name="local-6989586621679413465"><a href="#local-6989586621679413465"><span class="hs-identifier">stAdded</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2397"></a><span>
</span><a name="line-2398"></a><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413462"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413451"><span class="hs-identifier hs-var">bl</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2399"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413466"><a href="#local-6989586621679413466"><span class="hs-identifier">added</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">sCost</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679413462"><span class="hs-identifier hs-var">total</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413464"><span class="hs-identifier hs-var">toMinus</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span>
</span><a name="line-2400"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679413458"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679413466"><span class="hs-identifier hs-var">added</span></a><span class="hs-special">)</span><span>
</span><a name="line-2401"></a><span>                                                    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679413465"><span class="hs-identifier hs-var">stAdded</span></a><span> </span><a href="#local-6989586621679413466"><span class="hs-identifier hs-var">added</span></a><span>
</span><a name="line-2402"></a><span>
</span><a name="line-2403"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679413458"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2404"></a><span>                                                    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679413465"><span class="hs-identifier hs-var">stAdded</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2405"></a><span>
</span><a name="line-2406"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679413458"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2407"></a><span>                                                    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679413465"><span class="hs-identifier hs-var">stAdded</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2408"></a><span>                                </span><a name="local-6989586621679413467"><a href="#local-6989586621679413467"><span class="hs-identifier">resultSCost</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413458"><span class="hs-identifier hs-var">stSCost</span></a><span>
</span><a name="line-2409"></a><span>                                </span><a name="local-6989586621679413468"><a href="#local-6989586621679413468"><span class="hs-identifier">added</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413465"><span class="hs-identifier hs-var">stAdded</span></a><span>
</span><a name="line-2410"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413469"><a href="#local-6989586621679413469"><span class="hs-identifier">sCostCar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#22770;&#19978;&#21407;&#20385;&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413467"><span class="hs-identifier hs-var">resultSCost</span></a><span>
</span><a name="line-2411"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413470"><a href="#local-6989586621679413470"><span class="hs-identifier">totalCar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#36027;&#29992;&#32207;&#38989;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413462"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679413462"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413464"><span class="hs-identifier hs-var">toMinus</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679413468"><span class="hs-identifier hs-var">added</span></a><span class="hs-special">)</span><span>
</span><a name="line-2412"></a><span>                                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679413469"><span class="hs-identifier hs-var">sCostCar</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679413470"><span class="hs-identifier hs-var">totalCar</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679413461"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-2413"></a><span>
</span><a name="line-2414"></a><span>
</span><a name="line-2415"></a><span class="hs-identifier">f&#36027;&#29992;&#21029;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412649"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">[</span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412649"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412649"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679412649"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679412649"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2416"></a><a name="f%8CBB%7528%5225%51E6%7406"><a href="V.html#f%8CBB%7528%5225%51E6%7406"><span class="hs-identifier">f&#36027;&#29992;&#21029;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413471"><a href="#local-6989586621679413471"><span class="hs-identifier">result</span></a></a><span> </span><a name="local-6989586621679413472"><a href="#local-6989586621679413472"><span class="hs-identifier">total</span></a></a><span> </span><a name="local-6989586621679413473"><a href="#local-6989586621679413473"><span class="hs-identifier">sCost</span></a></a><span> </span><a name="local-6989586621679413474"><a href="#local-6989586621679413474"><span class="hs-identifier">toMinus</span></a></a><span> </span><a name="local-6989586621679413475"><a href="#local-6989586621679413475"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679413476"><a href="#local-6989586621679413476"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-2417"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#31199;&#31246;&#20844;&#35506;&quot;</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2418"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2419"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413474"><span class="hs-identifier hs-var">toMinus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2420"></a><span>
</span><a name="line-2421"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#32102;&#19982;&#32207;&#38989;&quot;</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2422"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413474"><span class="hs-identifier hs-var">toMinus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2423"></a><span>
</span><a name="line-2424"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#31119;&#21033;&#21402;&#29983;&#36027;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2425"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2426"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413474"><span class="hs-identifier hs-var">toMinus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2427"></a><span>
</span><a name="line-2428"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#25903;&#25173;&#21033;&#24687;&quot;</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2429"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2430"></a><span>
</span><a name="line-2431"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#22320;&#20195;&#23478;&#36035;&quot;</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679413475"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2432"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2433"></a><span>
</span><a name="line-2434"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#28187;&#20385;&#20767;&#21364;&#36027;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679413475"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2435"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2436"></a><span>
</span><a name="line-2437"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#21205;&#29987;&#19981;&#21205;&#29987;&#36035;&#20511;&#26009;&quot;</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679413475"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2438"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2439"></a><span>
</span><a name="line-2440"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#22320;&#20195;&#23478;&#36035;&quot;</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679413475"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2441"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2442"></a><span>
</span><a name="line-2443"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#22770;&#19978;&#21407;&#20385;&quot;</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679413473"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-2444"></a><span>                                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413472"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2445"></a><span>
</span><a name="line-2446"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413476"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;&#36027;&#29992;&#32207;&#38989;&quot;</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2447"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                               </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2448"></a><span>
</span><a name="line-2449"></a><span>
</span><a name="line-2450"></a><span>
</span><a name="line-2451"></a><span>
</span><a name="line-2452"></a><span class="hs-comment">-- ** &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span><span>
</span><a name="line-2453"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2454"></a><span class="hs-comment">{- | 
    * &#35519;&#26619;&#21697;&#30446;&#21029;&#12398;&#28040;&#36027;&#31246;&#12398;&#21152;&#31639;&#20966;&#29702;&#12399;&#65292;&#35506;&#31246;&#65292;&#30452;&#25509;&#36664;&#20986;&#65292;&#12398;&#26377;&#28961;&#12394;&#12393;&#12395;&#12424;&#12387;&#12390;&#20197;&#19979;&#12398;&#65299;&#12497;&#12479;&#12540;&#12531;&#12395;&#21306;&#20998;&#12373;&#12428;&#12427;&#65294;

    &#9312; &#21152;&#31639;&#65297;&#65288;&#35069;&#36896;&#26989;&#12398;&#19968;&#37096;&#12398;&#21697;&#30446;&#65289;
     
        &gt; &#21152;&#31639;&#38989; &#65309;&#65288;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;-&#35519;&#26619;&#21697;&#30446;&#21029;&#30452;&#25509;&#36664;&#20986;&#38989;&#65289;&#215;&#31246;&#29575;

    &#9313; &#21152;&#31639;&#65298;&#65288;&#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#12301;&#21450;&#12403;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12301;&#35519;&#26619;&#31080;&#12398;&#19968;&#37096;&#12398;&#21697;&#30446;&#65289;
     
        &gt; &#21152;&#31639;&#38989;&#65309;&#65288;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;-&#35519;&#26619;&#21697;&#30446;&#21029;&#28023;&#22806;&#21462;&#24341;&#38989;&#65289;&#215;&#31246;&#29575;

    &#9314; &#21152;&#31639;&#65299;
     
        &gt; &#21152;&#31639;&#38989;&#65309;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;&#215;&#31246;&#29575;
    
    * &#35069;&#36896;&#26989;&#12395;&#12362;&#12369;&#12427;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;
    &gt; &#21152;&#31639;&#38989;&#65309;&#35519;&#26619;&#21697;&#30446;&#21029;&#28040;&#36027;&#31246;&#12398;&#21152;&#31639;&#20966;&#29702;&#12395;&#12362;&#12369;&#12427;&#21508;&#35069;&#36896;&#21697;&#12398;&#21152;&#31639;&#38989;&#12398;&#21512;&#35336;

    * &#35069;&#36896;&#26989;&#12399;&#65292;&quot;H&#36664;&#20837;&#21106;&#21512;&quot;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#12399;&#65292;&quot;H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B&quot;&#12362;&#12424;&#12403;&quot;H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#21307;&#30274;&#31119;&#31049;&quot;&#12391;&#21028;&#23450;
    * &#31777;&#21336;&#12398;&#12383;&#12417;&#35069;&#36896;&#26989;&#21450;&#12403;,&#21307;&#30274;&#31119;&#31049;,&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B &#12399;&#20840;&#12390;&#30452;&#25509;&#36664;&#20986;&#12354;&#12426;&#12392;&#12375;&#12390;&#25201;&#12358;
-}</span><span>
</span><a name="line-2475"></a><span>
</span><a name="line-2476"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2477"></a><a name="f%4FA1%683C%5909%63DB_%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><a href="V.html#f%4FA1%683C%5909%63DB_%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a></a><span> </span><a name="local-6989586621679413477"><a href="#local-6989586621679413477"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413478"><a href="#local-6989586621679413478"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679413479"><a href="#local-6989586621679413479"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2478"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413480"><a href="#local-6989586621679413480"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2479"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413480"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2480"></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2481"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2482"></a><span>            </span><a href="VDS.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413481"><a href="#local-6989586621679413481"><span class="hs-identifier">valTar</span></a></a><span>
</span><a name="line-2483"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%8F38%51FA%5272%5408"><span class="hs-identifier hs-var">H&#36664;&#20986;&#21106;&#21512;</span></a><span>                   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413482"><a href="#local-6989586621679413482"><span class="hs-identifier">valEx</span></a></a><span>
</span><a name="line-2484"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-var">H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>       </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413483"><a href="#local-6989586621679413483"><span class="hs-identifier">valSB</span></a></a><span>
</span><a name="line-2485"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%76F8%624B%5148%5225%53CE%5165%5272%5408_%533B%7642%798F%7949"><span class="hs-identifier hs-var">H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#21307;&#30274;&#31119;&#31049;</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413484"><a href="#local-6989586621679413484"><span class="hs-identifier">valMed</span></a></a><span>
</span><a name="line-2486"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413477"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413478"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413481"><span class="hs-identifier hs-var">valTar</span></a><span> </span><a href="#local-6989586621679413482"><span class="hs-identifier hs-var">valEx</span></a><span> </span><a href="#local-6989586621679413483"><span class="hs-identifier hs-var">valSB</span></a><span> </span><a href="#local-6989586621679413484"><span class="hs-identifier hs-var">valMed</span></a><span>
</span><a name="line-2487"></a><span>
</span><a name="line-2488"></a><span class="hs-comment">-- | &#36664;&#20986;&#21106;&#21512;</span><span>
</span><a name="line-2489"></a><span class="hs-keyword">type</span><span> </span><a name="ExportRate"><a href="V.html#ExportRate"><span class="hs-identifier">ExportRate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2490"></a><span>
</span><a name="line-2491"></a><span>
</span><a name="line-2492"></a><span class="hs-comment">-- Null&#12398;&#12392;&#12365;&#12398;&#20966;&#29702;&#12399;,&#36664;&#20986;&#20837;&#12394;&#12375;&#12392;&#12375;&#12390;&#25201;&#12358;( &#20462;&#27491;&#26696; :&#24179;&#22343;&#31561;)</span><span>
</span><a name="line-2493"></a><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-2494"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-2495"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span>
</span><a name="line-2496"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2497"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8F38%51FA%5272%5408"><span class="hs-identifier hs-type">Val&#36664;&#20986;&#21106;&#21512;</span></a><span>
</span><a name="line-2498"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-2499"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span>
</span><a name="line-2500"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2501"></a><a name="f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97%51E6%7406"><a href="V.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97%51E6%7406"><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413485"><a href="#local-6989586621679413485"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413486"><a href="#local-6989586621679413486"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413487"><a href="#local-6989586621679413487"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><a name="local-6989586621679413488"><a href="#local-6989586621679413488"><span class="hs-identifier">valEx</span></a></a><span> </span><a name="local-6989586621679413489"><a href="#local-6989586621679413489"><span class="hs-identifier">valSB</span></a></a><span> </span><a name="local-6989586621679413490"><a href="#local-6989586621679413490"><span class="hs-identifier">valMed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2502"></a><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413491"><a href="#local-6989586621679413491"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413492"><a href="#local-6989586621679413492"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413493"><a href="#local-6989586621679413493"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413494"><a href="#local-6989586621679413494"><span class="hs-identifier">tar</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679413495"><a href="#local-6989586621679413495"><span class="hs-identifier">valEx</span></a></a><span> </span><a name="local-6989586621679413496"><a href="#local-6989586621679413496"><span class="hs-identifier">valSB</span></a></a><span> </span><a name="local-6989586621679413497"><a href="#local-6989586621679413497"><span class="hs-identifier">valMed</span></a></a><span>
</span><a name="line-2503"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413498"><a href="#local-6989586621679413498"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="V.html#f%751F%7523%7269%7A0E%52A0%7B97"><span class="hs-identifier hs-var">f&#29983;&#29987;&#29289;&#31246;&#21152;&#31639;</span></a><span> </span><a href="#local-6989586621679413491"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413493"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413495"><span class="hs-identifier hs-var">valEx</span></a><span> </span><a href="#local-6989586621679413496"><span class="hs-identifier hs-var">valSB</span></a><span> </span><a href="#local-6989586621679413497"><span class="hs-identifier hs-var">valMed</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413494"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-2504"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413492"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679413498"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-2505"></a><span>
</span><a name="line-2506"></a><span class="hs-identifier">f&#29983;&#29987;&#29289;&#31246;&#21152;&#31639;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-2507"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span>
</span><a name="line-2508"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8F38%51FA%5272%5408"><span class="hs-identifier hs-type">Val&#36664;&#20986;&#21106;&#21512;</span></a><span>
</span><a name="line-2509"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-2510"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#21307;&#30274;&#31119;&#31049;</span></a><span>
</span><a name="line-2511"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2512"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2513"></a><span>
</span><a name="line-2514"></a><a name="f%751F%7523%7269%7A0E%52A0%7B97"><a href="V.html#f%751F%7523%7269%7A0E%52A0%7B97"><span class="hs-identifier">f&#29983;&#29987;&#29289;&#31246;&#21152;&#31639;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413499"><a href="#local-6989586621679413499"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679413500"><a href="#local-6989586621679413500"><span class="hs-identifier">ex</span></a></a><span> </span><a name="local-6989586621679413501"><a href="#local-6989586621679413501"><span class="hs-identifier">sb</span></a></a><span> </span><a name="local-6989586621679413502"><a href="#local-6989586621679413502"><span class="hs-identifier">med</span></a></a><span> </span><a name="local-6989586621679413503"><a href="#local-6989586621679413503"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-2515"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#is%88FD%9020%696D"><span class="hs-identifier hs-var">is&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%52A0%7B971"><span class="hs-identifier hs-var">f&#21152;&#31639;1</span></a><span> </span><a href="#local-6989586621679413499"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413500"><span class="hs-identifier hs-var">ex</span></a><span>  </span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2516"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#is%30B5B"><span class="hs-identifier hs-var">is&#12469;B</span></a><span>    </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%52A0%7B972"><span class="hs-identifier hs-var">f&#21152;&#31639;2</span></a><span> </span><a href="#local-6989586621679413499"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413501"><span class="hs-identifier hs-var">sb</span></a><span>  </span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2517"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="V.html#is%533B%7642"><span class="hs-identifier hs-var">is&#21307;&#30274;</span></a><span>   </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%52A0%7B972"><span class="hs-identifier hs-var">f&#21152;&#31639;2</span></a><span> </span><a href="#local-6989586621679413499"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413502"><span class="hs-identifier hs-var">med</span></a><span> </span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2518"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%52A0%7B973"><span class="hs-identifier hs-var">f&#21152;&#31639;3</span></a><span> </span><a href="#local-6989586621679413499"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2519"></a><span>
</span><a name="line-2520"></a><span class="hs-identifier">f&#21152;&#31639;1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%8F38%51FA%5272%5408"><span class="hs-identifier hs-type">Val&#36664;&#20986;&#21106;&#21512;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2521"></a><a name="f%52A0%7B971"><a href="V.html#f%52A0%7B971"><span class="hs-identifier">f&#21152;&#31639;1</span></a></a><span> </span><a name="local-6989586621679413504"><a href="#local-6989586621679413504"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413505"><a href="#local-6989586621679413505"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413506"><a href="#local-6989586621679413506"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413505"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413506"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2522"></a><span class="hs-identifier">f&#21152;&#31639;1</span><span> </span><a name="local-6989586621679413507"><a href="#local-6989586621679413507"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413508"><a href="#local-6989586621679413508"><span class="hs-identifier">ex</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413509"><a href="#local-6989586621679413509"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413510"><a href="#local-6989586621679413510"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413509"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413509"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413509"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413508"><span class="hs-identifier hs-var">ex</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413507"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413510"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2523"></a><span>
</span><a name="line-2524"></a><span class="hs-identifier">f&#21152;&#31639;2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2525"></a><a name="f%52A0%7B972"><a href="V.html#f%52A0%7B972"><span class="hs-identifier">f&#21152;&#31639;2</span></a></a><span> </span><a name="local-6989586621679413511"><a href="#local-6989586621679413511"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                   </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413512"><a href="#local-6989586621679413512"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413513"><a href="#local-6989586621679413513"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413512"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413513"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2526"></a><span class="hs-identifier">f&#21152;&#31639;2</span><span> </span><a name="local-6989586621679413514"><a href="#local-6989586621679413514"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-var">V&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><a name="local-6989586621679413515"><a href="#local-6989586621679413515"><span class="hs-identifier">ex</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413516"><a href="#local-6989586621679413516"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413517"><a href="#local-6989586621679413517"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413516"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413516"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413516"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#28023;&#22806;&#21462;&#24341;</span><span> </span><a href="#local-6989586621679413515"><span class="hs-identifier hs-var">ex</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413514"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413517"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2527"></a><span>
</span><a name="line-2528"></a><span>
</span><a name="line-2529"></a><span class="hs-identifier">f&#21152;&#31639;3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2530"></a><a name="f%52A0%7B973"><a href="V.html#f%52A0%7B973"><span class="hs-identifier">f&#21152;&#31639;3</span></a></a><span> </span><a name="local-6989586621679413518"><a href="#local-6989586621679413518"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413519"><a href="#local-6989586621679413519"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413520"><a href="#local-6989586621679413520"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413519"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413518"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413520"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2531"></a><span>
</span><a name="line-2532"></a><span>
</span><a name="line-2533"></a><span class="hs-identifier">is&#12469;B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2534"></a><a name="is%30B5B"><a href="V.html#is%30B5B"><span class="hs-identifier">is&#12469;B</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413521"><a href="#local-6989586621679413521"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413521"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;39&quot;</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2535"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413521"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;40&quot;</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2536"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413521"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;83&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413521"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;85&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2537"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413521"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;95&quot;</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2538"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2539"></a><span>
</span><a name="line-2540"></a><span>
</span><a name="line-2541"></a><span class="hs-identifier">is&#21307;&#30274;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2542"></a><a name="is%533B%7642"><a href="V.html#is%533B%7642"><span class="hs-identifier">is&#21307;&#30274;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413522"><a href="#local-6989586621679413522"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413522"><span class="hs-identifier hs-var">ca</span></a><span>             </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;PZZZ&quot;</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2543"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413522"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;68&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413522"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;92&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2544"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2545"></a><span>
</span><a name="line-2546"></a><span class="hs-identifier">is&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2547"></a><a name="is%88FD%9020%696D"><a href="V.html#is%88FD%9020%696D"><span class="hs-identifier">is&#35069;&#36896;&#26989;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413523"><a href="#local-6989586621679413523"><span class="hs-identifier">ca</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413523"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;09&quot;</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2548"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413523"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;10&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413523"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;32&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2549"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2550"></a><span>
</span><a name="line-2551"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2552"></a><span class="hs-comment">-- * &#21517;&#23492;&#12379;</span><span>
</span><a name="line-2553"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2554"></a><span>
</span><a name="line-2555"></a><span class="hs-keyword">type</span><span> </span><a name="EnDivideMap"><a href="V.html#EnDivideMap"><span class="hs-identifier">EnDivideMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="VDS.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">,</span><a href="VDS.html#Header"><span class="hs-identifier hs-type">Header</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2556"></a><span>
</span><a name="line-2557"></a><span>
</span><a name="line-2558"></a><span class="hs-comment">{- |   

    V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#24517;&#35201;&#12394;&#38917;&#30446;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#12300;&#20225;&#26989;&#20840;&#20307;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#65292;
     &#36027;&#29992;&#32207;&#38989;&#21450;&#12403;&#36027;&#29992;&#20869;&#35379;&#12301;&#65288;&#22770;&#19978;&#39640;&#26410;&#25226;&#25569;&#20107;&#26989;&#25152;&#12398;&#35036;&#23450;&#65292;VAT&#25512;&#35336;&#21450;&#12403;&#12510;&#12540;&#12472;&#12531;&#38989;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#65292;
     &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;&#65292;&#12300;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#65292;&#12300;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#12301;&#65288;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#12398;&#65299;&#38917;&#30446;&#65294;
    
    &#35036;&#23450;&#12399;&#26082;&#12395;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;,&#12371;&#12371;&#12391;&#12399;,&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#29992;&#12395;
    &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#65292;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65292;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#65379;&#12392;&#65292;&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;&#12398;&#12510;&#12483;&#12503;&#12434;&#20316;&#25104;&#12377;&#12427;&#65294;
    
    &#21830;&#26989;&#12398;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#22580;&#21512;&#12398;&#12415;

-}</span><span>
</span><a name="line-2570"></a><span>
</span><a name="line-2571"></a><span class="hs-identifier">f&#21517;&#23492;&#12379;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412648"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679412648"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="V.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span>
</span><a name="line-2572"></a><a name="f%540D%5BC4%305B"><a href="V.html#f%540D%5BC4%305B"><span class="hs-identifier">f&#21517;&#23492;&#12379;</span></a></a><span> </span><a name="local-6989586621679413524"><a href="#local-6989586621679413524"><span class="hs-identifier">edm</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413525"><a href="#local-6989586621679413525"><span class="hs-identifier">maybeIcd</span></a></a><span>
</span><a name="line-2573"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413525"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2574"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413524"><span class="hs-identifier hs-var">edm</span></a><span>
</span><a name="line-2575"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413526"><a href="#local-6989586621679413526"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413526"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413527"><a href="#local-6989586621679413527"><span class="hs-identifier">kind</span></a></a><span>
</span><a name="line-2576"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="V.html#isEN"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679413527"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2577"></a><span>                                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="V.html#f%5546%696D%4F01%696D%9805%76EE%53D6%5F97"><span class="hs-identifier hs-var">f&#21830;&#26989;&#20225;&#26989;&#38917;&#30446;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679413526"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413524"><span class="hs-identifier hs-var">edm</span></a><span>
</span><a name="line-2578"></a><span>                                 </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2579"></a><span>                         </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%540D%5BC4%305B"><span class="hs-identifier hs-var">f&#21517;&#23492;&#12379;</span></a><span> </span><a href="#local-6989586621679413524"><span class="hs-identifier hs-var">edm</span></a><span>
</span><a name="line-2580"></a><span>
</span><a name="line-2581"></a><span>
</span><a name="line-2582"></a><span class="hs-comment">-- | &#20225;&#26989;&#12414;&#12383;&#12399;&#65292;&#22243;&#20307;&#12363;&#12434;&#21028;&#26029;&#12377;&#12427;</span><span>
</span><a name="line-2583"></a><span class="hs-comment">--   Nothing &#12398;&#26178;&#12399;&#38500;&#22806;</span><span>
</span><a name="line-2584"></a><span>
</span><a name="line-2585"></a><span class="hs-identifier">isEN</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2586"></a><a name="isEN"><a href="V.html#isEN"><span class="hs-identifier">isEN</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2587"></a><span class="hs-identifier">isEN</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413528"><a href="#local-6989586621679413528"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679413529"><a href="#local-6989586621679413529"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679413530"><a href="#local-6989586621679413530"><span class="hs-identifier">subject</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2588"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413528"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%4F01%696D%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#20225;&#26989;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413528"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%56E3%4F53%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#22243;&#20307;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413530"><span class="hs-identifier hs-var">subject</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%56E3%4F53%6CD5%4EBA%7528"><span class="hs-identifier hs-var">E&#22243;&#20307;&#27861;&#20154;&#29992;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2589"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2590"></a><span>
</span><a name="line-2591"></a><span>
</span><a name="line-2592"></a><span class="hs-identifier">f&#21830;&#26989;&#20225;&#26989;&#38917;&#30446;&#21462;&#24471;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2593"></a><a name="f%5546%696D%4F01%696D%9805%76EE%53D6%5F97"><a href="V.html#f%5546%696D%4F01%696D%9805%76EE%53D6%5F97"><span class="hs-identifier">f&#21830;&#26989;&#20225;&#26989;&#38917;&#30446;&#21462;&#24471;</span></a></a><span> </span><a name="local-6989586621679413531"><a href="#local-6989586621679413531"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679413532"><a href="#local-6989586621679413532"><span class="hs-identifier">edm</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413531"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413533"><a href="#local-6989586621679413533"><span class="hs-identifier">link</span></a></a><span>
</span><a name="line-2594"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413533"><span class="hs-identifier hs-var">link</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2595"></a><span>                                </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2596"></a><span>                                </span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413534"><a href="#local-6989586621679413534"><span class="hs-identifier">tx</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413535"><a href="#local-6989586621679413535"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">TL.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413534"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-2597"></a><span>                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413536"><a href="#local-6989586621679413536"><span class="hs-identifier">h</span></a></a><span>
</span><a name="line-2598"></a><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413531"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413536"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413537"><a href="#local-6989586621679413537"><span class="hs-identifier">tmpVal</span></a></a><span>
</span><a name="line-2599"></a><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413537"><span class="hs-identifier hs-var">tmpVal</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2600"></a><span>                                                        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2601"></a><span>                                                        </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413538"><a href="#local-6989586621679413538"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413532"><span class="hs-identifier hs-var">edm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413535"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679413536"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413538"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-2602"></a><span>
</span><a name="line-2603"></a><span class="hs-identifier">getDoubleFromVal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#ValDouble"><span class="hs-identifier hs-type">ValDouble</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2604"></a><a name="getDoubleFromVal"><a href="V.html#getDoubleFromVal"><span class="hs-identifier">getDoubleFromVal</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2605"></a><span class="hs-identifier">getDoubleFromVal</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413539"><a href="#local-6989586621679413539"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413539"><span class="hs-identifier hs-var">dl</span></a><span>
</span><a name="line-2606"></a><span>
</span><a name="line-2607"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2608"></a><span class="hs-comment">-- * &#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;</span><span>
</span><a name="line-2609"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2610"></a><span>
</span><a name="line-2611"></a><span class="hs-comment">{- |&#31532;12&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12395;&#12362;&#12369;&#12427;&#65288;&#32068;&#26367;&#65289;&#38598;&#35336;&#19978;&#12398;&#30041;&#24847;&#20107;&#38917;&#12398;&#19968;&#12388;&#12395;&#65292;
    &#12300;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12375;&#12363;&#12487;&#12540;&#12479;&#12364;&#12394;&#12356;&#38917;&#30446;&#65288;&#35373;&#20633;&#25237;&#36039;&#65292;&#36027;&#29992;&#12395;&#20418;&#12427;&#38917;&#30446;&#12394;&#12393;&#65289;&#12395;&#12388;&#12356;&#12390;&#12399;&#65292;
    &#20107;&#26989;&#25152;&#21029;&#24467;&#26989;&#32773;&#25968;&#31561;&#12391;&#26696;&#20998;&#12375;&#12390;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#65292;&#20107;&#26989;&#25152;&#21029;&#12487;&#12540;&#12479;&#12395;&#22793;&#25563;&#12375;&#12390;&#12363;&#12425;&#32068;&#26367;&#38598;&#35336;&#12434;&#23455;&#26045;&#12301;
    &#12300;&#12383;&#12384;&#12375;&#65292;&#35079;&#25968;&#20107;&#26989;&#25152;&#12434;&#26377;&#12377;&#12427;&#20225;&#26989;&#12391;&#12354;&#12387;&#12390;&#65292;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#22411;&#29987;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#12418;&#12398;&#12395;&#12388;&#12356;&#12390;&#12399;&#65292;
    &#22770;&#19978;&#39640;&#21450;&#12403;&#36027;&#29992;&#20849;&#12395;&#20107;&#26989;&#25152;&#31080;&#12391;&#25226;&#25569;&#12373;&#12428;&#12394;&#12356;&#12371;&#12392;&#12363;&#12425;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12301;&#12392;&#12398;&#35352;&#36617;&#12364;&#12354;&#12427;&#65294;
    
     V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#24517;&#35201;&#12394;&#38917;&#30446;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#12300;&#20225;&#26989;&#20840;&#20307;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#65292;
     &#36027;&#29992;&#32207;&#38989;&#21450;&#12403;&#36027;&#29992;&#20869;&#35379;&#12301;&#65288;&#22770;&#19978;&#39640;&#26410;&#25226;&#25569;&#20107;&#26989;&#25152;&#12398;&#35036;&#23450;&#65292;VAT&#25512;&#35336;&#21450;&#12403;&#12510;&#12540;&#12472;&#12531;&#38989;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#65292;
     &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;&#65292;&#12300;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#65292;&#12300;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#12301;&#65288;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#12398;&#65299;&#38917;&#30446;&#65294;
    
    &#35036;&#23450;&#12399;&#26082;&#12395;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;,&#12371;&#12371;&#12391;&#12399;,&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#29992;&#12395;
    &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#65292;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65292;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#65379;&#12398;&#12415;&#20998;&#21106;&#12377;&#12427;.

     &#12381;&#12398;&#20855;&#20307;&#30340;&#12394;&#25163;&#27861;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#31558;&#32773;&#12398;&#35519;&#12409;&#12427;&#38480;&#12426;&#36039;&#26009;&#12364;&#23384;&#22312;&#12375;&#12394;&#12356;&#12364;&#65292;
     &#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#12395;&#38306;&#12377;&#12427;&#35430;&#31639;&#12364;HP&#12300;&#65288;&#21442;&#32771;&#65289;&#20840;&#29987;&#26989;&#12398;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12395;&#38306;&#12377;&#12427;&#35430;&#31639;&#20516;&#12301; 
     &#12395;&#12362;&#12356;&#12390;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

    X[v],x_i [v]&#12364;&#12381;&#12428;&#12382;&#12428;&#65292;&#20225;&#26989;&#12398;v&#12398;&#20516;&#65292;&#20225;&#26989;&#20632;&#19979;&#20107;&#26989;&#25152;&#12398;&#20869;&#25972;&#29702;&#30058;&#21495;i&#12398;v&#12398;&#20516;&#12434;&#34920;&#12377;&#12392;&#12375;&#65292;
    &#12354;&#12427;&#20225;&#26989;&#12395;&#23646;&#12377;&#12409;&#12390;&#12398;&#20107;&#26989;&#25152;&#12398;&#25972;&#29702;&#30058;&#21495;&#12434;I&#12392;&#12377;&#12427;&#65294;I&#12398;&#12358;&#12385;&#65292;&#20998;&#21106;&#23550;&#35937;&#12395;&#23646;&#12377;&#12427;&#37096;&#20998;&#12434;IN,&#12381;&#12428;&#12356;&#12364;&#12356;&#12434;OUT&#12392;&#12377;&#12427;&#65294;
    &#12414;&#12383;&#65292;&#12354;&#12427;&#20107;&#26989;&#25152;i&#12398;&#20027;&#26989;&#12398;&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#12434;weight[i]&#12392;&#12377;&#12427;&#12392;&#65292;&#20225;&#26989;&#12363;&#12425;&#20998;&#21106;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#20516;&#12399;&#65292;

    [\  x_i= (X[v] - \sum_{j \in OUT} x_j [v]) \times \frac{x_i [w]&#215;weight[i]}{\sum_{i &#8712; I}{x_i [w]&#215; weight[i]}} \]

    &#12392;&#12394;&#12427;&#65294;&#12394;&#12362;&#65292;&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#12399;&#65292;&#29987;&#26989;&#22823;&#20998;&#39006;&#12372;&#12392;&#12395;&#65292;&#20027;&#29987;&#26989;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;&#21512;&#35336;&#12364;&#65292;
    &#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;70%&#20197;&#19978;&#12392;&#12394;&#12427;&#20225;&#26989;&#65288;&#21336;&#19968;&#29987;&#26989;&#20225;&#26989;&#65289;&#20840;&#20307;&#12398;&#22770;&#19978;&#39640;&#12434;&#65292;&#24403;&#35442;&#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#12391;&#38500;&#12375;&#12390;&#27714;&#12417;&#12427;&#65294;
    
    &#12371;&#12371;&#12391;&#65292;&#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#65292;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65292;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#65379;&#12399;&#21830;&#26989;&#12434;&#34892;&#12387;&#12390;&#12356;&#12394;&#12356;&#20107;&#26989;&#25152;&#12391;&#12399;&#30330;&#29983;&#12375;&#12394;&#12356;&#12383;&#12417;

    [\ \sum_{j \in OUT} x_j [v] = 0\]

    &#12391;&#12354;&#12427;&#12363;&#12425;
    
    [\  x_i= X[v] \times \frac{x_i [w]&#215;weight[i]}{\sum_{i &#8712; I}{x_i [w]&#215; weight[i]}} \]
    
    &#12364;&#25104;&#12426;&#31435;&#12388;&#65294;
    
-}</span><span>
</span><a name="line-2648"></a><span>
</span><a name="line-2649"></a><span>
</span><a name="line-2650"></a><span>
</span><a name="line-2651"></a><span class="hs-identifier">f&#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span>  </span><a href="#local-6989586621679412647"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="V.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="V.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412647"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2652"></a><a name="f%4F01%696D%306E%4E8B%696D%6240%3078%306E%5206%5272"><a href="V.html#f%4F01%696D%306E%4E8B%696D%6240%3078%306E%5206%5272"><span class="hs-identifier">f&#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;</span></a></a><span> </span><a name="local-6989586621679413540"><a href="#local-6989586621679413540"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679413541"><a href="#local-6989586621679413541"><span class="hs-identifier">edm</span></a></a><span> </span><a name="local-6989586621679413542"><a href="#local-6989586621679413542"><span class="hs-identifier">dm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2653"></a><span>        </span><a name="local-6989586621679413570"><a href="#local-6989586621679413570"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-2654"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413570"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2655"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2656"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413571"><a href="#local-6989586621679413571"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2657"></a><span>                </span><a name="local-6989586621679413572"><a href="#local-6989586621679413572"><span class="hs-identifier">valLink</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413571"><span class="hs-identifier hs-var">icd</span></a><span>  </span><a href="VDS.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span>
</span><a name="line-2658"></a><span>                </span><a name="local-6989586621679413573"><a href="#local-6989586621679413573"><span class="hs-identifier">valEmp</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413571"><span class="hs-identifier hs-var">icd</span></a><span>  </span><a href="VDS.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-2659"></a><span>                </span><a name="local-6989586621679413574"><a href="#local-6989586621679413574"><span class="hs-identifier">valClass</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413571"><span class="hs-identifier hs-var">icd</span></a><span>  </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-2660"></a><span>                </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413575"><a href="#local-6989586621679413575"><span class="hs-identifier">h</span></a></a><span>
</span><a name="line-2661"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413543"><span class="hs-identifier hs-var">culc</span></a><span> </span><a href="#local-6989586621679413571"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413540"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679413541"><span class="hs-identifier hs-var">edm</span></a><span> </span><a href="#local-6989586621679413542"><span class="hs-identifier hs-var">dm</span></a><span> </span><a href="#local-6989586621679413572"><span class="hs-identifier hs-var">valLink</span></a><span> </span><a href="#local-6989586621679413574"><span class="hs-identifier hs-var">valClass</span></a><span> </span><a href="#local-6989586621679413573"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679413575"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-2662"></a><span>                </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679413571"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2663"></a><span>                </span><a href="V.html#f%4F01%696D%306E%4E8B%696D%6240%3078%306E%5206%5272"><span class="hs-identifier hs-var">f&#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;</span></a><span> </span><a href="#local-6989586621679413540"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679413541"><span class="hs-identifier hs-var">edm</span></a><span> </span><a href="#local-6989586621679413542"><span class="hs-identifier hs-var">dm</span></a><span>
</span><a name="line-2664"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2665"></a><span>    </span><span class="hs-identifier">culc</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2666"></a><span>    </span><a name="local-6989586621679413543"><a href="#local-6989586621679413543"><span class="hs-identifier">culc</span></a></a><span> </span><a name="local-6989586621679413545"><a href="#local-6989586621679413545"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679413546"><a href="#local-6989586621679413546"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679413547"><a href="#local-6989586621679413547"><span class="hs-identifier">edm</span></a></a><span> </span><a name="local-6989586621679413548"><a href="#local-6989586621679413548"><span class="hs-identifier">dm</span></a></a><span> </span><a name="local-6989586621679413549"><a href="#local-6989586621679413549"><span class="hs-identifier">valLink</span></a></a><span> </span><a name="local-6989586621679413550"><a href="#local-6989586621679413550"><span class="hs-identifier">valKind</span></a></a><span> </span><a name="local-6989586621679413551"><a href="#local-6989586621679413551"><span class="hs-identifier">valEmp</span></a></a><span> </span><a name="local-6989586621679413552"><a href="#local-6989586621679413552"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413551"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">,</span><a href="#local-6989586621679413550"><span class="hs-identifier hs-var">valKind</span></a><span class="hs-special">,</span><a href="#local-6989586621679413549"><span class="hs-identifier hs-var">valLink</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2667"></a><span>        </span><span class="hs-special">(</span><a href="VDS.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679413553"><a href="#local-6989586621679413553"><span class="hs-identifier">emp</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413554"><a href="#local-6989586621679413554"><span class="hs-identifier">kind</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413555"><a href="#local-6989586621679413555"><span class="hs-identifier">tx</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413556"><a href="#local-6989586621679413556"><span class="hs-identifier">worker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413553"><span class="hs-identifier hs-var">emp</span></a><span class="hs-special">)</span><span>
</span><a name="line-2668"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413557"><a href="#local-6989586621679413557"><span class="hs-identifier">lInd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679413554"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-2669"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413558"><a href="#local-6989586621679413558"><span class="hs-identifier">top</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">TL.init</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413555"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-2670"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679413544"><span class="hs-identifier hs-var">ifNotNull</span></a><span> </span><a href="#local-6989586621679413545"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413546"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679413547"><span class="hs-identifier hs-var">edm</span></a><span> </span><a href="#local-6989586621679413548"><span class="hs-identifier hs-var">dm</span></a><span> </span><a href="#local-6989586621679413558"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679413557"><span class="hs-identifier hs-var">lInd</span></a><span> </span><a href="#local-6989586621679413556"><span class="hs-identifier hs-var">worker</span></a><span> </span><a href="#local-6989586621679413552"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-2671"></a><span>        </span><span class="hs-identifier">_</span><span>                                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2672"></a><span>
</span><a name="line-2673"></a><span>    </span><span class="hs-identifier">ifNotNull</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2674"></a><span>    </span><a name="local-6989586621679413544"><a href="#local-6989586621679413544"><span class="hs-identifier">ifNotNull</span></a></a><span> </span><a name="local-6989586621679413559"><a href="#local-6989586621679413559"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679413560"><a href="#local-6989586621679413560"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679413561"><a href="#local-6989586621679413561"><span class="hs-identifier">edm</span></a></a><span> </span><a name="local-6989586621679413562"><a href="#local-6989586621679413562"><span class="hs-identifier">dm</span></a></a><span> </span><a name="local-6989586621679413563"><a href="#local-6989586621679413563"><span class="hs-identifier">top</span></a></a><span> </span><a name="local-6989586621679413564"><a href="#local-6989586621679413564"><span class="hs-identifier">lInd</span></a></a><span> </span><a name="local-6989586621679413565"><a href="#local-6989586621679413565"><span class="hs-identifier">worker</span></a></a><span> </span><a name="local-6989586621679413566"><a href="#local-6989586621679413566"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413564"><span class="hs-identifier hs-var">lInd</span></a><span class="hs-special">,</span><a href="#local-6989586621679413566"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413560"><span class="hs-identifier hs-var">iwm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413563"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679413566"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413561"><span class="hs-identifier hs-var">edm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413563"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413566"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413562"><span class="hs-identifier hs-var">dm</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2675"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413567"><a href="#local-6989586621679413567"><span class="hs-identifier">weight</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413568"><a href="#local-6989586621679413568"><span class="hs-identifier">enV</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413569"><a href="#local-6989586621679413569"><span class="hs-identifier">denomi</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413559"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413566"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621679413568"><span class="hs-identifier hs-var">enV</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413565"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413567"><span class="hs-identifier hs-var">weight</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679413569"><span class="hs-identifier hs-var">denomi</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2676"></a><span>        </span><span class="hs-identifier">_</span><span>                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2677"></a><span>
</span><a name="line-2678"></a><span>
</span><a name="line-2679"></a><span class="hs-comment">-- | &#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#12392;&#65292;&#21517;&#23492;&#12379;&#12434;&#21516;&#26178;&#12395;&#34892;&#12358;</span><span>
</span><a name="line-2680"></a><span class="hs-identifier">getWeightAndLink</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span class="hs-special">,</span><span> </span><a href="V.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-2681"></a><a name="getWeightAndLink"><a href="V.html#getWeightAndLink"><span class="hs-identifier">getWeightAndLink</span></a></a><span> </span><a name="local-6989586621679413576"><a href="#local-6989586621679413576"><span class="hs-identifier">input</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413577"><a href="#local-6989586621679413577"><span class="hs-identifier">empMap1</span></a></a><span>
</span><a name="line-2682"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413578"><a href="#local-6989586621679413578"><span class="hs-identifier">empMap2</span></a></a><span>
</span><a name="line-2683"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">runConduitRes</span><span>
</span><a name="line-2684"></a><span>                        </span><span class="hs-operator hs-var">$</span><span>  </span><a href="VDS.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679413576"><span class="hs-identifier hs-var">input</span></a><span>
</span><a name="line-2685"></a><span>                        </span><span class="hs-operator hs-var">.|</span><span> </span><span class="hs-identifier">getZipSink</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">ZipSink</span><span> </span><span class="hs-special">(</span><a href="V.html#f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679413577"><span class="hs-identifier hs-var">empMap1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">ZipSink</span><span> </span><span class="hs-special">(</span><a href="V.html#f%540D%5BC4%305B"><span class="hs-identifier hs-var">f&#21517;&#23492;&#12379;</span></a><span> </span><a href="#local-6989586621679413578"><span class="hs-identifier hs-var">empMap2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2686"></a><span>
</span><a name="line-2687"></a><span>
</span><a name="line-2688"></a><span class="hs-comment">-- | &#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;&#12398;&#19979;&#65298;&#26689;&#24847;&#22806;&#12392;&#65292;&#20998;&#27597; [\ \sum_{i &#8712; I}{x_i [w]&#215; weight[i]} \] &#12398;Map</span><span>
</span><a name="line-2689"></a><span class="hs-keyword">type</span><span> </span><a name="DenomiMap"><a href="V.html#DenomiMap"><span class="hs-identifier">DenomiMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="VDS.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Header"><span class="hs-identifier hs-type">Header</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2690"></a><span>
</span><a name="line-2691"></a><span>
</span><a name="line-2692"></a><span class="hs-comment">-- | &#20225;&#26989;&#21029;&#12398;&#20998;&#27597; [\ \sum_{i &#8712; I}{x_i [w]&#215; weight[i]} \] &#12434;&#27714;&#12417;&#12427;</span><span>
</span><a name="line-2693"></a><span class="hs-identifier">getDenomiMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412646"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412646"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="V.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span>
</span><a name="line-2694"></a><a name="getDenomiMap"><a href="V.html#getDenomiMap"><span class="hs-identifier">getDenomiMap</span></a></a><span> </span><a name="local-6989586621679413579"><a href="#local-6989586621679413579"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679413580"><a href="#local-6989586621679413580"><span class="hs-identifier">dmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2695"></a><span>        </span><a name="local-6989586621679413604"><a href="#local-6989586621679413604"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-2696"></a><span>        </span><a name="local-6989586621679413605"><a href="#local-6989586621679413605"><span class="hs-identifier">tmpMap</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span class="hs-special">)</span><span>
</span><a name="line-2697"></a><span>        </span><span class="hs-comment">-----------------------------------------------------------  </span><span>
</span><a name="line-2698"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413604"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2699"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413580"><span class="hs-identifier hs-var">dmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-2700"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413606"><a href="#local-6989586621679413606"><span class="hs-identifier">icd</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2701"></a><span>                </span><a name="local-6989586621679413607"><a href="#local-6989586621679413607"><span class="hs-identifier">valLink</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413606"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2702"></a><span>                </span><a name="local-6989586621679413608"><a href="#local-6989586621679413608"><span class="hs-identifier">valType</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413606"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2703"></a><span>                </span><a name="local-6989586621679413609"><a href="#local-6989586621679413609"><span class="hs-identifier">valEmp</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413606"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2704"></a><span>                </span><a name="local-6989586621679413610"><a href="#local-6989586621679413610"><span class="hs-identifier">valKind</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413606"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2705"></a><span>                </span><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2706"></a><span>                </span><span class="hs-keyword">case</span><span> </span><a href="V.html#isEN"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679413608"><span class="hs-identifier hs-var">valType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2707"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413581"><span class="hs-identifier hs-var">ifNotEn</span></a><span> </span><a href="#local-6989586621679413605"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><a href="#local-6989586621679413607"><span class="hs-identifier hs-var">valLink</span></a><span> </span><a href="#local-6989586621679413609"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679413610"><span class="hs-identifier hs-var">valKind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#getDenomiMap"><span class="hs-identifier hs-var">getDenomiMap</span></a><span> </span><a href="#local-6989586621679413579"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679413580"><span class="hs-identifier hs-var">dmp</span></a><span>
</span><a name="line-2708"></a><span>                    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#getDenomiMap"><span class="hs-identifier hs-var">getDenomiMap</span></a><span> </span><a href="#local-6989586621679413579"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679413580"><span class="hs-identifier hs-var">dmp</span></a><span>
</span><a name="line-2709"></a><span>
</span><a name="line-2710"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2711"></a><span>    </span><span class="hs-identifier">ifNotEn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2712"></a><span>    </span><a name="local-6989586621679413581"><a href="#local-6989586621679413581"><span class="hs-identifier">ifNotEn</span></a></a><span> </span><a name="local-6989586621679413584"><a href="#local-6989586621679413584"><span class="hs-identifier">tmpMap</span></a></a><span> </span><a name="local-6989586621679413585"><a href="#local-6989586621679413585"><span class="hs-identifier">valLink</span></a></a><span> </span><a name="local-6989586621679413586"><a href="#local-6989586621679413586"><span class="hs-identifier">valEmp</span></a></a><span> </span><a name="local-6989586621679413587"><a href="#local-6989586621679413587"><span class="hs-identifier">valKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413585"><span class="hs-identifier hs-var">valLink</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2713"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2714"></a><span>        </span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413588"><a href="#local-6989586621679413588"><span class="hs-identifier">link</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413589"><a href="#local-6989586621679413589"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">TL.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413588"><span class="hs-identifier hs-var">link</span></a><span>
</span><a name="line-2715"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413584"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413590"><a href="#local-6989586621679413590"><span class="hs-identifier">redMap</span></a></a><span>
</span><a name="line-2716"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413591"><a href="#local-6989586621679413591"><span class="hs-identifier">h</span></a></a><span>
</span><a name="line-2717"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413589"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679413591"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413590"><span class="hs-identifier hs-var">redMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2718"></a><span>                        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413582"><span class="hs-identifier hs-var">modifyPart</span></a><span> </span><a href="#local-6989586621679413591"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679413587"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679413579"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679413584"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><a href="#local-6989586621679413586"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679413589"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2719"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413592"><a href="#local-6989586621679413592"><span class="hs-identifier">num</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413582"><span class="hs-identifier hs-var">modifyPart</span></a><span> </span><a href="#local-6989586621679413591"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679413587"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679413579"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679413584"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><a href="#local-6989586621679413586"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679413589"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679413592"><span class="hs-identifier hs-var">num</span></a><span>
</span><a name="line-2720"></a><span>
</span><a name="line-2721"></a><span>    </span><span class="hs-identifier">modifyPart</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2722"></a><span>    </span><a name="local-6989586621679413582"><a href="#local-6989586621679413582"><span class="hs-identifier">modifyPart</span></a></a><span> </span><a name="local-6989586621679413593"><a href="#local-6989586621679413593"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679413594"><a href="#local-6989586621679413594"><span class="hs-identifier">valKind</span></a></a><span> </span><a name="local-6989586621679413595"><a href="#local-6989586621679413595"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679413596"><a href="#local-6989586621679413596"><span class="hs-identifier">tmpMap</span></a></a><span> </span><a name="local-6989586621679413597"><a href="#local-6989586621679413597"><span class="hs-identifier">valEmp</span></a></a><span> </span><a name="local-6989586621679413598"><a href="#local-6989586621679413598"><span class="hs-identifier">top</span></a></a><span> </span><a name="local-6989586621679413599"><a href="#local-6989586621679413599"><span class="hs-identifier">num</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413594"><span class="hs-identifier hs-var">valKind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2723"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2724"></a><span>        </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413600"><a href="#local-6989586621679413600"><span class="hs-identifier">kind</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413601"><a href="#local-6989586621679413601"><span class="hs-identifier">lInd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679413600"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-2725"></a><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413601"><span class="hs-identifier hs-var">lInd</span></a><span class="hs-special">,</span><a href="#local-6989586621679413593"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413595"><span class="hs-identifier hs-var">iwm</span></a><span>  </span><span class="hs-keyword">of</span><span>
</span><a name="line-2726"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2727"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413602"><a href="#local-6989586621679413602"><span class="hs-identifier">weight</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413596"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413598"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679413593"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413599"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679413583"><span class="hs-identifier hs-var">getWorker</span></a><span> </span><a href="#local-6989586621679413597"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413602"><span class="hs-identifier hs-var">weight</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2728"></a><span>
</span><a name="line-2729"></a><span>    </span><span class="hs-comment">-- &#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#12434;&#12392;&#12427;</span><span>
</span><a name="line-2730"></a><span>    </span><span class="hs-identifier">getWorker</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2731"></a><span>    </span><a name="local-6989586621679413583"><a href="#local-6989586621679413583"><span class="hs-identifier">getWorker</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2732"></a><span>    </span><span class="hs-identifier">getWorker</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679413603"><a href="#local-6989586621679413603"><span class="hs-identifier">emp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413603"><span class="hs-identifier hs-var">emp</span></a><span class="hs-special">)</span><span>
</span><a name="line-2733"></a><span>
</span><a name="line-2734"></a><span>
</span><a name="line-2735"></a><span class="hs-comment">{- | &#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;
    &#29987;&#26989;&#22823;&#20998;&#39006;&#12372;&#12392;&#12395;&#65292;&#20027;&#29987;&#26989;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;&#21512;&#35336;&#12364;&#65292;  
    &#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;70%&#20197;&#19978;&#12392;&#12394;&#12427;&#20225;&#26989;&#65288;&#21336;&#19968;&#29987;&#26989;&#20225;&#26989;&#65289;&#20840;&#20307;&#12398;&#23550;&#35937;&#12398;&#20516;&#12434;&#65292;&#24403;&#35442;&#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#12391;&#38500;&#12375;&#12390;&#27714;&#12417;&#12427;
    
    &#22823;&#20998;&#39006;&#20197;&#19979;&#12398;&#32048;&#12363;&#12356;&#20998;&#39006;&#12391;&#12371;&#12428;&#12434;&#34892;&#12387;&#12390;&#12418;&#12424;&#12356;&#65288;&#35201;&#20462;&#27491;&#65289;

-}</span><span>
</span><a name="line-2742"></a><span>
</span><a name="line-2743"></a><span class="hs-keyword">type</span><span> </span><a name="IndWeightMap"><a href="V.html#IndWeightMap"><span class="hs-identifier">IndWeightMap</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span class="hs-special">,</span><a href="VDS.html#Header"><span class="hs-identifier hs-type">Header</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2744"></a><span>
</span><a name="line-2745"></a><span>
</span><a name="line-2746"></a><span>
</span><a name="line-2747"></a><span class="hs-comment">-- | &#20225;&#26989;&#21029;&#12398;&#24773;&#22577;&#12434;&#38598;&#12417;&#12383;Map</span><span>
</span><a name="line-2748"></a><span class="hs-keyword">type</span><span> </span><a name="EnWeightInfoMap"><a href="V.html#EnWeightInfoMap"><span class="hs-identifier">EnWeightInfoMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VDS.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><a href="V.html#EnWeightInfo"><span class="hs-identifier hs-type">EnWeightInfo</span></a><span>
</span><a name="line-2749"></a><span>
</span><a name="line-2750"></a><span>
</span><a name="line-2751"></a><span class="hs-comment">{- | &#20225;&#26989;&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;&#65292;&#20225;&#26989;&#21029;&#20027;&#29987;&#26989;&#65292;&#20840;&#20307;&#22770;&#19978;&#39640;&#65292;&#20840;&#20307;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#65292;&#35442;&#24403;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;
    &#12434;&#35352;&#37682;&#12377;&#12427;&#12383;&#12417;&#12398;&#12487;&#12540;&#12479;&#22411;

-}</span><span>
</span><a name="line-2755"></a><span class="hs-keyword">data</span><span> </span><a name="EnWeightInfo"><a href="V.html#EnWeightInfo"><span class="hs-identifier">EnWeightInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EWI"><a href="V.html#EWI"><span class="hs-identifier">EWI</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="lInd"><a href="V.html#lInd"><span class="hs-identifier">lInd</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>     </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#29987;&#26989;&#22823;&#20998;&#39006;</span><span>
</span><a name="line-2756"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enCost"><a href="V.html#enCost"><span class="hs-identifier">enCost</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span><span>
</span><a name="line-2757"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enBought"><a href="V.html#enBought"><span class="hs-identifier">enBought</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#24180;&#38291;&#20181;&#20837;&#38989;</span><span>
</span><a name="line-2758"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enBegin"><a href="V.html#enBegin"><span class="hs-identifier">enBegin</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span><span>
</span><a name="line-2759"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enEnd"><a href="V.html#enEnd"><span class="hs-identifier">enEnd</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span><span>
</span><a name="line-2760"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="totalEmp"><a href="V.html#totalEmp"><span class="hs-identifier">totalEmp</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#20840;&#20307;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;(&#20998;&#27597;)</span><span>
</span><a name="line-2761"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="targetEmp"><a href="V.html#targetEmp"><span class="hs-identifier">targetEmp</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ &#35442;&#24403;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968; (&#20998;&#23376;)</span><span>
</span><a name="line-2762"></a><span>                        </span><span class="hs-special">}</span><span>
</span><a name="line-2763"></a><span>
</span><a name="line-2764"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="V.html#EnWeightInfo"><span class="hs-identifier hs-type">EnWeightInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-2765"></a><a name="getDataFromEWI"><a href="V.html#getDataFromEWI"><span class="hs-identifier">getDataFromEWI</span></a></a><span> </span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enCost</span><span>
</span><a name="line-2766"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enBought</span><span>
</span><a name="line-2767"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enBegin</span><span>
</span><a name="line-2768"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enEnd</span><span>
</span><a name="line-2769"></a><span>
</span><a name="line-2770"></a><span>
</span><a name="line-2771"></a><span class="hs-comment">{- | Nothing&#12395;&#12394;&#12427;&#12414;&#12391; STRef&#12391;EnWeightInfo&#12434;&#21454;&#38598;&#12375;&#65292;Nothing&#12391;&#12381;&#12428;&#12434;EnWeightInfoMap &#12395;&#22793;&#25563;&#12375;&#12390;&#36820;&#12377;

&#20225;&#26989;&#12363;&#65292;&#22243;&#20307;&#12398;&#22580;&#21512;&#12399;&#65292;&#20840;&#20307;&#12398;&#22770;&#19978;&#39640;&#12434;&#35352;&#20837; &#22770;&#12426;&#19978;&#12370;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;&#22793;&#25563;&#12398;&#27573;&#38542;&#12391;&#38500;&#22806;&#65294;
&#65288;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12418;&#65292;&#22770;&#19978;&#39640;&#12398;&#12415;&#65289;

&#20107;&#26989;&#25152;&#12398;&#22580;&#21512;&#12399;&#65292;&#35442;&#24403;&#12377;&#12427;&#12394;&#12425;&#30452;&#36676;&#20225;&#26989;&#12395;&#35442;&#24403;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#21450;&#12403;&#65292;&#24467;&#26989;&#32773;&#25968;&#12434;&#35352;&#20837;


&#20491;&#20154;&#32076;&#21942;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#12399;&#65292;&#23550;&#35937;&#12363;&#12425;&#38500;&#12367;

-}</span><span>
</span><a name="line-2782"></a><span>
</span><a name="line-2783"></a><span class="hs-identifier">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412645"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679412645"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span>
</span><a name="line-2784"></a><a name="f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><a href="V.html#f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><span class="hs-identifier">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span></a></a><span> </span><a name="local-6989586621679413611"><a href="#local-6989586621679413611"><span class="hs-identifier">imap</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2785"></a><span>        </span><a name="local-6989586621679413671"><a href="#local-6989586621679413671"><span class="hs-identifier">maybeIcd</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-2786"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413671"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2787"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413611"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-2788"></a><span>                     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679413615"><span class="hs-identifier hs-var">makeIndWeightMap</span></a><span>
</span><a name="line-2789"></a><span>
</span><a name="line-2790"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413672"><a href="#local-6989586621679413672"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2791"></a><span>
</span><a name="line-2792"></a><span>                </span><a name="local-6989586621679413673"><a href="#local-6989586621679413673"><span class="hs-identifier">kind</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413672"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-2793"></a><span>                </span><a name="local-6989586621679413674"><a href="#local-6989586621679413674"><span class="hs-identifier">triple</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413672"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-var">H&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2794"></a><span>
</span><a name="line-2795"></a><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="V.html#isEN"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679413673"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">,</span><span> </span><a href="V.html#isSingle"><span class="hs-identifier hs-var">isSingle</span></a><span> </span><a href="#local-6989586621679413673"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679413674"><span class="hs-identifier hs-var">triple</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2796"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413614"><span class="hs-identifier hs-var">whenIsSi</span></a><span> </span><a href="#local-6989586621679413672"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413611"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-2797"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>   </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413613"><span class="hs-identifier hs-var">whenIsES</span></a><span> </span><a href="#local-6989586621679413672"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413611"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-2798"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413614"><span class="hs-identifier hs-var">whenIsSi</span></a><span> </span><a href="#local-6989586621679413672"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413611"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-2799"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413612"><span class="hs-identifier hs-var">whenIsEN</span></a><span> </span><a href="#local-6989586621679413672"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679413611"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-2800"></a><span>
</span><a name="line-2801"></a><span>                </span><a href="V.html#f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679413611"><span class="hs-identifier hs-var">imap</span></a><span>
</span><a name="line-2802"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2803"></a><span>    </span><span class="hs-comment">-- &#20225;&#26989;&#12414;&#12383;&#12399;&#22243;&#20307;&#12398;&#26178;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-2804"></a><span>    </span><span class="hs-comment">-- </span><span>
</span><a name="line-2805"></a><span>    </span><span class="hs-identifier">whenIsEN</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2806"></a><span>    </span><a name="local-6989586621679413612"><a href="#local-6989586621679413612"><span class="hs-identifier">whenIsEN</span></a></a><span> </span><a name="local-6989586621679413616"><a href="#local-6989586621679413616"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679413617"><a href="#local-6989586621679413617"><span class="hs-identifier">smap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2807"></a><span>            </span><a name="local-6989586621679413618"><a href="#local-6989586621679413618"><span class="hs-identifier">tmpMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413617"><span class="hs-identifier hs-var">smap</span></a><span>
</span><a name="line-2808"></a><span>            </span><a name="local-6989586621679413619"><a href="#local-6989586621679413619"><span class="hs-identifier">valCode</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2809"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413619"><span class="hs-identifier hs-var">valCode</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2810"></a><span>                </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2811"></a><span>                </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413620"><a href="#local-6989586621679413620"><span class="hs-identifier">code</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2812"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413621"><a href="#local-6989586621679413621"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.init</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TL.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413620"><span class="hs-identifier hs-var">code</span></a><span>
</span><a name="line-2813"></a><span>
</span><a name="line-2814"></a><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413621"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679413618"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2815"></a><span>                        </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2816"></a><span>                            </span><a name="local-6989586621679413622"><a href="#local-6989586621679413622"><span class="hs-identifier">valInd</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2817"></a><span>                            </span><a name="local-6989586621679413623"><a href="#local-6989586621679413623"><span class="hs-identifier">cost</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2818"></a><span>                            </span><a name="local-6989586621679413624"><a href="#local-6989586621679413624"><span class="hs-identifier">bought</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2819"></a><span>                            </span><a name="local-6989586621679413625"><a href="#local-6989586621679413625"><span class="hs-identifier">begin</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2820"></a><span>                            </span><a name="local-6989586621679413626"><a href="#local-6989586621679413626"><span class="hs-identifier">end</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2821"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413622"><span class="hs-identifier hs-var">valInd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2822"></a><span>                                </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413627"><a href="#local-6989586621679413627"><span class="hs-identifier">ind</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413617"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679413621"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">(</span><a href="V.html#EWI"><span class="hs-identifier hs-var">EWI</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679413627"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413623"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679413624"><span class="hs-identifier hs-var">bought</span></a><span> </span><a href="#local-6989586621679413625"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679413626"><span class="hs-identifier hs-var">end</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2823"></a><span>                                </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2824"></a><span>
</span><a name="line-2825"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413628"><a href="#local-6989586621679413628"><span class="hs-identifier">ewi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-2826"></a><span>                            </span><a name="local-6989586621679413629"><a href="#local-6989586621679413629"><span class="hs-identifier">valInd</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2827"></a><span>                            </span><a name="local-6989586621679413630"><a href="#local-6989586621679413630"><span class="hs-identifier">cost</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2828"></a><span>                            </span><a name="local-6989586621679413631"><a href="#local-6989586621679413631"><span class="hs-identifier">bought</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2829"></a><span>                            </span><a name="local-6989586621679413632"><a href="#local-6989586621679413632"><span class="hs-identifier">begin</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2830"></a><span>                            </span><a name="local-6989586621679413633"><a href="#local-6989586621679413633"><span class="hs-identifier">end</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="V.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413616"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2831"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413629"><span class="hs-identifier hs-var">valInd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2832"></a><span>                                </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413634"><a href="#local-6989586621679413634"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2833"></a><span>                                        </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679413635"><a href="#local-6989586621679413635"><span class="hs-identifier">tmpIndustry</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lInd</span><span>      </span><a href="#local-6989586621679413628"><span class="hs-identifier hs-var">ewi</span></a><span>
</span><a name="line-2834"></a><span>                                        </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679413636"><a href="#local-6989586621679413636"><span class="hs-identifier">tmpTotalEmp</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">totalEmp</span><span>  </span><a href="#local-6989586621679413628"><span class="hs-identifier hs-var">ewi</span></a><span>
</span><a name="line-2835"></a><span>                                        </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679413637"><a href="#local-6989586621679413637"><span class="hs-identifier">tmpTargetEmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679413628"><span class="hs-identifier hs-var">ewi</span></a><span>
</span><a name="line-2836"></a><span>                                        </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679413638"><a href="#local-6989586621679413638"><span class="hs-identifier">tmpEwi</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="V.html#EWI"><span class="hs-identifier hs-var">EWI</span></a><span> </span><a href="#local-6989586621679413635"><span class="hs-identifier hs-var">tmpIndustry</span></a><span> </span><a href="#local-6989586621679413630"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679413631"><span class="hs-identifier hs-var">bought</span></a><span> </span><a href="#local-6989586621679413632"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679413633"><span class="hs-identifier hs-var">end</span></a><span> </span><a href="#local-6989586621679413636"><span class="hs-identifier hs-var">tmpTotalEmp</span></a><span> </span><a href="#local-6989586621679413637"><span class="hs-identifier hs-var">tmpTargetEmp</span></a><span>
</span><a name="line-2837"></a><span>                                        </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413617"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679413621"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679413638"><span class="hs-identifier hs-var">tmpEwi</span></a><span class="hs-special">)</span><span>
</span><a name="line-2838"></a><span>                                </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2839"></a><span>
</span><a name="line-2840"></a><span>    </span><span class="hs-identifier">whenIsES</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2841"></a><span>    </span><a name="local-6989586621679413613"><a href="#local-6989586621679413613"><span class="hs-identifier">whenIsES</span></a></a><span> </span><a name="local-6989586621679413639"><a href="#local-6989586621679413639"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679413640"><a href="#local-6989586621679413640"><span class="hs-identifier">smap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2842"></a><span>            </span><a name="local-6989586621679413641"><a href="#local-6989586621679413641"><span class="hs-identifier">tmpMap</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413640"><span class="hs-identifier hs-var">smap</span></a><span>
</span><a name="line-2843"></a><span>            </span><a name="local-6989586621679413642"><a href="#local-6989586621679413642"><span class="hs-identifier">valCode</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413639"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2844"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413642"><span class="hs-identifier hs-var">valCode</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2845"></a><span>                </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2846"></a><span>                </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413643"><a href="#local-6989586621679413643"><span class="hs-identifier">code</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2847"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413644"><a href="#local-6989586621679413644"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.init</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TL.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413643"><span class="hs-identifier hs-var">code</span></a><span>
</span><a name="line-2848"></a><span>
</span><a name="line-2849"></a><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413644"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679413641"><span class="hs-identifier hs-var">tmpMap</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2850"></a><span>                        </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2851"></a><span>                            </span><a name="local-6989586621679413645"><a href="#local-6989586621679413645"><span class="hs-identifier">valInd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413639"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2852"></a><span>                            </span><a name="local-6989586621679413646"><a href="#local-6989586621679413646"><span class="hs-identifier">valEmp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413639"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2853"></a><span>
</span><a name="line-2854"></a><span>                            </span><span class="hs-keyword">case</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679413645"><span class="hs-identifier hs-var">valInd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413646"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2855"></a><span>                                </span><span class="hs-special">(</span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413647"><a href="#local-6989586621679413647"><span class="hs-identifier">ind</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679413648"><a href="#local-6989586621679413648"><span class="hs-identifier">emp</span></a></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2856"></a><span>                                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413649"><a href="#local-6989586621679413649"><span class="hs-identifier">totalEmpToAdd</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#38599;&#29992;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413648"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-2857"></a><span>                                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413650"><a href="#local-6989586621679413650"><span class="hs-identifier">targetEmpToAdd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413648"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-2858"></a><span>                                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413651"><a href="#local-6989586621679413651"><span class="hs-identifier">tmpEwi</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="V.html#EWI"><span class="hs-identifier hs-var">EWI</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679413647"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679413649"><span class="hs-identifier hs-var">totalEmpToAdd</span></a><span> </span><a href="#local-6989586621679413650"><span class="hs-identifier hs-var">targetEmpToAdd</span></a><span>
</span><a name="line-2859"></a><span>                                    </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413640"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679413644"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679413651"><span class="hs-identifier hs-var">tmpEwi</span></a><span class="hs-special">)</span><span>
</span><a name="line-2860"></a><span>                                </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span>               </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2861"></a><span>
</span><a name="line-2862"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413652"><a href="#local-6989586621679413652"><span class="hs-identifier">ewi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-2863"></a><span>                            </span><a name="local-6989586621679413653"><a href="#local-6989586621679413653"><span class="hs-identifier">valInd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413639"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2864"></a><span>                            </span><a name="local-6989586621679413654"><a href="#local-6989586621679413654"><span class="hs-identifier">valEmp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413639"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VDS.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2865"></a><span>
</span><a name="line-2866"></a><span>                            </span><span class="hs-keyword">case</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679413653"><span class="hs-identifier hs-var">valInd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413654"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2867"></a><span>                                </span><span class="hs-special">(</span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413655"><a href="#local-6989586621679413655"><span class="hs-identifier">ind</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679413656"><a href="#local-6989586621679413656"><span class="hs-identifier">emp</span></a></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2868"></a><span>                                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413657"><a href="#local-6989586621679413657"><span class="hs-identifier">totalEmpToAdd</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#38599;&#29992;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413656"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-2869"></a><span>                                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413658"><a href="#local-6989586621679413658"><span class="hs-identifier">targetEmpToAdd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679413656"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-2870"></a><span>                                    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679413652"><span class="hs-identifier hs-var">ewi</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679413655"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2871"></a><span>                                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413640"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679413644"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413652"><span class="hs-identifier hs-var">ewi</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">totalEmp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">totalEmp</span><span>  </span><a href="#local-6989586621679413652"><span class="hs-identifier hs-var">ewi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679413657"><span class="hs-identifier hs-var">totalEmpToAdd</span></a><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2872"></a><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413640"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679413644"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413652"><span class="hs-identifier hs-var">ewi</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">totalEmp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">totalEmp</span><span>  </span><a href="#local-6989586621679413652"><span class="hs-identifier hs-var">ewi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679413657"><span class="hs-identifier hs-var">totalEmpToAdd</span></a><span>
</span><a name="line-2873"></a><span>                                                                                   </span><span class="hs-special">,</span><span class="hs-identifier">targetEmp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679413652"><span class="hs-identifier hs-var">ewi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679413658"><span class="hs-identifier hs-var">targetEmpToAdd</span></a><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2874"></a><span>
</span><a name="line-2875"></a><span>    </span><span class="hs-identifier">whenIsSi</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2876"></a><span>    </span><a name="local-6989586621679413614"><a href="#local-6989586621679413614"><span class="hs-identifier">whenIsSi</span></a></a><span> </span><a name="local-6989586621679413659"><a href="#local-6989586621679413659"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679413660"><a href="#local-6989586621679413660"><span class="hs-identifier">smap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2877"></a><span>
</span><a name="line-2878"></a><span>    </span><span class="hs-identifier">makeIndWeightMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="V.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span>
</span><a name="line-2879"></a><span>    </span><a name="local-6989586621679413615"><a href="#local-6989586621679413615"><span class="hs-identifier">makeIndWeightMap</span></a></a><span> </span><a name="local-6989586621679413661"><a href="#local-6989586621679413661"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2880"></a><span>                    </span><a name="local-6989586621679413664"><a href="#local-6989586621679413664"><span class="hs-identifier">tmpMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span>
</span><a name="line-2881"></a><span>                    </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679413662"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413665"><a href="#local-6989586621679413665"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2882"></a><span>                        </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413666"><a href="#local-6989586621679413666"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2883"></a><span>
</span><a name="line-2884"></a><span>                            </span><a name="local-6989586621679413667"><a href="#local-6989586621679413667"><span class="hs-identifier">redMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413664"><span class="hs-identifier hs-var">tmpMap</span></a><span>
</span><a name="line-2885"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413666"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413667"><span class="hs-identifier hs-var">redMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2886"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2887"></a><span>                                    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="V.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679413666"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">(</span><span>
</span><a name="line-2888"></a><span>                                         </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413664"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679413666"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="V.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679413666"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2889"></a><span>
</span><a name="line-2890"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413668"><a href="#local-6989586621679413668"><span class="hs-identifier">tup</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2891"></a><span>                                    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="V.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679413666"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">(</span><span>
</span><a name="line-2892"></a><span>                                         </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679413664"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679413666"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679413668"><span class="hs-identifier hs-var">tup</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="V.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679413666"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-2893"></a><span>                                                                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679413668"><span class="hs-identifier hs-var">tup</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679413665"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2894"></a><span>                    </span><a name="local-6989586621679413669"><a href="#local-6989586621679413669"><span class="hs-identifier">resultMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679413664"><span class="hs-identifier hs-var">tmpMap</span></a><span>
</span><a name="line-2895"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413670"><a href="#local-6989586621679413670"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679413670"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413670"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413669"><span class="hs-identifier hs-var">resultMap</span></a><span>
</span><a name="line-2896"></a><span>
</span><a name="line-2897"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2898"></a><span>        </span><a name="local-6989586621679413662"><a href="#local-6989586621679413662"><span class="hs-identifier">ys</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Map.elems</span><span>
</span><a name="line-2899"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">Map.filter</span><span>
</span><a name="line-2900"></a><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413663"><a href="#local-6989586621679413663"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">targetEmp</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413663"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">totalEmp</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413663"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0.7</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413661"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2901"></a><span>
</span><a name="line-2902"></a><span>
</span><a name="line-2903"></a><span>
</span><a name="line-2904"></a><span class="hs-comment">-- | &#20491;&#20154;&#32076;&#21942;&#32773;,&#12354;&#12427;&#12356;&#12399;&#21336;&#29420;&#20107;&#26989;&#25152;&#12363;&#21542;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-2905"></a><span class="hs-identifier">isSingle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Val%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-type">Val&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2906"></a><a name="isSingle"><a href="V.html#isSingle"><span class="hs-identifier">isSingle</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2907"></a><span class="hs-identifier">isSingle</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413675"><a href="#local-6989586621679413675"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679413676"><a href="#local-6989586621679413676"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679413677"><a href="#local-6989586621679413677"><span class="hs-identifier">subject</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2908"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679413675"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5358%72EC%4E8B%696D%6240%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679413675"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span>  </span><a href="VDS.html#E%500B%4EBA%7D4C%55B6%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413677"><span class="hs-identifier hs-var">subject</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%500B%4EBA%7D4C%55B6%8005%7528"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#32773;&#29992;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2909"></a><span class="hs-identifier">isSingle</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679413678"><a href="#local-6989586621679413678"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679413679"><a href="#local-6989586621679413679"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679413680"><a href="#local-6989586621679413680"><span class="hs-identifier">subject</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-var">V&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span> </span><a name="local-6989586621679413681"><a href="#local-6989586621679413681"><span class="hs-identifier">triple</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2910"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679413678"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5358%72EC%4E8B%696D%6240%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679413678"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span>  </span><a href="VDS.html#E%500B%4EBA%7D4C%55B6%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413680"><span class="hs-identifier hs-var">subject</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%500B%4EBA%7D4C%55B6%8005%7528"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#32773;&#29992;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413681"><span class="hs-identifier hs-var">triple</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5358%72EC%4E8B%696D%6240"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2911"></a><span class="hs-identifier">isSingle</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-var">V&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span> </span><a name="local-6989586621679413682"><a href="#local-6989586621679413682"><span class="hs-identifier">triple</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2912"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413682"><span class="hs-identifier hs-var">triple</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VDS.html#E%5358%72EC%4E8B%696D%6240"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;</span></a><span class="hs-special">)</span><span>
</span><a name="line-2913"></a><span>
</span><a name="line-2914"></a><span>
</span><a name="line-2915"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2916"></a><span class="hs-comment">-- * &#12510;&#12540;&#12472;&#12531;&#25512;&#35336;</span><span>
</span><a name="line-2917"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2918"></a><span>
</span><a name="line-2919"></a><span class="hs-comment">{- | &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;

JSNA&#12395;&#12362;&#12369;&#12427;V&#34920;&#12399;&#22269;&#36899;&#22522;&#28310;&#12391;&#12354;&#12427;&#65292;&#22522;&#26412;&#20385;&#26684;&#34920;&#31034;&#12392;&#12399;&#30064;&#12394;&#12426;&#65292;&#36939;&#36664;&#12539;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12434;&#12381;&#12428;&#12382;&#12428;&#12398;&#29987;&#26989;&#12398;&#33258;&#20132;&#28857;&#12395;&#35336;&#19978;&#12375;&#12390;&#12356;&#12427;&#65294;
SUT&#20307;&#31995;&#12408;&#12398;&#31227;&#34892;&#24460;&#12398;S&#34920;&#12395;&#12362;&#12356;&#12390;&#12393;&#12398;&#12424;&#12358;&#12394;&#20385;&#26684;&#12434;&#25505;&#29992;&#12377;&#12427;&#12363;&#12399;&#29694;&#34892;&#26410;&#23450;&#12391;&#12354;&#12427;&#12398;&#12391;&#65292;
&#26412;&#31295;&#12391;&#12399;&#29694;&#34892;V&#34920;&#12395;&#21512;&#12431;&#12379;&#12390;&#65292;&#25512;&#35336;&#12373;&#12428;&#12383;&#12510;&#12540;&#12472;&#12531;&#12399;&#12381;&#12428;&#12382;&#12428;&#12398;&#33258;&#20132;&#28857;&#12395;&#35336;&#19978;&#12377;&#12427;&#65294;
&#20197;&#38477;&#21508;&#12510;&#12540;&#12472;&#12531;&#12398;&#25512;&#35336;&#25163;&#27861;&#12395;&#38306;&#12375;&#12390;&#22806;&#35251;&#65292;&#32771;&#23519;&#12377;&#12427;&#65294;

 &#24179;&#25104;23&#24180;V&#34920;&#12395;&#12362;&#12369;&#12427;&#21508;&#29987;&#26989;&#12398;&#32207;&#29983;&#29987;&#38989;&#12399;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#21462;&#24341;&#22522;&#26412;&#34920;&#12398;&#34892;&#21644;&#12364;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12427;&#65294;
 &#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#32207;&#21512;&#35299;&#35500;&#32232; &#12395;&#12424;&#12428;&#12400;&#65292;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12369;&#12427;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12399;

 &#12300;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#65309;&#22770;&#19978;&#38989;&#65288;&#21830;&#26989;&#36009;&#22770;&#38989;&#65289;&#65293; &#20181;&#20837;&#38989;&#12301;
 
 &#12395;&#12424;&#12387;&#12390;&#23450;&#32681;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#24179;&#25104;23&#24180;&#34920;&#12391;&#12399;&#12300;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12301;&#12398;&#32068;&#26367;&#38598;&#35336;&#32080;&#26524;&#65288;&#37096;&#20869;&#36039;&#26009;&#65289;&#12424;&#12426;&#25512;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

 &#19968;&#26041;&#65292;&#31532;52&#22238;&#12469;&#12540;&#12499;&#12473;&#32113;&#35336;&#12539;&#20225;&#26989;&#32113;&#35336;&#37096;&#20250;&#37197;&#24067;&#36039;&#26009; &#12391;&#12399;&#65292;
 &#24179;&#25104;24&#24180;&#12395;&#12362;&#12369;&#12427;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#12398;&#25512;&#35336;&#25163;&#27861;&#12399;&#65292;&#21830;&#21697;&#36009;&#22770;&#38989;&#12363;&#12425;&#20225;&#26989;&#35519;&#26619;&#31080;&#31561;&#12398;&#35519;&#26619;&#38917;&#30446;&#12391;&#12354;&#12427;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12434;&#24341;&#12367;&#24418;&#12391;&#27714;&#12417;&#12390;&#12356;&#12427;&#12392;&#35500;&#26126;&#12375;&#12390;&#12356;&#12427;&#65294;

&#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#65288;&#20027;&#26989;&#65292;&#24467;&#26989;&#65289;=&#24180;&#38291;&#21830;&#21697;&#36009;&#22770;&#38989;-&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;

&#12414;&#12383;&#65292;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#12399;&#35519;&#26619;&#22996;&#38917;&#30446;&#12395;&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;&#12364;&#36861;&#21152;&#12373;&#12428;&#65292;
&#20182;&#12398;&#35352;&#20837;&#38917;&#30446;&#12363;&#12425;&#35336;&#31639;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#22770;&#19978;&#21407;&#20385;&#12395;&#23550;&#12377;&#12427;&#35519;&#26619;&#38917;&#30446;&#12364;&#24259;&#27490;&#12373;&#12428;&#65292;
&#12414;&#12383;&#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#65292;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12398;&#22823;&#21322;&#12434;&#20027;&#26989;&#12364;&#21344;&#12417;&#12390;&#12356;&#12383;&#12371;&#12392;&#12363;&#12425;&#24467;&#26989;&#12395;&#38306;&#12377;&#12427;&#22770;&#19978;&#21407;&#20385;&#12398;&#25226;&#25569;&#12434;&#21462;&#12426;&#12420;&#12417;&#65292;
&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#25512;&#35336;&#12377;&#12427;&#12392;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

&#24179;&#25104;&#65298;8&#24180;&#12475;&#12531;&#12469;&#12473;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#65288;&#20027;&#26989;&#65289;&#65309;&#24180;&#38291;&#21830;&#21697;&#36009;&#22770;&#38989;- &#65288;&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;&#65291;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#38989;-&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65289;

 &#20197;&#19979;&#22522;&#26412;&#30340;&#12395;&#12399;&#19978;&#35352;&#36039;&#26009;&#12395;&#24467;&#12356;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#38917;&#30446;&#12364;&#21462;&#24471;&#12391;&#12365;&#12394;&#12356;&#22580;&#21512;&#12395;&#12362;&#12369;&#12427;&#22580;&#21512;&#12434;&#32771;&#24942;&#12375;&#12390;&#65292;
 &#24179;&#25104;24&#24180;&#65292;&#24179;&#25104;28&#24180;&#12381;&#12428;&#12382;&#12428;&#12398;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#25163;&#27861;&#12434;&#35373;&#35336;&#12377;&#12427;&#65294;

 &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12398;&#25512;&#35336;&#12395;&#29992;&#12356;&#12427;&#38917;&#30446;&#12399;&#65292;

&#12539;&#24179;&#25104;24&#24180;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#9312;&#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;

&#12539;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#9313;&#12300;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#65292;&#9314;&#12300;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#38989;&#12301;

&#12539;&#24179;&#25104;24&#24180;&#65292;28&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#21450;&#12403;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#9315;&#12300;&#24180;&#38291;&#21830;&#21697;&#36009;&#22770;&#38989;&#12301;&#65292;
&#9316;&#12300;&#36027;&#29992;&#32207;&#38989;&#21450;&#12403;&#36027;&#29992;&#20869;&#35379;&#12301;&#12398;&#12358;&#12385;&#12300;&#22770;&#19978;&#21407;&#20385;&#12301;

&#12539;&#12381;&#12398;&#20182;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#9317;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12398;&#12358;&#12385;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12398;&#22238;&#31572;&#38989;

&#12392;&#12394;&#12427;&#65294;&#21508;&#38917;&#30446;&#12398;&#35519;&#26619;&#31080;&#21029;&#12398;&#26377;&#28961;&#12399;&#65292;&#12300;&#34920; 2 &#21508;&#24180;&#24230;&#21029;&#35519;&#26619;&#31080;&#12395;&#21547;&#12414;&#12428;&#12427;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12395;&#21033;&#29992;&#12373;&#12428;&#12427;&#38917;&#30446;&#12392;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#25163;&#27861;&#12301;&#12395;&#12414;&#12392;&#12417;&#12383;&#65294;
&#20197;&#38477;&#65292;&#26410;&#22238;&#31572;&#12398;&#22580;&#21512;&#12434;&#21547;&#12417;&#12390;&#65292;&#21508;&#24773;&#22577;&#12398;&#35352;&#36617;&#12398;&#26377;&#28961;&#12395;&#12381;&#12387;&#12390;&#12300;&#22259; 7 &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#21462;&#24471;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#12301;&#12395;&#24467;&#12387;&#12390;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12434;&#27714;&#12417;&#12427;&#65294; 


![&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#21462;&#24471;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;](margin.png)

&#20966;&#29702;&#12392;&#12375;&#12390;&#12399;&#65292;&#65298;&#65298;&#21306;&#20998;&#12398;&#22770;&#19978;&#39640;&#12398;&#20516;&#21450;&#12403;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#12358;&#12385;&#21830;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#12418;&#12398;&#12395;&#20966;&#29702;&#12434;&#26045;&#12375;&#12390;&#12356;&#12367;&#65294;
&#39006;&#20284;&#35519;&#26619;&#31080;&#20966;&#29702;&#12364;&#24517;&#35201;&#12395;&#12394;&#12387;&#12383;&#12418;&#12398;&#12399; IORef [IOCensusRow] &#12391;&#20445;&#23384;&#12375;&#65292;&#32066;&#20102;&#24460;&#12377;&#12409;&#12390;&#20966;&#29702;&#12375;&#12390;yield&#12377;&#12427;&#65294;

&#26412;&#24403;&#12399;&#33258;&#23478;&#20489;&#24235;&#12420;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#20998;&#12395;&#12399;&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#20055;&#12376;&#12427;&#12409;&#12365;&#12391;&#12399;&#12394;&#12356;(&#26410;&#23550;&#24540;)

&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;&#12399;,&#24517;&#35201;&#12394;&#22580;&#21512;List&#12395;&#12383;&#12417;&#12390;&#12362;&#12365;,&#26368;&#24460;&#12395;&#12414;&#12392;&#12417;&#12390;&#20966;&#29702;&#12434;&#34892;&#12358;.
-}</span><span>
</span><a name="line-2972"></a><span>
</span><a name="line-2973"></a><span>
</span><a name="line-2974"></a><span class="hs-identifier">f&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679412644"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412644"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#ToMakeMarginMap"><span class="hs-identifier hs-type">ToMakeMarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-special">[</span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412644"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2975"></a><a name="f%5546%696D%30DE%30FC%30B8%30F3%51E6%7406"><a href="V.html#f%5546%696D%30DE%30FC%30B8%30F3%51E6%7406"><span class="hs-identifier">f&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#20966;&#29702;</span></a></a><span>  </span><a name="local-6989586621679413683"><a href="#local-6989586621679413683"><span class="hs-identifier">refTmm</span></a></a><span> </span><a name="local-6989586621679413684"><a href="#local-6989586621679413684"><span class="hs-identifier">icrList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2976"></a><span>        </span><a name="local-6989586621679413685"><a href="#local-6989586621679413685"><span class="hs-identifier">maybeIcr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-2977"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413685"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2978"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413684"><span class="hs-identifier hs-var">icrList</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413686"><a href="#local-6989586621679413686"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-2979"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413683"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413687"><a href="#local-6989586621679413687"><span class="hs-identifier">tm</span></a></a><span>
</span><a name="line-2980"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">CL.sourceList</span><span> </span><a href="#local-6989586621679413686"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-operator hs-var">.|</span><span> </span><a href="V.html#f%540C%4E00%7523%696D%51E6%7406"><span class="hs-identifier hs-var">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span></a><span> </span><span class="hs-special">(</span><a href="V.html#makeMarginMap"><span class="hs-identifier hs-var">makeMarginMap</span></a><span> </span><a href="#local-6989586621679413687"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span>
</span><a name="line-2981"></a><span>
</span><a name="line-2982"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413688"><a href="#local-6989586621679413688"><span class="hs-identifier">icr</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413689"><a href="#local-6989586621679413689"><span class="hs-identifier">valSev</span></a></a><span>
</span><a name="line-2983"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">)</span><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413690"><a href="#local-6989586621679413690"><span class="hs-identifier">valCost</span></a></a><span>
</span><a name="line-2984"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413691"><a href="#local-6989586621679413691"><span class="hs-identifier">valTar</span></a></a><span>
</span><a name="line-2985"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>         </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413692"><a href="#local-6989586621679413692"><span class="hs-identifier">valBegin</span></a></a><span>
</span><a name="line-2986"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>         </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413693"><a href="#local-6989586621679413693"><span class="hs-identifier">valEnd</span></a></a><span>
</span><a name="line-2987"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">)</span><span>             </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413694"><a href="#local-6989586621679413694"><span class="hs-identifier">valBought</span></a></a><span>
</span><a name="line-2988"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413695"><a href="#local-6989586621679413695"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-2989"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413689"><span class="hs-identifier hs-var">valSev</span></a><span class="hs-special">,</span><a href="#local-6989586621679413690"><span class="hs-identifier hs-var">valCost</span></a><span class="hs-special">,</span><a href="#local-6989586621679413692"><span class="hs-identifier hs-var">valBegin</span></a><span class="hs-special">,</span><a href="#local-6989586621679413693"><span class="hs-identifier hs-var">valEnd</span></a><span class="hs-special">,</span><a href="#local-6989586621679413694"><span class="hs-identifier hs-var">valBought</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2990"></a><span>                            </span><span class="hs-special">(</span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-2991"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413684"><span class="hs-identifier hs-var">icrList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2992"></a><span>
</span><a name="line-2993"></a><span>                            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413696"><a href="#local-6989586621679413696"><span class="hs-identifier">sev</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413697"><a href="#local-6989586621679413697"><span class="hs-identifier">cost</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-2994"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413698"><a href="#local-6989586621679413698"><span class="hs-identifier">cSales</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><a href="V.html#isCommerceDetail"><span class="hs-identifier hs-var">isCommerceDetail</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413696"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2995"></a><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413699"><a href="#local-6989586621679413699"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413698"><span class="hs-identifier hs-var">cSales</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413697"><span class="hs-identifier hs-var">cost</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679413698"><span class="hs-identifier hs-var">cSales</span></a><span>
</span><a name="line-2996"></a><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="V.html#f%8868%9762%88CF%9762%51E6%7406"><span class="hs-identifier hs-var">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413699"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413689"><span class="hs-identifier hs-var">valSev</span></a><span> </span><a href="#local-6989586621679413691"><span class="hs-identifier hs-var">valTar</span></a><span> </span><a href="#local-6989586621679413695"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679413683"><span class="hs-identifier hs-var">refTmm</span></a><span>
</span><a name="line-2997"></a><span>
</span><a name="line-2998"></a><span>                            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413700"><a href="#local-6989586621679413700"><span class="hs-identifier">sev</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413701"><a href="#local-6989586621679413701"><span class="hs-identifier">begin</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413702"><a href="#local-6989586621679413702"><span class="hs-identifier">end</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413703"><a href="#local-6989586621679413703"><span class="hs-identifier">bought</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2999"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413704"><a href="#local-6989586621679413704"><span class="hs-identifier">cSales</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><a href="V.html#isCommerceDetail"><span class="hs-identifier hs-var">isCommerceDetail</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413700"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-3000"></a><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413705"><a href="#local-6989586621679413705"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413704"><span class="hs-identifier hs-var">cSales</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413701"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679413702"><span class="hs-identifier hs-var">end</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413703"><span class="hs-identifier hs-var">bought</span></a><span>
</span><a name="line-3001"></a><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="V.html#f%8868%9762%88CF%9762%51E6%7406"><span class="hs-identifier hs-var">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413705"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413689"><span class="hs-identifier hs-var">valSev</span></a><span> </span><a href="#local-6989586621679413691"><span class="hs-identifier hs-var">valTar</span></a><span> </span><a href="#local-6989586621679413695"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679413683"><span class="hs-identifier hs-var">refTmm</span></a><span>
</span><a name="line-3002"></a><span>
</span><a name="line-3003"></a><span>                            </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413706"><a href="#local-6989586621679413706"><span class="hs-identifier">sev</span></a></a><span class="hs-special">,</span><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3004"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413684"><span class="hs-identifier hs-var">icrList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3005"></a><span>                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679413688"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3006"></a><span>                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%5546%696D%30DE%30FC%30B8%30F3%51E6%7406"><span class="hs-identifier hs-var">f&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#20966;&#29702;</span></a><span>  </span><a href="#local-6989586621679413683"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><a href="#local-6989586621679413684"><span class="hs-identifier hs-var">icrList</span></a><span>
</span><a name="line-3007"></a><span>
</span><a name="line-3008"></a><span class="hs-comment">-- | &#12510;&#12540;&#12472;&#12531;&#29575;</span><span>
</span><a name="line-3009"></a><span class="hs-keyword">type</span><span> </span><a name="MarginRate"><a href="V.html#MarginRate"><span class="hs-identifier">MarginRate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3010"></a><span>
</span><a name="line-3011"></a><span class="hs-comment">-- | &#21516;&#19968;&#12398;&#22823;&#20998;&#39006;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;&#12398;&#24179;&#22343;&#12510;&#12540;&#12472;&#12531;&#29575;</span><span>
</span><a name="line-3012"></a><span class="hs-keyword">type</span><span> </span><a name="MarginMap"><a href="V.html#MarginMap"><span class="hs-identifier">MarginMap</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span>   </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><a href="V.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span>
</span><a name="line-3013"></a><span>
</span><a name="line-3014"></a><span class="hs-comment">-- | MarginMap&#12434;&#20316;&#12427;&#12383;&#12417;&#12398;&#20013;&#38291;&#12487;&#12540;&#12479;&#22411; </span><span>
</span><a name="line-3015"></a><span class="hs-keyword">type</span><span> </span><a name="ToMakeMarginMap"><a href="V.html#ToMakeMarginMap"><span class="hs-identifier">ToMakeMarginMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span>  </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-special">(</span><a href="V.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-3016"></a><span>
</span><a name="line-3017"></a><span>
</span><a name="line-3018"></a><span class="hs-identifier">makeMarginMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#ToMakeMarginMap"><span class="hs-identifier hs-type">ToMakeMarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#MarginMap"><span class="hs-identifier hs-type">MarginMap</span></a><span>
</span><a name="line-3019"></a><a name="makeMarginMap"><a href="V.html#makeMarginMap"><span class="hs-identifier">makeMarginMap</span></a></a><span> </span><a name="local-6989586621679413707"><a href="#local-6989586621679413707"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679413708"><a href="#local-6989586621679413708"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679413709"><a href="#local-6989586621679413709"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413708"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679413709"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413707"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-3020"></a><span>
</span><a name="line-3021"></a><span>
</span><a name="line-3022"></a><span class="hs-comment">-- | &#20107;&#26989;&#20998;&#39006;&#12398;&#21830;&#26989;&#21450;&#12403;,&#35023;&#38754;&#12398;&#21830;&#26989;&#12434;&#12510;&#12540;&#12472;&#12531;&#21270;&#12377;&#12427;</span><span>
</span><a name="line-3023"></a><span class="hs-identifier">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412643"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="V.html#MarginMap"><span class="hs-identifier hs-type">MarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412643"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3024"></a><a name="f%540C%4E00%7523%696D%51E6%7406"><a href="V.html#f%540C%4E00%7523%696D%51E6%7406"><span class="hs-identifier">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413710"><a href="#local-6989586621679413710"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3025"></a><span>    </span><a name="local-6989586621679413713"><a href="#local-6989586621679413713"><span class="hs-identifier">maybeIcr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-3026"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413713"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3027"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3028"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413714"><a href="#local-6989586621679413714"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413715"><a href="#local-6989586621679413715"><span class="hs-identifier">sev</span></a></a><span>
</span><a name="line-3029"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413716"><a href="#local-6989586621679413716"><span class="hs-identifier">tar</span></a></a><span>
</span><a name="line-3030"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413717"><a href="#local-6989586621679413717"><span class="hs-identifier">kind</span></a></a><span>
</span><a name="line-3031"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413717"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3032"></a><span>                    </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413718"><a href="#local-6989586621679413718"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679413719"><a href="#local-6989586621679413719"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679413720"><a href="#local-6989586621679413720"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679413721"><a href="#local-6989586621679413721"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679413722"><a href="#local-6989586621679413722"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679413723"><a href="#local-6989586621679413723"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3033"></a><span>                            </span><span class="hs-glyph">|</span><span class="hs-identifier hs-var">Maybe.isJust</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413718"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679413710"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3034"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413724"><a href="#local-6989586621679413724"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413718"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679413710"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3035"></a><span>                            </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">liftIO</span><span>  </span><span class="hs-operator hs-var">$</span><span>  </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-special">(</span><a href="V.html#convMarginSev"><span class="hs-identifier hs-var">convMarginSev</span></a><span> </span><a href="#local-6989586621679413724"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679413715"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>
</span><a name="line-3036"></a><span>                                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="V.html#convMarginTar"><span class="hs-identifier hs-var">convMarginTar</span></a><span> </span><a href="#local-6989586621679413724"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679413716"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-3037"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-3038"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">liftIO</span><span>  </span><span class="hs-operator hs-var">$</span><span>  </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-special">(</span><a href="V.html#convMarginSev"><span class="hs-identifier hs-var">convMarginSev</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413711"><span class="hs-identifier hs-var">mm2mr</span></a><span> </span><a href="#local-6989586621679413710"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413715"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>
</span><a name="line-3039"></a><span>                                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="V.html#convMarginSev"><span class="hs-identifier hs-var">convMarginSev</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413711"><span class="hs-identifier hs-var">mm2mr</span></a><span> </span><a href="#local-6989586621679413710"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413716"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-3040"></a><span>                 </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679413714"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3041"></a><span>                 </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%540C%4E00%7523%696D%51E6%7406"><span class="hs-identifier hs-var">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413710"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-3042"></a><span>
</span><a name="line-3043"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-3044"></a><span>    </span><span class="hs-comment">-- | &#29987;&#26989;&#20998;&#39006;&#12364;&#12431;&#12363;&#12425;&#12394;&#12356;&#12392;&#12365;&#29992;&#12395;,&#20840;&#20307;&#12398;&#24179;&#22343;&#12398;&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#29992;&#12356;&#12427;</span><span>
</span><a name="line-3045"></a><span>    </span><span class="hs-identifier">mm2mr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#MarginMap"><span class="hs-identifier hs-type">MarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3046"></a><span>    </span><a name="local-6989586621679413711"><a href="#local-6989586621679413711"><span class="hs-identifier">mm2mr</span></a></a><span> </span><a name="local-6989586621679413712"><a href="#local-6989586621679413712"><span class="hs-identifier">mm</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Map.size</span><span> </span><a href="#local-6989586621679413712"><span class="hs-identifier hs-var">mm</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map.elems</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413712"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map.size</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413712"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3047"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error: mm2MR, in module V; MarginMap is empty&quot;</span><span>
</span><a name="line-3048"></a><span>
</span><a name="line-3049"></a><span class="hs-comment">-- | &#21830;&#26989;&#12398;&#12415;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;(&#32048;&#20998;&#39006;)&#12510;&#12540;&#12522;&#12531;&#29575;&#12434;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-3050"></a><span class="hs-identifier">convMarginSev</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3051"></a><a name="convMarginSev"><a href="V.html#convMarginSev"><span class="hs-identifier">convMarginSev</span></a></a><span> </span><a name="local-6989586621679413725"><a href="#local-6989586621679413725"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413726"><a href="#local-6989586621679413726"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.map</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413726"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-3052"></a><span>                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413727"><a href="#local-6989586621679413727"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413727"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T5&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413727"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;TL.4&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-3053"></a><span>                                                </span><span class="hs-keyword">then</span><span>   </span><a href="#local-6989586621679413727"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413727"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413725"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-3054"></a><span>                                                </span><span class="hs-keyword">else</span><span>   </span><a href="#local-6989586621679413727"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3055"></a><span class="hs-identifier">convMarginSev</span><span> </span><a name="local-6989586621679413728"><a href="#local-6989586621679413728"><span class="hs-identifier">mr</span></a></a><span> </span><a name="local-6989586621679413729"><a href="#local-6989586621679413729"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413729"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3056"></a><span>
</span><a name="line-3057"></a><span class="hs-comment">-- | &#21830;&#26989;&#12398;&#12415;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;(&#32048;&#20998;&#39006;)&#12510;&#12540;&#12522;&#12531;&#29575;&#12434;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-3058"></a><span class="hs-identifier">convMarginTar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3059"></a><a name="convMarginTar"><a href="V.html#convMarginTar"><span class="hs-identifier">convMarginTar</span></a></a><span> </span><a name="local-6989586621679413730"><a href="#local-6989586621679413730"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413731"><a href="#local-6989586621679413731"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.map</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413731"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-3060"></a><span>                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413732"><a href="#local-6989586621679413732"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">if</span><span> </span><a href="V.html#isCommerceDetail"><span class="hs-identifier hs-var">isCommerceDetail</span></a><span> </span><a href="#local-6989586621679413732"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3061"></a><span>                                                </span><span class="hs-keyword">then</span><span>   </span><a href="#local-6989586621679413732"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413732"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413730"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-3062"></a><span>                                                </span><span class="hs-keyword">else</span><span>   </span><a href="#local-6989586621679413732"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3063"></a><span class="hs-identifier">convMarginTar</span><span> </span><a name="local-6989586621679413733"><a href="#local-6989586621679413733"><span class="hs-identifier">mr</span></a></a><span> </span><a name="local-6989586621679413734"><a href="#local-6989586621679413734"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679413734"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3064"></a><span>
</span><a name="line-3065"></a><span>
</span><a name="line-3066"></a><span class="hs-comment">-- | &#29987;&#26989;&#32048;&#20998;&#39006;&#12398;&#21830;&#26989;&#12363;&#21542;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-3067"></a><span class="hs-identifier">isCommerceDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3068"></a><a name="isCommerceDetail"><a href="V.html#isCommerceDetail"><span class="hs-identifier">isCommerceDetail</span></a></a><span> </span><a name="local-6989586621679413735"><a href="#local-6989586621679413735"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;51&quot;</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413735"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413735"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;61&quot;</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3069"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413735"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;I1ZZ&quot;</span><span>                                                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3070"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413735"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;I2ZZ&quot;</span><span>                                                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3071"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3072"></a><span>
</span><a name="line-3073"></a><span class="hs-comment">-- | 22&#21306;&#20998;&#12398;&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#21697;&#30446;&#21029;&#22770;&#19978;&#39640;&#12395;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-3074"></a><span class="hs-identifier">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span>
</span><a name="line-3075"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-3076"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3077"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3078"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-3079"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="V.html#ToMakeMarginMap"><span class="hs-identifier hs-type">ToMakeMarginMap</span></a><span>
</span><a name="line-3080"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3081"></a><span>
</span><a name="line-3082"></a><a name="f%8868%9762%88CF%9762%51E6%7406"><a href="V.html#f%8868%9762%88CF%9762%51E6%7406"><span class="hs-identifier">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413736"><a href="#local-6989586621679413736"><span class="hs-identifier">mr</span></a></a><span> </span><a name="local-6989586621679413737"><a href="#local-6989586621679413737"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413738"><a href="#local-6989586621679413738"><span class="hs-identifier">sev</span></a></a><span> </span><a name="local-6989586621679413739"><a href="#local-6989586621679413739"><span class="hs-identifier">tar</span></a></a><span> </span><a name="local-6989586621679413740"><a href="#local-6989586621679413740"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679413741"><a href="#local-6989586621679413741"><span class="hs-identifier">refTmm</span></a></a><span>
</span><a name="line-3083"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413737"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-special">(</span><a href="V.html#convMarginSev"><span class="hs-identifier hs-var">convMarginSev</span></a><span> </span><a href="#local-6989586621679413736"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679413738"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>
</span><a name="line-3084"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413737"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="V.html#convMarginTar"><span class="hs-identifier hs-var">convMarginTar</span></a><span> </span><a href="#local-6989586621679413736"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679413739"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-3085"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413740"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3086"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3087"></a><span>        </span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413742"><a href="#local-6989586621679413742"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679413743"><a href="#local-6989586621679413743"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679413744"><a href="#local-6989586621679413744"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679413745"><a href="#local-6989586621679413745"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679413746"><a href="#local-6989586621679413746"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679413747"><a href="#local-6989586621679413747"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413741"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413748"><a href="#local-6989586621679413748"><span class="hs-identifier">tmm</span></a></a><span>
</span><a name="line-3088"></a><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413742"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679413748"><span class="hs-identifier hs-var">tmm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3089"></a><span>                                                    </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413741"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679413742"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413736"><span class="hs-identifier hs-var">mr</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3090"></a><span>                                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679413749"><a href="#local-6989586621679413749"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><a name="local-6989586621679413750"><a href="#local-6989586621679413750"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413741"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679413742"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413749"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679413736"><span class="hs-identifier hs-var">mr</span></a><span class="hs-special">,</span><a href="#local-6989586621679413750"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3091"></a><span>
</span><a name="line-3092"></a><span>
</span><a name="line-3093"></a><span>
</span><a name="line-3094"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3095"></a><span class="hs-comment">-- * &#37325;&#35079;&#12398;&#21066;&#38500;</span><span>
</span><a name="line-3096"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3097"></a><span class="hs-comment">-- ** &#20225;&#26989;&#20869;&#21462;&#24341;&#21450;&#12403;&#19979;&#35531;&#12369;&#27083;&#36896;</span><span>
</span><a name="line-3098"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-3099"></a><span>
</span><a name="line-3100"></a><span class="hs-comment">{- |  &#20225;&#26989;&#20869;&#21462;&#24341;&#21450;&#12403;&#19979;&#35531;&#12369;&#27083;&#36896;

 &#31532;21&#22238;&#12469;&#12540;&#12499;&#12473;&#32113;&#35336;&#12539;&#20225;&#26989;&#32113;&#35336;&#37096;&#20250;&#37197;&#24067;&#36039;&#26009; &#12391;&#12399;&#65292;
 &#12300;&#35069;&#36896;&#26989;&#12398;&#20225;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#37096;&#21697;&#24037;&#22580;&#12363;&#12425;&#23436;&#25104;&#21697;&#32068;&#12415;&#31435;&#12390;&#24037;&#22580;&#12408;&#12398;&#37096;&#21697;&#20379;&#32102;&#12398;&#12424;&#12358;&#12395;&#20225;&#26989;&#20869;&#21462;&#24341;&#12364;&#23384;&#22312;&#12375;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12301;&#12392;&#12375;&#65292;
 &#12381;&#12398;&#21462;&#12426;&#25201;&#12356;&#12395;&#12362;&#12356;&#12390;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#38989;&#12392;&#65292;
 &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#22770;&#19978;&#38989;&#12398;&#24046;&#38989;&#12434;&#20225;&#26989;&#20869;&#21462;&#24341;&#12392;&#12375;&#12390;&#25226;&#25569;&#12375;&#12383;&#19978;&#12391;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#38598;&#35336;&#12398;&#20225;&#26989;&#38598;&#35336;&#34920;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
 &#20225;&#26989;&#20869;&#21462;&#24341;&#12434;&#35336;&#19978;&#12375;&#12394;&#12356;&#24418;&#12391;&#65292;&#20107;&#26989;&#25152;&#38598;&#35336;&#34920;&#12395;&#12362;&#12356;&#12390;&#12399;&#20225;&#26989;&#20869;&#21462;&#24341;&#12434;&#35336;&#19978;&#12377;&#12427;&#24418;&#12391;&#34920;&#35937;&#12377;&#12427;&#12392;&#12356;&#12358;&#26041;&#37341;&#12364;&#25522;&#12370;&#12425;&#12428;&#12390;&#12356;&#12427;&#65294;
 &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#20107;&#26989;&#25152;&#12434;&#38598;&#35336;&#21336;&#20301;&#12392;&#12377;&#12427;&#35069;&#36896;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#29694;&#34892;&#12398;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12356;&#12390;&#65292;&#20225;&#26989;&#20869;&#21462;&#24341;&#12399;&#29983;&#29987;&#38989;&#12395;&#38598;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

 SNA&#12395;&#12362;&#12369;&#12427;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#21450;&#12403;&#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#12394;&#12393;&#12398;&#29983;&#29987;&#38989;&#12434;&#25512;&#35336;&#12377;&#12427;&#12395;&#12399;&#65292;
 &#12381;&#12398;&#22770;&#19978;&#39640;&#12363;&#12425;OEM&#65288;&#30456;&#25163;&#20808;&#12502;&#12521;&#12531;&#12489;&#21517;&#35069;&#36896;&#65289;&#12394;&#12393;&#12395;&#12424;&#12387;&#12390;&#37325;&#35079;&#12377;&#12427;&#20998;&#12398;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#38989;&#21450;&#12403;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#38989;&#12434;&#38500;&#22806;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#12290;
 &#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12369;&#12427;&#12381;&#12398;&#12381;&#12428;&#12425;&#12398;&#29987;&#26989;&#12395;&#21462;&#12426;&#25201;&#12356;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#12300;&#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920; &#32207;&#21512;&#35299;&#35500;&#32232;&#12301;&#12395;&#12362;&#12356;&#12390;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#65292;
 &#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473; &#65292;&#24195;&#21578; &#65292;&#35686;&#20633;&#26989;&#65292;&#12503;&#12521;&#12531;&#12488;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;&#26989;&#21450;&#12403;&#37489;&#29289;&#25506;&#26619;&#20197;&#22806;&#12398;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473; 
 &#12399;&#12356;&#12378;&#12428;&#12418;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12434;&#36039;&#26009;&#12392;&#12375;&#12390;&#12300;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#21450;&#12403;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#38989;&#12434;&#38500;&#22806;&#12375;&#12390;&#29983;&#29987;&#38989;&#12434;&#27714;&#12417;&#12383;&#12301;&#12392;&#12398;&#35352;&#36848;&#12364;&#12354;&#12427;&#65294;

 &#12371;&#12398;&#20869;&#65292;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#38989;&#12395;&#30456;&#24403;&#12377;&#12427;&#12398;&#12364;&#20225;&#26989;&#20869;&#21462;&#24341;&#12392;&#12415;&#12394;&#12373;&#12428;&#12427;&#12418;&#12398;&#12391;&#12354;&#12426;&#65292;
 &#19978;&#35352;&#12398;&#20107;&#26989;&#12399;&#20840;&#12390;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12301;&#12395;&#38306;&#12377;&#12427;&#35519;&#26619;&#31080;&#12391;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#65289;&#12395;&#12399;&#65292;
 &#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;&#12301;&#12392;&#12356;&#12358;&#38917;&#30446;&#12364;&#23384;&#22312;&#12375;&#65292;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#21450;&#12403;&#65292;
 &#24773;&#22577;&#21033;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#12434;&#38500;&#12367;&#20107;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
 &#35519;&#26619;&#38917;&#30446;&#12398;&#20869;&#12300;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#12301;&#12395;&#12424;&#12387;&#12390;&#25226;&#25569;&#12373;&#12428;&#12383;&#21516;&#19968;&#20225;&#26989;&#20869;&#21462;&#24341;&#38989;&#12434;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#39640;&#12363;&#12425;&#38500;&#22806;&#12377;&#12427;&#20966;&#29702;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;
 &#12477;&#12501;&#12488;&#12454;&#12455;&#26989;&#21450;&#12403;&#65292;&#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
 &#21516;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#29305;&#23450;&#12398;&#12469;&#12540;&#12499;&#12473;&#26989;&#12395;&#12362;&#12369;&#12427;&#21516;&#26989;&#32773;&#12392;&#12398;&#22865;&#32004;&#21106;&#21512;&#12301;&#12395;&#24403;&#12383;&#12427;&#22770;&#19978;&#39640;&#12434;&#38500;&#22806;&#12377;&#12427;&#20966;&#29702;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#65294;
 &#12414;&#12383;&#65292;&#12300;&#29289;&#21697;&#36035;&#36024;&#26989;&#65288;&#36024;&#12375;&#33258;&#21205;&#36554;&#12434;&#38500;&#12367;&#65294;&#65289;&#12301;&#12395;&#38306;&#12375;&#12390;&#12418;&#65292;&#29305;&#23450;&#12469;&#12540;&#12499;&#12473;&#29987;&#26989;&#23455;&#24907;&#35519;&#26619;&#12434;&#21033;&#29992;&#12375;&#12390;&#65292;
 &#21463;&#27880;&#12375;&#12383;&#26989;&#21209;&#12398;&#22806;&#37096;&#22996;&#35351;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#38989;&#12434;&#24046;&#12375;&#24341;&#12356;&#12383;&#12392;&#12398;&#35352;&#36848;&#12364;&#12354;&#12427;&#12364;&#65292;
 &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#20418;&#12427;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#12434;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#12371;&#12392;&#12363;&#12425;&#65292;
 &#20195;&#26367;&#12392;&#12375;&#12390;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#21516;&#19968;&#20225;&#26989;&#20869;&#21462;&#24341;&#12301;&#20998;&#12434;&#38500;&#22806;&#12377;&#12427;&#12371;&#12392;&#12392;&#12377;&#12427;&#65294;

 2021&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#38477;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12364;&#20225;&#26989;&#35519;&#26619;&#31080;&#12392;&#12394;&#12387;&#12383;&#22580;&#21512;&#65292;
 &#12371;&#12428;&#12425;&#12398;&#20966;&#29702;&#12398;&#20869;&#20225;&#26989;&#20869;&#21462;&#24341;&#12399;&#12381;&#12418;&#12381;&#12418;&#35519;&#26619;&#31080;&#12395;&#29694;&#12428;&#12394;&#12367;&#12394;&#12427;&#12383;&#12417;&#65292;&#20966;&#29702;&#12364;&#19981;&#24517;&#35201;&#12392;&#12394;&#12427;&#12364;&#65292;
 &#29694;&#34892;&#12398;&#12300;&#30456;&#25163;&#20808;&#21454;&#20837;&#21106;&#21512;&#12301;&#21450;&#12403;&#12300;&#21516;&#26989;&#32773;&#12392;&#12398;&#22865;&#32004;&#21106;&#21512;&#12301;&#12395;&#12424;&#12387;&#12390;&#25512;&#35336;&#12373;&#12428;&#12427;&#38989;&#12392;&#21516;&#31561;&#12398;&#12418;&#12398;&#12392;&#12394;&#12427;&#12363;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#35696;&#35542;&#12364;&#24517;&#35201;&#12391;&#12354;&#12427;&#65294; 

 

-}</span><span>
</span><a name="line-3134"></a><span>
</span><a name="line-3135"></a><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412642"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412642"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3136"></a><a name="f%4F01%696D%5185%53D6%5F15%524A%9664"><a href="V.html#f%4F01%696D%5185%53D6%5F15%524A%9664"><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679413751"><a href="#local-6989586621679413751"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413752"><a href="#local-6989586621679413752"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-3137"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413752"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3138"></a><span>                        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3139"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413753"><a href="#local-6989586621679413753"><span class="hs-identifier">icr</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413753"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-var">H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span class="hs-special">)</span><span>    </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413754"><a href="#local-6989586621679413754"><span class="hs-identifier">valTarget</span></a></a><span>
</span><a name="line-3140"></a><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413753"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%540C%696D%8005%5272%5408_%30B5B"><span class="hs-identifier hs-var">H&#21516;&#26989;&#32773;&#21106;&#21512;_&#12469;B</span></a><span class="hs-special">)</span><span>          </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413755"><a href="#local-6989586621679413755"><span class="hs-identifier">valSame</span></a></a><span>
</span><a name="line-3141"></a><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413753"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span>            </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413756"><a href="#local-6989586621679413756"><span class="hs-identifier">valBusi</span></a></a><span>
</span><a name="line-3142"></a><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413753"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413757"><a href="#local-6989586621679413757"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-3143"></a><span>                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%4F01%696D%5185%53D6%5F15%524A%9664%51E6%7406"><span class="hs-identifier hs-var">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413751"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413753"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413754"><span class="hs-identifier hs-var">valTarget</span></a><span> </span><a href="#local-6989586621679413755"><span class="hs-identifier hs-var">valSame</span></a><span> </span><a href="#local-6989586621679413756"><span class="hs-identifier hs-var">valBusi</span></a><span> </span><a href="#local-6989586621679413757"><span class="hs-identifier hs-var">valComm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3144"></a><span>                                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679413753"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3145"></a><span>                                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%4F01%696D%5185%53D6%5F15%524A%9664"><span class="hs-identifier hs-var">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;</span></a><span> </span><a href="#local-6989586621679413751"><span class="hs-identifier hs-var">year</span></a><span>
</span><a name="line-3146"></a><span>
</span><a name="line-3147"></a><span>
</span><a name="line-3148"></a><span class="hs-comment">-- | &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12363;&#21450;&#12403;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12363;&#12425;&#20225;&#26989;&#20869;&#21462;&#24341;&#12392;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#12434;&#21066;&#38500;&#12377;&#12427;</span><span>
</span><a name="line-3149"></a><span class="hs-comment">-- </span><span>
</span><a name="line-3150"></a><span class="hs-comment">--  &#20516;&#12398;&#12394;&#12356;&#12418;&#12398;&#12398;&#20107;&#26989;&#20998;&#39006;&#12395;&#38306;&#12375;&#12390;&#12399;&#21462;&#24341;&#12398;&#21066;&#38500;&#12434;&#34892;&#12431;&#12394;&#12356;(&#24179;&#22343;&#20516;&#20351;&#12358;&#12392;&#12363;&#35201;&#20462;&#27491;)</span><span>
</span><a name="line-3151"></a><span class="hs-comment">-- </span><span>
</span><a name="line-3152"></a><span class="hs-comment">-- &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12363;&#12425;&#12399;,&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12391;&#24341;&#12356;&#12383;&#32207;&#38989;&#12434;&#24341;&#12367;</span><span>
</span><a name="line-3153"></a><span>
</span><a name="line-3154"></a><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;&#20966;&#29702;</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-3155"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-3156"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-3157"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%540C%696D%8005%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#21516;&#26989;&#32773;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-3158"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3159"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3160"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3161"></a><span>
</span><a name="line-3162"></a><a name="f%4F01%696D%5185%53D6%5F15%524A%9664%51E6%7406"><a href="V.html#f%4F01%696D%5185%53D6%5F15%524A%9664%51E6%7406"><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413758"><a href="#local-6989586621679413758"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413759"><a href="#local-6989586621679413759"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413760"><a href="#local-6989586621679413760"><span class="hs-identifier">valTarget</span></a></a><span> </span><a name="local-6989586621679413761"><a href="#local-6989586621679413761"><span class="hs-identifier">valSame</span></a></a><span> </span><a name="local-6989586621679413762"><a href="#local-6989586621679413762"><span class="hs-identifier">valBusi</span></a></a><span> </span><a name="local-6989586621679413763"><a href="#local-6989586621679413763"><span class="hs-identifier">valComm</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3163"></a><span>        </span><a name="local-6989586621679413770"><a href="#local-6989586621679413770"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-comment">-- &#24773;&#22577;&#29987;&#26989;&#12398;&#12510;&#12452;&#12490;&#12473;&#20998;</span><span>
</span><a name="line-3164"></a><span>        </span><a name="local-6989586621679413771"><a href="#local-6989586621679413771"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-comment">-- &#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12510;&#12452;&#12490;&#12473;&#20998;</span><span>
</span><a name="line-3165"></a><span>        </span><a name="local-6989586621679413772"><a href="#local-6989586621679413772"><span class="hs-identifier">toMinusOth</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-comment">-- &#19978;&#35352;&#20197;&#22806;&#12398;&#12469;&#12540;&#12499;&#12473;&#26989;&#12398;&#12510;&#12452;&#12490;&#12473;&#20998;</span><span>
</span><a name="line-3166"></a><span>        </span><span class="hs-comment">-- &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span><span>
</span><a name="line-3167"></a><span>        </span><a href="V.html#f%60C5%5831%7523%696D%524A%9664"><span class="hs-identifier hs-var">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span></a><span>    </span><a href="#local-6989586621679413758"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413759"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413770"><span class="hs-identifier hs-var">toMinusInfo</span></a><span> </span><a href="#local-6989586621679413761"><span class="hs-identifier hs-var">valSame</span></a><span>   </span><a href="#local-6989586621679413763"><span class="hs-identifier hs-var">valComm</span></a><span>
</span><a name="line-3168"></a><span>        </span><a href="V.html#f%7269%54C1%8CC3%8CB8%696D%524A%9664"><span class="hs-identifier hs-var">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span></a><span>  </span><a href="#local-6989586621679413758"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413759"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413771"><span class="hs-identifier hs-var">toMinusRent</span></a><span> </span><a href="#local-6989586621679413760"><span class="hs-identifier hs-var">valTarget</span></a><span> </span><a href="#local-6989586621679413763"><span class="hs-identifier hs-var">valComm</span></a><span>
</span><a name="line-3169"></a><span>        </span><a href="V.html#f%305D%306E%4ED6%306E%30B5B%524A%9664"><span class="hs-identifier hs-var">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span></a><span> </span><a href="#local-6989586621679413758"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679413759"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413772"><span class="hs-identifier hs-var">toMinusOth</span></a><span>  </span><a href="#local-6989586621679413760"><span class="hs-identifier hs-var">valTarget</span></a><span> </span><a href="#local-6989586621679413763"><span class="hs-identifier hs-var">valComm</span></a><span>
</span><a name="line-3170"></a><span>        </span><span class="hs-comment">-- &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span><span>
</span><a name="line-3171"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413762"><span class="hs-identifier hs-var">valBusi</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3172"></a><span>            </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3173"></a><span>            </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413773"><a href="#local-6989586621679413773"><span class="hs-identifier">busi</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413770"><span class="hs-identifier hs-var">toMinusInfo</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413774"><a href="#local-6989586621679413774"><span class="hs-identifier">minusInfo</span></a></a><span>
</span><a name="line-3174"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413771"><span class="hs-identifier hs-var">toMinusRent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413775"><a href="#local-6989586621679413775"><span class="hs-identifier">minusRent</span></a></a><span>
</span><a name="line-3175"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413772"><span class="hs-identifier hs-var">toMinusOth</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413776"><a href="#local-6989586621679413776"><span class="hs-identifier">minusOth</span></a></a><span>
</span><a name="line-3176"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413759"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413764"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679413774"><span class="hs-identifier hs-var">minusInfo</span></a><span> </span><a href="#local-6989586621679413775"><span class="hs-identifier hs-var">minusRent</span></a><span> </span><a href="#local-6989586621679413776"><span class="hs-identifier hs-var">minusOth</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413773"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3177"></a><span>
</span><a name="line-3178"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-3179"></a><span>        </span><a name="local-6989586621679413764"><a href="#local-6989586621679413764"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679413765"><a href="#local-6989586621679413765"><span class="hs-identifier">minusInfo</span></a></a><span> </span><a name="local-6989586621679413766"><a href="#local-6989586621679413766"><span class="hs-identifier">minusRent</span></a></a><span> </span><a name="local-6989586621679413767"><a href="#local-6989586621679413767"><span class="hs-identifier">minusOth</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413768"><a href="#local-6989586621679413768"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413769"><a href="#local-6989586621679413769"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3180"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413769"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T12&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413768"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413765"><span class="hs-identifier hs-var">minusInfo</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413769"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3181"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413769"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T14&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413768"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413766"><span class="hs-identifier hs-var">minusRent</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413769"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3182"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413769"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;T20&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413768"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413767"><span class="hs-identifier hs-var">minusOth</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679413769"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3183"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413768"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413769"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3184"></a><span>
</span><a name="line-3185"></a><span>
</span><a name="line-3186"></a><span>
</span><a name="line-3187"></a><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%540C%696D%8005%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#21516;&#26989;&#32773;&#21106;&#21512;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3188"></a><a name="f%60C5%5831%7523%696D%524A%9664"><a href="V.html#f%60C5%5831%7523%696D%524A%9664"><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679413777"><a href="#local-6989586621679413777"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413778"><a href="#local-6989586621679413778"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413779"><a href="#local-6989586621679413779"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3189"></a><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679413780"><a href="#local-6989586621679413780"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413781"><a href="#local-6989586621679413781"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413782"><a href="#local-6989586621679413782"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3190"></a><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679413783"><a href="#local-6989586621679413783"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413784"><a href="#local-6989586621679413784"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413785"><a href="#local-6989586621679413785"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679413786"><a href="#local-6989586621679413786"><span class="hs-identifier">same</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413787"><a href="#local-6989586621679413787"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3191"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413788"><a href="#local-6989586621679413788"><span class="hs-identifier">result</span></a></a><span>
</span><a name="line-3192"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413787"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413789"><a href="#local-6989586621679413789"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413790"><a href="#local-6989586621679413790"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3193"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="V.html#isDetail%60C5%5831%7523%696D"><span class="hs-identifier hs-var">isDetail&#24773;&#22577;&#29987;&#26989;</span></a><span> </span><a href="#local-6989586621679413783"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413789"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413790"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3194"></a><span>            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413788"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413789"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413790"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-3195"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413788"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413789"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413786"><span class="hs-identifier hs-var">same</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413790"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-3196"></a><span>                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413785"><span class="hs-identifier hs-var">toMinusInfo</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679413789"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413786"><span class="hs-identifier hs-var">same</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3197"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>    </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span>
</span><a name="line-3198"></a><span>                </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413788"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-3199"></a><span>                </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413784"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3200"></a><span>
</span><a name="line-3201"></a><span>
</span><a name="line-3202"></a><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3203"></a><a name="f%7269%54C1%8CC3%8CB8%696D%524A%9664"><a href="V.html#f%7269%54C1%8CC3%8CB8%696D%524A%9664"><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679413791"><a href="#local-6989586621679413791"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413792"><a href="#local-6989586621679413792"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413793"><a href="#local-6989586621679413793"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3204"></a><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679413794"><a href="#local-6989586621679413794"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413795"><a href="#local-6989586621679413795"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413796"><a href="#local-6989586621679413796"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3205"></a><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679413797"><a href="#local-6989586621679413797"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413798"><a href="#local-6989586621679413798"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413799"><a href="#local-6989586621679413799"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-var">V&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><a name="local-6989586621679413800"><a href="#local-6989586621679413800"><span class="hs-identifier">eRate</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413801"><a href="#local-6989586621679413801"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3206"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413802"><a href="#local-6989586621679413802"><span class="hs-identifier">rate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#21516;&#19968;&#20225;&#26989;</span><span> </span><a href="#local-6989586621679413800"><span class="hs-identifier hs-var">eRate</span></a><span>
</span><a name="line-3207"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413803"><a href="#local-6989586621679413803"><span class="hs-identifier">result</span></a></a><span>
</span><a name="line-3208"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413801"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413804"><a href="#local-6989586621679413804"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413805"><a href="#local-6989586621679413805"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3209"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="V.html#isDetail%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><a href="#local-6989586621679413797"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413804"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413805"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3210"></a><span>            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413803"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413804"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413805"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-3211"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413803"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413804"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413802"><span class="hs-identifier hs-var">rate</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413805"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-3212"></a><span>                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413799"><span class="hs-identifier hs-var">toMinusRent</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679413804"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413802"><span class="hs-identifier hs-var">rate</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3213"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>    </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span>
</span><a name="line-3214"></a><span>                </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413803"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-3215"></a><span>
</span><a name="line-3216"></a><span>
</span><a name="line-3217"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VDS.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3218"></a><a name="f%305D%306E%4ED6%306E%30B5B%524A%9664"><a href="V.html#f%305D%306E%4ED6%306E%30B5B%524A%9664"><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679413806"><a href="#local-6989586621679413806"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413807"><a href="#local-6989586621679413807"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413808"><a href="#local-6989586621679413808"><span class="hs-identifier">toMinusOth</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3219"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span><span> </span><a name="local-6989586621679413809"><a href="#local-6989586621679413809"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413810"><a href="#local-6989586621679413810"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413811"><a href="#local-6989586621679413811"><span class="hs-identifier">toMinusOth</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3220"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span><span> </span><a name="local-6989586621679413812"><a href="#local-6989586621679413812"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679413813"><a href="#local-6989586621679413813"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413814"><a href="#local-6989586621679413814"><span class="hs-identifier">toMinusOth</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-var">V&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><a name="local-6989586621679413815"><a href="#local-6989586621679413815"><span class="hs-identifier">eRate</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413816"><a href="#local-6989586621679413816"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3221"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413817"><a href="#local-6989586621679413817"><span class="hs-identifier">rate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#21516;&#19968;&#20225;&#26989;</span><span> </span><a href="#local-6989586621679413815"><span class="hs-identifier hs-var">eRate</span></a><span>
</span><a name="line-3222"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413818"><a href="#local-6989586621679413818"><span class="hs-identifier">result</span></a></a><span>
</span><a name="line-3223"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413816"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413819"><a href="#local-6989586621679413819"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679413820"><a href="#local-6989586621679413820"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3224"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="V.html#isDetail%305D%306E%4ED6%306E%30B5B"><span class="hs-identifier hs-var">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span></a><span> </span><a href="#local-6989586621679413812"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413819"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413820"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3225"></a><span>            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413818"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679413819"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679413820"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-3226"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413818"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413819"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413817"><span class="hs-identifier hs-var">rate</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413820"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-3227"></a><span>                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413814"><span class="hs-identifier hs-var">toMinusOth</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679413819"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679413817"><span class="hs-identifier hs-var">rate</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3228"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>    </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span>
</span><a name="line-3229"></a><span>                </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413818"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-3230"></a><span>
</span><a name="line-3231"></a><span>
</span><a name="line-3232"></a><span class="hs-comment">-- | 22&#21306;&#20998;&#21450;&#12403;&#32048;&#20998;&#39006;&#12391;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#65292;&#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#26989;&#12363;&#21028;&#23450;</span><span>
</span><a name="line-3233"></a><span class="hs-identifier">isDetail&#24773;&#22577;&#29987;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3234"></a><a name="isDetail%60C5%5831%7523%696D"><a href="V.html#isDetail%60C5%5831%7523%696D"><span class="hs-identifier">isDetail&#24773;&#22577;&#29987;&#26989;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413821"><a href="#local-6989586621679413821"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413821"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;39&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3235"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413821"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;40&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3236"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3237"></a><span>
</span><a name="line-3238"></a><span class="hs-identifier">isDetail&#24773;&#22577;&#29987;&#26989;</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679413822"><a href="#local-6989586621679413822"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413822"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;39&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3239"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413822"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;40&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3240"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3241"></a><span>
</span><a name="line-3242"></a><span>
</span><a name="line-3243"></a><span class="hs-comment">-- | &#32048;&#20998;&#39006;&#12391;&#29289;&#21697;&#36035;&#36024;&#26989;&#12363;&#21028;&#23450;</span><span>
</span><a name="line-3244"></a><span class="hs-identifier">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3245"></a><a name="isDetail%7269%54C1%8CC3%8CB8%696D"><a href="V.html#isDetail%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413823"><a href="#local-6989586621679413823"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413823"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;70&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3246"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3247"></a><span>
</span><a name="line-3248"></a><span class="hs-identifier">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679413824"><a href="#local-6989586621679413824"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413824"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;70&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3249"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3250"></a><span>
</span><a name="line-3251"></a><span>
</span><a name="line-3252"></a><span>
</span><a name="line-3253"></a><span class="hs-comment">-- | &#32048;&#20998;&#39006;&#12391;&#24195;&#21578; &#65292;&#35686;&#20633;&#26989;&#65292;&#12503;&#12521;&#12531;&#12488;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;&#26989;&#21450;&#12403;&#37489;&#29289;&#25506;&#26619;&#20197;&#22806;&#12398;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-3254"></a><span class="hs-comment">-- </span><span>
</span><a name="line-3255"></a><span class="hs-comment">-- &#12503;&#12521;&#12531;&#12488;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;,&#37489;&#29289;&#25506;&#26619;&#12398;&#21306;&#21029;&#12399;&#19981;&#21487;&#12394;&#12398;&#12391;,&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473;&#20840;&#20307;&#12391;&#36969;&#29992;</span><span>
</span><a name="line-3256"></a><span class="hs-identifier">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VClass.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3257"></a><a name="isDetail%305D%306E%4ED6%306E%30B5B"><a href="V.html#isDetail%305D%306E%4ED6%306E%30B5B"><span class="hs-identifier">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679413825"><a href="#local-6989586621679413825"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413825"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;73&quot;</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#24195;&#21578;</span><span>
</span><a name="line-3258"></a><span>                          </span><span class="hs-glyph">|</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413825"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;9231&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#35686;&#20633;&#26989;</span><span>
</span><a name="line-3259"></a><span>                          </span><span class="hs-glyph">|</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413825"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;9299&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473; </span><span>
</span><a name="line-3260"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3261"></a><span>
</span><a name="line-3262"></a><span class="hs-identifier">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679413826"><a href="#local-6989586621679413826"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413826"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;73&quot;</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#24195;&#21578;</span><span>
</span><a name="line-3263"></a><span>                          </span><span class="hs-glyph">|</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413826"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;9231&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#35686;&#20633;&#26989;</span><span>
</span><a name="line-3264"></a><span>                          </span><span class="hs-glyph">|</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413826"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;9299&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473; </span><span>
</span><a name="line-3265"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3266"></a><span>
</span><a name="line-3267"></a><span>
</span><a name="line-3268"></a><span>
</span><a name="line-3269"></a><span>
</span><a name="line-3270"></a><span>
</span><a name="line-3271"></a><span class="hs-comment">-- ** &#20225;&#26989;&#24115;&#31080;&#12398;&#21462;&#25201;</span><span>
</span><a name="line-3272"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-3273"></a><span class="hs-comment">{- | 

* &#9312; &#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12398;&#20225;&#26989;&#12398;&#20632;&#19979;&#12395;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#23384;&#22312;&#12377;&#12427;&#12465;&#12540;&#12473;
 
 &#12371;&#12398;&#12465;&#12540;&#12473;&#12391;&#12399;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20225;&#26989;&#12398;&#20632;&#19979;&#20107;&#26989;&#25152;&#12391;&#12354;&#12427;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#38989;&#31561;&#12398;&#24773;&#22577;&#12399;&#65292;
 &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#19988;&#12388;&#12381;&#12398;&#20516;&#12399;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12434;&#20803;&#12395;&#38598;&#35336;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;
 &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#20516;&#20840;&#12390;&#12434;&#38598;&#35336;&#12377;&#12427;&#12392;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#38598;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#37096;&#20998;&#12395;&#38306;&#12375;&#12390;&#37325;&#35079;&#12364;&#30330;&#29983;&#12377;&#12427;&#65294;
 &#12371;&#12398;&#37325;&#35079;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;&#12395;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#38598;&#35336;&#21336;&#20301;&#12434;&#20225;&#26989;&#12391;&#12399;&#12394;&#12367;&#65292;
 &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12427;&#37096;&#20998;&#12434;&#38500;&#12356;&#12383;&#37096;&#20998;&#12434;&#19968;&#12388;&#12398;&#20107;&#26989;&#25152;&#12392;&#12415;&#12394;&#12375;&#12383;&#20206;&#24819;&#20107;&#26989;&#25152;&#12392;&#12375;&#12390;&#38598;&#35336;&#12434;&#34892;&#12358;&#65294;
 &#12394;&#12362;&#65292;&#12371;&#12398;&#12424;&#12358;&#12394;&#20966;&#29702;&#12364;&#29694;&#34892;&#12398;&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12371;&#12392;&#12434;&#31034;&#12377;&#36039;&#26009;&#12434;&#31558;&#32773;&#12399;&#35211;&#12388;&#12369;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12394;&#12363;&#12387;&#12383;&#12383;&#12417;&#65292;
 &#12371;&#12398;&#35430;&#31639;&#12399;&#20170;&#24460;&#12398;&#35506;&#38988;&#12392;&#12375;&#12383;&#12356;&#65294;


* &#9313; &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12398;&#20225;&#26989;&#12398;&#20632;&#19979;&#12395;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#23384;&#22312;&#12377;&#12427;&#22580;&#21512;&#65294;
 &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20225;&#26989;&#12398;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#20516;&#12399;&#65292;&#36890;&#24120;&#38598;&#35336;&#12395;&#12399;&#29992;&#12356;&#12425;&#12428;&#12394;&#12356;&#12364;&#65292;
 &#12371;&#12398;&#20225;&#26989;&#12398;&#20632;&#19979;&#20107;&#26989;&#25152;&#12395;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#23384;&#22312;&#12375;&#12383;&#22580;&#21512;&#65292;&#12381;&#12398;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#39640;&#31561;&#12398;&#20516;&#12399;&#65292;
 &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#65294;&#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#12371;&#12398;&#20225;&#26989;&#12395;&#38306;&#12375;&#12390;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#12415;&#12434;&#38598;&#35336;&#12395;&#29992;&#12356;&#12383;&#22580;&#21512;&#65292;
 &#12381;&#12398;&#20225;&#26989;&#20632;&#19979;&#12398;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12398;&#20516;&#12364;&#38598;&#35336;&#12363;&#12425;&#27424;&#25613;&#12377;&#12427;&#12371;&#12392;&#12392;&#12394;&#12427;&#65294;
 &#12371;&#12428;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;&#65292;&#12371;&#12398;&#20225;&#26989;&#20632;&#19979;&#12398;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12398;&#20516;&#12434;&#38500;&#12356;&#12383;&#37096;&#20998;&#12434;&#20206;&#24819;&#20107;&#26989;&#25152;&#12392;&#12375;&#12390;&#38598;&#35336;&#12395;&#21152;&#12360;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#65294;
 &#12371;&#12398;&#28857;&#12395;&#38306;&#12375;&#12390;&#21839;&#38988;&#12392;&#12394;&#12427;&#12398;&#12399;&#65292;&#29305;&#12395;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12364;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12392;&#12394;&#12427;&#12371;&#12392;&#12391;&#65292;&#12393;&#12398;&#31243;&#24230;&#24433;&#38911;&#12364;&#12391;&#12427;&#12363;&#12391;&#12354;&#12427;&#12364;&#65292;
 &#12371;&#12398;&#28857;&#12395;&#38306;&#12375;&#12390;&#12418;&#20170;&#24460;&#12398;&#35430;&#31639;&#12395;&#12424;&#12427;&#35506;&#38988;&#12392;&#12375;&#12383;&#12356;&#65294;

-}</span><span>
</span><a name="line-3296"></a><span>
</span><a name="line-3297"></a><a name="f%4F01%696D%8ABF%67FB%7968%51E6%7406"><a href="V.html#f%4F01%696D%8ABF%67FB%7968%51E6%7406"><span class="hs-identifier">f&#20225;&#26989;&#35519;&#26619;&#31080;&#20966;&#29702;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-3298"></a><span>
</span><a name="line-3299"></a><span>
</span><a name="line-3300"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3301"></a><span class="hs-comment">-- * &#21103;&#26989;&#12398;&#20998;&#35299;</span><span>
</span><a name="line-3302"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3303"></a><span>
</span><a name="line-3304"></a><span class="hs-comment">-- | &#30476; 1-47</span><span>
</span><a name="line-3305"></a><span class="hs-keyword">type</span><span> </span><a name="PrefInt"><a href="V.html#PrefInt"><span class="hs-identifier">PrefInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-3306"></a><span>
</span><a name="line-3307"></a><span class="hs-comment">-- | 22&#21306;&#20998;&#12398;&#20107;&#26989; 1 - 22</span><span>
</span><a name="line-3308"></a><span class="hs-keyword">type</span><span> </span><a name="BusiInt"><a href="V.html#BusiInt"><span class="hs-identifier">BusiInt</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-3309"></a><span>
</span><a name="line-3310"></a><span class="hs-comment">-- | &#29987;&#26989;&#32048;&#20998;&#39006; 1- 1617</span><span>
</span><a name="line-3311"></a><span class="hs-keyword">type</span><span> </span><a name="DetaInt"><a href="V.html#DetaInt"><span class="hs-identifier">DetaInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-3312"></a><span>
</span><a name="line-3313"></a><span class="hs-comment">-- | &#30476;&#21029;22&#21306;&#20998;&#21029;&#29987;&#26989;&#32048;&#20998;&#39006;&#21029;&#12398;&#12395;&#23550;&#12377;&#12427;&#27604;&#29575;&#12398;Map</span><span>
</span><a name="line-3314"></a><span class="hs-keyword">type</span><span> </span><a name="SubRateArray"><a href="V.html#SubRateArray"><span class="hs-identifier">SubRateArray</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="V.html#PrefInt"><span class="hs-identifier hs-type">PrefInt</span></a><span class="hs-special">,</span><span> </span><a href="V.html#BusiInt"><span class="hs-identifier hs-type">BusiInt</span></a><span class="hs-special">,</span><span> </span><a href="V.html#DetaInt"><span class="hs-identifier hs-type">DetaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3315"></a><span>
</span><a name="line-3316"></a><span>
</span><a name="line-3317"></a><span class="hs-comment">-- | &#38750;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;</span><span>
</span><a name="line-3318"></a><span class="hs-comment">--</span><span>
</span><a name="line-3319"></a><span class="hs-comment">-- &#12371;&#12428;&#12391;&#12523;&#12540;&#12503;&#12434;&#22238;&#12377;&#12371;&#12392;&#12391;&#23455;&#36074;&#30340;&#12395;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12434;&#25244;&#12356;&#12390;&#12356;&#12427;&#12371;&#12392;&#12392;&#21516;&#12376;&#12395;&#12377;&#12427;. </span><span>
</span><a name="line-3320"></a><span class="hs-comment">--</span><span>
</span><a name="line-3321"></a><span class="hs-comment">-- &#20170;&#12399;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12394;&#12375;(&#35201;&#20462;&#27491;)</span><span>
</span><a name="line-3322"></a><a name="canBeSub"><a href="V.html#canBeSub"><span class="hs-identifier">canBeSub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">2000</span><span class="hs-special">]</span><span>
</span><a name="line-3323"></a><span>
</span><a name="line-3324"></a><span class="hs-comment">-- | &#22320;&#22495;&#12467;&#12540;&#12489;&#12363;&#12425;&#30476;&#12398;&#30058;&#21495;&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-3325"></a><span class="hs-identifier">area2Int</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#PrefInt"><span class="hs-identifier hs-type">PrefInt</span></a><span>
</span><a name="line-3326"></a><a name="area2Int"><a href="V.html#area2Int"><span class="hs-identifier">area2Int</span></a></a><span> </span><a name="local-6989586621679413827"><a href="#local-6989586621679413827"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VIO.html#textToInt"><span class="hs-identifier hs-var">VIO.textToInt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TL.take</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679413827"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-3327"></a><span>
</span><a name="line-3328"></a><span class="hs-comment">-- | &#20107;&#26989;&#20998;&#39006;&#12363;&#12425;BusiInt&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-3329"></a><span class="hs-identifier">busi2Int</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#BusiInt"><span class="hs-identifier hs-type">BusiInt</span></a><span>
</span><a name="line-3330"></a><a name="busi2Int"><a href="V.html#busi2Int"><span class="hs-identifier">busi2Int</span></a></a><span> </span><a name="local-6989586621679413828"><a href="#local-6989586621679413828"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VIO.html#textToInt"><span class="hs-identifier hs-var">VIO.textToInt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TL.tail</span><span> </span><a href="#local-6989586621679413828"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-3331"></a><span>
</span><a name="line-3332"></a><span class="hs-comment">-- | Int&#12363;&#12425;Business&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-3333"></a><span class="hs-identifier">int2Busi</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>
</span><a name="line-3334"></a><a name="int2Busi"><a href="V.html#int2Busi"><span class="hs-identifier">int2Busi</span></a></a><span> </span><a name="local-6989586621679413829"><a href="#local-6989586621679413829"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413829"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679413829"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">9</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;T0&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679413829"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span>
</span><a name="line-3335"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679413829"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679413829"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">22</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;T&quot;</span><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679413829"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span>
</span><a name="line-3336"></a><span>
</span><a name="line-3337"></a><span class="hs-comment">-- | &#32048;&#20998;&#39006;&#12363;&#12425;DetaIot &#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-3338"></a><span class="hs-identifier">deta2Int</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-identifier hs-type">TL.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#DetaInt"><span class="hs-identifier hs-type">DetaInt</span></a><span>
</span><a name="line-3339"></a><a name="deta2Int"><a href="V.html#deta2Int"><span class="hs-identifier">deta2Int</span></a></a><span> </span><a name="local-6989586621679413830"><a href="#local-6989586621679413830"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679413830"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VClass.html#ci%7D30%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9"><span class="hs-identifier hs-var">VClass.ci&#32048;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3340"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413831"><a href="#local-6989586621679413831"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679413831"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-3341"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;error : deta2Int : Can not find deta&quot;</span><span>
</span><a name="line-3342"></a><span>
</span><a name="line-3343"></a><span class="hs-comment">-- | DetaIot &#12363;&#12425; &#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-3344"></a><span class="hs-identifier">int2Deta</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="V.html#DetaInt"><span class="hs-identifier hs-type">DetaInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VClass.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>
</span><a name="line-3345"></a><a name="int2Deta"><a href="V.html#int2Deta"><span class="hs-identifier">int2Deta</span></a></a><span> </span><a name="local-6989586621679413832"><a href="#local-6989586621679413832"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679413832"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span> </span><a href="VClass.html#ic%7D30%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9"><span class="hs-identifier hs-var">VClass.ic&#32048;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3346"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413833"><a href="#local-6989586621679413833"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679413833"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-3347"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;error : int2Deta : Can not find deta&quot;</span><span>
</span><a name="line-3348"></a><span>
</span><a name="line-3349"></a><span>
</span><a name="line-3350"></a><span>
</span><a name="line-3351"></a><span>
</span><a name="line-3352"></a><span class="hs-comment">{- |
 &#12371;&#12428;&#12414;&#12391;&#12395;&#34892;&#12431;&#12428;&#12383;&#20966;&#29702;&#12434;&#32076;&#12390;&#65292;&#21508;&#20107;&#26989;&#25152;&#12398;22&#21306;&#20998;&#12398;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21450;&#12403;&#65292;
 &#20027;&#26989;&#12395;&#38306;&#12377;&#12427;&#20107;&#26989;&#21029;&#21830;&#21697;&#21029;&#29987;&#20986;&#38989;&#12364;&#25226;&#25569;&#12373;&#12428;&#12383;&#12371;&#12392;&#12392;&#12394;&#12427;&#65294;

 &#12375;&#12363;&#12375;&#65292;22&#21306;&#20998;&#12398;&#20027;&#26989;&#20197;&#22806;&#12398;&#20107;&#26989;&#65292;&#21363;&#12385;&#21103;&#26989;&#12398;&#20869;&#35379;&#65288;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#65289;&#12395;&#38306;&#12377;&#12427;&#35443;&#32048;&#12399;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#65294;
 &#23455;&#38555;&#12398;&#21508;&#20107;&#26989;&#25152;&#12398;&#21103;&#26989;&#12398;&#20869;&#35379;&#12399;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#35519;&#26619;&#32080;&#26524;&#12363;&#12425;&#25226;&#25569;&#12373;&#12428;&#12394;&#12356;&#12383;&#12417;&#65292;
 &#12371;&#12371;&#12391;&#12399;&#65292;&#29305;&#23450;&#12398;&#20107;&#26989;&#25152;&#12398;&#21103;&#26989;&#12395;&#38306;&#12375;&#12390;&#65292;&#12381;&#12398;&#21103;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12398;&#12487;&#12540;&#12479;&#12434;&#22522;&#12395;&#21103;&#26989;&#12398;&#20516;&#12434;&#25353;&#20998;&#12377;&#12427;&#12371;&#12392;&#12392;&#12377;&#12427;&#65294;
 &#21103;&#26989;&#12398;&#20998;&#35299;&#12398;&#25163;&#27861;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
 &#12300;&#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920; &#31532;13&#22238; &#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696; &#37197;&#24067;&#36039;&#26009;&#65288;&#65297;&#65289;
  &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12398;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12375;&#12383;&#22269;&#20869;&#29983;&#29987;&#38989;&#12398;&#25512;&#35336;&#12395;&#12388;&#12356;&#12390; 
  &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#24471;&#12425;&#12428;&#12427;&#21103;&#26989;&#12487;&#12540;&#12479;&#12434;IO&#37096;&#38272;&#12395;&#20998;&#35299;&#12377;&#12427;&#26041;&#27861;&#26696;&#21450;&#12403;&#30041;&#24847;&#28857; &#8544; &#22522;&#26412;&#30340;&#12394;&#35336;&#31639;&#26041;&#27861;&#12301;
  &#12395;&#12362;&#12356;&#12390;&#65292;&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

&#32068;&#26367;&#38598;&#35336;&#12363;&#12425;&#24471;&#12425;&#12428;&#12427;&#20027;&#26989;&#12505;&#12540;&#12473;&#12398;&#37096;&#38272;&#21029;&#22770;&#19978;&#39640;A&#12434;&#29992;&#12356;&#12390;&#37096;&#38272;&#21029;&#12398;&#27604;&#29575;B&#12434;&#20316;&#12427;&#65292;
&#12371;&#12398;&#27604;&#29575;&#12434;&#65292;&#12402;&#12394;&#24418;&#12539;&#32113;&#21512;&#20998;&#39006;&#12505;&#12540;&#12473;&#12398;&#32207;&#38989;&#12375;&#12363;&#20998;&#12363;&#12425;&#12394;&#12356;&#21103;&#26989;&#12398;&#22770;&#19978;&#39640;C&#12395;&#20055;&#12376;&#12390;&#65292;&#37096;&#38272;&#21029;&#12398;&#21103;&#26989;&#25512;&#35336;&#20516;D&#12434;&#35336;&#31639;&#12377;&#12427;&#65294;
&#30041;&#24847;&#28857;

&#9312; &#22320;&#22495;&#34920;&#20316;&#25104;&#12398;&#35251;&#28857;&#12418;&#36367;&#12414;&#12360;&#65292;&#21487;&#33021;&#12394;&#31684;&#22258;&#12391;&#37117;&#36947;&#24220;&#30476;&#21029;&#12395;&#35336;&#31639;&#12375;&#65292;&#12381;&#12398;&#31309;&#12415;&#19978;&#12370;&#12434;&#12418;&#12387;&#12390;&#20840;&#22269;&#20516;&#12392;&#12377;&#12427;&#65294;

&#9313; &#21103;&#26989;&#12392;&#12375;&#12390;&#34892;&#12360;&#12394;&#12356;&#12371;&#12392;&#12364;&#26126;&#30333;&#12394;&#37096;&#38272;&#12395;&#12388;&#12356;&#12390;&#12399;&#65292;&#27604;&#29575;&#35336;&#31639;&#12363;&#12425;&#38500;&#22806;&#12377;&#12427;&#65294;

&#21516;&#36039;&#26009;&#12363;&#12425;&#24341;&#29992; &#19968;&#37096;&#31558;&#32773;&#32232;&#38598;

 &#12371;&#12398;&#12300;&#21103;&#26989;&#12392;&#12375;&#12390;&#34892;&#12360;&#12394;&#12356;&#12371;&#12392;&#12364;&#26126;&#30333;&#12394;&#37096;&#38272;&#12301;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
 &#21516;&#36039;&#26009;&#20013; &#12300;&#21442;&#32771;&#36039;&#26009;&#65297; CT&#25512;&#35336;&#12395;&#12362;&#12369;&#12427;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12398;&#21033;&#29992;&#20104;&#23450;&#65288;&#29694;&#26178;&#28857;&#12391;&#12398;&#35211;&#36796;&#12415;&#65294;&#20170;&#24460;&#12398;&#22793;&#26356;&#26377;&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
 &#22522;&#26412;&#20998;&#39006;&#12372;&#12392;&#12395;&#12381;&#12428;&#12364;&#65292;&#12300;&#20182;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#65292;&#21103;&#26989;&#12392;&#12375;&#12390;&#34892;&#12358;&#12371;&#12392;&#12364;&#22256;&#38627;&#12301;&#12363;&#21542;&#12363;&#12364;&#19968;&#35239;&#34920;&#12398;&#24418;&#12391;&#25522;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
 &#29539;&#21307;&#26989;&#65292;&#19979;&#27700;&#36947;&#65292;&#20844;&#20849;&#25918;&#36865;&#12394;&#12393;&#12364;&#65292;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12392;&#12375;&#12390;&#35373;&#23450;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
 &#12383;&#12384;&#12375;&#65292;&#24403;&#35442;&#36039;&#26009;&#12399;&#65292;&#34920;&#38988;&#12398;&#36890;&#12426;&#30906;&#23450;&#21069;&#12398;&#35211;&#36796;&#12415;&#12391;&#12354;&#12426;&#65292;&#23455;&#38555;&#12398;&#35373;&#23450;&#12399;&#30064;&#12394;&#12387;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#65294;
 &#23455;&#38555;&#65292;&#21516;&#20250;&#12395;&#12362;&#12369;&#12427;&#35696;&#20107;&#27010;&#35201;&#12391;&#12399;&#65292;

&gt; &#20363;&#12360;&#12400;&#12289;&#12300;&#12488;&#12521;&#12483;&#12463;&#12539;&#12496;&#12473;&#12539;&#12381;&#12398;&#20182;&#12398;&#33258;&#21205;&#36554;&#12301;&#12395;&#12388;&#12356;&#12390;&#12289;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12392;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12364;&#12289;
&gt; &#35069;&#36896;&#26989;&#20197;&#22806;&#12398;&#20107;&#26989;&#25152;&#12391;&#12300;&#12488;&#12521;&#12483;&#12463;&#12539;&#12496;&#12473;&#12539;&#12381;&#12398;&#20182;&#12398;&#33258;&#21205;&#36554;&#12301;&#12398;&#29983;&#29987;&#12364;&#21487;&#33021;&#12392;&#12356;&#12358;&#12371;&#12392;&#12363;&#12290;
&gt; &#29305;&#12395;&#35069;&#36896;&#26989;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#26412;&#26085;&#12398;&#36039;&#26009;&#12391;&#31034;&#12373;&#12428;&#12383;&#12418;&#12398;&#12398;&#12411;&#12363;&#12395;&#12418;&#12289;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12364;&#12354;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12290;
&gt; 
&gt; &#8594;  &#29987;&#26989;&#26684;&#20184;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#19968;&#27425;&#32113;&#35336;&#12395;&#12362;&#12356;&#12390;&#12418;&#38627;&#12375;&#12356;&#35506;&#38988;&#12391;&#12354;&#12427;&#12290;
&gt; &#20363;&#12360;&#12400;&#12289;&#22823;&#35215;&#27169;&#12395;&#38651;&#27671;&#35069;&#21697;&#12398;&#29983;&#29987;&#12539;&#36009;&#22770;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#20225;&#26989;&#12395;&#12388;&#12356;&#12390;&#12289;&#29987;&#26989;&#26684;&#20184;&#19978;&#12289;&#21830;&#26989;&#12392;&#12373;&#12428;&#12383;&#22580;&#21512;&#12289;
&gt; &#20225;&#26989;&#27963;&#21205;&#12398;&#22522;&#26412;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#35069;&#36896;&#26989;&#12398;&#27963;&#21205;&#12399;&#21103;&#26989;&#12394;&#12398;&#12363;&#12392;&#12356;&#12358;&#21839;&#38988;&#12418;&#12354;&#12427;&#12290;&#12381;&#12358;&#12356;&#12387;&#12383;&#24847;&#21619;&#12391;&#12289;&#20027;&#26989;&#12539;&#21103;&#26989;&#12398;&#21306;&#20998;&#12399;&#12289;
&gt; &#27096;&#12293;&#12394;&#35506;&#38988;&#12434;&#12399;&#12425;&#12435;&#12391;&#12356;&#12427;&#12290;
&gt; &#8594;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#26412;&#26085;&#12398;&#24481;&#25351;&#25688;&#12434;&#36367;&#12414;&#12360;&#12390;&#12289;&#23450;&#32681;&#12418;&#21547;&#12417;&#12289;&#25913;&#12417;&#12390;&#25972;&#29702;&#12373;&#12379;&#12390;&#38914;&#12367;&#12290;
&gt;
&gt; &#21516;&#36039;&#26009;&#65292;pp&#65294;3&#12424;&#12426;&#24341;&#29992;

&#12392;&#12356;&#12387;&#12383;&#35696;&#35542;&#12364;&#25522;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#23455;&#38555;&#12398;&#25512;&#35336;&#26178;&#12395;&#12399;&#22823;&#12365;&#12367;&#22793;&#26356;&#12373;&#12428;&#12390;&#12356;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12364;&#65292;
&#31558;&#32773;&#12398;&#25506;&#12377;&#38480;&#12426;&#12391;&#12399;&#12371;&#12398;&#28857;&#12395;&#38306;&#12377;&#12427;&#20844;&#34920;&#36039;&#26009;&#12399;&#23384;&#22312;&#12375;&#12394;&#12356;&#12418;&#12398;&#12392;&#24605;&#12431;&#12428;&#12427;&#65294;
&#22522;&#26412;&#30340;&#12394;&#25512;&#35336;&#25163;&#27861;&#12399;&#65292;&#20808;&#12395;&#12415;&#12383;&#12424;&#12358;&#12395;&#65292;&#30476;&#12372;&#12392;&#12395;&#65292;&#21103;&#26989;&#21029;&#12398;&#32207;&#22770;&#19978;&#39640;&#12395;&#65292;
&#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#12539;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;&#39640;&#12398;&#27604;&#29575;&#12434;&#25499;&#12369;&#12427;&#12371;&#12392;&#12391;&#65292;&#21103;&#26989;&#12398;&#20998;&#35299;&#12364;&#12394;&#12373;&#12428;&#12427;&#12364;&#65292;
&#21516;&#36039;&#26009; &#12300;&#8546;&#12381;&#12398;&#20182;&#12398;&#30041;&#24847;&#28857;&#12301;&#12391;&#12399;&#65292;22&#21306;&#20998;&#12398;&#20869;&#65292;CT&#25512;&#35336;&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12364;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12394;&#12356;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
&#21103;&#26989;&#12487;&#12540;&#12479;&#12398;&#20998;&#35299;&#20316;&#26989;&#12399;&#34892;&#12431;&#12394;&#12356;&#12392;&#12375;&#12390;&#12356;&#12427;&#65294;&#26412;&#31295;&#12391;&#12399;&#65292;&#12371;&#12428;&#12425;&#12398;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12418;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12434;&#29992;&#12356;&#12390;&#65292;
&#21103;&#26989;&#12398;&#20998;&#35299;&#12434;&#34892;&#12358;&#12424;&#12358;&#35373;&#35336;&#12377;&#12427;&#65294;

&#29694;&#27573;&#38542;&#12391;&#12399;,&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12398;&#35373;&#23450;&#12399;&#34892;&#12387;&#12390;&#12356;&#12394;&#12356;(&#35201;&#20462;&#27491;)

-}</span><span>
</span><a name="line-3405"></a><span>
</span><a name="line-3406"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412641"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679412641"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3407"></a><a name="f%526F%696D%306E%5206%89E3"><a href="V.html#f%526F%696D%306E%5206%89E3"><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;</span></a></a><span> </span><a name="local-6989586621679413834"><a href="#local-6989586621679413834"><span class="hs-identifier">sra</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413835"><a href="#local-6989586621679413835"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-3408"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413835"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3409"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3410"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413836"><a href="#local-6989586621679413836"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413836"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413837"><a href="#local-6989586621679413837"><span class="hs-identifier">valBusi</span></a></a><span>
</span><a name="line-3411"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413836"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413838"><a href="#local-6989586621679413838"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-3412"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413836"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>             </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413839"><a href="#local-6989586621679413839"><span class="hs-identifier">valArea</span></a></a><span>
</span><a name="line-3413"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%526F%696D%306E%5206%89E3%51E6%7406"><span class="hs-identifier hs-var">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413834"><span class="hs-identifier hs-var">sra</span></a><span> </span><a href="#local-6989586621679413836"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679413839"><span class="hs-identifier hs-var">valArea</span></a><span> </span><a href="#local-6989586621679413837"><span class="hs-identifier hs-var">valBusi</span></a><span> </span><a href="#local-6989586621679413838"><span class="hs-identifier hs-var">valComm</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3414"></a><span>                             </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679413836"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3415"></a><span>                             </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%526F%696D%306E%5206%89E3"><span class="hs-identifier hs-var">f&#21103;&#26989;&#12398;&#20998;&#35299;</span></a><span> </span><a href="#local-6989586621679413834"><span class="hs-identifier hs-var">sra</span></a><span>
</span><a name="line-3416"></a><span class="hs-comment">{- | 
&#22320;&#22495;&#12467;&#12540;&#12489;&#12364;&#12394;&#12356;&#22580;&#21512;,&#26032;&#28511;(15)&#12398;&#21106;&#21512;&#12434;&#20351;&#12358;(&#22320;&#22495;&#12467;&#12540;&#12489;&#12364;&#12394;&#12356;&#12371;&#12392;&#12399;&#12411;&#12412;&#12394;&#12356;&#12399;&#12378;)

&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;&#20309;&#12418;&#12375;&#12394;&#12356;    
 -}</span><span>
</span><a name="line-3421"></a><span>
</span><a name="line-3422"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3423"></a><a name="f%526F%696D%306E%5206%89E3%51E6%7406"><a href="V.html#f%526F%696D%306E%5206%89E3%51E6%7406"><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413840"><a href="#local-6989586621679413840"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679413841"><a href="#local-6989586621679413841"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679413842"><a href="#local-6989586621679413842"><span class="hs-identifier">valArea</span></a></a><span>      </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><a name="local-6989586621679413843"><a href="#local-6989586621679413843"><span class="hs-identifier">valComm</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3424"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413844"><a href="#local-6989586621679413844"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679413845"><a href="#local-6989586621679413845"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413846"><a href="#local-6989586621679413846"><span class="hs-identifier">area</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413847"><a href="#local-6989586621679413847"><span class="hs-identifier">busi</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679413848"><a href="#local-6989586621679413848"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-3425"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413849"><a href="#local-6989586621679413849"><span class="hs-identifier">prefInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#area2Int"><span class="hs-identifier hs-var">area2Int</span></a><span> </span><a href="#local-6989586621679413846"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-3426"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413850"><a href="#local-6989586621679413850"><span class="hs-identifier">refToAdd</span></a></a><span>
</span><a name="line-3427"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413847"><span class="hs-identifier hs-var">busi</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679413851"><a href="#local-6989586621679413851"><span class="hs-identifier">va</span></a></a><span> </span><a name="local-6989586621679413852"><a href="#local-6989586621679413852"><span class="hs-identifier">na</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3428"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413853"><a href="#local-6989586621679413853"><span class="hs-identifier">busiInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#busi2Int"><span class="hs-identifier hs-var">busi2Int</span></a><span> </span><a href="#local-6989586621679413852"><span class="hs-identifier hs-var">na</span></a><span>
</span><a name="line-3429"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="V.html#canBeSub"><span class="hs-identifier hs-var">canBeSub</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413854"><a href="#local-6989586621679413854"><span class="hs-identifier">detaInt</span></a></a><span>
</span><a name="line-3430"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413844"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413849"><span class="hs-identifier hs-var">prefInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413853"><span class="hs-identifier hs-var">busiInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413854"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413855"><a href="#local-6989586621679413855"><span class="hs-identifier">rate</span></a></a><span>
</span><a name="line-3431"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413856"><a href="#local-6989586621679413856"><span class="hs-identifier">newName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#int2Deta"><span class="hs-identifier hs-var">int2Deta</span></a><span> </span><a href="#local-6989586621679413854"><span class="hs-identifier hs-var">detaInt</span></a><span>
</span><a name="line-3432"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413855"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413850"><span class="hs-identifier hs-var">refToAdd</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VDS.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413855"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679413851"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413856"><span class="hs-identifier hs-var">newName</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3433"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413850"><span class="hs-identifier hs-var">refToAdd</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413857"><a href="#local-6989586621679413857"><span class="hs-identifier">toAdd</span></a></a><span>
</span><a name="line-3434"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413848"><span class="hs-identifier hs-var">valComm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3435"></a><span>        </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413845"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><a href="#local-6989586621679413857"><span class="hs-identifier hs-var">toAdd</span></a><span>
</span><a name="line-3436"></a><span>        </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413858"><a href="#local-6989586621679413858"><span class="hs-identifier">comm</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413845"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679413858"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><a href="#local-6989586621679413857"><span class="hs-identifier hs-var">toAdd</span></a><span>
</span><a name="line-3437"></a><span>
</span><a name="line-3438"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413859"><a href="#local-6989586621679413859"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679413860"><a href="#local-6989586621679413860"><span class="hs-identifier">icr</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413861"><a href="#local-6989586621679413861"><span class="hs-identifier">busi</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679413862"><a href="#local-6989586621679413862"><span class="hs-identifier">valComm</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="V.html#f%526F%696D%306E%5206%89E3%51E6%7406"><span class="hs-identifier hs-var">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413859"><span class="hs-identifier hs-var">sra</span></a><span> </span><a href="#local-6989586621679413860"><span class="hs-identifier hs-var">icr</span></a><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL.pack</span><span> </span><span class="hs-string">&quot;15&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679413861"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413862"><span class="hs-identifier hs-var">valComm</span></a><span>
</span><a name="line-3439"></a><span>
</span><a name="line-3440"></a><span>
</span><a name="line-3441"></a><span>
</span><a name="line-3442"></a><span>
</span><a name="line-3443"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679412640"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VDS.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679412640"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span>
</span><a name="line-3444"></a><a name="f%526F%696D%6BD4%7387%4F5C%6210"><a href="V.html#f%526F%696D%6BD4%7387%4F5C%6210"><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span></a></a><span> </span><span class="hs-number">0</span><span>   </span><a name="local-6989586621679413863"><a href="#local-6989586621679413863"><span class="hs-identifier">sra</span></a></a><span>
</span><a name="line-3445"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">newArray</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">2000</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679413864"><a href="#local-6989586621679413864"><span class="hs-identifier">initSra</span></a></a><span>
</span><a name="line-3446"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="V.html#f%526F%696D%6BD4%7387%4F5C%6210"><span class="hs-identifier hs-var">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679413864"><span class="hs-identifier hs-var">initSra</span></a><span>
</span><a name="line-3447"></a><span>
</span><a name="line-3448"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span><span> </span><a name="local-6989586621679413865"><a href="#local-6989586621679413865"><span class="hs-identifier">num</span></a></a><span> </span><a name="local-6989586621679413866"><a href="#local-6989586621679413866"><span class="hs-identifier">sra</span></a></a><span>
</span><a name="line-3449"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413878"><a href="#local-6989586621679413878"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-3450"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679413878"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3451"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413867"><span class="hs-identifier hs-var">culcSRA</span></a><span> </span><a href="#local-6989586621679413866"><span class="hs-identifier hs-var">sra</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-3452"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413879"><a href="#local-6989586621679413879"><span class="hs-identifier">icr</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413879"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413880"><a href="#local-6989586621679413880"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-3453"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413879"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>             </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413881"><a href="#local-6989586621679413881"><span class="hs-identifier">valArea</span></a></a><span>
</span><a name="line-3454"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413879"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VDS.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413882"><a href="#local-6989586621679413882"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-3455"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="V.html#f%526F%696D%6BD4%7387%4F5C%6210%51E6%7406"><span class="hs-identifier hs-var">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679413866"><span class="hs-identifier hs-var">sra</span></a><span> </span><a href="#local-6989586621679413880"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679413881"><span class="hs-identifier hs-var">valArea</span></a><span> </span><a href="#local-6989586621679413882"><span class="hs-identifier hs-var">valComm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3456"></a><span>                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="V.html#f%526F%696D%6BD4%7387%4F5C%6210"><span class="hs-identifier hs-var">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span></a><span> </span><a href="#local-6989586621679413865"><span class="hs-identifier hs-var">num</span></a><span> </span><a href="#local-6989586621679413866"><span class="hs-identifier hs-var">sra</span></a><span>
</span><a name="line-3457"></a><span>
</span><a name="line-3458"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-3459"></a><span>    </span><span class="hs-comment">-- &#32207;&#38989;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#12392;&#12371;&#12429;&#12434;&#27604;&#29575;&#12395;&#27835;&#12377;</span><span>
</span><a name="line-3460"></a><span>    </span><span class="hs-identifier">culcSRA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span>
</span><a name="line-3461"></a><span>    </span><a name="local-6989586621679413867"><a href="#local-6989586621679413867"><span class="hs-identifier">culcSRA</span></a></a><span> </span><a name="local-6989586621679413868"><a href="#local-6989586621679413868"><span class="hs-identifier">sra</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3462"></a><span>                </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">47</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413869"><a href="#local-6989586621679413869"><span class="hs-identifier">pref</span></a></a><span>
</span><a name="line-3463"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">22</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413870"><a href="#local-6989586621679413870"><span class="hs-identifier">busi</span></a></a><span>
</span><a name="line-3464"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413871"><a href="#local-6989586621679413871"><span class="hs-identifier">refTotal</span></a></a><span>
</span><a name="line-3465"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="V.html#canBeSub"><span class="hs-identifier hs-var">canBeSub</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413872"><a href="#local-6989586621679413872"><span class="hs-identifier">deta</span></a></a><span>
</span><a name="line-3466"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679413868"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413869"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413870"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413872"><span class="hs-identifier hs-var">deta</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413873"><a href="#local-6989586621679413873"><span class="hs-identifier">tmpVal</span></a></a><span>
</span><a name="line-3467"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413871"><span class="hs-identifier hs-var">refTotal</span></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413874"><a href="#local-6989586621679413874"><span class="hs-identifier">total</span></a></a><span>
</span><a name="line-3468"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679413871"><span class="hs-identifier hs-var">refTotal</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413874"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3469"></a><span>                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679413871"><span class="hs-identifier hs-var">refTotal</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413875"><a href="#local-6989586621679413875"><span class="hs-identifier">total</span></a></a><span>
</span><a name="line-3470"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="V.html#canBeSub"><span class="hs-identifier hs-var">canBeSub</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413876"><a href="#local-6989586621679413876"><span class="hs-identifier">deta</span></a></a><span>
</span><a name="line-3471"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679413868"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413869"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413870"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413876"><span class="hs-identifier hs-var">deta</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413877"><a href="#local-6989586621679413877"><span class="hs-identifier">tmpVal</span></a></a><span>
</span><a name="line-3472"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413868"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413869"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413870"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413876"><span class="hs-identifier hs-var">deta</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413877"><span class="hs-identifier hs-var">tmpVal</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679413875"><span class="hs-identifier hs-var">total</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3473"></a><span>                </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679413868"><span class="hs-identifier hs-var">sra</span></a><span>
</span><a name="line-3474"></a><span>
</span><a name="line-3475"></a><span>
</span><a name="line-3476"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="V.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span>
</span><a name="line-3477"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-3478"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span>
</span><a name="line-3479"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VDS.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3480"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3481"></a><a name="f%526F%696D%6BD4%7387%4F5C%6210%51E6%7406"><a href="V.html#f%526F%696D%6BD4%7387%4F5C%6210%51E6%7406"><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679413883"><a href="#local-6989586621679413883"><span class="hs-identifier">sra</span></a></a><span> </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><a name="local-6989586621679413884"><a href="#local-6989586621679413884"><span class="hs-identifier">valArea</span></a></a><span>      </span><a name="local-6989586621679413885"><a href="#local-6989586621679413885"><span class="hs-identifier">valComm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3482"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413886"><a href="#local-6989586621679413886"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679413887"><a href="#local-6989586621679413887"><span class="hs-identifier">valKind</span></a></a><span>           </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><a name="local-6989586621679413888"><a href="#local-6989586621679413888"><span class="hs-identifier">valComm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3483"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413889"><a href="#local-6989586621679413889"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679413890"><a href="#local-6989586621679413890"><span class="hs-identifier">valKind</span></a></a><span>           </span><a name="local-6989586621679413891"><a href="#local-6989586621679413891"><span class="hs-identifier">valArea</span></a></a><span>      </span><a href="VDS.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3484"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span> </span><a name="local-6989586621679413892"><a href="#local-6989586621679413892"><span class="hs-identifier">sra</span></a></a><span> </span><span class="hs-special">(</span><a href="VDS.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679413893"><a href="#local-6989586621679413893"><span class="hs-identifier">eKind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679413894"><a href="#local-6989586621679413894"><span class="hs-identifier">area</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VDS.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679413895"><a href="#local-6989586621679413895"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3485"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679413896"><a href="#local-6989586621679413896"><span class="hs-identifier">busiTx</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VClass.html#upInd"><span class="hs-identifier hs-var">VClass.upInd</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20013;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679413893"><span class="hs-identifier hs-var">eKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-3486"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413897"><a href="#local-6989586621679413897"><span class="hs-identifier">busiInt</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="V.html#busi2Int"><span class="hs-identifier hs-var">busi2Int</span></a><span> </span><a href="#local-6989586621679413896"><span class="hs-identifier hs-var">busiTx</span></a><span>
</span><a name="line-3487"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413898"><a href="#local-6989586621679413898"><span class="hs-identifier">prefInt</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="V.html#area2Int"><span class="hs-identifier hs-var">area2Int</span></a><span> </span><a href="#local-6989586621679413894"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-3488"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413899"><a href="#local-6989586621679413899"><span class="hs-identifier">notSub</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679413900"><a href="#local-6989586621679413900"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413900"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="VClass.html#isMemberOf"><span class="hs-identifier hs-var">VClass.isMemberOf</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679413896"><span class="hs-identifier hs-var">busiTx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679413895"><span class="hs-identifier hs-var">comm</span></a><span>
</span><a name="line-3489"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679413899"><span class="hs-identifier hs-var">notSub</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413901"><a href="#local-6989586621679413901"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-3490"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679413902"><a href="#local-6989586621679413902"><span class="hs-identifier">detaInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="V.html#deta2Int"><span class="hs-identifier hs-var">deta2Int</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679413901"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-3491"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679413892"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413898"><span class="hs-identifier hs-var">prefInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413897"><span class="hs-identifier hs-var">busiInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413902"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679413903"><a href="#local-6989586621679413903"><span class="hs-identifier">curVal</span></a></a><span>
</span><a name="line-3492"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679413892"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679413898"><span class="hs-identifier hs-var">prefInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413897"><span class="hs-identifier hs-var">busiInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679413902"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span>
</span><a name="line-3493"></a><span>        </span><span class="hs-operator hs-var">$</span><span>  </span><a href="#local-6989586621679413903"><span class="hs-identifier hs-var">curVal</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679413901"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-3494"></a><span>
</span><a name="line-3495"></a><span class="hs-comment">{- |
&#26412;&#31295;&#12398;&#20027;&#38988;&#12398;&#19968;&#12388;&#12364;&#65292;&#29694;&#34892;&#12398;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12434;&#29992;&#12356;&#12390;&#65292;&#12393;&#12398;&#31243;&#24230;&#32048;&#12363;&#12356;&#37096;&#38272;&#12398;V&#34920;&#12364;&#25512;&#35336;&#12391;&#12365;&#12427;&#12363;&#12392;&#12356;&#12358;&#28857;&#12395;&#38306;&#12377;&#12427;&#12418;&#12398;&#12391;&#12354;&#12427;&#12364;&#65292;
&#21516;&#36039;&#26009;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#32048;&#21697;&#30446;&#12398;&#27083;&#25104;&#12395;&#12388;&#12356;&#12390;CT&#12398;&#27083;&#25104;&#36942;&#31243;&#12391;&#22793;&#21205;&#12377;&#12427;&#21487;&#33021;&#24615;&#12364;&#12354;&#12427;&#12371;&#12392;&#12301;&#65292;
&#12300;&#21103;&#26989;&#12364;&#22256;&#38627;&#12363;&#21542;&#12363;&#12395;&#12388;&#12356;&#12390;&#65292;&#22522;&#26412;&#20998;&#39006;&#12372;&#12392;&#12395;&#12375;&#12363;&#21028;&#26029;&#12375;&#12390;&#12356;&#12394;&#12356;&#12371;&#12392;&#12301;&#12363;&#12425;&#65292;
&#12300;&#21103;&#26989;&#12487;&#12540;&#12479;&#12398;&#20998;&#35299;&#12399;&#65292;&#22522;&#26412;&#20998;&#39006;&#12398;&#21336;&#20301;&#12391;&#34892;&#12358;&#12301;&#12418;&#12398;&#12392;&#12375;&#12390;&#12356;&#12427;&#65294;&#24467;&#12387;&#12390;&#65292;&#29694;&#34892;&#12398;&#12475;&#12531;&#12469;&#12473;&#12398;&#32068;&#26367;&#38598;&#35336;&#12398;&#31684;&#22258;&#12391;&#12399;&#65292;
&#22522;&#26412;&#20998;&#39006;&#12364;V&#34920;&#65288;S&#34920;&#65289;&#12434;&#27083;&#25104;&#21487;&#33021;&#12394;&#26368;&#23567;&#12398;&#37096;&#38272;&#20998;&#39006;&#12391;&#12354;&#12427;&#12392;&#12356;&#12360;&#12427;&#65294;&#12375;&#12363;&#12375;&#65292;&#12371;&#12398;&#65298;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#20107;&#21069;&#12395;&#12381;&#12428;&#12382;&#12428;&#12434;&#23450;&#32681;&#12377;&#12427;&#12371;&#12392;&#12391;&#65292;
&#35299;&#27770;&#12391;&#12365;&#12427;&#12371;&#12392;&#12363;&#12425;&#65292;&#21407;&#29702;&#30340;&#12395;&#12399;&#12424;&#12426;&#32048;&#12363;&#12356;&#37096;&#38272;&#12391;&#12398;&#25512;&#35336;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12371;&#12392;&#12418;&#31034;&#21766;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

 &#30476;&#21029;&#12395;&#38598;&#35336;&#12377;&#12427;&#12371;&#12392;&#12395;&#38306;&#12375;&#12390;&#65292;&#21516;&#36039;&#26009; &#12300;&#8545; &#27604;&#36611;&#12487;&#12540;&#12479;&#12398;&#20316;&#25104;&#12301;&#12391;&#12399;&#65292;
 &#12300;&#30476;&#12372;&#12392;&#12395;&#35336;&#31639;&#12375;&#12383;&#32080;&#26524;&#12434;&#31309;&#12415;&#19978;&#12370;&#12390;&#20840;&#22269;&#20516;&#12395;&#12377;&#12427;&#12371;&#12392;&#12392;&#12375;&#12390;&#12356;&#12427;&#12364;&#65292;&#30476;&#12372;&#12392;&#12398;&#29305;&#24500;&#12364;&#65292;
 &#12393;&#12398;&#31243;&#24230;&#24433;&#38911;&#12434;&#21450;&#12412;&#12375;&#12390;&#12356;&#12427;&#12363;&#12395;&#12388;&#12356;&#12390;&#65292;&#29694;&#26178;&#28857;&#12391;&#26908;&#35388;&#12377;&#12427;&#12371;&#12392;&#12399;&#12391;&#12365;&#12394;&#12356;&#12301;&#12392;&#12354;&#12427;&#65294;

 &#12371;&#12398;&#29694;&#26178;&#28857;&#12392;&#12356;&#12358;&#12398;&#12399;&#65292;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#38598;&#35336;&#21069;&#12392;&#12356;&#12358;&#24847;&#21619;&#12391;&#12354;&#12429;&#12358;&#12363;&#12425;&#29694;&#22312;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
 &#26082;&#12395;&#30476;&#21029;&#12398;&#29305;&#24500;&#12364;&#26908;&#35388;&#12373;&#12428;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#24605;&#12431;&#12428;&#12427;&#12364;&#65292;&#12381;&#12398;&#32080;&#26524;&#12395;&#38306;&#12377;&#12427;&#36039;&#26009;&#12399;&#35211;&#12388;&#12369;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12394;&#12363;&#12387;&#12383;&#65294;
 &#12356;&#12378;&#12428;&#12395;&#12379;&#12424;&#65292;&#12371;&#12398;&#12424;&#12358;&#12395;&#38598;&#35336;&#21336;&#20301;&#12434;&#12354;&#12427;&#31243;&#24230;&#12398;&#21516;&#36074;&#24615;&#12434;&#20206;&#23450;&#12375;&#12390;&#23567;&#12373;&#12367;&#12377;&#12427;&#12371;&#12392;&#12399;&#38598;&#35336;&#19978;&#26377;&#29992;&#12391;&#12354;&#12427;&#12392;&#24605;&#12431;&#12428;&#65292;
 &#22320;&#22495;&#12372;&#12392;&#12395;&#29987;&#26989;&#12399;&#30064;&#12394;&#12427;&#29305;&#24500;&#12434;&#25345;&#12388;&#12392;&#12356;&#12358;&#12398;&#12399;&#26696;&#12395;&#29987;&#26989;&#25216;&#34899;&#20206;&#23450;&#12434;&#21542;&#23450;&#12375;&#12390;&#12356;&#12427;&#12371;&#12392;&#12392;&#12394;&#12427;&#65294;&#12381;&#12398;&#35251;&#28857;&#12363;&#12425;&#12377;&#12427;&#12392;&#65292;
 &#19968;&#28857;&#29694;&#34892;&#12398;&#25512;&#35336;&#26041;&#27861;&#12395;&#12399;&#19981;&#21512;&#29702;&#12394;&#28857;&#12364;&#35211;&#21463;&#12369;&#12425;&#12428;&#12427;&#65294;&#12381;&#12428;&#12399;&#65292;V&#34920;&#12398;&#25512;&#35336;&#12395;&#24403;&#12383;&#12387;&#12390;&#32068;&#26367;&#38598;&#35336;&#12434;&#32076;&#30001;&#12375;&#12390;&#65292;
 &#19968;&#24230;&#38598;&#35336;&#12373;&#12428;&#12383;&#12418;&#12398;&#12434;&#32232;&#32386;&#12377;&#12427;&#12392;&#12356;&#12358;&#24418;&#12434;&#12392;&#12387;&#12390;&#12356;&#12427;&#28857;&#12391;&#12354;&#12427;&#65294;&#29694;&#22312;&#12391;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20491;&#31080;&#12524;&#12505;&#12523;&#12398;&#24773;&#22577;&#12434;
 &#19968;&#24230;&#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#20107;&#26989;&#21029;&#22770;&#19978;&#38989;&#21450;&#12403;&#65292;&#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#35519;&#26619;&#21697;&#30446;&#22770;&#19978;&#38989;&#12398;&#24418;&#12391;&#38598;&#35336;&#12375;&#65292;&#12381;&#12398;&#27604;&#29575;&#12434;&#29992;&#12356;&#12390;V&#34920;&#12434;&#20316;&#25104;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#12371;&#12428;&#12399;&#12356;&#12358;&#12394;&#12428;&#12400;&#21516;&#19968;&#12398;&#29987;&#26989;&#12395;&#23646;&#12377;&#12427;&#21830;&#21697;&#12399;&#21516;&#19968;&#12398;&#25216;&#34899;&#27083;&#36896;&#12434;&#25345;&#12388;&#12392;&#12356;&#12358;&#21830;&#21697;&#25216;&#34899;&#20206;&#23450;&#12434;&#29992;&#12356;&#12390;&#12356;&#12427;&#12371;&#12392;&#12434;&#24847;&#21619;&#12377;&#12427;&#12364;&#65292;
 &#20808;&#12398;&#22320;&#22495;&#21306;&#20998;&#12395;&#12424;&#12387;&#12390;&#29987;&#26989;&#25216;&#34899;&#20206;&#23450;&#12434;&#21542;&#23450;&#12375;&#12383;&#12398;&#12392;&#21516;&#27096;&#12395;&#65292;&#21830;&#21697;&#25216;&#34899;&#20206;&#23450;&#12434;&#32622;&#12363;&#12394;&#12356;&#12424;&#12358;&#12394;&#25512;&#35336;&#25163;&#27861;&#12434;&#21462;&#12426;&#20837;&#12428;&#12427;&#24907;&#24230;&#12398;&#26041;&#12364;
 &#19968;&#36011;&#24615;&#12364;&#12354;&#12427;&#12392;&#12356;&#12360;&#12427;&#65294;&#29694;&#22312;&#12371;&#12398;&#12424;&#12358;&#12394;&#24418;&#12434;&#12392;&#12387;&#12390;&#12356;&#12427;&#12398;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#38598;&#35336;&#12434;&#29420;&#31435;&#34892;&#25919;&#27861;&#20154; &#32113;&#35336;&#12475;&#12531;&#12479;&#12540;&#12364;&#35531;&#12369;&#36000;&#12356;&#65292;
 &#32068;&#26367;&#38598;&#35336;&#12434;&#29992;&#12356;&#12390;V&#34920;&#12398;&#25512;&#35336;&#12434;&#32207;&#21209;&#30465;&#12364;&#34892;&#12358;&#12392;&#12356;&#12358;&#20307;&#21046;&#12395;&#12424;&#12427;&#12418;&#12398;&#12391;&#12354;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12364;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#19968;&#36011;&#12375;&#12390;&#65292;
 V&#34920;&#12434;&#25512;&#35336;&#12375;&#65292;&#20107;&#26989;&#25152;&#27598;&#12398;&#29305;&#24615;&#12395;&#12424;&#12387;&#12390;&#19968;&#23450;&#12398;&#21306;&#20998;&#12434;&#12388;&#12369;&#12383;&#19978;&#12391;&#65292;&#21103;&#26989;&#12398;&#20998;&#35299;&#31561;&#12434;&#34892;&#12358;&#12371;&#12392;&#12391;&#65292;
 &#21830;&#21697;&#25216;&#34899;&#20206;&#23450;&#12434;&#32622;&#12363;&#12394;&#12356;V&#34920;&#12398;&#25512;&#35336;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12392;&#24605;&#12431;&#12428;&#12427;&#65294;&#26412;&#31295;&#12391;&#12399;&#65292;&#12381;&#12398;&#23455;&#38555;&#12398;&#35430;&#31639;&#12434;&#34892;&#12431;&#12394;&#12356;&#12364;&#65292;
 &#20170;&#24460;&#12398;&#30740;&#31350;&#35506;&#38988;&#12392;&#12375;&#12390;&#65292;&#27531;&#12375;&#12390;&#12362;&#12365;&#12383;&#12356;&#65294;



-}</span><span>
</span><a name="line-3525"></a><span>
</span><a name="line-3526"></a><a name="f%526F%696D%628A%63E1%6539%5584%7248"><a href="V.html#f%526F%696D%628A%63E1%6539%5584%7248"><span class="hs-identifier">f&#21103;&#26989;&#25226;&#25569;&#25913;&#21892;&#29256;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-3527"></a><span>
</span><a name="line-3528"></a><span>
</span><a name="line-3529"></a><span>
</span><a name="line-3530"></a><span>
</span><a name="line-3531"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3532"></a><span class="hs-comment">-- * CT&#25512;&#35336;</span><span>
</span><a name="line-3533"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3534"></a><span class="hs-comment">{- | 
&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;V&#34920;&#12398;&#21015;&#21644;&#65292;
&#21363;&#12385;&#21830;&#21697;&#21029;&#32207;&#29987;&#20986;&#38989;&#65288;Control Total&#65289;&#12434;&#20027;&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#21547;&#12416;&#21508;&#31278;&#22522;&#30990;&#35519;&#26619;&#12363;&#12425;
&#25512;&#35336;&#12373;&#12428;&#12383;&#21462;&#24341;&#22522;&#26412;&#34920;&#12398;&#34892;&#37096;&#38272;&#12434;V&#34920;&#21015;&#37096;&#38272;&#12395;&#32068;&#12415;&#26367;&#12360;&#12383;&#20516;&#12434;&#22266;&#23450;&#20516;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#12362;&#12426;&#65292;
&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#24471;&#12425;&#12428;&#12383;&#21508;&#31278;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12375;&#12390;CT&#12434;&#21508;&#29987;&#26989;&#12395;&#26696;&#20998;&#12377;&#12427;&#20966;&#29702;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;

&#26412;&#31295;&#12391;&#12399;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12363;&#12425;CT&#12434;&#30452;&#25509;&#21462;&#24471;&#12377;&#12427;&#12371;&#12392;&#12434;&#35430;&#12415;&#12427;&#12364;&#65292;
&#23455;&#38555;&#12398;V&#34920;&#12398;&#31639;&#20986;&#12395;&#12362;&#12369;&#12427;CT&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12364;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12427;&#37096;&#38272;&#12399;&#38480;&#23450;&#30340;&#12391;&#12354;&#12427;&#65294;
&#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12395;&#12424;&#12428;&#12400;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#21462;&#24341;&#22522;&#26412;&#34920;&#12391;&#12399;&#65292;&#24179;&#25104;17&#24180;&#20197;&#21069;&#12395;&#12362;&#12356;&#12390;&#24037;&#26989;&#32113;&#35336;&#65292;
&#21830;&#26989;&#32113;&#35336;&#21448;&#12399;&#12469;&#12540;&#12499;&#12473;&#26989;&#22522;&#26412;&#32113;&#35336;&#12434;CT&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#21033;&#29992;&#12375;&#12390;&#12356;&#12383;&#35069;&#36896;&#26989;&#65292;&#21830;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#12394;&#12393;&#12398;&#20998;&#37326;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12434;&#22522;&#30990;&#36039;&#26009;&#12392;&#12375;&#12390;&#21033;&#29992;&#12375;&#12390;&#12356;&#12427;&#65294;&#19968;&#26041;&#12381;&#12428;&#20197;&#22806;&#12398;&#20998;&#37326;&#12398;&#12358;&#12385;&#36786;&#26519;&#28417;&#26989;&#12399;&#65292;
&#20491;&#20154;&#32076;&#21942;&#12398;&#36786;&#26519;&#28417;&#23478;&#12364;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#35519;&#26619;&#23550;&#35937;&#12392;&#12394;&#12387;&#12390;&#12356;&#12394;&#12356;&#12383;&#12417;&#65292;&#12381;&#12398;&#20182;&#12398;&#20998;&#37326;&#12395;&#38306;&#12375;&#12390;&#12399;&#12300;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#24773;&#22577;&#12391;&#25512;&#35336;&#12377;&#12427;&#26041;&#12364;&#65292;
&#12424;&#12426;&#27491;&#30906;&#12363;&#12388;&#21177;&#29575;&#30340;&#12391;&#12354;&#12427;&#12301;&#12383;&#12417;&#29992;&#12356;&#12390;&#12356;&#12394;&#12356;&#12392;&#12375;&#12390;&#12356;&#12427;

&#20197;&#38477;&#65292;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12356;&#12390;CT&#25512;&#35336;&#12395;&#12475;&#12531;&#12469;&#12473;&#12434;&#29992;&#12356;&#12383;&#37096;&#38272;&#12398;&#25512;&#35336;&#25163;&#27861;&#21450;&#12403;&#12381;&#12398;&#21839;&#38988;&#28857;&#12395;&#38306;&#12375;&#12390;&#35542;&#12376;&#12383;&#12398;&#12385;&#65292;
&#29992;&#12356;&#12390;&#12356;&#12394;&#12356;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;CT&#12434;&#25512;&#35336;&#12375;&#12383;&#22580;&#21512;&#12393;&#12398;&#12424;&#12358;&#12394;&#12418;&#12398;&#12395;&#12394;&#12427;&#12363;&#26908;&#35342;&#12377;&#12427;&#65294;


_5.2.1   &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;CT&#25512;&#35336;&#12395;&#29992;&#12356;&#12390;&#12356;&#12427;&#37096;&#38272;_

&#12469;&#12540;&#12499;&#12473;&#37096;&#38272;

&#24179;&#25104;23&#24180;IO&#12391;&#12399;&#65292;&#12469;&#12540;&#12499;&#12473;&#37096;&#38272;&#12398;CT&#25512;&#35336;&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12434;&#29992;&#12356;&#12390;&#12356;&#12427;&#12364;&#65292;
&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#12469;&#12540;&#12499;&#12473;&#37096;&#38272;&#12395;&#12399;&#26410;&#25226;&#25569;&#37096;&#20998;&#12364;&#22823;&#12365;&#12356;&#12392;&#12356;&#12358;&#21839;&#38988;&#12364;&#12354;&#12427;&#65294;
&#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12395;&#12424;&#12428;&#12400;&#12469;&#12540;&#12499;&#12473;&#26989;&#12398;&#22770;&#19978;&#31561;&#26410;&#25226;&#25569;&#29575;&#12399;&#12300;&#24773;&#22577;&#36890;&#20449;&#26989;&#12398;&#20869;&#65292;40 &#12452;&#12531;&#12479;&#12540;&#12493;&#12483;&#12488;&#20184;&#38543;&#12469;&#12540;&#12499;&#12473;&#26989;&#12301;
&#12395;&#12362;&#12356;&#12390;33.3%&#65292;&#12300;&#23487;&#27850;&#26989;&#65292;&#39154;&#39135;&#12469;&#12540;&#12499;&#12473;&#26989;&#12301;&#12395;&#12362;&#12356;&#12390;26%&#65292;&#12300;
&#12469;&#12540;&#12499;&#12473;&#26989;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12418;&#12398;&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;20%&#12395;&#19978;&#12426;&#65292;
&#12300;&#35069;&#36896;&#26989;&#12301;&#12398;12.80&#65285;&#65292;&#12300;&#36786;&#26989;&#65292;&#26519;&#26989;&#12301;&#12398;16.30%&#65292;&#12300;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12301;&#12395;&#12362;&#12369;&#12427;17&#65294;50%&#12394;&#12393;&#12469;&#12540;&#12499;&#12473;&#26989;&#12392;&#27604;&#36611;&#12377;&#12428;&#12400;&#39640;&#12356;&#20516;&#12391;&#12354;&#12427;&#12392;&#12356;&#12360;&#12427;&#65294;

 &#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12391;&#12399;&#65292;&#12469;&#12540;&#12499;&#12473;&#37096;&#38272;&#12398;CT&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#65292;&#12414;&#12378;&#20107;&#26989;&#25152;&#12434;&#65292;
 &#20027;&#26989;&#65292;&#21103;&#26989;&#12372;&#12392;&#12395;&#12300;&#22770;&#19978;&#39640;&#21450;&#12403;&#37325;&#35201;&#32773;&#25968;&#12392;&#12418;&#12395;&#25226;&#25569;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#65288;&#22770;&#19978;&#25226;&#25569;&#20998;&#65289;&#12301;
 &#12300;&#24467;&#26989;&#32773;&#25968;&#12399;&#25226;&#25569;&#12373;&#12428;&#12383;&#12364;&#65292;&#22770;&#19978;&#39640;&#12364;&#25226;&#25569;&#12373;&#12428;&#12394;&#12363;&#12387;&#12383;&#20107;&#26989;&#25152;&#65288;&#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#65289;&#12301;&#12398;&#65298;&#21306;&#20998;&#12391;&#20998;&#21106;&#12375;&#65292;
 &#12381;&#12398;&#12358;&#12385;&#65292;&#20027;&#26989;&#12395;&#38306;&#12375;&#12390;&#25226;&#25569;&#20998;&#12539;&#26410;&#25226;&#25569;&#20998;&#21452;&#26041;&#12398;&#22770;&#12426;&#19978;&#12370;&#12434;&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#25512;&#35336;&#12375;&#12390;&#12356;&#12427;&#65294;

 &#29987;&#26989;&#36899;&#38306;&#34920;&#12398;&#37096;&#38272;&#20998;&#39006;&#12434;CIO,&#37096;&#38272;&#20998;&#39006;&#12398;&#20869;&#12469;&#12540;&#12499;&#12473;&#29987;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#37096;&#20998;&#12434;CIOS&#8834; CIO,&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#29987;&#26989;&#20998;&#39006;&#12434;CC&#12392;&#12375;&#12390;&#65292;
 &#12354;&#12427;&#37096;&#38272; \(&#969; \in CIOS \)&#12392;&#23550;&#24540;&#20184;&#12369;&#12425;&#12428;&#12427; \(&#969;' \in ' CC \)&#12392;&#12377;&#12427;&#12392;&#65292;
 &#969; &#12398;&#20027;&#26989;&#30456;&#24403;&#12398;&#25226;&#25569;&#21450;&#12403;&#26410;&#25226;&#25569;&#37096;&#20998;&#12398;&#29983;&#29987;&#38989; \( CT_main [&#969;] \) &#12399;&#65292;&#20197;&#19979;&#12398;&#24335;&#12391;&#27714;&#12417;&#12425;&#12428;&#12427;&#65294;

\[ CT_main=SPP[&#969;] \times compInvEmp[&#969;'] \times activityRate[&#969;] \]

where

\[ SPP[&#969;]= \frac{sales[&#969;]}{invEmp[&#969;]} \]

\[ activityRate[&#969;']= \frac{invEmp[&#969;]}{totalEmp[&#969;'] \times \frac{compInvEmp[&#969;']}{compTotalEmp[&#969;']}} \]

&#12394;&#12362;&#65292;&#21508;&#22793;&#25968;&#12399;&#20197;&#19979;&#12395;&#24467;&#12358;&#65294;

* _SPP[&#969;]&#65288;Sales per person&#65289;_

&#65306;&#969;&#8712;CIOS &#29987;&#26989;&#12398;&#19968;&#20154;&#12354;&#12383;&#12426;&#22770;&#19978;&#39640;

* _sales[&#969;]_

: &#969;&#8712;CIOS &#12398;&#22770;&#19978;&#39640;&#65294;IO&#12398;&#37096;&#38272;&#20998;&#39006;&#12395;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#35519;&#26619;&#32080;&#26524;&#12434;&#32068;&#12415;&#26367;&#12360;&#12383;&#32068;&#26367;&#38598;&#35336;&#65288;&#38750;&#20844;&#34920;&#65289;&#12424;&#12426;&#21462;&#24471;&#65294;

* _invEmp[&#969;](Number of involved employment)_

: &#29987;&#26989;&#969;&#8712;CIOS&#12398;&#24467;&#26989;&#32773;&#25968;&#12398;&#12358;&#12385;&#65292;&#27966;&#36963;&#65292;&#20986;&#21521;&#31561;&#12391;&#22806;&#37096;&#12395;&#36865;&#12426;&#20986;&#12375;&#12390;&#12356;&#12427;&#24467;&#26989;&#21729;&#12434;&#38500;&#12356;&#12383;&#24467;&#26989;&#21729;&#25968;&#65288;&#20107;&#26989;&#24467;&#26989;&#21729;&#25968;&#65289;&#65294;(\ &#969; \in CIOS \)&#12395;&#38306;&#12375;&#12390;&#12399;&#32068;&#26367;&#38598;&#35336;&#12424;&#12426;&#21462;&#24471;&#65294; 

* activetyRate[&#969;']

:&#12450;&#12463;&#12486;&#12451;&#12499;&#12486;&#12451;&#29575;; &#20107;&#26989;&#25152;&#12398;&#24467;&#26989;&#32773;&#12398;&#20869;&#65292;&#12381;&#12398;&#20107;&#26989;&#25152;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369; \( &#969;&#8217;\in CC \)&#12395;&#24467;&#20107;&#12375;&#12390;&#12356;&#12427;&#20154;&#25968;&#12398;&#21106;&#21512;

* compInvEmp[&#969;&#8216;] (Complete Number of involved employments)

:&#969; &#8712; CIOS&#12392;&#23550;&#24540;&#20184;&#12369;&#12425;&#12428;&#12383;\( &#969;' \in CC )&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12373;&#12428;&#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#12434;&#21547;&#12417;&#12383;&#20107;&#26989;&#25152;&#12398;&#20107;&#26989;&#24467;&#26989;&#21729;&#25968;&#65294;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65300; &#34920;&#12424;&#12426;&#21462;&#24471;&#65294;

* _totalEmp[&#969;](Total number of employments)_

:&#29987;&#26989; \( &#969;&#8217;\in CC \) &#12398;&#32207;&#24467;&#26989;&#32773;&#25968;&#65294;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65298;-1-1&#34920; &#12424;&#12426;&#21462;&#24471;&#65294;

* _compTotalEmp[&#969;&#8217;] (Complete Total Number of Employments)_

: \( &#969; \in CIOS \)&#12392;&#23550;&#24540;&#20184;&#12369;&#12425;&#12428;&#12383;&#969;&#8712;CC&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#12434;&#21547;&#12417;&#12394;&#12356;&#20107;&#26989;&#25152;&#12398;&#24467;&#26989;&#21729;&#25968;&#65294;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65300;&#34920;&#12414;&#12383;&#12399;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65298;&#34920; &#12424;&#12426;&#21462;&#24471;(&#31532;&#65298;&#34920;&#12399;&#29987;&#26989;&#32048;&#20998;&#39006;&#12414;&#12391;&#25226;&#25569;&#21487;&#33021;)

 &#12371;&#12398;&#26178; CT_main&#12434;&#22793;&#24418;&#12377;&#12427;&#12392;&#65292;&#38917;&#12364;&#25171;&#12385;&#28040;&#12375;&#12354;&#12356;&#65292;

\[ CT_main [&#969;] = sales[&#969;] * \frac{compTotalEmp[&#969;']}{totalEmp[&#969;']} \]

&#12364;&#24471;&#12425;&#12428;&#12427;&#65294;


-}</span><span>
</span><a name="line-3618"></a><a name="fCT%63A8%8A08"><a href="V.html#fCT%63A8%8A08"><span class="hs-identifier">fCT&#25512;&#35336;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-3619"></a><span>
</span><a name="line-3620"></a><span>
</span><a name="line-3621"></a><span class="hs-comment">-- &#20351;&#29992;&#12375;&#12394;&#12356;&#20225;&#26989;&#12398;&#12487;&#12540;&#12479;&#12420;,&#22243;&#20307;&#12398;&#12487;&#12540;&#12479;,&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12398;&#20107;&#26989;&#25152;&#12398;&#12487;&#12540;&#12479;&#12434;&#25244;&#12363;&#12377;</span><span>
</span><a name="line-3622"></a><span>
</span><a name="line-3623"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3624"></a><span class="hs-comment">-- * &#23633;&#12398;&#25512;&#35336;</span><span>
</span><a name="line-3625"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3626"></a><span class="hs-comment">-- | &#23633;&#12434;&#38598;&#12417;&#12390;&#23633;&#37096;&#38272;&#12434;&#20316;&#12427;</span><span>
</span><a name="line-3627"></a><span>
</span><a name="line-3628"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3629"></a><span class="hs-comment">-- * &#29987;&#26989;&#21029;&#21830;&#21697;&#21029;&#29987;&#20986;&#38989;&#12398;&#25226;&#25569;</span><span>
</span><a name="line-3630"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3631"></a><span>
</span><a name="line-3632"></a><span>
</span><a name="line-3633"></a><span>
</span><a name="line-3634"></a></pre></body></html>