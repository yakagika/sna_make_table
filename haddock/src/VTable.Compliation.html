<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE  BangPatterns, OverloadedStrings, StrictData, Strict, MultiWayIf #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">{- |
      Module     : VTable.Compliation
      Copyright  : (c) Kaya Akagi. 2018-2019
      Maintainer : akagi15@cs.dis.titech.ac.jp

      V&#34920;&#20316;&#34920;&#12398;&#12383;&#12417;&#12398;&#12514;&#12472;&#12517;&#12540;&#12523;

      * &#34920;&#35352;&#12434;&#12510;&#12491;&#12517;&#12450;&#12523;&#12392;&#32113;&#19968;&#12377;&#12427;&#12383;&#12417;&#12395;&#26085;&#26412;&#35486;&#12434;&#20351;&#12387;&#12390;&#12356;&#12427;&#12398;&#12391;,&#31561;&#24133;&#12501;&#12457;&#12531;&#12488;&#25512;&#22888;
      * &#12467;&#12513;&#12531;&#12488;&#12398;&#23383;&#19979;&#12370;&#12399;,&#20316;&#32773;&#12398;&#12486;&#12461;&#12473;&#12488;&#12456;&#12487;&#12451;&#12479;(SublimeText3)&#12395;&#26368;&#36969;&#21270;&#12373;&#12428;&#12390;&#12356;&#12427;.
      * &#12456;&#12531;&#12467;&#12540;&#12487;&#12451;&#12531;&#12464;&#12395;&#38306;&#12375;&#12390;

         &gt; &#20837;&#20986;&#21147;&#12418;&#21547;&#12417;&#12390;&#12377;&#12409;&#12390;UTF-8&#12391;&#32113;&#19968;&#12377;&#12427;
         &gt; Windows&#19978;&#12391;&#21033;&#29992;&#12377;&#12427;&#22580;&#21512;&#12399; chcp 65001 &#21069;&#25552;

      * &#12487;&#12540;&#12479;&#22411;&#12398;&#31777;&#21336;&#12394;&#35211;&#26041;

      &gt; f :: A -&gt; B -&gt; C
      &gt; A &#12392; B &#12434;&#24341;&#25968;&#12395;&#12392;&#12387;&#12390;&#65292;C&#12364;&#36820;&#12427;&#65294;


      * &#20966;&#29702;&#12395;&#12513;&#12514;&#12522;&#12364;&#36275;&#12426;&#12394;&#12356;&#12398;&#12391;&#65292;Conduit &#12434;&#29992;&#12356;&#12390;&#36880;&#27425;&#20966;&#29702;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;
-}</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">VTable.Compliation</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Vector</span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Vector</span><span>                     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Vector.Mutable</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MV</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Map.Strict</span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Map.Strict</span><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Text</span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Text</span><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Text.IO</span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TO</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.List</span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Maybe</span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Semigroup</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Array.IArray</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Array.ST</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Array.IO</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Ix</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.STRef</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.IORef</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Monad.ST</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.DeepSeq</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.STRef</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.IORef</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Either</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">System.IO</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">System.Process</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Text.Read</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Debug.Trace</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Monad.IO.Class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftIO</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Text.Show.Unicode</span><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ushow</span><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">GHC.Err</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">GHC.Prim</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">--  for pararel</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Parallel.Strategies</span><span>     </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parMap</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-operator hs-var">.|</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Control.Parallel</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Control.Monad.Parallel</span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CMP</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- conduit</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">Data.Conduit</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Conduit.List</span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CL</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Conduit.Binary</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CB</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sequence</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">sourceFile</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">Data.Conduit.Combinators</span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CC</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">--  Original Modules</span><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><span class="hs-identifier">CSV.Text</span><span>                        </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CSV</span><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span>              </span><span class="hs-identifier">CSV.Text</span><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span>              </span><a href="VTable.Compliation.Conversion.html"><span class="hs-identifier">VTable.Compliation.Conversion</span></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><a href="VTable.Compliation.Conversion.html"><span class="hs-identifier">VTable.Compliation.Conversion</span></a><span>   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">VCC</span><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span>              </span><a href="VTable.Data.Structure.html"><span class="hs-identifier">VTable.Data.Structure</span></a><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><a href="VTable.Data.Structure.html"><span class="hs-identifier">VTable.Data.Structure</span></a><span>           </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">VDS</span><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span>              </span><a href="VTable.Data.Classification.html"><span class="hs-identifier">VTable.Data.Classification</span></a><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span>    </span><a href="VTable.Data.Classification.html"><span class="hs-identifier">VTable.Data.Classification</span></a><span>      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">VDC</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- * V&#34920;&#20316;&#25104;</span><span>
</span><a name="line-90"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-91"></a><span class="hs-comment">{- |
 &#31227;&#34892;&#24460;S&#34920;&#12398;&#35373;&#35336;&#12398;&#35696;&#35542;&#12395;&#20808;&#31435;&#12387;&#12390;&#65292;&#29694;&#34892;V&#34920;&#12398;&#25512;&#35336;&#25163;&#27861;&#12434;&#21487;&#33021;&#12394;&#38480;&#12426;&#35443;&#32048;&#12395;&#26908;&#35388;&#12377;&#12427;&#65294;

 &#12300;&#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920; &#32207;&#21512;&#35299;&#35500;&#32232;&#12301;&#12395;&#12424;&#12428;&#12400;,V&#34920;&#12399;&#65292;&#24179;&#25104;17&#24180;&#12414;&#12391;&#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#65292;
 &#21830;&#26989;&#32113;&#35336;&#35519;&#26619;&#21450;&#12403;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#22522;&#26412;&#35519;&#26619;&#12434;&#20027;&#12395;&#29992;&#12356;&#12390;&#25512;&#35336;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
 23&#24180;&#20197;&#38477;&#12399;&#23550;&#24540;&#12377;&#12427;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;- &#27963;&#21205;&#35519;&#26619;&#12398;&#32080;&#26524;&#12434;&#20027;&#12394;&#36039;&#26009;&#12392;&#12375;&#12390;&#25512;&#35336;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#12383;&#12384;&#12375;&#65292;&#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12391;&#12399;&#65292;CT&#12395;&#38306;&#12375;&#12390;17&#34920;&#20197;&#21069;&#12395;&#19978;&#35352;&#65299;&#12388;&#12398;&#32113;&#35336;&#20197;&#22806;&#12363;&#12425;&#25512;&#35336;&#12373;&#12428;&#12390;&#12356;&#12383;&#36786;&#26519;&#27700;&#29987;&#65292;
 &#24314;&#35373;&#65292;&#37329;&#34701;&#12394;&#12393;&#12398;&#37096;&#38272;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12434;&#29992;&#12356;&#12378;&#65292;
 17&#24180;&#34920;&#20197;&#21069;&#12398;&#23550;&#24540;&#12377;&#12427;&#22522;&#30990;&#32113;&#35336;&#12398;&#20516;&#12434;&#22269;&#20869;&#32207;&#29983;&#29987;&#38989;&#65288;CT&#65307;Control Total&#65289;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#12356;&#12427;&#12392;&#12398;&#35352;&#36848;&#12364;&#12354;&#12427;&#65294;
 &#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#20184;&#24111;&#34920;V&#34920;&#20316;&#25104;&#25163;&#38918;&#12399;&#22823;&#12414;&#12363;&#12395;&#12399;&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#12394;&#12427;&#65294;&#12414;&#12378;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12398;&#32080;&#26524;&#12434;&#29992;&#12356;&#12390;&#65292;
 &#29987;&#26989;&#21029;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;&#38989;&#21450;&#12403;&#65292;&#29987;&#26989;&#21029;&#20107;&#26989;&#21029;&#22770;&#19978;&#38989;&#12487;&#12540;&#12479;&#12434;&#38598;&#35336;&#12375;&#65292;V&#34920;&#29987;&#26989;&#20998;&#39006;&#12395;&#21512;&#12431;&#12379;&#12390;&#20998;&#39006;&#12398;&#22793;&#25563;&#12434;&#34892;&#12356;&#65292;
 &#20182;&#12398;&#36039;&#26009;&#12392;&#20341;&#12379;&#12390;&#24471;&#12425;&#12428;&#12383;CT&#12434;&#12475;&#12531;&#12469;&#12473;&#32068;&#26367;&#34920;&#12424;&#12426;&#24471;&#12425;&#12428;&#12383;&#27604;&#29575;&#12391;&#26696;&#20998;&#12377;&#12427;&#12371;&#12392;&#12391;&#65292;&#19968;&#27425;&#25512;&#35336;&#20516;&#12434;&#20316;&#25104;&#12377;&#12427;&#65294;

 &#12381;&#12398;&#24460;&#65292;&#12381;&#12398;&#19968;&#27425;&#25512;&#35336;&#20516;&#12434;&#21508;&#31278;&#32113;&#35336;&#36039;&#26009;&#12395;&#12424;&#12387;&#12390;&#20418;&#25968;&#12434;&#35519;&#25972;&#12377;&#12427;&#12371;&#12392;&#12391;&#20844;&#34920;&#20516;&#12364;&#20316;&#25104;&#12373;&#12428;&#12427;&#65294;

 &#12414;&#12383;&#65292;&#23633;&#12539;&#21103;&#29987;&#29289;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21462;&#24341;&#22522;&#26412;&#34920;&#12395;&#12362;&#12369;&#12427;&#23633;&#12539;&#21103;&#29987;&#29289;&#30330;&#29983;&#37096;&#38272;&#12434;V&#34920;&#29987;&#26989;&#20998;&#39006;&#12408;&#32068;&#26367;&#12360;&#65292;
 &#12381;&#12398;&#20516;&#12434;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#27714;&#12417;&#12425;&#12428;&#12383;&#29987;&#26989;&#215;&#21830;&#21697;&#34920;&#12398;&#24403;&#35442;&#20132;&#28857;&#12395;&#35336;&#19978;&#12375;&#12390;&#12356;&#12427;&#65294;

 &#12371;&#12398;&#12424;&#12358;&#12395;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#20027;&#12394;&#36039;&#26009;&#12392;&#12375;&#12390;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#29992;&#12356;&#12390;&#12399;&#12356;&#12427;&#12364;&#65292;
 &#27096;&#12293;&#12394;&#32113;&#35336;&#35519;&#26619;&#12398;&#20516;&#12364;&#35079;&#21512;&#30340;&#12395;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12427;&#65294;&#26412;&#26469;&#12391;&#12354;&#12428;&#12400;&#65292;&#29694;&#34892;V&#34920;&#12398;&#20316;&#25104;&#25163;&#27861;&#12392;&#12399;&#65292;
 &#12381;&#12428;&#12425;&#21033;&#29992;&#12373;&#12428;&#12427;&#20840;&#12390;&#12398;&#22522;&#30990;&#32113;&#35336;&#21450;&#12403;&#12381;&#12398;&#21033;&#29992;&#26041;&#27861;&#12434;&#12418;&#12428;&#12394;&#12367;&#35352;&#36617;&#12377;&#12427;&#12371;&#12392;&#12392;&#12394;&#12427;&#12364;&#65292;
 &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#22522;&#30990;&#32113;&#35336;&#12398;&#20516;&#12434;&#21033;&#29992;&#12377;&#12427;&#20966;&#29702;&#12395;&#38306;&#12377;&#12427;&#36039;&#26009;&#12399;&#23569;&#12394;&#12367;&#65292;&#12414;&#12383;&#65292;&#20316;&#26989;&#12418;&#21508;&#30465;&#24193;&#12395;&#12424;&#12387;&#12390;&#22810;&#23696;&#12395;&#28193;&#12427;&#12383;&#12417;&#65292;
 &#12381;&#12398;&#35443;&#32048;&#12434;&#25226;&#25569;&#12377;&#12427;&#12371;&#12392;&#12399;&#22256;&#38627;&#12391;&#12354;&#12427;&#65294;

 &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#12381;&#12428;&#12425;&#12398;&#20966;&#29702;&#12395;&#38306;&#12375;&#12390;&#12414;&#12392;&#12417;&#12427;&#12371;&#12392;&#12399;&#12379;&#12378;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#21033;&#29992;&#12377;&#12427;&#37096;&#20998;&#12395;&#12381;&#12398;&#23550;&#35937;&#12434;&#32094;&#12426;&#65292;
 &#20182;&#12398;&#36039;&#26009;&#12364;&#21033;&#29992;&#12373;&#12428;&#12390;&#12356;&#12427;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#12381;&#12398;&#26088;&#12434;&#35328;&#21450;&#12375;&#12383;&#19978;&#12391;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#21033;&#29992;&#12375;&#12383;&#20195;&#26367;&#30340;&#12394;&#25512;&#35336;&#25163;&#27861;&#12434;&#25522;&#36617;&#12377;&#12427;&#65294;
 &#12371;&#12428;&#12399;&#65292;&#37096;&#20998;&#30340;&#12395;&#12363;&#12369;&#12390;&#12356;&#12427;&#25512;&#35336;&#25163;&#27861;&#12391;&#12399;&#65292;&#20840;&#20307;&#20687;&#12364;&#12388;&#12363;&#12415;&#12395;&#12367;&#12367;&#65292;&#12414;&#12383;&#65292;&#25968;&#20516;&#35336;&#31639;&#31561;&#12434;&#34892;&#12358;&#38555;&#12395;&#19981;&#20855;&#21512;&#12364;&#29983;&#12376;&#12427;&#12371;&#12392;&#12395;&#12418;&#12424;&#12427;&#65294;
 &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#20197;&#38477;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#25163;&#27861;&#12398;&#35519;&#26619;&#12395;&#24403;&#12383;&#12387;&#12390;&#21487;&#33021;&#12394;&#38480;&#12426;&#65292;&#36039;&#26009;&#12395;&#22522;&#12389;&#12356;&#12383;&#25512;&#28204;&#12434;&#34892;&#12358;&#12364;&#65292;
 &#9312;&#36039;&#26009;&#12398;&#19981;&#36275;&#12395;&#12424;&#12426;&#35443;&#32048;&#12398;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#31623;&#25152;&#65292;&#9313;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#22522;&#30990;&#32113;&#35336;&#12434;&#12418;&#12392;&#12395;&#25512;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#20491;&#25152;&#65292;
 &#12398;&#65298;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#22810;&#20998;&#12395;&#31558;&#32773;&#12398;&#25014;&#28204;&#12364;&#21547;&#12414;&#12428;&#12390;&#12356;&#12427;&#28857;&#12395;&#30041;&#24847;&#12375;&#12390;&#38914;&#12365;&#12383;&#12356;&#65294;

 &#26412;&#31295;&#12391;&#12399;V&#34920;&#12398;&#20316;&#25104;&#12399;&#22823;&#12414;&#12363;&#12395;&#65292;&#20197;&#19979;&#9312;~&#9316;&#12398;&#20316;&#26989;&#12434;&#24819;&#23450;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#12394;&#12362;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#23633;&#65292;&#21103;&#29987;&#29289;&#12398;&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#21462;&#24341;&#22522;&#26412;&#34920;&#12434;&#32076;&#30001;&#12375;&#12390;&#12362;&#12426;&#65292;
 &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#21508;&#31278;&#22522;&#30990;&#32113;&#35336;&#20516;&#12418;&#12381;&#12398;&#25512;&#35336;&#12395;&#21033;&#29992;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#26412;&#30740;&#31350;&#12399;&#65292;&#39165;&#12367;&#12414;&#12391;&#21516;&#19968;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12377;&#12427;&#12371;&#12392;&#12391;&#25512;&#35336;&#25163;&#27861;&#27598;&#12398;&#24046;&#30064;&#12434;&#20998;&#26512;&#12377;&#12427;&#12371;&#12392;&#12434;&#30446;&#30340;&#12392;&#12375;&#12390;&#12362;&#12426;&#65292;
 &#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12363;&#12425;&#30452;&#25509;&#30340;&#12395;&#20516;&#12434;&#27083;&#25104;&#12377;&#12427;&#12392;&#12356;&#12358;&#28857;&#12391;&#65292;&#25512;&#35336;&#25163;&#27861;&#12364;&#29694;&#34892;&#12398;&#12418;&#12398;&#12392;&#12399;&#30064;&#12394;&#12427;&#65294;

 &#24190;&#12388;&#12363;&#12398;&#35036;&#36275;&#12391;&#12365;&#12394;&#12356;&#27010;&#24565;&#31561;&#12418;&#12381;&#12398;&#12414;&#12414;&#26410;&#25226;&#25569;&#12392;&#12375;&#12390;&#25201;&#12356;&#65292;&#22823;&#12365;&#12394;&#38917;&#30446;&#12395;&#12388;&#12356;&#12390;&#12399;&#20182;&#12398;&#32113;&#35336;&#12434;&#29992;&#12356;&#12390;&#31777;&#26131;&#30340;&#12395;&#25512;&#35336;&#12377;&#12427;&#12394;&#12393;&#65292;
 &#31777;&#26131;&#30340;&#20316;&#25104;&#25163;&#27861;&#12434;&#25505;&#29992;&#12377;&#12427;&#65294;

 ![V&#34920;&#25512;&#35336;&#25163;&#38918;&#22259;](procedure.png)
-}</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-identifier">compileVTable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><a name="compileVTable"><a href="VTable.Compliation.html#compileVTable"><span class="hs-identifier">compileVTable</span></a></a><span> </span><a name="local-6989586621679475908"><a href="#local-6989586621679475908"><span class="hs-identifier">inputFile</span></a></a><span> </span><a name="local-6989586621679475909"><a href="#local-6989586621679475909"><span class="hs-identifier">maxRowNum</span></a></a><span> </span><a name="local-6989586621679475910"><a href="#local-6989586621679475910"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-string">&quot;start first step &quot;</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-comment">{-&gt;&gt; runConduitRes    (  sourceCensus inputFile
                        .| f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;
                        .| f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861; year
                        .| f&#19981;&#36969;&#24403;&#20998;&#21066;&#38500;
                        .| f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861; year
                        .| f&#20385;&#26684;&#22793;&#25563; year
                        .| sinkCensus maxRowNum tmpFile)
    &gt;&gt; print &quot;end first step. And start culculation of Industry weight map&quot;
    &gt;&gt;  getWeightAndLink tmpFile                                                &gt;&gt;= \ (!iwm, !edm)
    -&gt;  newIORef Map.empty                                                      &gt;&gt;= \ !empDenomiMap
    -&gt;  runConduitRes (sourceCensus  tmpFile  .| getDenomiMap iwm empDenomiMap) &gt;&gt;= \ !denomi
    -&gt;  newIORef Map.empty                                                      &gt;&gt;= \ !empToMakeMarginMap
    -&gt;  newIORef []                                                             &gt;&gt;= \ !nullList
    -&gt;  print &quot;end second step. And start division&quot;
    &gt;&gt;  runConduitRes   (sourceCensus tmpFile
                        .| f&#20225;&#26989;&#20998;&#21106; iwm edm denomi
                        .| f&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#20966;&#29702; empToMakeMarginMap nullList
                        .| f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500; year
                        .| sinkCensus maxRowNum tmpFile2)
    &gt;&gt; print &quot;culculating sub rate....&quot;
    &gt;&gt; empSubRateArray                                                                              &gt;&gt;= \ !empSra
    -&gt; runConduitRes ( sourceCensus  tmpFile2  .| f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104; empSra)                             &gt;&gt;= \ !sra
    -&gt; print &quot;dividing sub products....&quot;
    &gt;&gt; runConduitRes ( sourceCensus  tmpFile2  .| f&#21103;&#26989;&#12398;&#20998;&#35299; sra .| sinkCensus maxRowNum tmpFile3)
    &gt;&gt; print &quot;culculating multipler....&quot;
    &gt;&gt; newIORef Map.empty                                                                           &gt;&gt;= \ !emptmcm
    -&gt; runConduitRes ( sourceCensus  tmpFile3  .| fCT&#20055;&#25968;&#25512;&#35336; emptmcm)                              &gt;&gt;= \ !ctm
    -&gt; print &quot;culculating table....&quot;
    &gt;&gt; empICASmallDetail                                                                            &gt;&gt;= \ !empIca
    -&gt; putStrLn &quot;start f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;&quot;
    &gt;&gt; runConduitRes ( sourceCensus  tmpFile3  .| f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989; ctm empIca)                 &gt;&gt;= \ !result&#32048;&#20998;&#39006;
    -&gt; writeVTable &quot;Data/Result/result&#32048;&#20998;&#39006;.csv&quot; result&#32048;&#20998;&#39006;
    &gt;&gt; putStrLn &quot;start f&#32048;&#20998;&#39006;&#25391;&#26367;&quot;
    &gt;&gt; f&#32048;&#20998;&#39006;&#25391;&#26367;           result&#32048;&#20998;&#39006;                                                           &gt;&gt;= \ !result&#23567;&#20998;&#39006;
    -&gt; writeVTable &quot;Data/Result/result&#23567;&#20998;&#39006;.csv&quot; result&#23567;&#20998;&#39006;
    -}</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#readTable"><span class="hs-identifier hs-var">readTable</span></a><span> </span><span class="hs-string">&quot;Data/Result/result&#23567;&#20998;&#39006;.csv&quot;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-special">)</span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475915"><a href="#local-6989586621679475915"><span class="hs-identifier">result&#23567;&#20998;&#39006;</span></a></a><span> </span><span class="hs-comment">-- &#28040;&#21435;</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;start f&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#25391;&#26367;&quot;</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%7BA1%7406%88DC%52A9%7684%696D%52D9%632F%66FF"><span class="hs-identifier hs-var">f&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#25391;&#26367;</span></a><span>   </span><a href="#local-6989586621679475915"><span class="hs-identifier hs-var">result&#23567;&#20998;&#39006;</span></a><span>                                                           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475916"><a href="#local-6989586621679475916"><span class="hs-identifier">result&#23567;&#20998;&#39006;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12394;&#12375;</span></a></a><span>
</span><a name="line-177"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#writeVTable"><span class="hs-identifier hs-var">writeVTable</span></a><span> </span><span class="hs-string">&quot;Data/Result/result&#23567;&#20998;&#39006;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12394;&#12375;.csv&quot;</span><span> </span><a href="#local-6989586621679475916"><span class="hs-identifier hs-var">result&#23567;&#20998;&#39006;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12394;&#12375;</span></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;start f&#26684;&#20184;&#12369;&#19981;&#33021;&#25391;&#26367;&quot;</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%683C%4ED8%3051%4E0D%80FD%632F%66FF"><span class="hs-identifier hs-var">f&#26684;&#20184;&#12369;&#19981;&#33021;&#25391;&#26367;</span></a><span>       </span><a href="#local-6989586621679475916"><span class="hs-identifier hs-var">result&#23567;&#20998;&#39006;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12394;&#12375;</span></a><span>                                         </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475917"><a href="#local-6989586621679475917"><span class="hs-identifier">result&#23567;&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#33021;&#25391;&#26367;</span></a></a><span>
</span><a name="line-180"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#fV%8868%5909%63DB"><span class="hs-identifier hs-var">fV&#34920;&#22793;&#25563;</span></a><span>              </span><a href="#local-6989586621679475917"><span class="hs-identifier hs-var">result&#23567;&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#33021;&#25391;&#26367;</span></a><span>                                             </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475918"><a href="#local-6989586621679475918"><span class="hs-identifier">result</span></a></a><span>
</span><a name="line-181"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#writeVTable"><span class="hs-identifier hs-var">writeVTable</span></a><span> </span><a href="#local-6989586621679475914"><span class="hs-identifier hs-var">resultFile</span></a><span> </span><a href="#local-6989586621679475918"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-182"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-string">&quot;finished!!&quot;</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-185"></a><span>    </span><a name="local-6989586621679475911"><a href="#local-6989586621679475911"><span class="hs-identifier">tmpFile</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data/Result/tempFile.csv&quot;</span><span>
</span><a name="line-186"></a><span>    </span><a name="local-6989586621679475912"><a href="#local-6989586621679475912"><span class="hs-identifier">tmpFile2</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data/Result/tempFile2.csv&quot;</span><span>
</span><a name="line-187"></a><span>    </span><a name="local-6989586621679475913"><a href="#local-6989586621679475913"><span class="hs-identifier">tmpFile3</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data/Result/tempFile3.csv&quot;</span><span>
</span><a name="line-188"></a><span>    </span><a name="local-6989586621679475914"><a href="#local-6989586621679475914"><span class="hs-identifier">resultFile</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data/Result/resultTable.csv&quot;</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- * &#19981;&#36969;&#24403;&#20998;&#39006;&#21066;&#38500;</span><span>
</span><a name="line-194"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-195"></a><span class="hs-comment">{- | &#20998;&#39006;&#12364;&#24494;&#22937;&#12395;&#30064;&#12394;&#12427;&#12418;&#12398;&#12434;&#19968;&#12388;&#19968;&#12388;&#23550;&#24540;&#12375;&#12365;&#12428;&#12394;&#12356;&#12398;&#12391;&#65292;&#12371;&#12371;&#12391;&#24375;&#21046;&#30340;&#12395;&#20966;&#29702;&#12377;&#12427;&#65294;

&#35201;&#20462;&#27491; -}</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-identifier">f&#19981;&#36969;&#24403;&#20998;&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475907"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475907"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><a name="f%4E0D%9069%5F53%5206%524A%9664"><a href="VTable.Compliation.html#f%4E0D%9069%5F53%5206%524A%9664"><span class="hs-identifier">f&#19981;&#36969;&#24403;&#20998;&#21066;&#38500;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-201"></a><span>  </span><a name="local-6989586621679475925"><a href="#local-6989586621679475925"><span class="hs-identifier">maybeIcr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679475925"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679475926"><a href="#local-6989586621679475926"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679475926"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679475927"><a href="#local-6989586621679475927"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-205"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679475927"><span class="hs-identifier hs-var">valComm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-206"></a><span>                  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679475926"><span class="hs-identifier hs-var">icr</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%4E0D%9069%5F53%5206%524A%9664"><span class="hs-identifier hs-var">f&#19981;&#36969;&#24403;&#20998;&#21066;&#38500;</span></a><span>
</span><a name="line-207"></a><span>                  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679475928"><a href="#local-6989586621679475928"><span class="hs-identifier">comm</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679475919"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679475926"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679475928"><span class="hs-identifier hs-var">comm</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679475926"><span class="hs-identifier hs-var">icr</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%4E0D%9069%5F53%5206%524A%9664"><span class="hs-identifier hs-var">f&#19981;&#36969;&#24403;&#20998;&#21066;&#38500;</span></a><span>
</span><a name="line-209"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>    </span><a name="local-6989586621679475919"><a href="#local-6989586621679475919"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679475920"><a href="#local-6989586621679475920"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679475921"><a href="#local-6989586621679475921"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-212"></a><span>        </span><a name="local-6989586621679475922"><a href="#local-6989586621679475922"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-213"></a><span>        </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679475921"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679475923"><a href="#local-6989586621679475923"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-214"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#isDetail"><span class="hs-identifier hs-var">VDC.isDetail</span></a><span class="hs-operator hs-var">.</span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475923"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef</span><span> </span><a href="#local-6989586621679475922"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span> </span><a href="#local-6989586621679475923"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679475920"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679475924"><a href="#local-6989586621679475924"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-216"></a><span>                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;&#35519;&#26619;&#31080;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679475924"><span class="hs-identifier hs-var">valKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>                                                   </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;&#12395;&#12362;&#12369;&#12427;, \n &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12395;&#21547;&#12414;&#12428;&#12427;&#20197;&#19979;&#12398;&#20998;&#39006;&#12399;&#32048;&#20998;&#39006;&#12395;&#24403;&#12390;&#12399;&#12414;&#12427;&#12418;&#12398;&#12364;&#12354;&#12426;&#12414;&#12379;&#12435;. &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679475923"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>        </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679475922"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679475920"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- * &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span><span>
</span><a name="line-223"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- | &#12501;&#12449;&#12452;&#12523;&#12434;&#21463;&#12369;&#21462;&#12387;&#12390;&#65292;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#34892;&#12387;&#12390;&#20986;&#21147;&#12377;&#12427;</span><span>
</span><a name="line-226"></a><span class="hs-comment">--</span><span>
</span><a name="line-227"></a><span class="hs-comment">-- -N5 &#12391;&#65299;&#26178;&#38291;&#31243;&#24230;</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-identifier">full&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-231"></a><a name="full%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><a href="VTable.Compliation.html#full%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier">full&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a></a><span> </span><a name="local-6989586621679475929"><a href="#local-6989586621679475929"><span class="hs-identifier">inputFile</span></a></a><span> </span><a name="local-6989586621679475930"><a href="#local-6989586621679475930"><span class="hs-identifier">maxRowNum</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runConduitRes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679475929"><span class="hs-identifier hs-var">inputFile</span></a><span>
</span><a name="line-232"></a><span>                                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a><span>
</span><a name="line-233"></a><span>                                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Data.Structure.html#sinkCensus"><span class="hs-identifier hs-var">sinkCensus</span></a><span> </span><a href="#local-6989586621679475930"><span class="hs-identifier hs-var">maxRowNum</span></a><span> </span><a href="#local-6989586621679475931"><span class="hs-identifier hs-var">outputFile</span></a><span>
</span><a name="line-234"></a><span>                                </span><span class="hs-keyword">where</span><span>
</span><a name="line-235"></a><span>                                </span><a name="local-6989586621679475931"><a href="#local-6989586621679475931"><span class="hs-identifier">outputFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475929"><span class="hs-identifier hs-var">inputFile</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Stock.csv&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">-- | &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12384;&#12369;&#12434;&#34892;&#12387;&#12390;&#20986;&#21147;&#12377;&#12427;</span><span>
</span><a name="line-238"></a><span class="hs-comment">--</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679475906"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475906"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475906"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-241"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-242"></a><span>            </span><a name="local-6989586621679475932"><a href="#local-6989586621679475932"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-243"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679475932"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-244"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679475933"><a href="#local-6989586621679475933"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574%51E6%7406"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679475933"><span class="hs-identifier hs-var">icd</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>                         </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679475933"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-247"></a><span>                         </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;</span></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">--  | &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#34892;&#12358;&#38306;&#25968;</span><span>
</span><a name="line-251"></a><span class="hs-comment">--</span><span>
</span><a name="line-252"></a><span class="hs-comment">--    &#21508;&#20107;&#26989;&#25152;&#12364;&#12393;&#12398;&#35519;&#26619;&#31080;&#12391;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#12363;&#12395;&#24540;&#12376;&#12390;&#20966;&#29702;&#12434;&#22793;&#12360;&#12427;</span><span>
</span><a name="line-253"></a><span class="hs-comment">--    &#21830;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12391;&#34892;&#12358;&#12383;&#12417;&#65292;&#12371;&#12371;&#12391;&#12399;&#65292;&#20966;&#29702;&#12375;&#12394;&#12356;</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574%51E6%7406"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574%51E6%7406"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679475934"><a href="#local-6989586621679475934"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-257"></a><span>        </span><a name="local-6989586621679475935"><a href="#local-6989586621679475935"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679475934"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-258"></a><span>        </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5206%5C90"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20998;&#23696;</span></a><span> </span><a href="#local-6989586621679475935"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679475934"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- | &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#21029;&#12398;&#20966;&#29702;&#12434;&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12395;&#24540;&#12376;&#12390;&#20998;&#23696;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-262"></a><span class="hs-comment">--</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20998;&#23696;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-265"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5206%5C90"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5206%5C90"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20998;&#23696;</span></a></a><span> </span><a name="local-6989586621679475936"><a href="#local-6989586621679475936"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679475937"><a href="#local-6989586621679475937"><span class="hs-identifier">icd</span></a></a><span>
</span><a name="line-266"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679475936"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679475936"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%8FB2%6797%6F01%696D"><span class="hs-identifier hs-var">E&#36786;&#26519;&#28417;&#26989;</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%8FB2%6797%6C34%7523%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span></a><span>       </span><a href="#local-6989586621679475937"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">--  = return ()</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679475936"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%9271%696D"><span class="hs-identifier hs-var">E&#37489;&#26989;</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%9271%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span></a><span>             </span><a href="#local-6989586621679475937"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-269"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679475936"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%88FD%9020%696D"><span class="hs-identifier hs-var">E&#35069;&#36896;&#26989;</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%88FD%9020%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span></a><span>           </span><a href="#local-6989586621679475937"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-270"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679475936"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5546%696D"><span class="hs-identifier hs-var">E&#21830;&#26989;</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5546%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;</span></a><span>             </span><a href="#local-6989586621679475937"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">--  = return ()</span><span>
</span><a name="line-271"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679475936"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%30B5%30FC%30D3%30B9B"><span class="hs-identifier hs-var">E&#12469;&#12540;&#12499;&#12473;B</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%51FA%7248%30BD%30D5%30C8%30A6%30A7%30A2"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span></a><span> </span><a href="#local-6989586621679475937"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">--  = return ()</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span><span> </span><a href="#local-6989586621679475936"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5EFA%8A2D%696D"><span class="hs-identifier hs-var">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;&#26989;</span></a><span>           </span><a href="#local-6989586621679475937"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-comment">--  = return ()</span><span>
</span><a name="line-273"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- ** &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12398;&#35519;&#26619;&#31080;&#65292;&#29987;&#26989;&#21029;&#20966;&#29702;</span><span>
</span><a name="line-278"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span><span>
</span><a name="line-281"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-282"></a><span class="hs-comment">{- |
    &#36786;&#26519;&#27700;&#29987;&#26989;&#12395;&#38306;&#12375;&#12390;&#21462;&#24471;&#21487;&#33021;&#12394;&#22770;&#19978;&#37329;&#38989;&#12399;&#65292;&#20027;&#26989;&#12399;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#65289;&#65292;
    &#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#65289;&#12398;&#21452;&#26041;&#12363;&#12425;&#24471;&#12425;&#12428;&#12427;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#12398;&#21454;&#20837;&#12301;&#21450;&#12403;&#65292;
    &#35023;&#38754;&#12300;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12391;&#12354;&#12426;&#65292;&#20849;&#12395;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12364;&#35352;&#20837;&#12373;&#12428;&#12390;&#12356;&#12427;&#12383;&#12417;&#65292;&#29987;&#20986;&#37327;&#12398;&#31639;&#20986;&#12398;&#12383;&#12417;&#12395;&#12399;&#65292;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#24517;&#35201;&#12392;&#12377;&#12427;&#65294;

    &#12375;&#12363;&#12375;&#65292;&#22312;&#24235;&#65292;&#20385;&#26684;&#20849;&#12395;&#12475;&#12531;&#12469;&#12473;&#20491;&#31080;&#12363;&#12425;&#25512;&#35336;&#12377;&#12427;&#12371;&#12392;&#12399;&#12391;&#12365;&#12394;&#12356;&#12383;&#12417;&#26412;&#31295;&#12391;&#12399;&#20197;&#38477;&#22770;&#19978;&#12434;&#31639;&#20986;&#12392;&#12375;&#12390;&#25201;&#12358;&#65294;-}</span><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%8FB2%6797%6C34%7523%696D"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%8FB2%6797%6C34%7523%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#36786;&#26519;&#27700;&#29987;&#26989;</span></a></a><span> </span><a name="local-6989586621679475938"><a href="#local-6989586621679475938"><span class="hs-identifier">cd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span><span>
</span><a name="line-294"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-295"></a><span class="hs-comment">{- |
    &#37489;&#26989;&#65292;&#25505;&#30707;&#26989;&#65292;&#30722;&#21033;&#25505;&#21462;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21508;&#31278;&#35519;&#26619;&#31080;&#34920;&#38754;&#12300;&#20107;&#26989;&#25152;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12391;&#12399;&#22770;&#19978;&#12434;&#35352;&#20837;&#12377;&#12427;&#12383;&#12417;&#12371;&#12398;&#20516;&#12434;&#29992;&#12356;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;
    &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12364;&#24517;&#35201;&#12392;&#12394;&#12427;&#65294;

    &#19968;&#26041;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#37489;&#26989;&#65292;&#25505;&#30707;&#26989;&#65292;&#30722;&#21033;&#25505;&#21462;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35023;&#38754;&#12300;&#29983;&#29987;&#25968;&#37327;&#21450;&#12403;&#29983;&#29987;&#37329;&#38989;&#12301;&#12391;&#12399;&#65292;
    &#30330;&#29983;&#20027;&#32681;&#12395;&#22522;&#12389;&#12367;&#29983;&#29987;&#25968;&#37327;&#21450;&#12403;&#37329;&#38989;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#12383;&#12417;&#65292;&#35023;&#38754;&#12398;&#24773;&#22577;&#12395;&#38306;&#12375;&#12390;&#12399;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12434;&#24517;&#35201;&#12392;&#12375;&#12394;&#12356;&#65294;

     &#24467;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#34920;&#38754;&#12398;&#24773;&#22577;&#12434;&#35023;&#38754;&#12398;&#24773;&#22577;&#12395;&#32622;&#12365;&#25563;&#12360;&#12427;&#12383;&#12417;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#35023;&#38754;&#12398;&#21512;&#35336;&#38989;&#12392;&#34920;&#38754;&#12398;&#38989;&#12398;&#27604;&#12363;&#12425;&#65292;
     &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#25351;&#25968;&#12434;&#20316;&#25104;&#12375;&#65292;&#12381;&#12428;&#12434;&#21103;&#29987;&#29289;&#12398;&#25512;&#35336;&#12398;&#38555;&#12395;&#21508;&#24467;&#26989;&#12398;&#22770;&#19978;&#37329;&#38989;&#12395;&#20055;&#12376;&#12427;&#20966;&#29702;&#12434;&#34892;&#12358;&#65294;
     &#12371;&#12398;&#12424;&#12358;&#12394;&#20966;&#29702;&#12364;&#23455;&#38555;&#12395;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12363;&#12399;&#19981;&#26126;&#12391;&#12354;&#12427;&#12364;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#12475;&#12531;&#12469;&#12473;&#38598;&#35336;&#21450;&#12403;&#65292;&#32068;&#26367;&#38598;&#35336;&#12395;&#12390;&#12371;&#12428;&#12434;&#34892;&#12358;&#12418;&#12398;&#12392;&#12375;&#12390;&#35373;&#35336;&#12377;&#12427;&#65294;-}</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-307"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%9271%696D"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%9271%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#37489;&#26989;</span></a></a><span> </span><a name="local-6989586621679475939"><a href="#local-6989586621679475939"><span class="hs-identifier">cd</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679475939"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679475953"><a href="#local-6989586621679475953"><span class="hs-identifier">front</span></a></a><span>
</span><a name="line-308"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679475939"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%751F%7523_%9271%696D_%91D1%984D"><span class="hs-identifier hs-var">H&#29983;&#29987;_&#37489;&#26989;_&#37329;&#38989;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679475954"><a href="#local-6989586621679475954"><span class="hs-identifier">back</span></a></a><span>
</span><a name="line-309"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679475940"><span class="hs-identifier hs-var">convert</span></a><span> </span><a href="#local-6989586621679475939"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="#local-6989586621679475953"><span class="hs-identifier hs-var">front</span></a><span> </span><a href="#local-6989586621679475954"><span class="hs-identifier hs-var">back</span></a><span>
</span><a name="line-310"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-311"></a><span>    </span><span class="hs-identifier">convert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-312"></a><span>    </span><a name="local-6989586621679475940"><a href="#local-6989586621679475940"><span class="hs-identifier">convert</span></a></a><span> </span><a name="local-6989586621679475941"><a href="#local-6989586621679475941"><span class="hs-identifier">cd</span></a></a><span> </span><a name="local-6989586621679475942"><a href="#local-6989586621679475942"><span class="hs-identifier">front</span></a></a><span> </span><a name="local-6989586621679475943"><a href="#local-6989586621679475943"><span class="hs-identifier">back</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679475942"><span class="hs-identifier hs-var">front</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679475943"><span class="hs-identifier hs-var">back</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-313"></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679475944"><a href="#local-6989586621679475944"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679475945"><a href="#local-6989586621679475945"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475946"><a href="#local-6989586621679475946"><span class="hs-identifier">frontTotal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679475947"><a href="#local-6989586621679475947"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679475947"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T2&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475944"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-314"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475948"><a href="#local-6989586621679475948"><span class="hs-identifier">backTotal</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475945"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-315"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475949"><a href="#local-6989586621679475949"><span class="hs-identifier">r</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679475948"><span class="hs-identifier hs-var">backTotal</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679475946"><span class="hs-identifier hs-var">frontTotal</span></a><span>
</span><a name="line-316"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475950"><a href="#local-6989586621679475950"><span class="hs-identifier">newFront</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679475951"><a href="#local-6989586621679475951"><span class="hs-identifier">z</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679475952"><a href="#local-6989586621679475952"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679475951"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679475951"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679475952"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679475949"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475944"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-317"></a><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679475941"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679475950"><span class="hs-identifier hs-var">newFront</span></a><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span><span>
</span><a name="line-323"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-324"></a><span class="hs-comment">{- |
    &#35069;&#36896;&#26989;&#12399;&#24467;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21508;&#31278;&#35519;&#26619;&#31080;&#12398;&#34920;&#38754;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12391;&#22770;&#19978;&#12434;&#32862;&#12356;&#12390;&#12362;&#12426;&#65292;
    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#35069;&#36896;&#26989;&#65289;&#35023;&#38754;&#12300;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;&#65292;&#22312;&#24235;&#38989;&#31561;&#12301;&#12391;&#12399;&#65292;&#12300;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;&#12301;&#21450;&#12403;&#12300;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#12301;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;
    &#12414;&#12383;&#65292;&#21516;&#35023;&#38754;&#35519;&#26619;&#38917;&#30446;&#12300;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#65292;&#21322;&#35069;&#21697;&#65292;&#20181;&#25499;&#21697;&#12398;&#20385;&#38989;&#21450;&#12403;&#21407;&#26448;&#26009;&#65292;&#29123;&#26009;&#12398;&#22312;&#24235;&#38989;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;&#20107;&#26989;&#25152;&#20840;&#20307;&#12398;&#24180;&#21021;&#24180;&#26411;&#12300;&#35069;&#36896;&#21697;&#12301;&#65292;
    &#12300;&#21322;&#35069;&#21697;&#21450;&#12403;&#20181;&#25499;&#21697;&#12301;&#25152;&#26377;&#37329;&#38989;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#12371;&#12428;&#12425;&#12398;&#24773;&#22577;&#12434;&#21033;&#29992;&#12375;&#12390;&#65292;&#35069;&#36896;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#20197;&#19979;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;&#65294;

     &#35069;&#36896;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#35069;&#36896;&#21697;&#30446;&#12364;&#36861;&#35352;&#24335;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#34920;&#38754;&#12398;&#32207;&#21644;&#12392;&#35023;&#38754;&#12398;&#32207;&#21644;&#12364;&#19968;&#33268;&#12377;&#12427;&#12392;&#12399;&#12363;&#12366;&#12425;&#12394;&#12356;&#12383;&#12417;&#65292;&#34920;&#38754;&#35023;&#38754;&#12381;&#12428;&#12382;&#12428;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#65294;

    * &#34920;&#38754;

        &gt;  &#24180;&#21021;&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#65292;&#21322;&#35069;&#21697;&#21450;&#12403;&#20181;&#25499;&#21697;&#22312;&#24235;&#38989;&#12363;&#12425;&#21517;&#30446;&#22312;&#24235;&#22793;&#21205;&#12434;&#27714;&#12417;&#65292;
        &gt; &#21517;&#30446;&#22312;&#24235;&#22793;&#21205;&#12434;&#22770;&#19978;&#39640;&#12395;&#36275;&#12375;&#12383;&#32207;&#29987;&#20986;&#38989;&#12434;&#27714;&#12417;&#12427;&#65294;

    * &#35023;&#38754;

        &gt; &#21517;&#30446;&#22312;&#24235;&#38989;/&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#12398;&#27604;&#12434;&#27714;&#12417;&#12390;&#12381;&#12428;&#12434;&#65292;&#21508;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;&#12395;&#20055;&#12378;&#12427;&#12371;&#12392;&#12391;&#21517;&#30446;&#21697;&#30446;&#21029;&#22312;&#24235;&#22793;&#21205;&#38989;&#12434;&#25512;&#35336;&#12375;&#65292;
        &gt; &#12381;&#12428;&#12434;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;&#12395;&#36275;&#12377;&#12371;&#12392;&#12391;&#21697;&#30446;&#21029;&#35069;&#36896;&#21697;&#29987;&#20986;&#38989;&#12434;&#27714;&#12417;&#12427;&#65294;-}</span><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-345"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%88FD%9020%696D"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%88FD%9020%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#35069;&#36896;&#26989;</span></a></a><span> </span><a name="local-6989586621679475955"><a href="#local-6989586621679475955"><span class="hs-identifier">cd</span></a></a><span>
</span><a name="line-346"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679475955"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%521D%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679475991"><a href="#local-6989586621679475991"><span class="hs-identifier">first</span></a></a><span>
</span><a name="line-347"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679475955"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%672B%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679475992"><a href="#local-6989586621679475992"><span class="hs-identifier">final</span></a></a><span>
</span><a name="line-348"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679475955"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679475993"><a href="#local-6989586621679475993"><span class="hs-identifier">front</span></a></a><span>
</span><a name="line-349"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679475955"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5728%5EAB%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#22312;&#24235;&#38989;_&#35069;&#36896;&#26989;</span></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-keyword">stock</span><span>
</span><a name="line-350"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>    </span><a href="#local-6989586621679475955"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679475995"><a href="#local-6989586621679475995"><span class="hs-identifier">output</span></a></a><span>
</span><a name="line-351"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679475956"><span class="hs-identifier hs-var">convertFront</span></a><span> </span><a href="#local-6989586621679475955"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="#local-6989586621679475991"><span class="hs-identifier hs-var">first</span></a><span> </span><a href="#local-6989586621679475992"><span class="hs-identifier hs-var">final</span></a><span> </span><a href="#local-6989586621679475993"><span class="hs-identifier hs-var">front</span></a><span>
</span><a name="line-352"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621679475957"><span class="hs-identifier hs-var">convertBack</span></a><span>  </span><a href="#local-6989586621679475955"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="#local-6989586621679475991"><span class="hs-identifier hs-var">first</span></a><span> </span><a href="#local-6989586621679475992"><span class="hs-identifier hs-var">final</span></a><span> </span><a href="#local-6989586621679475993"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-keyword">stock</span><span> </span><a href="#local-6989586621679475995"><span class="hs-identifier hs-var">output</span></a><span>
</span><a name="line-353"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-354"></a><span>    </span><span class="hs-identifier">convertFront</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-355"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E74%521D%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-type">Val&#24180;&#21021;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span>
</span><a name="line-356"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E74%672B%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-type">Val&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span>
</span><a name="line-357"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-358"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>    </span><a name="local-6989586621679475956"><a href="#local-6989586621679475956"><span class="hs-identifier">convertFront</span></a></a><span> </span><a name="local-6989586621679475958"><a href="#local-6989586621679475958"><span class="hs-identifier">cd</span></a></a><span>  </span><a name="local-6989586621679475959"><a href="#local-6989586621679475959"><span class="hs-identifier">first</span></a></a><span> </span><a name="local-6989586621679475960"><a href="#local-6989586621679475960"><span class="hs-identifier">final</span></a></a><span> </span><a name="local-6989586621679475961"><a href="#local-6989586621679475961"><span class="hs-identifier">front</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679475959"><span class="hs-identifier hs-var">first</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679475960"><span class="hs-identifier hs-var">final</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679475961"><span class="hs-identifier hs-var">front</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- &#34920;&#38754;&#20966;&#29702;</span><span>
</span><a name="line-360"></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679475962"><a href="#local-6989586621679475962"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679475963"><a href="#local-6989586621679475963"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679475964"><a href="#local-6989586621679475964"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-361"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679475965"><a href="#local-6989586621679475965"><span class="hs-identifier">newFront</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679475966"><a href="#local-6989586621679475966"><span class="hs-identifier">car</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679475967"><a href="#local-6989586621679475967"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679475966"><span class="hs-identifier hs-var">car</span></a><span>
</span><a name="line-362"></a><span>                                            </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679475966"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T3&quot;</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679475966"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679475967"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679475963"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679475962"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-363"></a><span>                                                                           </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679475966"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475964"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-364"></a><span>            </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679475958"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679475965"><span class="hs-identifier hs-var">newFront</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span>    </span><span class="hs-identifier">convertBack</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-368"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E74%521D%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-type">Val&#24180;&#21021;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span>
</span><a name="line-369"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E74%672B%88FD%9020%54C1%5728%5EAB%984D"><span class="hs-identifier hs-type">Val&#24180;&#26411;&#35069;&#36896;&#21697;&#22312;&#24235;&#38989;</span></a><span>
</span><a name="line-370"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-371"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5728%5EAB%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Val&#22312;&#24235;&#38989;_&#35069;&#36896;&#26989;</span></a><span>
</span><a name="line-372"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Val&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span>
</span><a name="line-373"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>    </span><a name="local-6989586621679475957"><a href="#local-6989586621679475957"><span class="hs-identifier">convertBack</span></a></a><span> </span><a name="local-6989586621679475968"><a href="#local-6989586621679475968"><span class="hs-identifier">cd</span></a></a><span> </span><a name="local-6989586621679475969"><a href="#local-6989586621679475969"><span class="hs-identifier">first</span></a></a><span> </span><a name="local-6989586621679475970"><a href="#local-6989586621679475970"><span class="hs-identifier">final</span></a></a><span> </span><a name="local-6989586621679475971"><a href="#local-6989586621679475971"><span class="hs-identifier">front</span></a></a><span> </span><span class="hs-keyword">stock</span><span> </span><a name="local-6989586621679475973"><a href="#local-6989586621679475973"><span class="hs-identifier">output</span></a></a><span>
</span><a name="line-375"></a><span>        </span><span class="hs-glyph">=</span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679475969"><span class="hs-identifier hs-var">first</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679475970"><span class="hs-identifier hs-var">final</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679475971"><span class="hs-identifier hs-var">front</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">stock</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679475973"><span class="hs-identifier hs-var">output</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- &#35023;&#38754;&#20966;&#29702;</span><span>
</span><a name="line-376"></a><span>            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679475974"><a href="#local-6989586621679475974"><span class="hs-identifier">ft</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679475975"><a href="#local-6989586621679475975"><span class="hs-identifier">fl</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679475976"><a href="#local-6989586621679475976"><span class="hs-identifier">fr</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679475977"><a href="#local-6989586621679475977"><span class="hs-identifier">st</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679475978"><a href="#local-6989586621679475978"><span class="hs-identifier">ou</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-377"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679475979"><a href="#local-6989586621679475979"><span class="hs-identifier">stockDiffRatio</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679475975"><span class="hs-identifier hs-var">fl</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679475974"><span class="hs-identifier hs-var">ft</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679475975"><span class="hs-identifier hs-var">fl</span></a><span>
</span><a name="line-378"></a><span>                    </span><a name="local-6989586621679475980"><a href="#local-6989586621679475980"><span class="hs-identifier">mapSt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span>
</span><a name="line-379"></a><span>                          </span><span class="hs-operator hs-var">.</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679475984"><a href="#local-6989586621679475984"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679475984"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679475984"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679475979"><span class="hs-identifier hs-var">stockDiffRatio</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475977"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-380"></a><span>                    </span><a name="local-6989586621679475981"><a href="#local-6989586621679475981"><span class="hs-identifier">ouF</span></a></a><span> </span><a name="local-6989586621679475985"><a href="#local-6989586621679475985"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475986"><a href="#local-6989586621679475986"><span class="hs-identifier">toAdd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679475985"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475980"><span class="hs-identifier hs-var">mapSt</span></a><span>
</span><a name="line-381"></a><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679475986"><span class="hs-identifier hs-var">toAdd</span></a><span> </span><span class="hs-keyword">of</span><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679475985"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-382"></a><span>                                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679475987"><a href="#local-6989586621679475987"><span class="hs-identifier">y</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679475988"><a href="#local-6989586621679475988"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679475985"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679475985"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679475988"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679475987"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">}</span><span>
</span><a name="line-383"></a><span>                    </span><a name="local-6989586621679475982"><a href="#local-6989586621679475982"><span class="hs-identifier">newOu</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><a href="#local-6989586621679475981"><span class="hs-identifier hs-var">ouF</span></a><span> </span><a href="#local-6989586621679475978"><span class="hs-identifier hs-var">ou</span></a><span>
</span><a name="line-384"></a><span>                    </span><a name="local-6989586621679475983"><a href="#local-6989586621679475983"><span class="hs-identifier">newSt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679475989"><a href="#local-6989586621679475989"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679475990"><a href="#local-6989586621679475990"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679475989"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679475989"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679475990"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679475979"><span class="hs-identifier hs-var">stockDiffRatio</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475977"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span>                </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679475968"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679475982"><span class="hs-identifier hs-var">newOu</span></a><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>                </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679475968"><span class="hs-identifier hs-var">cd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5728%5EAB%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#22312;&#24235;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679475983"><span class="hs-identifier hs-var">newSt</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;&#20966;&#29702;</span><span>
</span><a name="line-394"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-395"></a><span class="hs-comment">{- |
    &#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#22312;&#24235;&#27010;&#24565;&#12399;&#65292;&#21508;&#31278;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;&#12420;&#65292;
    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35023;&#38754;&#12300;&#65288;&#24180;&#26411;&#24180;&#21021;&#65289;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#12395;&#12424;&#12387;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
    &#12381;&#12428;&#12425;&#21517;&#30446;&#22312;&#24235;&#20966;&#29702;&#12398;&#35443;&#32048;&#12399;&#12300;4.6.1&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12301;&#12398;&#25512;&#35336;&#12434;&#21442;&#29031;&#65294;-}</span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-401"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5546%696D"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5546%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#21830;&#26989;</span></a></a><span> </span><a name="local-6989586621679475996"><a href="#local-6989586621679475996"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span><span>
</span><a name="line-405"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-406"></a><span class="hs-comment">{- |
    &#20986;&#29256;&#21450;&#12403;&#26377;&#24418;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#12399;&#65292;&#22312;&#24235;&#12364;&#35336;&#19978;&#12373;&#12428;&#12427;&#12364;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#35519;&#26619;&#38917;&#30446;&#12363;&#12425;&#12399;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#12383;&#12417;&#65292;&#12371;&#12371;&#12391;&#12399;&#65292;&#21454;&#20837;&#37329;&#38989;=&#29987;&#20986;&#37329;&#38989;&#12392;&#12375;&#12390;&#25201;&#12358;&#65294;-}</span><span>
</span><a name="line-409"></a><span>
</span><a name="line-410"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-411"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%51FA%7248%30BD%30D5%30C8%30A6%30A7%30A2"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%51FA%7248%30BD%30D5%30C8%30A6%30A7%30A2"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#20986;&#29256;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;</span></a></a><span> </span><a name="local-6989586621679475997"><a href="#local-6989586621679475997"><span class="hs-identifier">cd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-comment">-- &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;</span><span>
</span><a name="line-414"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-415"></a><span class="hs-comment">{- |
    &#24314;&#35373;&#26989;&#12399;&#21508;&#31278;&#35519;&#26619;&#31080;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12356;&#12390;&#20027;&#26989;&#65292;
    &#24467;&#26989;&#12398;&#32207;&#38989;&#12434;&#65292;&#12300;&#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;&#20027;&#26989;&#12398;&#20869;&#35379;&#12434;&#25226;&#25569;&#12377;&#12427;&#65294;
    SNA&#12395;&#12362;&#12369;&#12427;&#24314;&#35373;&#26989;&#12399;&#65292;&#23436;&#25104;&#24037;&#20107;&#39640;&#12398;&#20182;&#12395;&#65292;&#26410;&#23436;&#25104;&#24037;&#20107;&#39640;&#12418;&#12381;&#12398;&#29983;&#29987;&#37329;&#38989;&#12395;&#21547;&#12416;&#12364;&#12371;&#12428;&#12425;&#12398;&#26410;&#23436;&#25104;&#24037;&#20107;&#39640;&#12399;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12391;&#12399;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#65294;
    &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26412;&#31295;&#12391;&#12399;&#24314;&#35373;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#26410;&#23436;&#25104;&#24037;&#20107;&#39640;&#12434;&#21547;&#12417;&#12394;&#12356;&#23436;&#25104;&#24037;&#20107;&#39640;&#20998;&#12398;&#22770;&#19978;&#38989;&#12434;&#29983;&#29987;&#38989;&#12392;&#12415;&#12394;&#12375;&#12390;&#20197;&#24460;&#25512;&#35336;&#12434;&#34892;&#12358;&#65294;-}</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-422"></a><a name="f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5EFA%8A2D%696D"><a href="VTable.Compliation.html#f%5728%5EAB%54C1%8A55%4FA1%8ABF%6574_%5EFA%8A2D%696D"><span class="hs-identifier">f&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;_&#24314;&#35373;&#26989;</span></a></a><span> </span><a name="local-6989586621679475998"><a href="#local-6989586621679475998"><span class="hs-identifier">cd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-427"></a><span class="hs-comment">-- * &#29987;&#26989;&#26684;&#20184;</span><span>
</span><a name="line-428"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-comment">-- | &#12501;&#12449;&#12452;&#12523;&#12434;&#21463;&#12369;&#21462;&#12387;&#12390;&#65292;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12387;&#12383;&#24460;&#20986;&#21147;</span><span>
</span><a name="line-431"></a><span class="hs-identifier">full&#29987;&#26989;&#26684;&#20184;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-432"></a><a name="full%7523%696D%683C%4ED8"><a href="VTable.Compliation.html#full%7523%696D%683C%4ED8"><span class="hs-identifier">full&#29987;&#26989;&#26684;&#20184;</span></a></a><span> </span><a name="local-6989586621679475999"><a href="#local-6989586621679475999"><span class="hs-identifier">inputFile</span></a></a><span> </span><a name="local-6989586621679476000"><a href="#local-6989586621679476000"><span class="hs-identifier">maxRowNum</span></a></a><span> </span><a name="local-6989586621679476001"><a href="#local-6989586621679476001"><span class="hs-identifier">year</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runConduitRes</span><span>
</span><a name="line-433"></a><span>                                        </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679475999"><span class="hs-identifier hs-var">inputFile</span></a><span>
</span><a name="line-434"></a><span>                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;</span></a><span> </span><a href="#local-6989586621679476001"><span class="hs-identifier hs-var">year</span></a><span>
</span><a name="line-435"></a><span>                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#f%4E0D%9069%5F53%5206%524A%9664"><span class="hs-identifier hs-var">f&#19981;&#36969;&#24403;&#20998;&#21066;&#38500;</span></a><span>
</span><a name="line-436"></a><span>                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span></a><span> </span><a href="#local-6989586621679476001"><span class="hs-identifier hs-var">year</span></a><span>
</span><a name="line-437"></a><span>                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Data.Structure.html#sinkCensus"><span class="hs-identifier hs-var">sinkCensus</span></a><span> </span><a href="#local-6989586621679476000"><span class="hs-identifier hs-var">maxRowNum</span></a><span> </span><a href="#local-6989586621679476002"><span class="hs-identifier hs-var">outputFile</span></a><span>
</span><a name="line-438"></a><span>                                </span><span class="hs-keyword">where</span><span>
</span><a name="line-439"></a><span>                                </span><a name="local-6989586621679476002"><a href="#local-6989586621679476002"><span class="hs-identifier">outputFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679475999"><span class="hs-identifier hs-var">inputFile</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Classify.csv&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span class="hs-comment">{- | &#29987;&#26989;&#26684;&#20184;&#12398;&#12415;&#12434;&#34892;&#12358;Conduit

    &#20197;&#38477;&#12398;&#20966;&#29702;&#12391;&#24517;&#35201;&#12398;&#12394;&#12356;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12399;,&#12487;&#12540;&#12479;&#12434;&#21066;&#38500;&#12377;&#12427;.

    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#65292;&#29987;&#26989;&#27598;&#12395;&#22770;&#19978;&#65292;&#24467;&#26989;&#32773;&#25968;&#12420;&#26989;&#24907;&#12394;&#12393;&#12398;&#38598;&#35336;&#12434;&#34892;&#12358;&#12383;&#12417;&#65292;
    &#12381;&#12398;&#38598;&#35336;&#12395;&#12354;&#12383;&#12387;&#12390;&#35519;&#26619;&#23458;&#20307;&#12391;&#12354;&#12427;&#20225;&#26989;/&#20107;&#26989;&#25152;&#21508;&#12293;&#12398;&#20027;&#26989;&#12434;&#23450;&#12417;&#12427;&#20316;&#26989;&#12434;&#34892;&#12358;&#24517;&#35201;&#12364;&#12354;&#12427;&#65294;

    &#12371;&#12398;&#20225;&#26989;&#12539;&#20107;&#26989;&#25152;&#21029;&#12398;&#20027;&#26989;&#12398;&#31574;&#23450;&#20316;&#26989;&#12434;&#19968;&#33324;&#12395;&#12300;&#29987;&#26989;&#26684;&#20184;&#12369;&#12301;&#12392;&#12356;&#12358;&#65294;

    24&#24180;&#21450;&#12403;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#35519;&#26619;&#31080;&#12395;&#12399;&#65292;&#21454;&#20837;&#38989;&#65292;&#36009;&#22770;&#38989;&#12392;&#12399;&#21029;&#12395;&#12300;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12395;&#38306;&#12377;&#12427;&#35519;&#26619;&#38917;&#30446;&#12364;&#23384;&#22312;&#12377;&#12427;&#65294;
    &#12371;&#12398;&#12300;&#20027;&#12394;&#20107;&#26989;&#25152;&#12301;&#12399;&#65292;&#26085;&#26412;&#22269;&#20869;&#12398;&#12377;&#12409;&#12390;&#12398;&#20107;&#26989;&#25152;&#12539;&#20225;&#26989;&#24773;&#22577;&#12434;&#35036;&#36275;&#12377;&#12427;&#12300;&#20107;&#26989;&#25152;&#27597;&#38598;&#22243;&#12487;&#12540;&#12479;&#12505;&#12540;&#12473;&#65288;&#12499;&#12472;&#12493;&#12473;&#12524;&#12472;&#12473;&#12479;&#12540;&#65289;&#12301;
    &#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#12539;&#20225;&#26989;&#29031;&#20250;&#65292;&#21450;&#12403;&#12300;&#20107;&#26989;&#12398;&#23455;&#26045;&#29366;&#27841;&#30906;&#35469;&#12301;&#12434;&#12418;&#12392;&#12395;&#20107;&#21069;&#12395;&#35352;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
    &#22793;&#26356;&#12398;&#12354;&#12387;&#12383;&#22580;&#21512;&#12398;&#12415;&#35519;&#26619;&#31080;&#12395;&#21508;&#20107;&#26989;&#25152;&#12364;&#35352;&#36617;&#12377;&#12427;&#12371;&#12392;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;

    &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#26032;&#35215;&#20107;&#26989;&#25152;&#12434;&#38500;&#12356;&#12390;&#21508;&#12293;&#12398;&#20107;&#26989;&#25152;&#12399;&#65292;&#35519;&#26619;&#27573;&#38542;&#12391;&#26082;&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12364;&#12394;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
    &#12375;&#12363;&#12375;&#65292;&#12524;&#12473;&#12488;&#12521;&#12531;&#12420;&#12452;&#12505;&#12531;&#12488;&#20250;&#22580;&#12434;&#21547;&#12435;&#12384;&#12507;&#12486;&#12523;&#26045;&#35373;&#12395;&#12362;&#12356;&#12390;&#65292;&#12524;&#12473;&#12488;&#12521;&#12531;&#12398;&#22770;&#12426;&#19978;&#12370;&#12364;&#65292;&#23487;&#27850;&#20107;&#26989;&#12424;&#12426;&#12418;&#21454;&#30410;&#12364;&#22823;&#12365;&#12356;&#22580;&#21512;&#12394;&#12393;&#65292;
    &#20107;&#26989;&#25152;&#21450;&#12403;&#20225;&#26989;&#12398;&#35469;&#35672;&#12377;&#12427;&#20027;&#12394;&#20107;&#26989;&#12392;&#12300;&#21454;&#20837;&#38989;&#12414;&#12383;&#12399;&#20986;&#33655;&#38989;&#12398;&#26368;&#12418;&#22810;&#12356;&#12418;&#12398;&#12301;&#12392;&#12356;&#12358;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#21407;&#21063;&#12364;&#19968;&#33268;&#12375;&#12394;&#12356;&#12371;&#12392;&#12364;&#12414;&#12414;&#12354;&#12427;&#65294;
    &#12371;&#12398;&#12383;&#12417;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#38598;&#35336;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#21508;&#20107;&#26989;&#25152;&#12434;&#21407;&#21063;&#12395;&#21063;&#12387;&#12390;&#20877;&#12403;&#29987;&#26989;&#26684;&#20184;&#12369;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12424;&#12427;&#26684;&#20184;&#12369;&#12399;&#29987;&#26989;&#21029;&#12398;&#38598;&#35336;&#12398;&#38555;&#12395;&#29992;&#12356;&#12425;&#12428;&#12427;&#12364;&#65292;
    &#32068;&#26367;&#38598;&#35336;&#12398;&#12383;&#12417;&#12395;&#12399;&#65292;&#20027;&#12395;&#35519;&#26619;&#31080;&#31532;&#65298;&#38754;&#12391;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12427;&#29983;&#29987;&#29289;&#21029;&#12398;&#22770;&#19978;&#38989;&#12434;&#25226;&#25569;&#12375;&#65292;
    &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#29983;&#29987;&#37327;&#12434;&#25226;&#25569;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12426;&#65292;&#12381;&#12398;&#12383;&#12417;&#12395;&#12399;&#65292;&#35519;&#26619;&#31080;&#12391;&#35352;&#36617;&#12373;&#12428;&#12383;&#21508;&#35519;&#26619;&#38917;&#30446;&#12363;&#12425;&#65292;
    &#12381;&#12398;&#20107;&#26989;&#25152;&#12395;&#12362;&#12369;&#12427;&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#65292;&#21103;&#29983;&#29987;&#29289;&#12434;&#25226;&#25569;&#12377;&#12427;&#12371;&#12392;&#12364;&#27714;&#12417;&#12425;&#12428;&#12427;&#65294;

    &#12381;&#12398;&#38555;&#65292;&#35023;&#38754;&#12395;&#12362;&#12360;&#12369;&#12427;&#21508;&#35519;&#26619;&#38917;&#30446;&#12399;&#65292;&#29983;&#29987;&#29289;&#12392;&#19968;&#23550;&#19968;&#23550;&#24540;&#12395;&#12354;&#12427;&#12431;&#12369;&#12391;&#12399;&#12394;&#12356;&#12398;&#12391;&#65292;
    &#12381;&#12428;&#12382;&#12428;&#12398;&#35519;&#26619;&#38917;&#30446;&#12363;&#12425;&#29983;&#29987;&#29289;&#21450;&#12403;&#22770;&#19978;&#38989;&#12434;&#29305;&#23450;&#12377;&#12427;&#20316;&#26989;&#12434;&#24517;&#35201;&#12392;&#12377;&#12427;&#65294;

    &#12371;&#12428;&#12425;&#12398;&#20966;&#29702;&#12399;&#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12362;&#12369;&#12427;&#20966;&#29702;&#12364;&#21442;&#32771;&#12392;&#12394;&#12427;&#12383;&#12417;&#65292;&#12371;&#12371;&#12391;&#12399;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;&#12392;&#21516;&#26178;&#12395;&#65292;
    &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12364;&#25226;&#25569;&#12391;&#12365;&#12427;&#12424;&#12358;&#12395;&#35373;&#35336;&#12377;&#12427;&#65294;

    &#20840;&#12390;IO&#12395;&#12375;&#12390;,&#19968;&#34892;&#12378;&#12388;&#20966;&#29702;&#12377;&#12427;&#12411;&#12358;&#12364;&#33391;&#12356;(&#35201;&#20462;&#27491;)
-}</span><span>
</span><a name="line-475"></a><span>
</span><a name="line-476"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679475905"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475905"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475905"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-477"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;</span></a></a><span> </span><a name="local-6989586621679476003"><a href="#local-6989586621679476003"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-478"></a><span>    </span><a name="local-6989586621679476004"><a href="#local-6989586621679476004"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-479"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476004"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-480"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476005"><a href="#local-6989586621679476005"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5%51E6%7406"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476003"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476005"><span class="hs-identifier hs-var">icd</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679476005"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-483"></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;</span></a><span> </span><a href="#local-6989586621679476003"><span class="hs-identifier hs-var">year</span></a><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679475904"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475904"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475904"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-486"></a><a name="f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span></a></a><span> </span><a name="local-6989586621679476006"><a href="#local-6989586621679476006"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-487"></a><span>    </span><a name="local-6989586621679476007"><a href="#local-6989586621679476007"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-488"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476007"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-489"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476008"><a href="#local-6989586621679476008"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5%51E6%7406"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476006"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476008"><span class="hs-identifier hs-var">icd</span></a><span class="hs-special">)</span><span>
</span><a name="line-491"></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679476008"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-492"></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span></a><span> </span><a href="#local-6989586621679476006"><span class="hs-identifier hs-var">year</span></a><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span class="hs-comment">-- ** &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;</span><span>
</span><a name="line-496"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span class="hs-comment">{- | &#22770;&#19978;&#39640;&#12391;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;&#12383;&#12417;&#65292;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12398;&#21069;&#12395;&#34892;&#12358;&#65294;

    &#26412;&#31295;&#12391;&#12399;,&#12371;&#12398;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#37329;&#38989;&#12398;&#12487;&#12540;&#12479;&#12434;&#20316;&#25104;&#12377;&#12427;&#12371;&#12392;&#12434;&#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12362;&#12369;&#12427;&#65378;&#29305;&#27530;&#12394;&#26041;&#27861;&#65379;&#12434;&#21033;&#29992;&#12375;&#12390;&#34892;&#12356;,
    &#20316;&#25104;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#21029;&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#12398;&#20869;&#26368;&#22823;&#12398;&#12418;&#12398;&#12434;&#20027;&#26989;&#12392;&#12375;&#12390;&#36984;&#25246;&#12377;&#12427;&#12371;&#12392;&#12434;&#65378;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#65379;&#12392;&#12375;&#12390;&#12356;&#12427;(&#21516;&#26178;&#12395;&#24467;&#26989;,&#20027;&#29983;&#29987;&#29289;,&#21103;&#29983;&#29987;&#29289;&#12364;&#20309;&#12391;&#12354;&#12427;&#12363;&#12364;&#21028;&#26126;&#12377;&#12427;)&#12290;
    &#12371;&#12428;&#12425;&#12398;&#26041;&#27861;&#12434;&#29992;&#12356;&#12390;&#27770;&#23450;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#21450;&#12403;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#20998;&#39006;&#38917;&#30446;&#12434;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#20998;&#39006;&#12395;&#22793;&#25563;&#12375;&#65292;
    &#29987;&#26989;&#21029;&#12395;&#38598;&#35336;&#12377;&#12427;&#12371;&#12392;&#12391;&#29987;&#26989;&#21029;&#21697;&#30446;&#21029;&#12398;&#32068;&#26367;&#38598;&#35336;&#12364;&#23436;&#20102;&#12377;&#12427;&#12290;


     &#12300;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12301;&#12399;&#65292;&#20197;&#19979;&#12398;&#25163;&#32154;&#12365;&#12395;&#21063;&#12387;&#12390;&#34892;&#12431;&#12428;&#12427;&#12290;

    1. &#20107;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#37329;&#38989;&#21450;&#12403;&#65292;&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#12398;&#26368;&#22823;&#22770;&#19978;&#37096;&#38272;&#12434;&#21462;&#24471;&#12377;&#12427;&#12290;

    2. &#12391;&#27770;&#23450;&#12375;&#12383;&#21306;&#20998;&#12395;&#35442;&#24403;&#12377;&#12427;&#37096;&#38272;&#12398;&#12415;&#12398;&#12487;&#12540;&#12479;&#12434;&#29992;&#12356;&#12390;&#65292;&#27425;&#28857;&#12391;&#32048;&#12363;&#12356;&#20998;&#39006;&#12398;&#26368;&#22823;&#22770;&#19978;&#21306;&#20998;&#12434;&#25226;&#25569;&#12377;&#12427;&#12290;
     &#26368;&#22823;&#22770;&#19978;&#21306;&#20998;&#12395;&#37325;&#35079;&#12364;&#12354;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;&#21452;&#26041;&#12395;&#12362;&#12356;&#12390;&#27425;&#28857;&#12391;&#32048;&#12363;&#12356;&#20998;&#39006;&#12398;&#26368;&#22823;&#22770;&#12426;&#19978;&#12370;&#21306;&#20998;&#12434;&#25226;&#25569;&#12375;&#65292;&#12381;&#12398;&#38989;&#12398;&#22823;&#12365;&#12356;&#26041;&#12434;&#25505;&#29992;&#12377;&#12427;&#12290;

    3. &#12381;&#12428;&#20197;&#19978;&#32048;&#12363;&#12356;&#21306;&#20998;&#12364;&#23384;&#22312;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399;&#21069;&#27573;&#38542;&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#19979;&#20301;&#20998;&#39006;&#12398;&#12300;&#26684;&#20184;&#12369;&#19981;&#33021;&#12301;&#38917;&#30446;&#12395;&#20998;&#39006;&#12377;&#12427;&#12290;
    &#37325;&#35079;&#12364;&#12354;&#12427;&#12398;&#12364;&#26368;&#12418;&#32048;&#12363;&#12356;&#20998;&#39006;&#12391;&#12354;&#12427;&#22580;&#21512;&#12399;&#65292;&#35672;&#21029;&#30058;&#21495;&#12398;&#33509;&#12356;&#26041;&#12434;&#25505;&#29992;&#12377;&#12427;&#12290;

     ![&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;](general.png)

    &#21103;&#26989;&#12398;&#20998;&#35299;&#12399;&#65292;&#21103;&#26989;&#12398;&#20998;&#35299;&#12398;&#38917;&#30446;&#12391;&#34892;&#12358;&#65294;

    &#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#12395;&#12399;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#22770;&#12426;&#19978;&#12370;&#12418;&#21547;&#12414;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;&#27880;&#24847;



-}</span><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20966;&#29702;</span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-527"></a><a name="f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5%51E6%7406"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%4E00%822C%7684%306A%65B9%6CD5%51E6%7406"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476009"><a href="#local-6989586621679476009"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476010"><a href="#local-6989586621679476010"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-528"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476011"><a href="#local-6989586621679476011"><span class="hs-identifier">en</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476010"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-var">H&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span>
</span><a name="line-529"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476012"><a href="#local-6989586621679476012"><span class="hs-identifier">es</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476010"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-var">H&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span>
</span><a name="line-530"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476013"><a href="#local-6989586621679476013"><span class="hs-identifier">sev</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476010"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-531"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476014"><a href="#local-6989586621679476014"><span class="hs-identifier">tar</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476010"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-532"></a><span>        </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476010"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%4E00%822C%7684%306A%65B9%6CD5%5206%5C90"><span class="hs-identifier hs-var">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20998;&#23696;</span></a><span> </span><a href="#local-6989586621679476013"><span class="hs-identifier hs-var">sev</span></a><span> </span><a href="#local-6989586621679476014"><span class="hs-identifier hs-var">tar</span></a><span> </span><a href="#local-6989586621679476011"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476012"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span>
</span><a name="line-534"></a><span class="hs-identifier">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20998;&#23696;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-535"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-536"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span>
</span><a name="line-537"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span>
</span><a name="line-538"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-539"></a><a name="f%4E00%822C%7684%306A%65B9%6CD5%5206%5C90"><a href="VTable.Compliation.html#f%4E00%822C%7684%306A%65B9%6CD5%5206%5C90"><span class="hs-identifier">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20998;&#23696;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a name="local-6989586621679476015"><a href="#local-6989586621679476015"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476016"><a href="#local-6989586621679476016"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679476015"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476016"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-540"></a><span class="hs-identifier">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20998;&#23696;</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a name="local-6989586621679476017"><a href="#local-6989586621679476017"><span class="hs-identifier">comm</span></a></a><span> </span><a name="local-6989586621679476018"><a href="#local-6989586621679476018"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476019"><a href="#local-6989586621679476019"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679476017"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476018"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476019"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-541"></a><span class="hs-identifier">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20998;&#23696;</span><span> </span><a name="local-6989586621679476020"><a href="#local-6989586621679476020"><span class="hs-identifier">sev</span></a></a><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a name="local-6989586621679476021"><a href="#local-6989586621679476021"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476022"><a href="#local-6989586621679476022"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><span class="hs-identifier hs-var">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679476020"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476021"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476022"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-542"></a><span class="hs-identifier">f&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#20998;&#23696;</span><span> </span><a name="local-6989586621679476023"><a href="#local-6989586621679476023"><span class="hs-identifier">sev</span></a></a><span>  </span><a name="local-6989586621679476024"><a href="#local-6989586621679476024"><span class="hs-identifier">comm</span></a></a><span> </span><a name="local-6989586621679476025"><a href="#local-6989586621679476025"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476026"><a href="#local-6989586621679476026"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><span class="hs-identifier hs-var">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679476023"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476024"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476025"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476026"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-comment">-- | &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12398;&#20869;&#26368;&#22823;&#12398;&#38917;&#30446;&#12398;&#29987;&#26989;&#20998;&#39006;&#12434;&#21462;&#24471;</span><span>
</span><a name="line-547"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span>
</span><a name="line-548"></a><a name="f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><a href="VTable.Compliation.html#f%4E8B%696D%5225%58F2%4E0A%91D1%984D%6700%5927%9805%76EE%53D6%5F97"><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-549"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#37329;&#38989;&#26368;&#22823;&#38917;&#30446;&#21462;&#24471;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476027"><a href="#local-6989586621679476027"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#vmaximumNamesWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNamesWithoutErr</span></a><span>
</span><a name="line-550"></a><span>                                          </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="VTable.Compliation.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476027"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-comment">-- | &#19981;&#36969;&#24403;&#12394;&#25991;&#23383;&#21015;&#12395;&#23550;&#12377;&#12427;&#20966;&#29702;&#65292;Map&#20351;&#12358;&#12392;&#36933;&#12356;&#12398;&#12391;&#65292;&#12392;&#12426;&#12354;&#12360;&#12378;&#20986;&#12390;&#12365;&#12383;&#12497;&#12479;&#12540;&#12531;&#12395;&#23550;&#24540;&#12377;&#12427;</span><span>
</span><a name="line-553"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">notSuiteCarName</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-554"></a><a name="notSuiteCarName"><a href="VTable.Compliation.html#notSuiteCarName"><span class="hs-identifier">notSuiteCarName</span></a></a><span> </span><a name="local-6989586621679476028"><a href="#local-6989586621679476028"><span class="hs-identifier">tx</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.null</span><span> </span><a href="#local-6989586621679476028"><span class="hs-identifier hs-var">tx</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-555"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.any</span><span> </span><span class="hs-special">(</span><span class="hs-char">'&#12288;'</span><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476028"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-556"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.any</span><span> </span><span class="hs-special">(</span><span class="hs-char">' '</span><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476028"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-557"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-comment">-- | &#19981;&#36969;&#24403;&#12394;&#25991;&#23383;&#21015;&#12395;&#23550;&#12377;&#12427;&#20966;&#29702;&#65292;Map&#20351;&#12358;&#12392;&#36933;&#12356;&#12398;&#12391;&#65292;&#12392;&#12426;&#12354;&#12360;&#12378;&#20986;&#12390;&#12365;&#12383;&#12497;&#12479;&#12540;&#12531;&#12395;&#23550;&#24540;&#12377;&#12427;</span><span>
</span><a name="line-560"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">convNotSuiteVal</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-561"></a><span class="hs-identifier">convNotSuiteVal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-562"></a><a name="convNotSuiteVal"><a href="VTable.Compliation.html#convNotSuiteVal"><span class="hs-identifier">convNotSuiteVal</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-563"></a><span class="hs-identifier">convNotSuiteVal</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476029"><a href="#local-6989586621679476029"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Compliation.html#convNotSuiteCars"><span class="hs-identifier hs-var">convNotSuiteCars</span></a><span> </span><a href="#local-6989586621679476029"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span>
</span><a name="line-566"></a><span>
</span><a name="line-567"></a><span class="hs-identifier">convNotSuiteCars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-568"></a><a name="convNotSuiteCars"><a href="VTable.Compliation.html#convNotSuiteCars"><span class="hs-identifier">convNotSuiteCars</span></a></a><span> </span><a name="local-6989586621679476030"><a href="#local-6989586621679476030"><span class="hs-identifier">cs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476031"><a href="#local-6989586621679476031"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Compliation.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span> </span><span class="hs-operator hs-var">.</span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476031"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476030"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-comment">{- | &#20107;&#21069;&#26684;&#20184;&#12434;&#21033;&#29992;&#12375;&#12383;&#20966;&#29702;
&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369;&#12399;&#20225;&#26989;&#29987;&#26989;&#20998;&#39006;&#12392;&#12356;&#12358;&#35598;&#12398;&#20998;&#39006;&#12434;&#20351;&#29992;&#12375;&#12390;&#12356;&#12427;
-}</span><span>
</span><a name="line-574"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-575"></a><span class="hs-identifier">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-576"></a><a name="f%4E8B%524D%683C%4ED8%51E6%7406"><a href="VTable.Compliation.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476032"><a href="#local-6989586621679476032"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679476033"><a href="#local-6989586621679476033"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476034"><a href="#local-6989586621679476034"><span class="hs-identifier">es</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.null</span><span> </span><a href="#local-6989586621679476032"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476033"><span class="hs-identifier hs-var">en</span></a><span class="hs-special">,</span><a href="#local-6989586621679476034"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-577"></a><span>                                        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679476049"><a href="#local-6989586621679476049"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679476050"><a href="#local-6989586621679476050"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476035"><span class="hs-identifier hs-var">cov15and35</span></a><span> </span><a href="#local-6989586621679476050"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-578"></a><span>                                        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span>        </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679476051"><a href="#local-6989586621679476051"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476035"><span class="hs-identifier hs-var">cov15and35</span></a><span> </span><a href="#local-6989586621679476051"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>                                        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679476052"><a href="#local-6989586621679476052"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476035"><span class="hs-identifier hs-var">cov15and35</span></a><span> </span><a href="#local-6989586621679476052"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-580"></a><span>                                        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#generalCNC"><span class="hs-identifier hs-var">generalCNC</span></a><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.minimum</span><span> </span><a href="#local-6989586621679476032"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-583"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-584"></a><span>    </span><a name="local-6989586621679476035"><a href="#local-6989586621679476035"><span class="hs-identifier">cov15and35</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679476037"><a href="#local-6989586621679476037"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679476038"><a href="#local-6989586621679476038"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679476039"><a href="#local-6989586621679476039"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679476040"><a href="#local-6989586621679476040"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679476041"><a href="#local-6989586621679476041"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679476042"><a href="#local-6989586621679476042"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-585"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679476036"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="VTable.Data.Classification.html#Large"><span class="hs-identifier hs-var">Large</span></a><span> </span><a href="#local-6989586621679476037"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-586"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679476036"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="VTable.Data.Classification.html#OF"><span class="hs-identifier hs-var">OF</span></a><span> </span><a href="#local-6989586621679476038"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span>
</span><a name="line-587"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679476036"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="VTable.Data.Classification.html#Middle"><span class="hs-identifier hs-var">Middle</span></a><span> </span><a href="#local-6989586621679476039"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-588"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679476036"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="VTable.Data.Classification.html#Small"><span class="hs-identifier hs-var">Small</span></a><span> </span><a href="#local-6989586621679476040"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679476036"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="VTable.Data.Classification.html#TF"><span class="hs-identifier hs-var">TF</span></a><span> </span><a href="#local-6989586621679476041"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679476036"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="VTable.Data.Classification.html#Detail"><span class="hs-identifier hs-var">Detail</span></a><span> </span><a href="#local-6989586621679476042"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-591"></a><span>
</span><a name="line-592"></a><span>    </span><a name="local-6989586621679476036"><a href="#local-6989586621679476036"><span class="hs-identifier">conv</span></a></a><span> </span><a href="VTable.Data.Classification.html#Large"><span class="hs-identifier hs-var">Large</span></a><span>  </span><a name="local-6989586621679476043"><a href="#local-6989586621679476043"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="VTable.Data.Classification.html#isLarge"><span class="hs-identifier hs-var">isLarge</span></a><span>  </span><a href="#local-6989586621679476043"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476043"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="VTable.Compliation.html#lemp"><span class="hs-identifier hs-var">lemp</span></a><span>
</span><a name="line-593"></a><span>    </span><span class="hs-identifier">conv</span><span> </span><a href="VTable.Data.Classification.html#OF"><span class="hs-identifier hs-var">OF</span></a><span>     </span><a name="local-6989586621679476044"><a href="#local-6989586621679476044"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="VTable.Data.Classification.html#isOF"><span class="hs-identifier hs-var">isOF</span></a><span>     </span><a href="#local-6989586621679476044"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476044"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="VTable.Compliation.html#oemp"><span class="hs-identifier hs-var">oemp</span></a><span>
</span><a name="line-594"></a><span>    </span><span class="hs-identifier">conv</span><span> </span><a href="VTable.Data.Classification.html#Middle"><span class="hs-identifier hs-var">Middle</span></a><span> </span><a name="local-6989586621679476045"><a href="#local-6989586621679476045"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="VTable.Data.Classification.html#isMiddle"><span class="hs-identifier hs-var">isMiddle</span></a><span> </span><a href="#local-6989586621679476045"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476045"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="VTable.Compliation.html#memp"><span class="hs-identifier hs-var">memp</span></a><span>
</span><a name="line-595"></a><span>    </span><span class="hs-identifier">conv</span><span> </span><a href="VTable.Data.Classification.html#Small"><span class="hs-identifier hs-var">Small</span></a><span>  </span><a name="local-6989586621679476046"><a href="#local-6989586621679476046"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="VTable.Data.Classification.html#isSmall"><span class="hs-identifier hs-var">isSmall</span></a><span>  </span><a href="#local-6989586621679476046"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476046"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="VTable.Compliation.html#semp"><span class="hs-identifier hs-var">semp</span></a><span>
</span><a name="line-596"></a><span>    </span><span class="hs-identifier">conv</span><span> </span><a href="VTable.Data.Classification.html#TF"><span class="hs-identifier hs-var">TF</span></a><span>     </span><a name="local-6989586621679476047"><a href="#local-6989586621679476047"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="VTable.Data.Classification.html#isTF"><span class="hs-identifier hs-var">isTF</span></a><span>     </span><a href="#local-6989586621679476047"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476047"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="VTable.Compliation.html#temp"><span class="hs-identifier hs-var">temp</span></a><span>
</span><a name="line-597"></a><span>    </span><span class="hs-identifier">conv</span><span> </span><a href="VTable.Data.Classification.html#Detail"><span class="hs-identifier hs-var">Detail</span></a><span> </span><a name="local-6989586621679476048"><a href="#local-6989586621679476048"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="VTable.Data.Classification.html#isDetail"><span class="hs-identifier hs-var">isDetail</span></a><span> </span><a href="#local-6989586621679476048"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476048"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-598"></a><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><a name="lemp"><a href="VTable.Compliation.html#lemp"><span class="hs-identifier">lemp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#9651;&quot;</span><span>         </span><span class="hs-comment">--  &#22823;&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-601"></a><a name="oemp"><a href="VTable.Compliation.html#oemp"><span class="hs-identifier">oemp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;15#&#9651;&#9651;&quot;</span><span>    </span><span class="hs-comment">--  1.5&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-602"></a><a name="memp"><a href="VTable.Compliation.html#memp"><span class="hs-identifier">memp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&quot;</span><span>       </span><span class="hs-comment">--  &#20013;&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-603"></a><a name="semp"><a href="VTable.Compliation.html#semp"><span class="hs-identifier">semp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&quot;</span><span>     </span><span class="hs-comment">--  &#23567;&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-604"></a><a name="temp"><a href="VTable.Compliation.html#temp"><span class="hs-identifier">temp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;35#&#9651;&#9651;&#9651;&quot;</span><span>  </span><span class="hs-comment">--  3.5&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-605"></a><a name="demp"><a href="VTable.Compliation.html#demp"><span class="hs-identifier">demp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&#9651;&quot;</span><span>   </span><span class="hs-comment">--  &#32048;&#20998;&#39006;&#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-606"></a><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span class="hs-comment">-- | &#20107;&#26989;&#20869;&#23481;&#31561;&#19981;&#35443;</span><span>
</span><a name="line-609"></a><a name="generalCNC"><a href="VTable.Compliation.html#generalCNC"><span class="hs-identifier">generalCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span>  </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="VTable.Compliation.html#lemp"><span class="hs-identifier hs-var">lemp</span></a><span> </span><a href="VTable.Compliation.html#oemp"><span class="hs-identifier hs-var">oemp</span></a><span> </span><a href="VTable.Compliation.html#memp"><span class="hs-identifier hs-var">memp</span></a><span> </span><a href="VTable.Compliation.html#semp"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="VTable.Compliation.html#temp"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-comment">-- | &#19982;&#12360;&#12425;&#12428;&#12383;&#26368;&#19979;&#23652;&#29987;&#26989;&#20998;&#39006;&#12434;&#21033;&#29992;&#12375;&#12390;,&#29987;&#26989;&#26684;&#20184;&#12434;&#22475;&#12417;&#12427;</span><span>
</span><a name="line-612"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-613"></a><a name="f%7523%696D%683C%4ED8%88DC%5B8C"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476053"><a href="#local-6989586621679476053"><span class="hs-identifier">ind</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#generalCNC"><span class="hs-identifier hs-var">generalCNC</span></a><span>
</span><a name="line-614"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476054"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#Large"><span class="hs-identifier hs-var">Large</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VTable.Compliation.html#oemp"><span class="hs-identifier hs-var">oemp</span></a><span> </span><a href="VTable.Compliation.html#memp"><span class="hs-identifier hs-var">memp</span></a><span> </span><a href="VTable.Compliation.html#semp"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="VTable.Compliation.html#temp"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-615"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476054"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#Business"><span class="hs-identifier hs-var">Business</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476056"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="VTable.Compliation.html#oemp"><span class="hs-identifier hs-var">oemp</span></a><span> </span><a href="VTable.Compliation.html#memp"><span class="hs-identifier hs-var">memp</span></a><span> </span><a href="VTable.Compliation.html#semp"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="VTable.Compliation.html#temp"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-616"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476054"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#OF"><span class="hs-identifier hs-var">OF</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476056"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="VTable.Compliation.html#memp"><span class="hs-identifier hs-var">memp</span></a><span> </span><a href="VTable.Compliation.html#semp"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="VTable.Compliation.html#temp"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-617"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476054"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#Middle"><span class="hs-identifier hs-var">Middle</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476056"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679476057"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="VTable.Compliation.html#semp"><span class="hs-identifier hs-var">semp</span></a><span> </span><a href="VTable.Compliation.html#temp"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-618"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476054"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#Small"><span class="hs-identifier hs-var">Small</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476056"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679476057"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679476058"><span class="hs-identifier hs-var">m</span></a><span>    </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="VTable.Compliation.html#temp"><span class="hs-identifier hs-var">temp</span></a><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-619"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476054"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#TF"><span class="hs-identifier hs-var">TF</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476056"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679476057"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679476058"><span class="hs-identifier hs-var">m</span></a><span>    </span><a href="#local-6989586621679476059"><span class="hs-identifier hs-var">s</span></a><span>    </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span>  </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span>
</span><a name="line-620"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476054"><span class="hs-identifier hs-var">indStratum</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#Detail"><span class="hs-identifier hs-var">Detail</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476056"><span class="hs-identifier hs-var">l</span></a><span>   </span><a href="#local-6989586621679476057"><span class="hs-identifier hs-var">o</span></a><span>    </span><a href="#local-6989586621679476058"><span class="hs-identifier hs-var">m</span></a><span>    </span><a href="#local-6989586621679476059"><span class="hs-identifier hs-var">s</span></a><span>    </span><a href="#local-6989586621679476060"><span class="hs-identifier hs-var">t</span></a><span>    </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span>
</span><a name="line-621"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-622"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476054"><a href="#local-6989586621679476054"><span class="hs-identifier">indStratum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Classification.html#whichStratum"><span class="hs-identifier hs-var">whichStratum</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Stratum"><span class="hs-identifier hs-type">Stratum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>
</span><a name="line-625"></a><span>    </span><a name="local-6989586621679476055"><a href="#local-6989586621679476055"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476061"><a href="#local-6989586621679476061"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476062"><a href="#local-6989586621679476062"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Data.Classification.html#elevateStratum"><span class="hs-identifier hs-var">elevateStratum</span></a><span> </span><a href="#local-6989586621679476061"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476062"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-626"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476063"><a href="#local-6989586621679476063"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476063"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-627"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476055"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="VTable.Compliation.html#demp"><span class="hs-identifier hs-var">demp</span></a><span> </span><a href="#local-6989586621679476062"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476056"><a href="#local-6989586621679476056"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476055"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VTable.Data.Classification.html#Large"><span class="hs-identifier hs-var">Large</span></a><span>
</span><a name="line-630"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476057"><a href="#local-6989586621679476057"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476055"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VTable.Data.Classification.html#OF"><span class="hs-identifier hs-var">OF</span></a><span>
</span><a name="line-631"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476058"><a href="#local-6989586621679476058"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476055"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VTable.Data.Classification.html#Middle"><span class="hs-identifier hs-var">Middle</span></a><span>
</span><a name="line-632"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476059"><a href="#local-6989586621679476059"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476055"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VTable.Data.Classification.html#Small"><span class="hs-identifier hs-var">Small</span></a><span>
</span><a name="line-633"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476060"><a href="#local-6989586621679476060"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476055"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679476053"><span class="hs-identifier hs-var">ind</span></a><span> </span><a href="VTable.Data.Classification.html#TF"><span class="hs-identifier hs-var">TF</span></a><span>
</span><a name="line-634"></a><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-comment">-- | &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#20869;&#26368;&#22823;&#12398;&#38917;&#30446;&#12398;&#29987;&#26989;&#20998;&#39006;&#12434;&#21462;&#24471;</span><span>
</span><a name="line-637"></a><span class="hs-comment">--</span><span>
</span><a name="line-638"></a><span class="hs-comment">--   &#29987;&#26989;&#20998;&#39006;&#12395;&#35598;&#12398;&#12418;&#12398;&#12364;&#28151;&#12374;&#12387;&#12390;&#12356;&#12383;&#12425;&#12371;&#12371;&#12391;&#38500;&#21435;&#12377;&#12427;</span><span>
</span><a name="line-639"></a><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-642"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-643"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span>
</span><a name="line-644"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span>
</span><a name="line-645"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-646"></a><a name="f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><a href="VTable.Compliation.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%51E6%7406"><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476064"><a href="#local-6989586621679476064"><span class="hs-identifier">xs</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><a name="local-6989586621679476065"><a href="#local-6989586621679476065"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476066"><a href="#local-6989586621679476066"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476064"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679476065"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476066"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-647"></a><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span><span> </span><a name="local-6989586621679476067"><a href="#local-6989586621679476067"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476068"><a href="#local-6989586621679476068"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679476069"><a href="#local-6989586621679476069"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476070"><a href="#local-6989586621679476070"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476071"><a href="#local-6989586621679476071"><span class="hs-identifier">csSafe</span></a></a><span>
</span><a name="line-648"></a><span>                                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476072"><a href="#local-6989586621679476072"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#notSuiteCarName"><span class="hs-identifier hs-var">notSuiteCarName</span></a><span class="hs-operator hs-var">.</span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476072"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476072"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679476072"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476068"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-649"></a><span>                                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476073"><a href="#local-6989586621679476073"><span class="hs-identifier">looped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%524D%6BB5%968E%58F2%4E0A%533A%5206%5185%51E6%7406"><span class="hs-identifier hs-var">f&#21069;&#27573;&#38542;&#22770;&#19978;&#21306;&#20998;&#20869;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476067"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679476068"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-650"></a><span>                                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679476073"><span class="hs-identifier hs-var">looped</span></a><span>  </span><span class="hs-keyword">of</span><span>
</span><a name="line-651"></a><span>                                                    </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="VTable.Compliation.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476067"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679476069"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476070"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-652"></a><span>                                                    </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.head</span><span> </span><a href="#local-6989586621679476073"><span class="hs-identifier hs-var">looped</span></a><span>
</span><a name="line-653"></a><span>                                                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="VTable.Compliation.html#f%6700%4E0B%5C64%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#26368;&#19979;&#23652;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476067"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679476068"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679476069"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476070"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span class="hs-comment">-- | &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#32368;&#12426;&#36820;&#12375;&#37096;&#20998;</span><span>
</span><a name="line-656"></a><span class="hs-comment">--</span><span>
</span><a name="line-657"></a><span class="hs-comment">--   &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12395;&#12399;&#26368;&#19979;&#23652;&#20197;&#22806;&#12399;&#12394;&#12356;</span><span>
</span><a name="line-658"></a><span class="hs-comment">--</span><span>
</span><a name="line-659"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">f&#21069;&#27573;&#38542;&#22770;&#19978;&#21306;&#20998;&#20869;&#20966;&#29702;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-660"></a><span class="hs-identifier">f&#21069;&#27573;&#38542;&#22770;&#19978;&#21306;&#20998;&#20869;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">{- ^&#20107;&#26989;&#20998;&#39006;&#12391;&#19982;&#12360;&#12425;&#12428;&#12383;,&#26368;&#22823;&#21306;&#20998; -}</span><span>
</span><a name="line-661"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-662"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span class="hs-special">]</span><span>
</span><a name="line-663"></a><a name="f%524D%6BB5%968E%58F2%4E0A%533A%5206%5185%51E6%7406"><a href="VTable.Compliation.html#f%524D%6BB5%968E%58F2%4E0A%533A%5206%5185%51E6%7406"><span class="hs-identifier">f&#21069;&#27573;&#38542;&#22770;&#19978;&#21306;&#20998;&#20869;&#20966;&#29702;</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><a name="local-6989586621679476074"><a href="#local-6989586621679476074"><span class="hs-identifier">cs</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679476074"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-664"></a><span>                                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%524D%6BB5%968E%58F2%4E0A%533A%5206%5185%51E6%7406"><span class="hs-identifier hs-var">f&#21069;&#27573;&#38542;&#22770;&#19978;&#21306;&#20998;&#20869;&#20966;&#29702;</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.toList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convToStratum"><span class="hs-identifier hs-var">convToStratum</span></a><span> </span><a href="#local-6989586621679476074"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VTable.Data.Classification.html#Business"><span class="hs-identifier hs-var">Business</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476074"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-comment">-- &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12364;&#23384;&#22312;&#12375;&#12394;&#12356;&#22580;&#21512;&#12398;&#20998;&#23696;</span><span>
</span><a name="line-665"></a><span class="hs-identifier">f&#21069;&#27573;&#38542;&#22770;&#19978;&#21306;&#20998;&#20869;&#20966;&#29702;</span><span> </span><a name="local-6989586621679476075"><a href="#local-6989586621679476075"><span class="hs-identifier">higs</span></a></a><span> </span><a name="local-6989586621679476076"><a href="#local-6989586621679476076"><span class="hs-identifier">cs</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476077"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="VTable.Data.Classification.html#OF"><span class="hs-identifier hs-var">OF</span></a><span> </span><a href="#local-6989586621679476075"><span class="hs-identifier hs-var">higs</span></a><span> </span><a href="#local-6989586621679476076"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-comment">-- &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12364;&#23384;&#22312;&#12375;&#12383;&#22580;&#21512;&#12398;&#20998;&#23696;</span><span>
</span><a name="line-666"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-667"></a><span>    </span><span class="hs-comment">-- | &#19968;&#12388;&#19978;&#12398;&#21306;&#20998;&#12364;&#23384;&#22312;&#12377;&#12427;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-668"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Classification.html#Stratum"><span class="hs-identifier hs-type">Stratum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span class="hs-special">]</span><span>
</span><a name="line-669"></a><span>    </span><a name="local-6989586621679476077"><a href="#local-6989586621679476077"><span class="hs-identifier">f</span></a></a><span> </span><a href="VTable.Data.Classification.html#Detail"><span class="hs-identifier hs-var">Detail</span></a><span> </span><a name="local-6989586621679476078"><a href="#local-6989586621679476078"><span class="hs-identifier">xs</span></a></a><span>  </span><a name="local-6989586621679476079"><a href="#local-6989586621679476079"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476080"><a href="#local-6989586621679476080"><span class="hs-identifier">tmpCs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#filtSelect"><span class="hs-identifier hs-var">filtSelect</span></a><span> </span><a href="#local-6989586621679476078"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679476079"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">L.null</span><span> </span><a href="#local-6989586621679476080"><span class="hs-identifier hs-var">tmpCs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-670"></a><span>                        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476078"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-671"></a><span>                        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#vmaximumNamesWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNamesWithoutErr</span></a><span> </span><a href="#local-6989586621679476080"><span class="hs-identifier hs-var">tmpCs</span></a><span>
</span><a name="line-672"></a><span>
</span><a name="line-673"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476081"><a href="#local-6989586621679476081"><span class="hs-identifier">st</span></a></a><span>     </span><a name="local-6989586621679476082"><a href="#local-6989586621679476082"><span class="hs-identifier">xs</span></a></a><span>  </span><a name="local-6989586621679476083"><a href="#local-6989586621679476083"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476084"><a href="#local-6989586621679476084"><span class="hs-identifier">tmpCs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#filtSelect"><span class="hs-identifier hs-var">filtSelect</span></a><span> </span><a href="#local-6989586621679476082"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convToStratum"><span class="hs-identifier hs-var">convToStratum</span></a><span> </span><a href="#local-6989586621679476083"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679476081"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">L.null</span><span> </span><a href="#local-6989586621679476084"><span class="hs-identifier hs-var">tmpCs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-674"></a><span>                        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476082"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-675"></a><span>                        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476077"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Maybe.fromJust</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="VTable.Data.Classification.html#downStratum"><span class="hs-identifier hs-var">VDC.downStratum</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476081"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#vmaximumNamesWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNamesWithoutErr</span></a><span> </span><a href="#local-6989586621679476084"><span class="hs-identifier hs-var">tmpCs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476083"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span class="hs-comment">--  | &#19982;&#12360;&#12425;&#12428;&#12383;Stratum&#12395;Cars&#12434;&#22793;&#25563;&#32113;&#21512;&#12377;&#12427;</span><span>
</span><a name="line-678"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">convToStratum</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-679"></a><span class="hs-identifier">convToStratum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Stratum"><span class="hs-identifier hs-type">Stratum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-680"></a><a name="convToStratum"><a href="VTable.Compliation.html#convToStratum"><span class="hs-identifier">convToStratum</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476085"><a href="#local-6989586621679476085"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476086"><a href="#local-6989586621679476086"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span>
</span><a name="line-681"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier hs-var">Maybe.fromJust</span><span>
</span><a name="line-682"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-identifier hs-var">Maybe.isJust</span><span>
</span><a name="line-683"></a><span>                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476087"><span class="hs-identifier hs-var">elevateStratumOfCar</span></a><span> </span><a href="#local-6989586621679476086"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476085"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-684"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-685"></a><span>    </span><span class="hs-identifier">elevateStratumOfCar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Classification.html#Stratum"><span class="hs-identifier hs-type">Stratum</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-686"></a><span>    </span><a name="local-6989586621679476087"><a href="#local-6989586621679476087"><span class="hs-identifier">elevateStratumOfCar</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476088"><a href="#local-6989586621679476088"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476089"><a href="#local-6989586621679476089"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#elevateStratum"><span class="hs-identifier hs-var">elevateStratum</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476089"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476088"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-687"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476090"><a href="#local-6989586621679476090"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476089"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476090"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-comment">-- |  &#25351;&#23450;&#12373;&#12428;&#12383;&#29987;&#26989;&#20998;&#39006;&#12398;&#19979;&#20301;&#20998;&#39006;&#12384;&#12369;&#12391;filter&#12434;&#12363;&#12369;&#12427;</span><span>
</span><a name="line-691"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">filtSelect</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-692"></a><span class="hs-identifier">filtSelect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Higher"><span class="hs-identifier hs-type">Higher</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-693"></a><a name="filtSelect"><a href="VTable.Compliation.html#filtSelect"><span class="hs-identifier">filtSelect</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476091"><a href="#local-6989586621679476091"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476092"><a href="#local-6989586621679476092"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476093"><a href="#local-6989586621679476093"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476094"><a href="#local-6989586621679476094"><span class="hs-identifier">hig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476095"><a href="#local-6989586621679476095"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#isMemberOf"><span class="hs-identifier hs-var">isMemberOf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476095"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476094"><span class="hs-identifier hs-var">hig</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476095"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679476094"><span class="hs-identifier hs-var">hig</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476092"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-694"></a><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">V.concat</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><a href="#local-6989586621679476093"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476091"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span class="hs-comment">-- | &#26368;&#19979;&#23652;&#12395;&#34892;&#12387;&#12390;&#12418;,&#37325;&#35079;&#12364;&#12354;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-698"></a><span class="hs-identifier">f&#26368;&#19979;&#23652;&#26684;&#20184;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4F01%696D"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20225;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%524D%683C%4ED8_%4E8B%696D%6240"><span class="hs-identifier hs-type">Val&#20107;&#21069;&#26684;&#20184;_&#20107;&#26989;&#25152;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-699"></a><a name="f%6700%4E0B%5C64%683C%4ED8%51E6%7406"><a href="VTable.Compliation.html#f%6700%4E0B%5C64%683C%4ED8%51E6%7406"><span class="hs-identifier">f&#26368;&#19979;&#23652;&#26684;&#20184;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476096"><a href="#local-6989586621679476096"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679476097"><a href="#local-6989586621679476097"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679476098"><a href="#local-6989586621679476098"><span class="hs-identifier">en</span></a></a><span> </span><a name="local-6989586621679476099"><a href="#local-6989586621679476099"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.null</span><span>   </span><a href="#local-6989586621679476096"><span class="hs-identifier hs-var">xs</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#generalCNC"><span class="hs-identifier hs-var">generalCNC</span></a><span>
</span><a name="line-700"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679476096"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8%88DC%5B8C"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;&#35036;&#23436;</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.head</span><span> </span><a href="#local-6989586621679476096"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-701"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679476096"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%4E8B%524D%683C%4ED8%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#21069;&#26684;&#20184;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476096"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679476098"><span class="hs-identifier hs-var">en</span></a><span> </span><a href="#local-6989586621679476099"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-702"></a><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-705"></a><span class="hs-comment">-- ** &#29305;&#27530;&#12394;&#26041;&#27861;</span><span>
</span><a name="line-706"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-707"></a><span class="hs-comment">{- | &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12395;&#24540;&#12376;&#12390;&#20197;&#19979;&#12398;&#20491;&#21029;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;

     * &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#21450;&#12403;&#65292;&#26684;&#20184;&#12369;&#19981;&#33021;&#12418;&#12381;&#12428;&#12382;&#12428;&#12398;&#20966;&#29702;&#12391;&#34892;&#12358;&#65294;

     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12391;&#12399;&#65292;
     &#12418;&#12387;&#12401;&#12425;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#12381;&#12398;&#20869;&#23481;&#12395;&#38306;&#12375;&#12390;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#65292;&#35036;&#21161;&#30340;&#26989;&#21209;&#65292;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12363;&#12425;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;

     &#24403;&#35442;&#35519;&#26619;&#38917;&#30446;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#65292;
     &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#29987;&#26989;&#21306;&#20998;&#12392;&#26368;&#12418;&#36817;&#12356;&#21306;&#20998;&#12398;&#12300;&#20027;&#12392;&#12375;&#12390;&#31649;&#29702;&#20107;&#21209;&#12434;&#34892;&#12358;&#26412;&#31038;&#31561;&#12301;&#65292;
    &#12300;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12375;&#65292;
     &#21452;&#26041;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152; &#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#12301;&#12392;&#12377;&#12427;&#65294;

     &#12414;&#12383;&#65292;&#29305;&#27530;&#12394;&#26041;&#27861;&#21450;&#12403;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#32080;&#26524;&#65292;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12395;&#21306;&#20998;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12395;&#12362;&#12356;&#12390;&#65292;
     &#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#65292;&#26368;&#12418;&#36817;&#12356;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;

     &#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#20197;&#22806;&#12391;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;


    * &#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#25201;&#12356;

    &#12300;&#9675;&#9675; &#20869;&#26684;&#20184;&#19981;&#33021;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#12381;&#12398;&#23646;&#12377;&#12427;&#29987;&#26989;&#20998;&#39006;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#65292;
    &#20182;&#12398;&#20107;&#26989;&#25152;&#12398;&#24179;&#22343;&#30340;&#12394;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#22770;&#19978;&#39640;&#12391;&#65292;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12398;&#24403;&#35442;&#38917;&#30446;&#12398;&#38989;&#12434;&#25353;&#20998;&#12377;&#12427;&#65294;

    f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#20840;&#33324; &#12391;&#12399;&#65292;&#20491;&#21029;&#12398;&#20966;&#29702;&#12434;&#12377;&#12409;&#12390;&#32113;&#21512;&#12377;&#12427;&#65294;
    &#21508;&#35519;&#26619;&#31080;&#65292;&#29987;&#26989;&#12398;&#20966;&#29702;&#12399;&#20491;&#21029;&#12398;&#38306;&#25968; f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12295;&#12295;&#29987;&#26989; &#12434;&#35519;&#25972;&#12377;&#12427;&#12371;&#12392;&#65294;

-}</span><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span>
</span><a name="line-736"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-737"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5%51E6%7406"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5%51E6%7406"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476100"><a href="#local-6989586621679476100"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476101"><a href="#local-6989586621679476101"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-738"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%8FB2%6797%6F01%696D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#36786;&#26519;&#28417;&#26989;</span></a><span>     </span><a href="#local-6989586621679476100"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-739"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%9271%696D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#37489;&#26989;</span></a><span>         </span><a href="#local-6989586621679476100"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-740"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%88FD%9020%696D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#35069;&#36896;&#26989;</span></a><span>       </span><a href="#local-6989586621679476100"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-741"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5546%696D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21830;&#26989;</span></a><span>         </span><a href="#local-6989586621679476100"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-742"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%533B%7642%798F%7949"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21307;&#30274;&#31119;&#31049;</span></a><span>          </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-743"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%30B5B"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12469;B</span></a><span>          </span><a href="#local-6989586621679476100"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-744"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5354%540C%7D44%5408"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21332;&#21516;&#32068;&#21512;</span></a><span>          </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-745"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5EFA%30B5A"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A</span></a><span>        </span><a href="#local-6989586621679476100"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-746"></a><span>    </span><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%305D%306E%4ED6"><span class="hs-identifier hs-var">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12381;&#12398;&#20182;</span></a><span>       </span><a href="#local-6989586621679476100"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476101"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-747"></a><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-750"></a><span class="hs-comment">-- *** &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12395;&#23550;&#24540;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-751"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-752"></a><span>
</span><a name="line-753"></a><span class="hs-comment">-- | &#21830;&#26989;&#12363;&#21542;&#12363;</span><span>
</span><a name="line-754"></a><span class="hs-keyword">type</span><span> </span><a name="IsCommerce"><a href="VTable.Compliation.html#IsCommerce"><span class="hs-identifier">IsCommerce</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span class="hs-comment">{- | E&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209; &#12395;&#24540;&#12376;&#12390;&#65292;&#23550;&#24540;&#12377;&#12427;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#32048;&#12363;&#12356;&#20998;&#39006;&#12434;&#36820;&#12377;&#38306;&#25968;&#12434;&#20316;&#25104;&#12377;&#12427;&#38306;&#25968;

    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12391;&#12399;&#65292;
    &#12418;&#12387;&#12401;&#12425;&#12300;&#31649;&#29702;&#12539;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#12381;&#12398;&#20869;&#23481;&#12395;&#38306;&#12375;&#12390;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#65292;&#35036;&#21161;&#30340;&#26989;&#21209;&#65292;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12363;&#12425;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;
    &#24403;&#35442;&#35519;&#26619;&#38917;&#30446;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#31649;&#29702;&#36939;&#21942;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#65292;
    &#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#29987;&#26989;&#21306;&#20998;&#12392;&#26368;&#12418;&#36817;&#12356;&#21306;&#20998;&#12398;&#12300;&#20027;&#12392;&#12375;&#12390;&#31649;&#29702;&#20107;&#21209;&#12434;&#34892;&#12358;&#26412;&#31038;&#31561;&#12301;&#65292;
    &#12300;&#35036;&#21161;&#30340;&#26989;&#21209;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;
    &#12414;&#12383;&#65292;&#29305;&#27530;&#12394;&#26041;&#27861;&#21450;&#12403;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12398;&#32080;&#26524;&#65292;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12395;&#21306;&#20998;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#65292;
    &#26368;&#12418;&#36817;&#12356;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;
    &#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#20197;&#22806;&#12391;&#12300;&#33258;&#23478;&#29992;&#20489;&#24235;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#65294;


    * &#20027;&#12392;&#12375;&#12390;&#31649;&#29702;&#20107;&#21209;&#12434;&#34892;&#12358;&#26412;&#31038;&#31561;

        &gt; &#19979;&#20108;&#26689;&#12364;00
        &gt; &#38750;&#21942;&#21033;&#22243;&#20307;&#12395;&#12399;&#23384;&#22312;&#12375;&#12394;&#12356;

    * &#12381;&#12398;&#20182;&#12398;&#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152;

        &gt; &#19979;&#20108;&#26689;&#12364;09
        &gt; &#12383;&#12384;&#12375;&#65292;&#21830;&#26989;&#12398;&#12415;08

    * &#31649;&#29702;&#65292;&#35036;&#21161;&#30340;&#32076;&#28168;&#27963;&#21205;&#12434;&#34892;&#12358;&#20107;&#26989;&#25152; &#20869;&#26684;&#20184;&#19981;&#33021;

        &gt; &#19979;&#65298;&#26689;&#12364;0Z
        &gt; &#12383;&#12384;&#12375;&#65292;&#12371;&#12428;&#12395;&#20998;&#39006;&#12373;&#12428;&#12427;&#26465;&#20214;&#12364;&#19981;&#26126;&#12394;&#12383;&#12417;&#20351;&#29992;&#12375;&#12394;&#12356;
        &gt; 0609
        &gt; 0709
        &gt; 0809
        &gt; 7109
        &gt; 7209
        &gt; 7409
        &gt; 7809
        &gt; 784Z
        &gt; 801Z
        &gt; 8609
        &gt; 8909
        &gt; 9400
        &gt; 9509 &#12394;&#12393;&#23384;&#22312;&#12375;&#12394;&#12356;&#38917;&#30446;&#12418;&#25201;&#12356;&#12364;&#19981;&#26126;&#12394;&#12383;&#12417;,&#27231;&#26800;&#30340;&#12395;&#20998;&#39006;&#12434;&#36861;&#21152;&#12375;&#12390;&#20966;&#29702;&#12434;&#34892;&#12387;&#12383;

    * &#33258;&#23478;&#29992;&#20489;&#24235;

        &gt; &#19979;&#65298;&#26689;&#12364;08

    * &#29987;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#22580;&#21512;

        &gt; &#29987;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#12399;&#19979;&#65298;&#26689;&#12364;ZZ
        &gt; &#26684;&#20184;&#19981;&#33021;&#12399;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#12414;&#12414;&#20966;&#29702;&#12377;&#12427;&#65288;&#23455;&#38555;&#12395;&#12393;&#12398;&#12424;&#12358;&#12395;&#12375;&#12390;&#12356;&#12427;&#12398;&#12363;&#35519;&#12409;&#12427;&#24517;&#35201;&#12354;&#12426;&#65289;
        &gt; 784Z &#24656;&#12425;&#12367;&#20844;&#34886;&#28020;&#22580;&#26684;&#20184;&#12369;&#19981;&#33021; &#21450;&#12403; 801Z &#26144;&#30011;&#39208;&#26684;&#20184;&#12369;&#19981;&#33021;(?)&#12398;2&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;&#36861;&#21152;&#12375;&#20844;&#34886;&#28020;&#22580;&#21450;&#12403;&#26144;&#30011;&#39208;&#12392;&#12375;&#12390;&#25201;&#12358;

    ZZ &#12392; Z0&#31561;&#26411;&#23614;&#12364;&#32113;&#19968;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12398;&#12391;&#27880;&#24847;(&#35201;&#20462;&#27491;)
-}</span><span>
</span><a name="line-808"></a><span>
</span><a name="line-809"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">makeManagementClass</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-810"></a><span class="hs-identifier">makeManagementClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-811"></a><a name="makeManagementClass"><a href="VTable.Compliation.html#makeManagementClass"><span class="hs-identifier">makeManagementClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476103"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-812"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-813"></a><span>
</span><a name="line-814"></a><span>    </span><span class="hs-comment">-- | &#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#23550;&#31574;</span><span>
</span><a name="line-815"></a><span>    </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-816"></a><span>    </span><a name="local-6989586621679476102"><a href="#local-6989586621679476102"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679476104"><a href="#local-6989586621679476104"><span class="hs-identifier">tx1</span></a></a><span> </span><a name="local-6989586621679476105"><a href="#local-6989586621679476105"><span class="hs-identifier">tx2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">T.drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679476104"><span class="hs-identifier hs-var">tx1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;Z0&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">T.drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679476104"><span class="hs-identifier hs-var">tx1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;ZZ&quot;</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-817"></a><span>                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679476104"><span class="hs-identifier hs-var">tx1</span></a><span>
</span><a name="line-818"></a><span>                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">T.append</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679476104"><span class="hs-identifier hs-var">tx1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476105"><span class="hs-identifier hs-var">tx2</span></a><span>
</span><a name="line-819"></a><span>
</span><a name="line-820"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-821"></a><span>    </span><a name="local-6989586621679476103"><a href="#local-6989586621679476103"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                               </span><a name="local-6989586621679476106"><a href="#local-6989586621679476106"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476106"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-822"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VTable.Data.Structure.html#E%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">E&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span class="hs-special">)</span><span>   </span><a name="local-6989586621679476107"><a href="#local-6989586621679476107"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679476107"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;93&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476107"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-823"></a><span>                                                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476102"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476107"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;00&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-824"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VTable.Data.Structure.html#E%81EA%5BB6%7528%5009%5EAB"><span class="hs-identifier hs-var">E&#33258;&#23478;&#29992;&#20489;&#24235;</span></a><span>    </span><span class="hs-special">)</span><span>   </span><a name="local-6989586621679476108"><a href="#local-6989586621679476108"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476102"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476108"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;08&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VTable.Data.Structure.html#E%81EA%5BB6%7528%5009%5EAB"><span class="hs-identifier hs-var">E&#33258;&#23478;&#29992;&#20489;&#24235;</span></a><span>    </span><span class="hs-special">)</span><span>   </span><a name="local-6989586621679476109"><a href="#local-6989586621679476109"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476102"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476109"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;09&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-826"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">V&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><a href="VTable.Data.Structure.html#E%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">E&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>    </span><span class="hs-special">)</span><span>   </span><a name="local-6989586621679476110"><a href="#local-6989586621679476110"><span class="hs-identifier">tx</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476102"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476110"><span class="hs-identifier hs-var">tx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;09&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-827"></a><span>
</span><a name="line-828"></a><span>
</span><a name="line-829"></a><span>
</span><a name="line-830"></a><span class="hs-comment">-- | H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640; &#12398;Cars &#12434; &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12395;&#22793;&#25563;&#12377;&#12427;</span><span>
</span><a name="line-831"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">convMCinCars</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-832"></a><span class="hs-identifier">convMCinCars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-833"></a><a name="convMCinCars"><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier">convMCinCars</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679476111"><a href="#local-6989586621679476111"><span class="hs-identifier">bl</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679476112"><a href="#local-6989586621679476112"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679476113"><a href="#local-6989586621679476113"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476116"><span class="hs-identifier hs-var">merge</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476114"><span class="hs-identifier hs-var">converted</span></a><span class="hs-special">)</span><span>
</span><a name="line-834"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-835"></a><span>    </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476114"><a href="#local-6989586621679476114"><span class="hs-identifier">converted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476117"><a href="#local-6989586621679476117"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679476118"><a href="#local-6989586621679476118"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476117"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679476117"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#makeManagementClass"><span class="hs-identifier hs-var">makeManagementClass</span></a><span> </span><a href="#local-6989586621679476111"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621679476112"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679476118"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476113"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-836"></a><span>
</span><a name="line-837"></a><span>    </span><span class="hs-identifier">part</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">)</span><span>
</span><a name="line-838"></a><span>    </span><a name="local-6989586621679476115"><a href="#local-6989586621679476115"><span class="hs-identifier">part</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679476119"><a href="#local-6989586621679476119"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span>   </span><a href="#local-6989586621679476119"><span class="hs-identifier hs-var">cs</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-839"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-6989586621679476119"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476119"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-840"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476124"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476123"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-842"></a><span>        </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476120"><a href="#local-6989586621679476120"><span class="hs-identifier">hd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.head</span><span> </span><a href="#local-6989586621679476119"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-843"></a><span>        </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476121"><a href="#local-6989586621679476121"><span class="hs-identifier">hdName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476120"><span class="hs-identifier hs-var">hd</span></a><span>
</span><a name="line-844"></a><span>        </span><span class="hs-special">(</span><span class="hs-glyph">~</span><a name="local-6989586621679476122"><a href="#local-6989586621679476122"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span class="hs-glyph">~</span><a name="local-6989586621679476123"><a href="#local-6989586621679476123"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.partition</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476125"><a href="#local-6989586621679476125"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476125"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679476121"><span class="hs-identifier hs-var">hdName</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476119"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-845"></a><span>        </span><span class="hs-glyph">~</span><a name="local-6989586621679476124"><a href="#local-6989586621679476124"><span class="hs-identifier">l2</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476122"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476121"><span class="hs-identifier hs-var">hdName</span></a><span>
</span><a name="line-846"></a><span>
</span><a name="line-847"></a><span>    </span><span class="hs-identifier">merge</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-848"></a><span>    </span><a name="local-6989586621679476116"><a href="#local-6989586621679476116"><span class="hs-identifier">merge</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679476126"><a href="#local-6989586621679476126"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span class="hs-glyph">!</span><a name="local-6989586621679476127"><a href="#local-6989586621679476127"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679476127"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476126"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-849"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679476128"><a href="#local-6989586621679476128"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span class="hs-glyph">!</span><a name="local-6989586621679476129"><a href="#local-6989586621679476129"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476115"><span class="hs-identifier hs-var">part</span></a><span> </span><a href="#local-6989586621679476127"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-850"></a><span>                                 </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679476116"><span class="hs-identifier hs-var">merge</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476126"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476128"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476129"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-851"></a><span>
</span><a name="line-852"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-853"></a><span class="hs-comment">-- *** &#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-854"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-855"></a><span class="hs-comment">-- | &#26684;&#20184;&#12369;&#19981;&#33021;&#12394;&#20998;&#39006;&#21517; CNC : CanNotClassify</span><span>
</span><a name="line-856"></a><span class="hs-keyword">type</span><span> </span><a name="CNCName"><a href="VTable.Compliation.html#CNCName"><span class="hs-identifier">CNCName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span>
</span><a name="line-859"></a><span class="hs-comment">--- *** &#36786;&#26519;&#28417;&#26989;</span><span>
</span><a name="line-860"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-861"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#36786;&#26519;&#28417;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-862"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%8FB2%6797%6F01%696D"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%8FB2%6797%6F01%696D"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#36786;&#26519;&#28417;&#26989;</span></a></a><span> </span><a name="local-6989586621679476130"><a href="#local-6989586621679476130"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476131"><a href="#local-6989586621679476131"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-863"></a><span>    </span><a name="local-6989586621679476140"><a href="#local-6989586621679476140"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476131"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-864"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476140"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-865"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476141"><a href="#local-6989586621679476141"><span class="hs-identifier">x</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476141"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%8FB2%6797%6F01%696D"><span class="hs-identifier hs-var">E&#36786;&#26519;&#28417;&#26989;</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476132"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476130"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476131"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-866"></a><span>                                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-867"></a><span>        </span><span class="hs-identifier">_</span><span>                                                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-870"></a><span>    </span><span class="hs-comment">-- &#36786;&#26519;&#27700;&#29987;&#26989;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-871"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-872"></a><span>    </span><a name="local-6989586621679476132"><a href="#local-6989586621679476132"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679476133"><a href="#local-6989586621679476133"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476134"><a href="#local-6989586621679476134"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-873"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476135"><a href="#local-6989586621679476135"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476134"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-874"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476136"><a href="#local-6989586621679476136"><span class="hs-identifier">comm</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476134"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-875"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476137"><a href="#local-6989586621679476137"><span class="hs-identifier">front</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476134"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-876"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476138"><a href="#local-6989586621679476138"><span class="hs-identifier">prod</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476134"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%751F%7523_%8FB2%6797%6F01%696D_%91D1%984D"><span class="hs-identifier hs-var">H&#29983;&#29987;_&#36786;&#26519;&#28417;&#26989;_&#37329;&#38989;</span></a><span>
</span><a name="line-877"></a><span>
</span><a name="line-878"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476139"><a href="#local-6989586621679476139"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#getValCarsFromV%8FB2%6797%6F01%696D"><span class="hs-identifier hs-var">getValCarsFromV&#36786;&#26519;&#28417;&#26989;</span></a><span> </span><a href="#local-6989586621679476135"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476138"><span class="hs-identifier hs-var">prod</span></a><span>
</span><a name="line-879"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476131"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476136"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476139"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476137"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T1&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-880"></a><span>
</span><a name="line-881"></a><span>
</span><a name="line-882"></a><span class="hs-comment">-- | &#21336;&#32020;&#12395;&#29983;&#29987;_&#36786;&#26519;&#28417;&#26989;_&#37329;&#38989;&#12398;&#38917;&#30446;&#12434;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12395;&#25391;&#12426;&#20998;&#12369;&#12427;</span><span>
</span><a name="line-883"></a><span class="hs-identifier">getValCarsFromV&#36786;&#26519;&#28417;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%751F%7523_%8FB2%6797%6F01%696D_%91D1%984D"><span class="hs-identifier hs-type">Val&#29983;&#29987;_&#36786;&#26519;&#28417;&#26989;_&#37329;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-884"></a><a name="getValCarsFromV%8FB2%6797%6F01%696D"><a href="VTable.Compliation.html#getValCarsFromV%8FB2%6797%6F01%696D"><span class="hs-identifier">getValCarsFromV&#36786;&#26519;&#28417;&#26989;</span></a></a><span> </span><a name="local-6989586621679476142"><a href="#local-6989586621679476142"><span class="hs-identifier">man</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-885"></a><span class="hs-identifier">getValCarsFromV&#36786;&#26519;&#28417;&#26989;</span><span> </span><a name="local-6989586621679476143"><a href="#local-6989586621679476143"><span class="hs-identifier">man</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476144"><a href="#local-6989586621679476144"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-886"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679476143"><span class="hs-identifier hs-var">man</span></a><span> </span><span class="hs-comment">{-  &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#20966;&#29702; -}</span><span>
</span><a name="line-887"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476144"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-888"></a><span>
</span><a name="line-889"></a><span>
</span><a name="line-890"></a><span class="hs-comment">-- *** &#37489;&#26989;</span><span>
</span><a name="line-891"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-892"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#37489;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-893"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%9271%696D"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%9271%696D"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#37489;&#26989;</span></a></a><span> </span><a name="local-6989586621679476145"><a href="#local-6989586621679476145"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476146"><a href="#local-6989586621679476146"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-894"></a><span>    </span><a name="local-6989586621679476155"><a href="#local-6989586621679476155"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476146"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-895"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476155"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-896"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476156"><a href="#local-6989586621679476156"><span class="hs-identifier">x</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476156"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%9271%696D"><span class="hs-identifier hs-var">E&#37489;&#26989;</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476147"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476145"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476146"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-897"></a><span>                                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-898"></a><span>        </span><span class="hs-identifier">_</span><span>                                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-901"></a><span>    </span><span class="hs-comment">-- &#37489;&#26989;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-902"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-903"></a><span>    </span><a name="local-6989586621679476147"><a href="#local-6989586621679476147"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679476148"><a href="#local-6989586621679476148"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476149"><a href="#local-6989586621679476149"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-904"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476150"><a href="#local-6989586621679476150"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476149"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-905"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476151"><a href="#local-6989586621679476151"><span class="hs-identifier">comm</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476149"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-906"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476152"><a href="#local-6989586621679476152"><span class="hs-identifier">front</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476149"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-907"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476153"><a href="#local-6989586621679476153"><span class="hs-identifier">prod</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476149"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%751F%7523_%9271%696D_%91D1%984D"><span class="hs-identifier hs-var">H&#29983;&#29987;_&#37489;&#26989;_&#37329;&#38989;</span></a><span>
</span><a name="line-908"></a><span>
</span><a name="line-909"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476154"><a href="#local-6989586621679476154"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#getValCarsFromV%9271%696D"><span class="hs-identifier hs-var">getValCarsFromV&#37489;&#26989;</span></a><span> </span><a href="#local-6989586621679476150"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476153"><span class="hs-identifier hs-var">prod</span></a><span>
</span><a name="line-910"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476149"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476151"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476154"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476152"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T2&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-911"></a><span>
</span><a name="line-912"></a><span>
</span><a name="line-913"></a><span class="hs-comment">-- | &#21336;&#32020;&#12395;&#29983;&#29987;_&#37489;&#26989;_&#37329;&#38989;&#12398;&#38917;&#30446;&#12434;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12395;&#25391;&#12426;&#20998;&#12369;&#12427;</span><span>
</span><a name="line-914"></a><span class="hs-identifier">getValCarsFromV&#37489;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%751F%7523_%9271%696D_%91D1%984D"><span class="hs-identifier hs-type">Val&#29983;&#29987;_&#37489;&#26989;_&#37329;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-915"></a><a name="getValCarsFromV%9271%696D"><a href="VTable.Compliation.html#getValCarsFromV%9271%696D"><span class="hs-identifier">getValCarsFromV&#37489;&#26989;</span></a></a><span> </span><a name="local-6989586621679476157"><a href="#local-6989586621679476157"><span class="hs-identifier">man</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-916"></a><span class="hs-identifier">getValCarsFromV&#37489;&#26989;</span><span> </span><a name="local-6989586621679476158"><a href="#local-6989586621679476158"><span class="hs-identifier">man</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476159"><a href="#local-6989586621679476159"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-917"></a><span>                                   </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679476158"><span class="hs-identifier hs-var">man</span></a><span> </span><span class="hs-comment">{-  &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#20966;&#29702; -}</span><span>
</span><a name="line-918"></a><span>                                   </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476159"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span>
</span><a name="line-921"></a><span class="hs-comment">-- *** &#35069;&#36896;&#26989;</span><span>
</span><a name="line-922"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-923"></a><span class="hs-comment">{- |
    &#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12398;&#24460;&#65292;&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12392;&#12398;&#23550;&#24540;&#38306;&#20418;&#12395;&#22522;&#12389;&#12365;&#21697;&#30446;&#12434;&#32232;&#32386;&#12377;&#12427;&#65294;
    &#35069;&#36896;&#26989;&#12395;&#12362;&#12369;&#12427;&#29305;&#27530;&#12394;&#26041;&#27861;&#12399;&#65292;&#12300;&#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#20998;&#39006;&#38306;&#20418;&#36039;&#26009; &#29987;&#26989;&#26684;&#20184;&#12398;&#26041;&#27861;&#12301;
    &#12395;&#12362;&#12356;&#12390;&#35299;&#35500;&#12373;&#12428;&#12390;&#12356;&#12427;&#20197;&#19979;&#12398;&#35352;&#36848;&#20197;&#22806;&#12395;&#36039;&#26009;&#12434;&#35211;&#12388;&#12369;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12394;&#12363;&#12387;&#12383;&#65294;

    &#19978;&#35352;&#12398;&#26041;&#27861;&#20197;&#22806;&#12395;&#12289;&#21407;&#26448;&#26009;&#12289;&#20316;&#26989;&#24037;&#31243;&#12289;&#27231;&#26800;&#35373;&#20633;&#31561;&#12395;&#12424;&#12426;&#12289;
    &#29987;&#26989;&#12434;&#27770;&#23450;&#12375;&#12390;&#12356;&#12427;&#12418;&#12398;&#12364;&#12354;&#12427;&#12290;&#12381;&#12398;&#29987;&#26989;&#12392;&#12399;&#12289;&#12300;&#20013;&#20998;&#39006;22 &#37444;&#37628;&#26989;&#12301;&#12395;&#23646;&#12377;&#12427;&#12300;&#39640;&#28809;&#12395;&#12424;&#12427;&#35069;&#37444;&#26989;&#12301;&#12289;
    &#12300;&#35069;&#37628;&#12539;&#35069;&#37509;&#22311;&#24310;&#26989;&#65288;&#36578;&#28809;&#12539;&#38651;&#27671;&#28809;&#12434;&#21547;&#12416;&#65289;&#12301;&#12289;&#12300;&#29105;&#38291;&#22311;&#24310;&#26989;&#12301;&#12289;&#12300;&#20919;&#38291;&#22311;&#24310;&#26989;&#12301;&#12289;&#12300;&#20919;&#38291;&#12525;&#12540;&#12523;&#25104;&#22411;&#24418;&#37628;&#35069;&#36896;&#26989;&#12301;&#12289;
    &#12300;&#37628;&#31649;&#35069;&#36896;&#26989;&#12301;&#12289;&#12300;&#20280;&#37444;&#26989;&#12301;&#12289;&#12300;&#30952;&#26834;&#37509;&#35069;&#36896;&#26989;&#12301;&#12289;&#12300;&#24341;&#25244;&#37628;&#31649;&#35069;&#36896;&#26989;&#12301;&#12289;&#12300;&#20280;&#32218;&#26989;&#12301;&#21450;&#12403;&#12300;&#12381;&#12398;&#20182;&#12398;&#35069;&#37628;&#12434;&#34892;&#12431;&#12394;&#12356;&#37628;&#26448;&#35069;&#36896;&#26989;&#12301;
    &#12398;11 &#29987;&#26989;&#12391;&#12354;&#12427;&#12290;

    &#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#12395;&#12362;&#12356;&#12390;&#12399;&#21407;&#26448;&#26009;&#65292;&#20316;&#26989;&#24037;&#31243;&#65292;&#27231;&#26800;&#35373;&#20633;&#31561;&#12434;&#29992;&#12356;&#12390;&#29987;&#26989;&#12434;&#25226;&#25569;&#12375;&#12390;&#12356;&#12427;&#12364;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#35069;&#36896;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12395;&#12399;&#12300;&#20316;&#26989;&#24037;&#31243;&#12301;&#21450;&#12403;&#12300;&#20027;&#35201;&#21407;&#26448;&#26009;&#12301;&#12364;&#23384;&#22312;&#12375;&#65292;
    &#12381;&#12428;&#12382;&#12428;&#33258;&#30001;&#35352;&#36848;&#12395;&#12390;&#12381;&#12398;&#20869;&#23481;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;&#12371;&#12428;&#12425;&#12398;&#24773;&#22577;&#12434;&#29992;&#12356;&#12390;&#65292;&#29987;&#26989;&#12398;&#25226;&#25569;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12392;&#32771;&#12360;&#12425;&#12360;&#12427;&#65294;
    &#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#12391;&#12399;&#65292;&#20363;&#12392;&#12375;&#12390;&#65292;&#24418;&#37628;&#12434;&#35069;&#36896;&#12375;&#12390;&#12356;&#12390;&#12418;&#65292;&#37444;&#37489;&#30707;&#65292;&#30707;&#28845;&#65292;&#30707;&#28784;&#30707;&#12434;&#21407;&#26448;&#26009;&#65292;&#39640;&#28809;&#12434;&#27231;&#26800;&#35373;&#20633;&#12392;&#12375;&#12390;&#12356;&#12427;&#22580;&#21512;&#65292;
    &#12300;&#39640;&#28809;&#12395;&#12424;&#12427;&#35069;&#37444;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#65292;&#37521;&#37444;&#65292;&#37444;&#23633;&#12434;&#21407;&#26448;&#26009;&#12392;&#12375;&#65292;&#36578;&#28809;&#65292;&#38651;&#27671;&#28809;&#12434;&#27231;&#26800;&#35373;&#20633;&#12392;&#12375;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;
    &#12300;&#35069;&#37628;&#12539;&#35069;&#37628;&#22311;&#24310;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12427;&#12394;&#12393;&#12398;&#20966;&#29702;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#12371;&#12398;&#12424;&#12358;&#12394;&#20998;&#39006;&#12398;&#32068;&#12415;&#21512;&#12431;&#12379;&#12434;&#20840;&#12390;&#25226;&#25569;&#12377;&#12428;&#12400;&#65292;&#12381;&#12398;&#20877;&#29694;&#12399;&#21487;&#33021;&#12391;&#12354;&#12427;&#12392;&#24605;&#12431;&#12428;&#12427;&#12364;&#65292;
    &#12381;&#12398;&#35443;&#32048;&#12364;&#19981;&#26126;&#12391;&#12354;&#12427;&#12371;&#12392;&#12363;&#12425;&#65292;&#12381;&#12428;&#12425;&#12398;&#26684;&#20184;&#12369;&#12395;&#38306;&#12375;&#12390;&#12399;&#12354;&#12427;&#31243;&#24230;&#35069;&#36896;&#21697;&#12391;&#20505;&#35036;&#12434;&#36984;&#23450;&#12375;&#65292;
    &#26696;&#20998;&#12377;&#12427;&#31561;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;&#12418;&#12398;&#12392;&#12377;&#12427;&#65294;

    &#12414;&#12383;&#65292;&#35069;&#36896;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#21103;&#29987;&#29289;&#65292;&#29305;&#12395;&#33258;&#23478;&#29983;&#29987;&#12539;&#33258;&#23478;&#28040;&#36027;&#21697;&#12395;&#12418;&#27880;&#24847;&#12364;&#24517;&#35201;&#12392;&#12373;&#12428;&#12427;&#65294;
    &#29983;&#29987;&#36942;&#31243;&#12395;&#12362;&#12369;&#12427;&#20013;&#38291;&#35069;&#21697;&#12391;&#12354;&#12426;&#65292;&#33258;&#23478;&#29983;&#29987;&#12373;&#12428;&#12383;&#12418;&#12398;&#12364;&#20840;&#12390;&#33258;&#23478;&#28040;&#36027;&#12373;&#12428;&#12427;&#36001;&#12395;&#38306;&#12375;&#12390;&#12399;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31561;&#12398;&#20986;&#33655;&#12505;&#12540;&#12473;&#32113;&#35336;&#12391;&#12399;&#25226;&#25569;&#12373;&#12428;&#12394;&#12356;&#12383;&#12417;&#21407;&#21063;&#12392;&#12375;&#12390;&#35336;&#19978;&#12373;&#12428;&#12394;&#12356;&#12364;&#65292;&#37521;&#37444;&#12392;&#31895;&#37628;&#12394;&#12393;&#65292;
    &#25237;&#20837;&#12539;&#31639;&#20986;&#27083;&#36896;&#12364;&#30064;&#12394;&#12427;&#22580;&#21512;&#12395;&#12399;&#65292;&#12381;&#12428;&#12382;&#12428;&#25903;&#26609;&#12398;&#35069;&#21697;&#20385;&#26684;&#12434;&#22522;&#28310;&#12392;&#12375;&#12390;&#22269;&#20869;&#29983;&#29987;&#38989;&#12392;&#12375;&#12390;&#35336;&#19978;&#12373;&#12428;&#12427;&#65294;

    &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#12381;&#12428;&#12425;&#12398;&#25226;&#25569;&#12395;&#12399;&#65292;&#29983;&#29987;&#21205;&#24907;&#32113;&#35336;&#12394;&#12393;&#12398;&#29983;&#29987;&#39640;&#12505;&#12540;&#12473;&#12398;&#32113;&#35336;&#12434;&#36039;&#26009;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#12356;&#12427;&#12364;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#25226;&#25569;&#12377;&#12427;&#12383;&#12417;&#12395;&#12399;&#65292;&#25237;&#20837;&#27083;&#36896;&#12434;&#19968;&#23450;&#12392;&#20206;&#23450;&#12375;&#12390;&#65292;
    &#21407;&#26448;&#26009;&#20351;&#29992;&#38989;&#31561;&#12363;&#12425;&#25512;&#28204;&#12373;&#12428;&#12427;&#33258;&#23478;&#29983;&#29987;&#12539;&#33258;&#23478;&#28040;&#36027;&#20998;&#12434;&#25512;&#35336;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#65294;
    &#12375;&#12363;&#12375;&#65292;&#12381;&#12428;&#12425;&#12398;&#25237;&#20837;&#27083;&#36896;&#12398;&#25226;&#25569;&#65292;&#25512;&#35336;&#12364;&#22256;&#38627;&#12391;&#12354;&#12427;&#12371;&#12392;&#12363;&#12425;&#26412;&#31295;&#12391;&#12399;&#12371;&#12428;&#12434;&#25201;&#12431;&#12378;&#65292;
    &#33258;&#23478;&#29983;&#29987;&#12539;&#33258;&#23478;&#28040;&#36027;&#20998;&#12434;&#38500;&#12356;&#12383;&#29987;&#20986;&#37327;&#12392;&#12375;&#12390;&#25512;&#35336;&#12377;&#12427;&#65294;

    &#21462;&#24341;&#22522;&#26412;&#34920;&#12391;&#12399;&#12289;&#21508;&#37096;&#38272;&#12398;&#29983;&#29987;&#29289;&#12395;&#12388;&#12356;&#12390;&#12289;&#33258;&#20027;&#30340;&#12394;&#29983;&#29987;&#12399;&#12418;&#12392;&#12424;&#12426;&#12289;
    &#20182;&#37096;&#38272;&#12363;&#12425;&#12398;&#21463;&#35351;&#12395;&#22522;&#12389;&#12367;&#29983;&#29987;&#12391;&#12354;&#12387;&#12390;&#12418;&#12289;&#24403;&#35442;&#29983;&#29987;&#29289;&#12398;&#37096;&#38272;&#12395;&#37329;&#38989;&#12434;&#35336;&#19978;&#12377;&#12427;&#12398;&#12364;&#21407;&#21063;&#12391;&#12354;&#12427;&#12290;
    &#12375;&#12363;&#12375;&#12289;&#22269;&#20869;&#29983;&#29987;&#38989;&#12434;&#25512;&#35336;&#12377;&#12427;&#22522;&#30990;&#36039;&#26009;&#12398;&#19968;&#12388;&#12391;&#12354;&#12427;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#8208;&#27963;&#21205; &#35519;&#26619;&#12391;&#12399;&#12289;&#21463;&#35351;&#29983;&#29987;&#20998;&#12395;&#20418;&#12427;&#37329;&#38989;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;
    &#12300;&#21152;&#24037;&#36035;&#21454;&#20837;&#12301;&#12375;&#12363;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12290;
    &#12381;&#12398;&#12383;&#12417;&#12289;&#21516;&#35519;&#26619;&#12434;&#21033;&#29992;&#12375;&#12390;&#22269;&#20869;&#29983;&#29987;&#38989;&#12434;&#25512;&#35336;&#12377;&#12427;&#37096;&#38272;&#12391;&#12399;&#12289; &#21463;&#35351;&#29983;&#29987;&#12395;&#20418;&#12427;&#21407;&#26448;&#26009;&#31561;&#12398;&#37329;&#38989;&#12364;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#12290;

    &#19968;&#26041;&#12289;&#21463;&#35351;&#29983;&#29987;&#12398;&#22996;&#35351;&#32773;&#12364;&#38750;&#35069;&#36896;&#26989;&#12398;&#22580;&#21512;&#12395;&#12354;&#12387;&#12390;&#12399;&#12289;&#21830;&#31038;&#12420;&#30334;&#36008;&#24215;&#12394;&#12393;&#12398;&#21830;&#26989;&#37096;&#38272;&#12391;&#12354;&#12427;&#22580;&#21512;&#12364;&#22810;&#12356;&#12364;&#12289;
    &#12371;&#12428;&#12425;&#21830;&#26989;&#37096;&#38272;&#12398;&#22269;&#20869;&#29983;&#29987;&#38989;&#12399;&#12289;&#22522;&#26412;&#30340;&#12395;&#12300;&#36009;&#22770;&#38989; - &#22770;&#19978;&#21407;&#20385; = &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#12301;
     (&#21830;&#26989;&#37096;&#38272;&#12398;&#22269;&#20869;&#29983;&#29987;&#38989;&#12395;&#12399;&#12289;&#12371;&#12398;&#12411;&#12363;&#12289;&#12467;&#12473;&#12488; &#21830;&#26989;&#12395;&#30456;&#24403;&#12377;&#12427;&#37329;&#38989;&#12418;&#21547;&#12414;&#12428;&#12427;&#12290;)&#12391;&#35336;&#31639;&#12373;&#12428;&#12427;&#12383;&#12417;&#12289;
     &#22996;&#35351;&#29983;&#29987;&#12398;&#12383;&#12417;&#12398;&#26448;&#26009;&#36092;&#20837;&#36027;&#12364;&#30330;&#29983;&#12375;&#12390;&#12356;&#12383;&#12392;&#12375;&#12390;&#12418;&#12289;&#21830;&#26989;&#37096;&#38272;&#12395;&#12399;&#35336;&#19978;&#12373;&#12428;&#12394;&#12356;&#12290;

    &#12381;&#12398;&#32080;&#26524;&#12289;&#20309;&#12418;&#20966;&#29702;&#12434;&#34892;&#12431;&#12394;&#12356;&#12392;&#12377;&#12428;&#12400;&#12289;&#21407;&#26448;&#26009;&#12434;&#29983;&#29987;&#12375;&#12383;&#37096;&#38272;&#12391;&#12399;&#12289;
    &#21830;&#26989;&#37096;&#38272;&#12395;&#36009;&#22770;&#12375;&#12383;&#22996;&#35351;&#29983;&#29987;&#29992;&#21407;&#26448;&#26009;&#12398;&#29987;&#20986;&#12434;&#35336;&#19978;&#12391;&#12365;&#12394;&#12367;&#12394;&#12427;&#19968;&#26041;&#12391;&#12289;
    &#21463;&#35351;&#29983;&#29987;&#12434;&#34892;&#12387;&#12383;&#37096;&#38272;&#12391;&#12399;&#12289;&#22269;&#20869;&#29983;&#29987;&#38989;&#12364;&#36942;&#23567;&#35413;&#20385;&#12395;&#12394;&#12427;&#12392;&#12392;&#12418;&#12395;&#12289;&#20184;&#21152;&#20385;&#20516;&#29575;&#12364;&#36942;&#22823;&#35413;&#20385;&#12395;&#12394;&#12427;&#12290;

    &#12381;&#12371;&#12391;&#12289;&#38750;&#35069;&#36896;&#26989;&#12363;&#12425;&#12398;&#22996;&#35351;&#12434;&#21463;&#12369;&#12390;&#29983;&#29987;&#12377;&#12427; &#20998;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#27425;&#12395;&#25522;&#12370;&#12427;&#24335;&#12395;&#12424;&#12426;&#12289;
    &#21152;&#24037;&#36035;&#21454;&#20837;&#38989;&#12395;&#20184;&#21152;&#20385;&#20516;&#29575;&#12398;&#36870;&#25968;&#12434;&#20055;&#12378;&#12427;&#12371;&#12392;&#12395;&#12424;&#12426;&#12289;&#21407;&#26448;&#26009;&#36027;&#31561;&#12434;&#21547;&#12435;&#12384;&#22269;&#20869;&#29983;&#29987;&#38989;&#12434;&#25512;&#35336;&#12375;&#12390;&#12356;&#12427;&#12290;

    \[ &#22269;&#20869;&#29983;&#29987;&#38989; = &#21152;&#24037;&#36035;&#21454;&#20837;&#38989; \times \frac{&#35069;&#21697;&#20385;&#38989;}{&#35069;&#21697;&#38989;-&#21407;&#26448;&#26009;&#36027;}   \]

    (&#12487;&#12540;&#12479;&#12398;&#27424;&#25613;&#31561;&#12391;&#20184;&#21152;&#20385;&#20516;&#29575;&#12398;&#36870;&#25968;&#12364;0,&#12510;&#12452;&#12490;&#12473;,&#28961;&#38480;&#22823;&#12395;&#12394;&#12427;&#22580;&#21512;&#12399;,&#20840;&#12390;1&#12392;&#12375;&#12390;&#12356;&#12427;.)


    &#12367;&#12377;&#12441;&#12539;&#24259;&#29289;    7466 00 &#35069;&#36896;&#24037;&#31243;&#12363;&#12425;&#12390;&#12441;&#12383;&#12367;&#12377;&#12441;&#12539;&#24259;&#29289;

    &#12395;&#38306;&#12375;&#12390; &#35069;&#36896;&#26989;&#12398;&#27573;&#38542;&#12391;&#30330;&#29983;&#37096;&#38272;&#12395;&#25391;&#12426;&#20998;&#12369;
    &#12414;&#12383;&#65292;&#23633;&#12539;&#21103;&#29987;&#29289;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21462;&#24341;&#22522;&#26412;&#34920;&#12395;&#12362;&#12369;&#12427;&#23633;&#12539;&#21103;&#29987;&#29289;&#30330;&#29983;&#37096;&#38272;&#12434;V&#34920;&#29987;&#26989;&#20998;&#39006;&#12408;&#32068;&#26367;&#12360;&#65292;&#12381;&#12398;&#20516;&#12434;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#27714;&#12417;&#12425;&#12428;&#12383;&#29987;&#26989;&#215;&#21830;&#21697;&#34920;&#12398;&#24403;&#35442;&#20132;&#28857;&#12395;&#35336;&#19978;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#26412;&#31295;&#12391;&#12399;V&#34920;&#12398;&#20316;&#25104;&#12399;&#22823;&#12414;&#12363;&#12395;&#65292;&#20197;&#19979;&#9312;~&#9316;&#12398;&#20316;&#26989;&#12434;&#24819;&#23450;&#12375;&#12390;&#12356;&#12427;&#65294;
    &#12394;&#12362;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#23633;&#65292;&#21103;&#29987;&#29289;&#12398;&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#21462;&#24341;&#22522;&#26412;&#34920;&#12434;&#32076;&#30001;&#12375;&#12390;&#12362;&#12426;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#21508;&#31278;&#22522;&#30990;&#32113;&#35336;&#20516;&#12418;&#12381;&#12398;&#25512;&#35336;&#12395;&#21033;&#29992;&#12375;&#12390;&#12356;&#12427;&#65294;
     &#26412;&#30740;&#31350;&#12399;&#65292;&#39165;&#12367;&#12414;&#12391;&#21516;&#19968;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12377;&#12427;&#12371;&#12392;&#12391;&#25512;&#35336;&#25163;&#27861;&#27598;&#12398;&#24046;&#30064;&#12434;&#20998;&#26512;&#12377;&#12427;&#12371;&#12392;&#12434;&#30446;&#30340;&#12392;&#12375;&#12390;&#12362;&#12426;&#65292;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12363;&#12425;&#30452;&#25509;&#30340;&#12395;&#20516;&#12434;&#27083;&#25104;&#12377;&#12427;&#12392;&#12356;&#12358;&#28857;&#12391;&#65292;
    &#25512;&#35336;&#25163;&#27861;&#12364;&#29694;&#34892;&#12398;&#12418;&#12398;&#12392;&#12399;&#30064;&#12394;&#12427;&#65294;
    &#24190;&#12388;&#12363;&#12398;&#35036;&#36275;&#12391;&#12365;&#12394;&#12356;&#27010;&#24565;&#31561;&#12418;&#12381;&#12398;&#12414;&#12414;&#26410;&#25226;&#25569;&#12392;&#12375;&#12390;&#25201;&#12356;&#65292;&#22823;&#12365;&#12394;&#38917;&#30446;&#12395;&#12388;&#12356;&#12390;&#12399;&#20182;&#12398;&#32113;&#35336;&#12434;&#29992;&#12356;&#12390;&#31777;&#26131;&#30340;&#12395;&#25512;&#35336;&#12377;&#12427;&#12394;&#12393;&#65292;&#31777;&#26131;&#30340;&#20316;&#25104;&#25163;&#27861;&#12434;&#25505;&#29992;&#12377;&#12427;&#65294;

    -}</span><span>
</span><a name="line-991"></a><span>
</span><a name="line-992"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-993"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%88FD%9020%696D"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%88FD%9020%696D"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#35069;&#36896;&#26989;</span></a></a><span>  </span><a name="local-6989586621679476160"><a href="#local-6989586621679476160"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476161"><a href="#local-6989586621679476161"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-994"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-995"></a><span>    </span><a name="local-6989586621679476173"><a href="#local-6989586621679476173"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476161"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-996"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476173"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-997"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476174"><a href="#local-6989586621679476174"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476174"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%88FD%9020%696D"><span class="hs-identifier hs-var">E&#35069;&#36896;&#26989;</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476162"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476160"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476161"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-998"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-999"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1000"></a><span>
</span><a name="line-1001"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1002"></a><span>    </span><span class="hs-comment">-- &#35069;&#36896;&#26989;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1003"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1004"></a><span>    </span><a name="local-6989586621679476162"><a href="#local-6989586621679476162"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679476163"><a href="#local-6989586621679476163"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476164"><a href="#local-6989586621679476164"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1005"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476165"><a href="#local-6989586621679476165"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1006"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476166"><a href="#local-6989586621679476166"><span class="hs-identifier">comm</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1007"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476167"><a href="#local-6989586621679476167"><span class="hs-identifier">front</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1008"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476168"><a href="#local-6989586621679476168"><span class="hs-identifier">prod</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-var">H&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span>
</span><a name="line-1009"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476169"><a href="#local-6989586621679476169"><span class="hs-identifier">process</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%53CE%5165%984D_%52A0%5DE5%8CC3"><span class="hs-identifier hs-var">H&#21454;&#20837;&#38989;_&#21152;&#24037;&#36035;</span></a><span>
</span><a name="line-1010"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476170"><a href="#local-6989586621679476170"><span class="hs-identifier">oth</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%53CE%5165%984D_%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-var">H&#21454;&#20837;&#38989;_&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span>
</span><a name="line-1011"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476171"><a href="#local-6989586621679476171"><span class="hs-identifier">cost</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-var">H&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span>
</span><a name="line-1012"></a><span>
</span><a name="line-1013"></a><span>        </span><span class="hs-comment">--  &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-1014"></a><span>        </span><span class="hs-comment">-- &#12371;&#12371;&#12391;,&#20197;&#21069;&#12395;&#20966;&#29702;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12398;&#23550;&#20966;&#12434;&#20998;&#23696;</span><span>
</span><a name="line-1015"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476172"><a href="#local-6989586621679476172"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#getValCarsFromV%88FD%9020%696D"><span class="hs-identifier hs-var">getValCarsFromV&#35069;&#36896;&#26989;</span></a><span> </span><a href="#local-6989586621679476163"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476165"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476168"><span class="hs-identifier hs-var">prod</span></a><span> </span><a href="#local-6989586621679476169"><span class="hs-identifier hs-var">process</span></a><span> </span><a href="#local-6989586621679476170"><span class="hs-identifier hs-var">oth</span></a><span> </span><a href="#local-6989586621679476171"><span class="hs-identifier hs-var">cost</span></a><span>
</span><a name="line-1016"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476164"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476166"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476172"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476167"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T3&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1017"></a><span>
</span><a name="line-1018"></a><span class="hs-identifier">getValCarsFromV&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-1019"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1020"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Val&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span>
</span><a name="line-1021"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%53CE%5165%984D_%52A0%5DE5%8CC3"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#21152;&#24037;&#36035;</span></a><span>
</span><a name="line-1022"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%53CE%5165%984D_%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span>
</span><a name="line-1023"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-type">Val&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span>
</span><a name="line-1024"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1025"></a><a name="getValCarsFromV%88FD%9020%696D"><a href="VTable.Compliation.html#getValCarsFromV%88FD%9020%696D"><span class="hs-identifier">getValCarsFromV&#35069;&#36896;&#26989;</span></a></a><span> </span><a name="local-6989586621679476175"><a href="#local-6989586621679476175"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476176"><a href="#local-6989586621679476176"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679476177"><a href="#local-6989586621679476177"><span class="hs-identifier">prod</span></a></a><span> </span><a name="local-6989586621679476178"><a href="#local-6989586621679476178"><span class="hs-identifier">process</span></a></a><span> </span><a name="local-6989586621679476179"><a href="#local-6989586621679476179"><span class="hs-identifier">oth</span></a></a><span>  </span><a name="local-6989586621679476180"><a href="#local-6989586621679476180"><span class="hs-identifier">cost</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476185"><span class="hs-identifier hs-var">merge</span></a><span> </span><a href="#local-6989586621679476181"><span class="hs-identifier hs-var">prodDetail</span></a><span> </span><a href="#local-6989586621679476183"><span class="hs-identifier hs-var">processDetail</span></a><span> </span><a href="#local-6989586621679476184"><span class="hs-identifier hs-var">othDetail</span></a><span>
</span><a name="line-1026"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1027"></a><span>    </span><span class="hs-comment">-- | &#35069;&#36896;&#26989;</span><span>
</span><a name="line-1028"></a><span>    </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476181"><a href="#local-6989586621679476181"><span class="hs-identifier">prodDetail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#prodToDetail"><span class="hs-identifier hs-var">prodToDetail</span></a><span> </span><a href="#local-6989586621679476175"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476177"><span class="hs-identifier hs-var">prod</span></a><span>
</span><a name="line-1029"></a><span>    </span><span class="hs-comment">-- | &#21152;&#24037;&#36035;&#12434;&#38500;&#12367;&#35069;&#36896;&#38989;</span><span>
</span><a name="line-1030"></a><span>    </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476182"><a href="#local-6989586621679476182"><span class="hs-identifier">totalProd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476181"><span class="hs-identifier hs-var">prodDetail</span></a><span>
</span><a name="line-1031"></a><span>
</span><a name="line-1032"></a><span>    </span><span class="hs-comment">-- | &#21152;&#24037;&#36035;</span><span>
</span><a name="line-1033"></a><span>    </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476183"><a href="#local-6989586621679476183"><span class="hs-identifier">processDetail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#processToDetail"><span class="hs-identifier hs-var">processToDetail</span></a><span> </span><a href="#local-6989586621679476180"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679476182"><span class="hs-identifier hs-var">totalProd</span></a><span> </span><a href="#local-6989586621679476178"><span class="hs-identifier hs-var">process</span></a><span>
</span><a name="line-1034"></a><span>    </span><span class="hs-comment">-- | &#35069;&#36896;&#26989;&#20197;&#22806;</span><span>
</span><a name="line-1035"></a><span>    </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476184"><a href="#local-6989586621679476184"><span class="hs-identifier">othDetail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#othToDetail"><span class="hs-identifier hs-var">othToDetail</span></a><span> </span><a href="#local-6989586621679476179"><span class="hs-identifier hs-var">oth</span></a><span>
</span><a name="line-1036"></a><span>    </span><span class="hs-comment">-- | &#20966;&#29702;&#26041;&#37341; : &#12381;&#12428;&#12382;&#12428;,&#22793;&#25563;&#12375;&#12390;&#32080;&#21512;&#12377;&#12427;</span><span>
</span><a name="line-1037"></a><span>    </span><span class="hs-comment">-- | &#32080;&#21512;</span><span>
</span><a name="line-1038"></a><span>    </span><span class="hs-identifier">merge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Cars%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Cars&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%53CE%5165%984D_%52A0%5DE5%8CC3"><span class="hs-identifier hs-type">Cars&#21454;&#20837;&#38989;_&#21152;&#24037;&#36035;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%53CE%5165%984D_%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-type">Cars&#21454;&#20837;&#38989;_&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1039"></a><span>    </span><a name="local-6989586621679476185"><a href="#local-6989586621679476185"><span class="hs-identifier">merge</span></a></a><span> </span><a name="local-6989586621679476186"><a href="#local-6989586621679476186"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679476187"><a href="#local-6989586621679476187"><span class="hs-identifier">c2</span></a></a><span> </span><a name="local-6989586621679476188"><a href="#local-6989586621679476188"><span class="hs-identifier">c3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476186"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">,</span><a href="#local-6989586621679476187"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">,</span><a href="#local-6989586621679476188"><span class="hs-identifier hs-var">c3</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1040"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679476176"><span class="hs-identifier hs-var">man</span></a><span>  </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476186"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476187"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476188"><span class="hs-identifier hs-var">c3</span></a><span>
</span><a name="line-1041"></a><span>
</span><a name="line-1042"></a><span>
</span><a name="line-1043"></a><span class="hs-comment">-- | &#20986;&#33655;&#38989;</span><span>
</span><a name="line-1044"></a><span class="hs-comment">-- &#20986;&#33655;&#38989;&#12399;&#22522;&#26412;&#30340;&#12395;,&#21069;&#22235;&#25991;&#23383;&#12395;&#20999;&#12427;&#12392;,&#32048;&#20998;&#39006;&#12395;&#12394;&#12427;</span><span>
</span><a name="line-1045"></a><span class="hs-comment">-- &#65378;&#12367;&#12377;&#12441;&#12539;&#24259;&#29289;    7466 00 &#35069;&#36896;&#24037;&#31243;&#12363;&#12425;&#12390;&#12441;&#12383;&#12367;&#12377;&#12441;&#12539;&#24259;&#29289;&#65379; &#12399; &#12381;&#12398;&#20107;&#26989;&#25152;&#12398;&#20986;&#33655;&#35069;&#21697;&#12398;&#26368;&#22823;&#12398;&#12418;&#12398;&#12395;&#22793;&#25563;</span><span>
</span><a name="line-1046"></a><span>
</span><a name="line-1047"></a><span class="hs-identifier">prodToDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Val&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Cars&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1048"></a><a name="prodToDetail"><a href="VTable.Compliation.html#prodToDetail"><span class="hs-identifier">prodToDetail</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1049"></a><span class="hs-identifier">prodToDetail</span><span> </span><span class="hs-number">28</span><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476189"><a href="#local-6989586621679476189"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476190"><a href="#local-6989586621679476190"><span class="hs-identifier">cutted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476191"><a href="#local-6989586621679476191"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679476191"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476191"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476189"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1050"></a><span>                                    </span><span class="hs-keyword">in</span><span> </span><a href="VTable.Compliation.html#wasteTreate"><span class="hs-identifier hs-var">wasteTreate</span></a><span> </span><a href="#local-6989586621679476190"><span class="hs-identifier hs-var">cutted</span></a><span>
</span><a name="line-1051"></a><span>
</span><a name="line-1052"></a><span class="hs-identifier">prodToDetail</span><span> </span><span class="hs-number">24</span><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476192"><a href="#local-6989586621679476192"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476193"><a href="#local-6989586621679476193"><span class="hs-identifier">cutted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476194"><a href="#local-6989586621679476194"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679476194"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476194"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476192"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1053"></a><span>                                    </span><span class="hs-keyword">in</span><span> </span><a href="VTable.Compliation.html#wasteTreate"><span class="hs-identifier hs-var">wasteTreate</span></a><span> </span><a href="#local-6989586621679476193"><span class="hs-identifier hs-var">cutted</span></a><span>
</span><a name="line-1054"></a><span>
</span><a name="line-1055"></a><span class="hs-comment">-- | &#65378;&#12367;&#12377;&#12441;&#12539;&#24259;&#29289;    7466 00 &#35069;&#36896;&#24037;&#31243;&#12363;&#12425;&#12390;&#12441;&#12383;&#12367;&#12377;&#12441;&#12539;&#24259;&#29289;&#65379;  &#12434; &#12381;&#12398;&#20107;&#26989;&#25152;&#12398;&#20986;&#33655;&#35069;&#21697;&#12398;&#26368;&#22823;&#12398;&#12418;&#12398;&#12395;&#22793;&#25563;</span><span>
</span><a name="line-1056"></a><span class="hs-identifier">wasteTreate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Cars%51FA%8377%984D_%88FD%9020%696D"><span class="hs-identifier hs-type">Cars&#20986;&#33655;&#38989;_&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Cars&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1057"></a><a name="wasteTreate"><a href="VTable.Compliation.html#wasteTreate"><span class="hs-identifier">wasteTreate</span></a></a><span> </span><a name="local-6989586621679476195"><a href="#local-6989586621679476195"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476196"><a href="#local-6989586621679476196"><span class="hs-identifier">waste</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476197"><a href="#local-6989586621679476197"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476197"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7466&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476195"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1058"></a><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679476196"><span class="hs-identifier hs-var">waste</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1059"></a><span>                  </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476195"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1060"></a><span>                  </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476198"><a href="#local-6989586621679476198"><span class="hs-identifier">withoutWasteMaxValueName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#vmaximumNameWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNameWithoutErr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476199"><a href="#local-6989586621679476199"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476199"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7466&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476195"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1061"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">T.null</span><span> </span><a href="#local-6989586621679476198"><span class="hs-identifier hs-var">withoutWasteMaxValueName</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1062"></a><span>                            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476200"><a href="#local-6989586621679476200"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476200"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;EZZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476196"><span class="hs-identifier hs-var">waste</span></a><span>
</span><a name="line-1063"></a><span>                            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476201"><a href="#local-6989586621679476201"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476201"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7466&quot;</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679476201"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476198"><span class="hs-identifier hs-var">withoutWasteMaxValueName</span></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679476201"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476195"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1064"></a><span>
</span><a name="line-1065"></a><span class="hs-comment">-- | &#36035;&#21152;&#24037;</span><span>
</span><a name="line-1066"></a><span class="hs-comment">-- &#21069;&#22235;&#25991;&#23383;&#12391;&#20999;&#12387;&#12383;&#24460;&#12395;,&#36035;&#21152;&#24037;&#20197;&#22806;&#12398;&#35069;&#36896;&#21697;&#12398;&#21407;&#26448;&#26009;&#36027;</span><span>
</span><a name="line-1067"></a><span class="hs-comment">-- &#21407;&#26448;&#26009;&#20351;&#29992;&#38989;&#12363;,&#35069;&#36896;&#21697;&#20385;&#38989;&#12364;&#12431;&#12363;&#12425;&#12394;&#12356;&#22580;&#21512;&#12399;&#12381;&#12398;&#12414;&#12414;&#36275;&#12377;</span><span>
</span><a name="line-1068"></a><span class="hs-comment">-- &#36942;&#23569;&#12395;&#12394;&#12427;&#12383;&#12417;,&#20195;&#26367;&#26696;&#12399;&#24517;&#35201;</span><span>
</span><a name="line-1069"></a><span>
</span><a name="line-1070"></a><span class="hs-identifier">processToDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-type">Val&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%53CE%5165%984D_%52A0%5DE5%8CC3"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#21152;&#24037;&#36035;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-1071"></a><a name="processToDetail"><a href="VTable.Compliation.html#processToDetail"><span class="hs-identifier">processToDetail</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">_</span><span>          </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1072"></a><span class="hs-identifier">processToDetail</span><span> </span><a name="local-6989586621679476202"><a href="#local-6989586621679476202"><span class="hs-identifier">cost</span></a></a><span> </span><a name="local-6989586621679476203"><a href="#local-6989586621679476203"><span class="hs-identifier">totalProd</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476204"><a href="#local-6989586621679476204"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476208"><a href="#local-6989586621679476208"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476208"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476205"><span class="hs-identifier hs-var">getRate</span></a><span> </span><a href="#local-6989586621679476202"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679476203"><span class="hs-identifier hs-var">totalProd</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476208"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1073"></a><span>                                                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476208"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476204"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1074"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1075"></a><span>    </span><span class="hs-comment">-- &#20184;&#21152;&#20385;&#20516;&#29575;&#12398;&#36870;&#25968;&#12434;&#27714;&#12417;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-1076"></a><span>    </span><span class="hs-identifier">getRate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%539F%6750%6599%4F7F%7528%984D"><span class="hs-identifier hs-type">Val&#21407;&#26448;&#26009;&#20351;&#29992;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">{- ^ &#32207;&#35069;&#36896;&#38989; -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">{- ^ &#20184;&#21152;&#20385;&#20516;&#12398;&#36870;&#25968; -}</span><span>
</span><a name="line-1077"></a><span>    </span><a name="local-6989586621679476205"><a href="#local-6989586621679476205"><span class="hs-identifier">getRate</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1078"></a><span>    </span><span class="hs-identifier">getRate</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476206"><a href="#local-6989586621679476206"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679476207"><a href="#local-6989586621679476207"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476207"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679476206"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1079"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476207"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476207"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679476206"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span>
</span><a name="line-1082"></a><span class="hs-comment">-- | &#35069;&#36896;&#26989;&#20197;&#22806;</span><span>
</span><a name="line-1083"></a><span class="hs-identifier">othToDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%53CE%5165%984D_%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#38989;_&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-1084"></a><a name="othToDetail"><a href="VTable.Compliation.html#othToDetail"><span class="hs-identifier">othToDetail</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1085"></a><span class="hs-identifier">othToDetail</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476209"><a href="#local-6989586621679476209"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679476209"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VTable.Data.Classification.html#gd%88FD%9020%696D%4EE5%5916"><span class="hs-identifier hs-var">gd&#35069;&#36896;&#26989;&#20197;&#22806;</span></a><span>
</span><a name="line-1086"></a><span>
</span><a name="line-1087"></a><span>
</span><a name="line-1088"></a><span class="hs-comment">-- *** &#21830;&#26989;</span><span>
</span><a name="line-1089"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1090"></a><span>
</span><a name="line-1091"></a><span class="hs-comment">{- |
    &#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#65289;&#12364;&#12393;&#12398;&#12424;&#12358;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12390;&#12356;&#12427;&#12363;&#12395;&#38306;&#12377;&#12427;&#24773;&#22577;&#12399;&#65292;
    &#31558;&#32773;&#12398;&#30693;&#12427;&#38480;&#12426;&#20844;&#34920;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12364;&#65292;&#24179;&#25104;28&#24180;&#32080;&#26524;&#12398;&#27010;&#35201;&#12395;&#12362;&#12356;&#12390;&#65292;&#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#12300;&#29305;&#27530;&#12394;&#26041;&#27861;&#12301;&#12395;&#38306;&#12375;&#12390;&#35443;&#32048;&#12394;&#35352;&#36848;&#12364;&#23384;&#22312;&#12377;&#12427;&#65294;

    &#22312;&#24235;&#12395;&#38306;&#12377;&#12427;&#35519;&#26619;&#38917;&#30446;&#20197;&#22806;&#12395;&#12399;&#65292;&#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#21450;&#12403;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#21830;&#26989;&#37096;&#38272;&#12398;&#35519;&#26619;&#31080;&#12398;&#35373;&#35336;&#12395;&#22823;&#12365;&#12394;&#36949;&#12356;&#12399;&#12394;&#12356;&#12383;&#12417;&#65292;
    &#12371;&#12371;&#12391;&#12399;&#65292;&#24179;&#25104;28&#24180;&#12300;&#32080;&#26524;&#12398;&#27010;&#35201;&#12301;&#12395;&#35352;&#36848;&#12373;&#12428;&#12390;&#12356;&#12427;&#25163;&#27861;&#12395;&#21063;&#12387;&#12390;&#65292;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;&#65294;

    &#21516;&#36039;&#26009;&#12395;&#12424;&#12428;&#12400;&#65292;&#12302;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369;&#12395;&#12362;&#12356;&#12390;&#65292;&#21368;&#22770;&#26989;&#12398;&#12358;&#12385;&#12300;&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#65288;&#24467;&#26989;&#32773;&#12364;&#24120;&#26178;100&#20154;&#20197;&#19978;&#12398;&#12418;&#12398;&#65289;&#12301;&#65292;
    &#12300;&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#12301;&#21450;&#12403;&#12300;&#20195;&#29702;&#21830;&#65292;&#20210;&#31435;&#26989;&#12301;&#65292;&#23567;&#22770;&#26989;&#12398;&#12358;&#12385;&#12300;&#30334;&#36008;&#24215;&#65292;&#32207;&#21512;&#12473;&#12540;&#12497;&#12540;&#12301;&#65292;
    &#12300;&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#23567;&#22770;&#26989;&#65288;&#24467;&#26989;&#21729;&#12364;&#24120;&#26178;50&#20154;&#26410;&#28288;&#12398;&#12418;&#12398;&#65289;&#12301;&#65292;&#12300;&#21508;&#31278;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#65292;
    &#12300;&#12467;&#12531;&#12499;&#12491;&#12456;&#12531;&#12473;&#12473;&#12488;&#12450;&#65288;&#26032;&#39135;&#26009;&#21697;&#12434;&#20013;&#24515;&#12392;&#12377;&#12427;&#12418;&#12398;&#12395;&#38480;&#12427;&#65289;&#12301;&#65292;
    &#12300;&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12301;&#65292;&#12300;&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#12301;&#65292;&#12300;&#12383;&#12400;&#12371;&#12539;&#21931;&#29017;&#20855;&#23554;&#38272;&#23567;&#22770;&#26989;&#12301;&#21450;&#12403;&#12300;&#28961;&#24215;&#33303;&#23567;&#22770;&#26989;&#12301;&#12303;&#12399;&#29305;&#27530;&#12394;&#26041;&#27861;&#12395;&#12424;&#12387;&#12390;&#26684;&#20184;&#12369;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#32080;&#26524;&#12398;&#27010;&#35201;&#12395;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#20966;&#29702;&#12501;&#12525;&#12540;&#12434;&#12414;&#12392;&#12417;&#12383;&#12418;&#12398;&#12364;&#65292;&#12300;&#22259; 6&#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#29305;&#27530;&#12394;&#26041;&#27861;&#12398;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;&#12301;&#12391;&#12354;&#12427;&#65294;
    &#20197;&#19979;&#65292;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#12395;&#24467;&#12387;&#12390;&#20966;&#29702;&#12434;&#35373;&#35336;&#12375;&#12390;&#12356;&#12367;

    ![&#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#29305;&#27530;&#12394;&#26041;&#27861;&#12398;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;](commerceFlow.png)

    &#39006;&#20284;&#12510;&#12540;&#12472;&#12531;&#29575;&#21462;&#24471; &#12394;&#12393;&#12398;&#20966;&#29702;&#12399;&#65292;&#20182;&#12398;&#20966;&#29702;&#12364;&#32066;&#20102;&#12375;&#12383;&#24460;&#12395;&#20966;&#29702;&#12373;&#12428;&#12427;&#65294;


    * &#21830;&#26989;&#12399;,&#21830;&#21697;&#20998;&#39006;=&#29987;&#26989;&#20998;&#39006;&#32048;&#20998;&#39006;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#12398;&#12391;,&#22793;&#25563;&#12398;&#24517;&#35201;&#12394;&#12375;.
-}</span><span>
</span><a name="line-1114"></a><span>
</span><a name="line-1115"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21830;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1116"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5546%696D"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5546%696D"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21830;&#26989;</span></a></a><span> </span><a name="local-6989586621679476210"><a href="#local-6989586621679476210"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476211"><a href="#local-6989586621679476211"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1117"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1118"></a><span>    </span><a name="local-6989586621679476230"><a href="#local-6989586621679476230"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476211"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-1119"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476230"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1120"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476231"><a href="#local-6989586621679476231"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476231"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5546%696D"><span class="hs-identifier hs-var">E&#21830;&#26989;</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476212"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476210"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476211"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-1121"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1122"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1123"></a><span>
</span><a name="line-1124"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1125"></a><span>    </span><span class="hs-comment">-- | &#21830;&#26989;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1126"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1127"></a><span>    </span><a name="local-6989586621679476212"><a href="#local-6989586621679476212"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679476213"><a href="#local-6989586621679476213"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476214"><a href="#local-6989586621679476214"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1128"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476215"><a href="#local-6989586621679476215"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1129"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476216"><a href="#local-6989586621679476216"><span class="hs-identifier">comm</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1130"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476217"><a href="#local-6989586621679476217"><span class="hs-identifier">front</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1131"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476218"><a href="#local-6989586621679476218"><span class="hs-identifier">retail</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1132"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476219"><a href="#local-6989586621679476219"><span class="hs-identifier">wholesale</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span>
</span><a name="line-1133"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476220"><a href="#local-6989586621679476220"><span class="hs-identifier">area</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%58F2%5834%9762%7A4D"><span class="hs-identifier hs-var">H&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1134"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476221"><a href="#local-6989586621679476221"><span class="hs-identifier">self</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-var">H&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1135"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476222"><a href="#local-6989586621679476222"><span class="hs-identifier">sellType</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-var">H&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1136"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476223"><a href="#local-6989586621679476223"><span class="hs-identifier">goodsType</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%5F62%614B"><span class="hs-identifier hs-var">H&#21830;&#21697;&#24418;&#24907;</span></a><span>
</span><a name="line-1137"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476224"><a href="#local-6989586621679476224"><span class="hs-identifier">shopType</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-var">H&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1138"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476225"><a href="#local-6989586621679476225"><span class="hs-identifier">repair</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4FEE%7406%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-var">H&#20462;&#29702;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-1139"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476226"><a href="#local-6989586621679476226"><span class="hs-identifier">middle</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-var">H&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-1140"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476227"><a href="#local-6989586621679476227"><span class="hs-identifier">open</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-var">H&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1141"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476228"><a href="#local-6989586621679476228"><span class="hs-identifier">worker</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-1142"></a><span>
</span><a name="line-1143"></a><span>
</span><a name="line-1144"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-1145"></a><span>        </span><span class="hs-comment">-- &#12371;&#12371;&#12391;,&#20197;&#21069;&#12395;&#20966;&#29702;&#12373;&#12428;&#12390;&#12356;&#12383;&#22580;&#21512;&#12398;&#23550;&#20966;&#12434;&#20998;&#23696;</span><span>
</span><a name="line-1146"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476229"><a href="#local-6989586621679476229"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#getValCarsFromV%5546%696D"><span class="hs-identifier hs-var">getValCarsFromV&#21830;&#26989;</span></a><span> </span><a href="#local-6989586621679476213"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476215"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476217"><span class="hs-identifier hs-var">front</span></a><span> </span><a href="#local-6989586621679476218"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476219"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><a href="#local-6989586621679476225"><span class="hs-identifier hs-var">repair</span></a><span> </span><a href="#local-6989586621679476226"><span class="hs-identifier hs-var">middle</span></a><span> </span><a href="#local-6989586621679476220"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679476221"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679476222"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476223"><span class="hs-identifier hs-var">goodsType</span></a><span> </span><a href="#local-6989586621679476224"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679476227"><span class="hs-identifier hs-var">open</span></a><span> </span><a href="#local-6989586621679476228"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-1147"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476214"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476216"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476229"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476217"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T4&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T5&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1148"></a><span>
</span><a name="line-1149"></a><span class="hs-identifier">getValCarsFromV&#21830;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-1150"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1151"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1152"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1153"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span>
</span><a name="line-1154"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4FEE%7406%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20462;&#29702;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-1155"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span>
</span><a name="line-1156"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1157"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1158"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1159"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5F62%614B"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#24418;&#24907;</span></a><span>
</span><a name="line-1160"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1161"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1162"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-1163"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1164"></a><a name="getValCarsFromV%5546%696D"><a href="VTable.Compliation.html#getValCarsFromV%5546%696D"><span class="hs-identifier">getValCarsFromV&#21830;&#26989;</span></a></a><span> </span><a name="local-6989586621679476232"><a href="#local-6989586621679476232"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476233"><a href="#local-6989586621679476233"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679476234"><a href="#local-6989586621679476234"><span class="hs-identifier">seb</span></a></a><span> </span><a name="local-6989586621679476235"><a href="#local-6989586621679476235"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476236"><a href="#local-6989586621679476236"><span class="hs-identifier">wholesale</span></a></a><span> </span><a name="local-6989586621679476237"><a href="#local-6989586621679476237"><span class="hs-identifier">repair</span></a></a><span> </span><a name="local-6989586621679476238"><a href="#local-6989586621679476238"><span class="hs-identifier">middle</span></a></a><span> </span><a name="local-6989586621679476239"><a href="#local-6989586621679476239"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679476240"><a href="#local-6989586621679476240"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679476241"><a href="#local-6989586621679476241"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679476242"><a href="#local-6989586621679476242"><span class="hs-identifier">goodsType</span></a></a><span> </span><a name="local-6989586621679476243"><a href="#local-6989586621679476243"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679476244"><a href="#local-6989586621679476244"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679476245"><a href="#local-6989586621679476245"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-1165"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476235"><span class="hs-identifier hs-var">retail</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476236"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1166"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476247"><span class="hs-identifier hs-var">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a><span> </span><a href="#local-6989586621679476232"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#f%5C0F%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#23567;&#22770;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476235"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476241"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476239"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679476240"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679476244"><span class="hs-identifier hs-var">open</span></a><span> </span><a href="#local-6989586621679476243"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679476245"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-1167"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476247"><span class="hs-identifier hs-var">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a><span> </span><a href="#local-6989586621679476232"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#f%5378%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#21368;&#22770;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476238"><span class="hs-identifier hs-var">middle</span></a><span> </span><a href="#local-6989586621679476236"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><a href="#local-6989586621679476245"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-1168"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476246"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476247"><span class="hs-identifier hs-var">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a><span> </span><a href="#local-6989586621679476232"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%5C0F%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#23567;&#22770;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476235"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476241"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476239"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679476240"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679476244"><span class="hs-identifier hs-var">open</span></a><span> </span><a href="#local-6989586621679476243"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679476245"><span class="hs-identifier hs-var">worker</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1169"></a><span>                             </span><span class="hs-special">(</span><a href="#local-6989586621679476247"><span class="hs-identifier hs-var">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a><span> </span><a href="#local-6989586621679476232"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%5378%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#21368;&#22770;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476238"><span class="hs-identifier hs-var">middle</span></a><span> </span><a href="#local-6989586621679476236"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><a href="#local-6989586621679476245"><span class="hs-identifier hs-var">worker</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1170"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1171"></a><span>
</span><a name="line-1172"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1173"></a><span>    </span><a name="local-6989586621679476246"><a href="#local-6989586621679476246"><span class="hs-identifier">f</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1174"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476248"><a href="#local-6989586621679476248"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476248"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1175"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476249"><a href="#local-6989586621679476249"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476249"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1176"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476250"><a href="#local-6989586621679476250"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476251"><a href="#local-6989586621679476251"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476250"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679476251"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-1177"></a><span>
</span><a name="line-1178"></a><span>
</span><a name="line-1179"></a><span>    </span><span class="hs-comment">-- | CNC&#12398;&#23550;&#24540;&#12434;&#12375;&#12383;&#12354;&#12392;&#12395;,&#29987;&#26989;&#20998;&#39006;&#12408;&#25391;&#12426;&#36820;&#12427;</span><span>
</span><a name="line-1180"></a><span>    </span><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1181"></a><span>    </span><a name="local-6989586621679476247"><a href="#local-6989586621679476247"><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1182"></a><span>    </span><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span><span> </span><span class="hs-number">24</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476252"><a href="#local-6989586621679476252"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679476233"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476252"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1183"></a><span>    </span><span class="hs-identifier">f&#29987;&#26989;&#20998;&#39006;&#22793;&#25563;CNC</span><span> </span><span class="hs-number">28</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476253"><a href="#local-6989586621679476253"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679476233"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476253"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1184"></a><span>
</span><a name="line-1185"></a><span>
</span><a name="line-1186"></a><span class="hs-comment">-- **** &#23567;&#22770;&#26989;</span><span>
</span><a name="line-1187"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1188"></a><span class="hs-comment">{- |    &#23567;&#22770;&#26989;&#12398;&#20966;&#29702;

        * &#21931;&#29017;&#20855;&#20966;&#29702;
        &#12300;6092 &#12383;&#12400;&#12371;&#12539;&#21931;&#29017;&#20855;&#23554;&#38272;&#23567;&#22770;&#26989;&#12301;

        &#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12300;6092&#12301;&#65288;&#12383;&#12400;&#12371;&#12539;&#21931;&#29017;&#20855;&#23554;&#38272;&#23567;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#36009;&#22770;&#38989;&#12364;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;
        90&#65285;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

        &#21931;&#29017;&#20855;&#12395;&#38306;&#12375;&#12390;&#12399;,&#33258;&#21205;&#30340;&#12395;,&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12391;&#20966;&#29702;&#12373;&#12428;&#12427;&#12398;&#12391;&#12394;&#12395;&#12418;&#12375;&#12394;&#12356;.

-}</span><span>
</span><a name="line-1199"></a><span>
</span><a name="line-1200"></a><span class="hs-identifier">f&#23567;&#22770;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1201"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1202"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1203"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1204"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1205"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1206"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-1207"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1208"></a><a name="f%5C0F%58F2%51E6%7406"><a href="VTable.Compliation.html#f%5C0F%58F2%51E6%7406"><span class="hs-identifier">f&#23567;&#22770;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476254"><a href="#local-6989586621679476254"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476255"><a href="#local-6989586621679476255"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679476256"><a href="#local-6989586621679476256"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679476257"><a href="#local-6989586621679476257"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679476258"><a href="#local-6989586621679476258"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679476259"><a href="#local-6989586621679476259"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679476260"><a href="#local-6989586621679476260"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-1209"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#more50%5F93%696D%54E1"><span class="hs-identifier hs-var">more50&#24467;&#26989;&#21729;</span></a><span> </span><a href="#local-6989586621679476260"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><span class="hs-identifier hs-var">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476254"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476255"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476256"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1210"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%767E%8CA8%5E97%51E6%7406"><span class="hs-identifier hs-var">f&#30334;&#36008;&#24215;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476254"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476255"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476256"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679476257"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679476258"><span class="hs-identifier hs-var">open</span></a><span> </span><a href="#local-6989586621679476259"><span class="hs-identifier hs-var">shopType</span></a><span>
</span><a name="line-1211"></a><span>
</span><a name="line-1212"></a><span class="hs-comment">-- | &#24467;&#26989;&#21729;&#25968;&#12364;50&#20197;&#19978;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1213"></a><span class="hs-identifier">more50&#24467;&#26989;&#21729;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1214"></a><a name="more50%5F93%696D%54E1"><a href="VTable.Compliation.html#more50%5F93%696D%54E1"><span class="hs-identifier">more50&#24467;&#26989;&#21729;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1215"></a><span class="hs-identifier">more50&#24467;&#26989;&#21729;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679476261"><a href="#local-6989586621679476261"><span class="hs-identifier">em</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#20225;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679476261"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679476261"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">50</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1216"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1217"></a><span>
</span><a name="line-1218"></a><span class="hs-comment">{- |&#12450; &#12300;5611 &#30334;&#36008;&#24215;&#65292;&#32207;&#21512;&#12473;&#12540;&#12497;&#12540;&#12301;

    &#34920;3&#12398;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#23567;&#22770;&#12426;&#12375;&#12289;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12398;&#21508;&#36009;&#22770;
    &#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;10&#65285;&#20197;&#19978;70&#65285;&#26410;&#28288;&#12391;&#12289;&#24467;&#26989;&#32773;&#12364;50&#20154;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

    * &#34920;3 &#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12392;&#21830;&#21697;&#20998;&#39006;

    &#34915;&#12539;&#39135;&#12539;&#20182;&#21029; &#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;2&#26689; &#20197;&#19979;&#12398;&#29987;&#26989;&#20998;&#39006;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;

    &gt; &#34915; 57 &#32340;&#29289;&#12539;&#34915;&#26381;&#12539;&#36523;&#12398;&#22238;&#12426;&#21697;&#23567;&#22770;&#26989;
    &gt; &#39135; 58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;
    &gt; &#20182; 59 &#27231;&#26800;&#22120;&#20855;&#23567;&#22770;&#26989;
    &gt; &#20182; 60 &#12381;&#12398;&#20182;&#12398;&#23567;&#22770;&#26989;

    -}</span><span>
</span><a name="line-1233"></a><span class="hs-identifier">f&#30334;&#36008;&#24215;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1234"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1235"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1236"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1237"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1238"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1239"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1240"></a><a name="f%767E%8CA8%5E97%51E6%7406"><a href="VTable.Compliation.html#f%767E%8CA8%5E97%51E6%7406"><span class="hs-identifier">f&#30334;&#36008;&#24215;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476262"><a href="#local-6989586621679476262"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476263"><a href="#local-6989586621679476263"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679476264"><a href="#local-6989586621679476264"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679476265"><a href="#local-6989586621679476265"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679476266"><a href="#local-6989586621679476266"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679476267"><a href="#local-6989586621679476267"><span class="hs-identifier">shopType</span></a></a><span>
</span><a name="line-1241"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#more10Less70Every%88683"><span class="hs-identifier hs-var">more10Less70Every&#34920;3</span></a><span> </span><a href="#local-6989586621679476262"><span class="hs-identifier hs-var">retail</span></a><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1242"></a><span>                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1243"></a><span>                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476262"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;5699&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1244"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-1245"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#f%5C0F%58F2%4E2D%5C0F%5206%985E%683C%4ED8"><span class="hs-identifier hs-var">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span></a><span> </span><a href="#local-6989586621679476262"><span class="hs-identifier hs-var">retail</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1246"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1247"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679476268"><a href="#local-6989586621679476268"><span class="hs-identifier">middle</span></a></a><span class="hs-special">,</span><a name="local-6989586621679476269"><a href="#local-6989586621679476269"><span class="hs-identifier">small</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1248"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476268"><span class="hs-identifier hs-var">middle</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;60&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><span class="hs-identifier hs-var">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476262"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476263"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476264"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1249"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476268"><span class="hs-identifier hs-var">middle</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%98F2%98DF%6599%54C1%5C0F%58F2%51E6%7406"><span class="hs-identifier hs-var">f&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#20966;&#29702;</span></a><span>           </span><a href="#local-6989586621679476262"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476263"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476264"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679476265"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679476266"><span class="hs-identifier hs-var">open</span></a><span>
</span><a name="line-1250"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476269"><span class="hs-identifier hs-var">small</span></a><span>  </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;603&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%30C9%30E9%30C3%30B0%30B9%30C8%30A2%51E6%7406"><span class="hs-identifier hs-var">f&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#20966;&#29702;</span></a><span>         </span><a href="#local-6989586621679476262"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476263"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476264"><span class="hs-identifier hs-var">area</span></a><span> </span><a href="#local-6989586621679476265"><span class="hs-identifier hs-var">self</span></a><span> </span><a href="#local-6989586621679476267"><span class="hs-identifier hs-var">shopType</span></a><span>
</span><a name="line-1251"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span>                </span><a href="#local-6989586621679476262"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476263"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476264"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1252"></a><span>
</span><a name="line-1253"></a><span>
</span><a name="line-1254"></a><span>
</span><a name="line-1255"></a><span class="hs-comment">-- | &#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12398;&#21508;&#36009;&#22770;</span><span>
</span><a name="line-1256"></a><span class="hs-comment">-- &#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;10&#65285;&#20197;&#19978;70&#65285;&#26410;&#28288;&#12398;&#21028;&#26029;</span><span>
</span><a name="line-1257"></a><span class="hs-identifier">more10Less70Every&#34920;3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1258"></a><a name="more10Less70Every%88683"><a href="VTable.Compliation.html#more10Less70Every%88683"><span class="hs-identifier">more10Less70Every&#34920;3</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1259"></a><span class="hs-identifier">more10Less70Every&#34920;3</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476270"><a href="#local-6989586621679476270"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1260"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1261"></a><span>        </span><a name="local-6989586621679476282"><a href="#local-6989586621679476282"><span class="hs-identifier">cloth</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476281"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476281"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><span>        </span><a name="local-6989586621679476284"><a href="#local-6989586621679476284"><span class="hs-identifier">food</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476283"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476283"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1263"></a><span>        </span><a name="local-6989586621679476286"><a href="#local-6989586621679476286"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476285"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476285"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1264"></a><span>
</span><a name="line-1265"></a><span>        </span><span class="hs-identifier hs-var">V.forM</span><span> </span><a href="#local-6989586621679476270"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476271"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679476282"><span class="hs-identifier hs-var">cloth</span></a><span> </span><a href="#local-6989586621679476284"><span class="hs-identifier hs-var">food</span></a><span> </span><a href="#local-6989586621679476286"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-1266"></a><span>
</span><a name="line-1267"></a><span>        </span><a name="local-6989586621679476287"><a href="#local-6989586621679476287"><span class="hs-identifier">allC</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476282"><span class="hs-identifier hs-var">cloth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476284"><span class="hs-identifier hs-var">food</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476286"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">]</span><span>
</span><a name="line-1268"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476288"><a href="#local-6989586621679476288"><span class="hs-identifier">more3Kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.filter</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476287"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1269"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476289"><a href="#local-6989586621679476289"><span class="hs-identifier">more10Less70P</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476290"><a href="#local-6989586621679476290"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476270"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1270"></a><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476291"><a href="#local-6989586621679476291"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="#local-6989586621679476290"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679476291"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679476290"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.7</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679476291"><span class="hs-identifier hs-var">x</span></a><span>  </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476287"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476288"><span class="hs-identifier hs-var">more3Kind</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679476289"><span class="hs-identifier hs-var">more10Less70P</span></a><span>
</span><a name="line-1272"></a><span>
</span><a name="line-1273"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1274"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1275"></a><span>    </span><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476272"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476272"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476272"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1276"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476272"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1277"></a><span>    </span><a name="local-6989586621679476271"><a href="#local-6989586621679476271"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679476273"><a href="#local-6989586621679476273"><span class="hs-identifier">cloth</span></a></a><span> </span><a name="local-6989586621679476274"><a href="#local-6989586621679476274"><span class="hs-identifier">food</span></a></a><span> </span><a name="local-6989586621679476275"><a href="#local-6989586621679476275"><span class="hs-identifier">other</span></a></a><span> </span><a name="local-6989586621679476276"><a href="#local-6989586621679476276"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-1278"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476277"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;57&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476273"><span class="hs-identifier hs-var">cloth</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476278"><a href="#local-6989586621679476278"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476278"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476276"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1279"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476277"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476274"><span class="hs-identifier hs-var">food</span></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476279"><a href="#local-6989586621679476279"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476279"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476276"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1280"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476277"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;59&quot;</span><span>  </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679476277"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;60&quot;</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476275"><span class="hs-identifier hs-var">other</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476280"><a href="#local-6989586621679476280"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476280"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476276"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1281"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1282"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">~</span><span> </span><a name="local-6989586621679476277"><a href="#local-6989586621679476277"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476276"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1283"></a><span>
</span><a name="line-1284"></a><span>
</span><a name="line-1285"></a><span>
</span><a name="line-1286"></a><span class="hs-comment">{- | &#12452; &#12300;5699 &#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#65288;&#24467;&#26989;&#32773;&#12364;&#24120;&#26178;50&#20154;&#26410;&#28288;&#12398;&#12418;&#12398;&#65289;&#12301;

&#34920;3&#12398;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#23567;&#22770;&#12426;&#12375;&#12289;&#12300;&#34915;&#12301;&#12289;&#12300;&#39135;&#12301;&#21450;&#12403;&#12300;&#20182;&#12301;&#12398;&#21508;&#36009;&#22770;
&#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#23567;&#22770;&#36009;&#22770;&#32207;&#38989;&#12398;50&#65285;&#26410;&#28288;&#12391;&#12289;&#24467;&#26989;&#32773;&#12364;50&#20154;&#26410;&#28288;&#12398;&#20107;&#26989;&#25152;

-}</span><span>
</span><a name="line-1292"></a><span>
</span><a name="line-1293"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1294"></a><a name="f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><a href="VTable.Compliation.html#f%305D%306E%4ED6%306E%5404%7A2E%5546%54C1%5C0F%58F2%696D%51E6%7406"><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#23567;&#22770;&#26989;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476292"><a href="#local-6989586621679476292"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476293"><a href="#local-6989586621679476293"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679476294"><a href="#local-6989586621679476294"><span class="hs-identifier">area</span></a></a><span>
</span><a name="line-1295"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#less50Every%88683"><span class="hs-identifier hs-var">less50Every&#34920;3</span></a><span> </span><a href="#local-6989586621679476292"><span class="hs-identifier hs-var">retail</span></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1296"></a><span>                             </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1297"></a><span>                             </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476292"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;5699&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476292"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476293"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679476294"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1299"></a><span>
</span><a name="line-1300"></a><span class="hs-identifier">less50Every&#34920;3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1301"></a><a name="less50Every%88683"><a href="VTable.Compliation.html#less50Every%88683"><span class="hs-identifier">less50Every&#34920;3</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1302"></a><span class="hs-identifier">less50Every&#34920;3</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476295"><a href="#local-6989586621679476295"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1303"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1304"></a><span>        </span><a name="local-6989586621679476307"><a href="#local-6989586621679476307"><span class="hs-identifier">cloth</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476306"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476306"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1305"></a><span>        </span><a name="local-6989586621679476309"><a href="#local-6989586621679476309"><span class="hs-identifier">food</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476308"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476308"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1306"></a><span>        </span><a name="local-6989586621679476311"><a href="#local-6989586621679476311"><span class="hs-identifier">other</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476310"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476310"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1307"></a><span>
</span><a name="line-1308"></a><span>        </span><span class="hs-identifier hs-var">V.forM</span><span> </span><a href="#local-6989586621679476295"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476296"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679476307"><span class="hs-identifier hs-var">cloth</span></a><span> </span><a href="#local-6989586621679476309"><span class="hs-identifier hs-var">food</span></a><span> </span><a href="#local-6989586621679476311"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-1309"></a><span>
</span><a name="line-1310"></a><span>        </span><a name="local-6989586621679476312"><a href="#local-6989586621679476312"><span class="hs-identifier">allC</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476307"><span class="hs-identifier hs-var">cloth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476309"><span class="hs-identifier hs-var">food</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476311"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">]</span><span>
</span><a name="line-1311"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476313"><a href="#local-6989586621679476313"><span class="hs-identifier">more3Kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.filter</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476312"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1312"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476314"><a href="#local-6989586621679476314"><span class="hs-identifier">less50P</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476295"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476312"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span>
</span><a name="line-1313"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476313"><span class="hs-identifier hs-var">more3Kind</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679476314"><span class="hs-identifier hs-var">less50P</span></a><span>
</span><a name="line-1314"></a><span>
</span><a name="line-1315"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1316"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1317"></a><span>    </span><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476297"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476297"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476297"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1318"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476297"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1319"></a><span>    </span><a name="local-6989586621679476296"><a href="#local-6989586621679476296"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679476298"><a href="#local-6989586621679476298"><span class="hs-identifier">cloth</span></a></a><span> </span><a name="local-6989586621679476299"><a href="#local-6989586621679476299"><span class="hs-identifier">food</span></a></a><span> </span><a name="local-6989586621679476300"><a href="#local-6989586621679476300"><span class="hs-identifier">other</span></a></a><span> </span><a name="local-6989586621679476301"><a href="#local-6989586621679476301"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-1320"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476302"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;57&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476298"><span class="hs-identifier hs-var">cloth</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476303"><a href="#local-6989586621679476303"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476303"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476301"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1321"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476302"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476299"><span class="hs-identifier hs-var">food</span></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476304"><a href="#local-6989586621679476304"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476304"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476301"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1322"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476302"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;59&quot;</span><span>  </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679476302"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;60&quot;</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476300"><span class="hs-identifier hs-var">other</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476305"><a href="#local-6989586621679476305"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476305"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476301"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1323"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1324"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476302"><a href="#local-6989586621679476302"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476301"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span class="hs-comment">{- | &#20197;&#19979;&#12398;,&#20966;&#29702;&#12398;&#12383;&#12417;&#12395;,&#20013;&#20998;&#39006;,&#23567;&#20998;&#39006;&#12391;&#19968;&#26086;&#26684;&#20184;&#12369;&#12434;&#34892;&#12358;.

&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#22580;&#21512;&#12399;,Nothing &#12434;&#36820;&#12377;
-}</span><span>
</span><a name="line-1330"></a><span>
</span><a name="line-1331"></a><span class="hs-identifier">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span>
</span><a name="line-1332"></a><a name="f%5C0F%58F2%4E2D%5C0F%5206%985E%683C%4ED8"><a href="VTable.Compliation.html#f%5C0F%58F2%4E2D%5C0F%5206%985E%683C%4ED8"><span class="hs-identifier">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1333"></a><span class="hs-identifier">f&#23567;&#22770;&#20013;&#23567;&#20998;&#39006;&#26684;&#20184;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476315"><a href="#local-6989586621679476315"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476317"><span class="hs-identifier hs-var">middle</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476316"><span class="hs-identifier hs-var">small</span></a><span class="hs-special">)</span><span>
</span><a name="line-1334"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1335"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476316"><a href="#local-6989586621679476316"><span class="hs-identifier">small</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#vmaximumNameWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNameWithoutErr</span></a><span>
</span><a name="line-1336"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span>
</span><a name="line-1337"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476318"><a href="#local-6989586621679476318"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476318"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476318"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476315"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1338"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476317"><a href="#local-6989586621679476317"><span class="hs-identifier">middle</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#vmaximumNameWithoutErr"><span class="hs-identifier hs-var">VDS.vmaximumNameWithoutErr</span></a><span>
</span><a name="line-1339"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#mergeSameNameCars"><span class="hs-identifier hs-var">mergeSameNameCars</span></a><span>
</span><a name="line-1340"></a><span>            </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476319"><a href="#local-6989586621679476319"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476319"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476319"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476315"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1341"></a><span>
</span><a name="line-1342"></a><span>
</span><a name="line-1343"></a><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span class="hs-comment">{- | &#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12398;&#20966;&#29702;
    * &#12458; &#12300;6031 &#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12301;

    &#23567;&#20998;&#39006;&#12300;603 &#21307;&#34220;&#21697;&#12539;&#21270;&#31911;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#20197;&#19979;&#12398;&#12356;&#12378;&#12428;&#12363;&#12398;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12390;&#12362;&#12426;&#12289;&#65378;6032 &#19968;&#33324;&#29992;&#21307;&#34220;&#21697;&#65379; &#12434;&#23567;&#22770;&#12426;&#12375;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12390;&#12362;&#12426;&#12289;&#12300;&#24215;&#33303;&#24418;&#24907;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#12301;&#12434;&#36984;&#25246;&#12375;&#12383;&#20107;&#26989;&#25152;
-}</span><span>
</span><a name="line-1354"></a><span>
</span><a name="line-1355"></a><span class="hs-identifier">f&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1356"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1357"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1358"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1359"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1360"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1361"></a><a name="f%30C9%30E9%30C3%30B0%30B9%30C8%30A2%51E6%7406"><a href="VTable.Compliation.html#f%30C9%30E9%30C3%30B0%30B9%30C8%30A2%51E6%7406"><span class="hs-identifier">f&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476320"><a href="#local-6989586621679476320"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476321"><a href="#local-6989586621679476321"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679476322"><a href="#local-6989586621679476322"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679476323"><a href="#local-6989586621679476323"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679476324"><a href="#local-6989586621679476324"><span class="hs-identifier">shopType</span></a></a><span>
</span><a name="line-1362"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679476323"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679476325"><span class="hs-identifier hs-var">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span></a><span> </span><a href="#local-6989586621679476324"><span class="hs-identifier hs-var">shopType</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476320"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;6031&quot;</span><span>
</span><a name="line-1363"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679476323"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679476327"><span class="hs-identifier hs-var">include</span></a><span> </span><a href="#local-6989586621679476320"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476320"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;6031&quot;</span><span>
</span><a name="line-1364"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476320"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476321"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679476322"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1365"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1366"></a><span>    </span><span class="hs-identifier">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1367"></a><span>    </span><a name="local-6989586621679476325"><a href="#local-6989586621679476325"><span class="hs-identifier">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1368"></a><span>    </span><span class="hs-identifier">is&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-var">V&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><a name="local-6989586621679476328"><a href="#local-6989586621679476328"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476328"><span class="hs-identifier hs-var">sk</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%30C9%30E9%30C3%30B0%30B9%30C8%30A2"><span class="hs-identifier hs-var">E&#12489;&#12521;&#12483;&#12464;&#12473;&#12488;&#12450;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1369"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1370"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1371"></a><span>    </span><span class="hs-identifier">included</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1372"></a><span>    </span><a name="local-6989586621679476326"><a href="#local-6989586621679476326"><span class="hs-identifier">included</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1373"></a><span>    </span><a name="local-6989586621679476327"><a href="#local-6989586621679476327"><span class="hs-identifier">include</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476329"><a href="#local-6989586621679476329"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679476330"><span class="hs-identifier hs-var">len</span></a><span>
</span><a name="line-1374"></a><span>                        </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476330"><a href="#local-6989586621679476330"><span class="hs-identifier">len</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.length</span><span>
</span><a name="line-1375"></a><span>                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476329"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1376"></a><span>                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476331"><a href="#local-6989586621679476331"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476331"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;6032&quot;</span><span>
</span><a name="line-1377"></a><span>
</span><a name="line-1378"></a><span>
</span><a name="line-1379"></a><span class="hs-comment">{- | &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12398;&#12392;&#12365;&#12398;&#20966;&#29702;

    *&#12300;5891 &#12467;&#12531;&#12499;&#12491;&#12456;&#12531;&#12473;&#12473;&#12488;&#12450;&#65288;&#39154;&#39135;&#26009;&#21697;&#12434;&#20013;&#24515;&#12392;&#12377;&#12427;&#12418;&#12398;&#12395;&#38480;&#12427;&#65289;&#12301;

    &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12289;&#22770;
    &#22580;&#38754;&#31309;&#12364;30&#13217;&#20197;&#19978;250&#13217;&#26410;&#28288;&#12391;&#12289;&#21942;&#26989;&#26178;&#38291;&#12364;14&#26178;&#38291;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

    *&#12300;5811 &#21508;&#31278;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;

    &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#34920;4&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;3&#26689;&#12391;&#20998;&#39006;
    &#38598;&#35336;&#12375;&#12383;&#23567;&#22770;&#36009;&#22770;&#38989;&#12364;3&#12388;&#20197;&#19978;&#12354;&#12426;&#12289;&#12381;&#12398;&#12356;&#12378;&#12428;&#12418;&#12364;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12300;58&#12301;&#65288;&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12395;&#23646;&#12377;
    &#12427;&#21697;&#30446;&#65289;&#12398;&#32207;&#38989;&#12398;50&#65285;&#12395;&#28288;&#12383;&#12394;&#12356;&#20107;&#26989;&#25152;


    *&#34920;4 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12392;&#21830;&#21697;&#20998;&#39006;

    &#29987;&#26989;&#20998;&#39006; &#21830;&#21697;&#20998;&#39006;&#30058;&#21495;

    &#19978;&#20301;3&#26689; &#20197;&#19979;&#12398;&#29987;&#26989;&#20998;&#39006;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;

    &gt; 58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;
    &gt; 582 &#37326;&#33756;&#12539;&#26524;&#23455;&#23567;&#22770;&#26989;
    &gt; 583 &#39135;&#32905;&#23567;&#22770;&#26989;
    &gt; 584 &#39854;&#39770;&#23567;&#22770;&#26989;
    &gt; 585 &#37202;&#23567;&#22770;&#26989;
    &gt; 586 &#33747;&#23376;&#12539;&#12497;&#12531;&#23567;&#22770;&#26989;
    &gt; 589 &#12381;&#12398;&#20182;&#12398;&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;
-}</span><span>
</span><a name="line-1407"></a><span>
</span><a name="line-1408"></a><span class="hs-identifier">f&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#20966;&#29702;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1409"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1410"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1411"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1412"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%958B%5E97%9589%5E97%671F%9593"><span class="hs-identifier hs-type">Val&#38283;&#24215;&#38281;&#24215;&#26399;&#38291;</span></a><span>
</span><a name="line-1413"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1414"></a><a name="f%98F2%98DF%6599%54C1%5C0F%58F2%51E6%7406"><a href="VTable.Compliation.html#f%98F2%98DF%6599%54C1%5C0F%58F2%51E6%7406"><span class="hs-identifier">f&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476332"><a href="#local-6989586621679476332"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476333"><a href="#local-6989586621679476333"><span class="hs-identifier">sellType</span></a></a><span> </span><a name="local-6989586621679476334"><a href="#local-6989586621679476334"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679476335"><a href="#local-6989586621679476335"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679476336"><a href="#local-6989586621679476336"><span class="hs-identifier">open</span></a></a><span>
</span><a name="line-1415"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679476335"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476337"><span class="hs-identifier hs-var">more30Less250</span></a><span> </span><a href="#local-6989586621679476334"><span class="hs-identifier hs-var">area</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476338"><span class="hs-identifier hs-var">more14hour</span></a><span> </span><a href="#local-6989586621679476336"><span class="hs-identifier hs-var">open</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1416"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1417"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476332"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;6091&quot;</span><span>
</span><a name="line-1418"></a><span>
</span><a name="line-1419"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#less50Every%88684"><span class="hs-identifier hs-var">less50Every&#34920;4</span></a><span> </span><a href="#local-6989586621679476332"><span class="hs-identifier hs-var">retail</span></a><span>                                         </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1420"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1421"></a><span>                                                                    </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476332"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;5811&quot;</span><span>
</span><a name="line-1422"></a><span>
</span><a name="line-1423"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                     </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476332"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476333"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679476334"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1424"></a><span>
</span><a name="line-1425"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1426"></a><span>    </span><span class="hs-comment">--  | &#22770;&#22580;&#38754;&#31309;&#12364;30&#13217;&#20197;&#19978;250&#13217;&#26410;&#28288; &#12398;&#21028;&#23450;</span><span>
</span><a name="line-1427"></a><span>    </span><span class="hs-identifier">more30Less250</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1428"></a><span>    </span><a name="local-6989586621679476337"><a href="#local-6989586621679476337"><span class="hs-identifier">more30Less250</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1429"></a><span>    </span><span class="hs-identifier">more30Less250</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476339"><a href="#local-6989586621679476339"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476339"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">30</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-number">250</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679476339"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1430"></a><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1431"></a><span>    </span><span class="hs-comment">-- | &#21942;&#26989;&#26178;&#38291;&#12364;14&#26178;&#38291;&#20197;&#19978;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-1432"></a><span>    </span><span class="hs-identifier">more14hour</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#ValInt"><span class="hs-identifier hs-type">ValInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1433"></a><span>    </span><a name="local-6989586621679476338"><a href="#local-6989586621679476338"><span class="hs-identifier">more14hour</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1434"></a><span>    </span><span class="hs-identifier">more14hour</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VInt"><span class="hs-identifier hs-var">VInt</span></a><span> </span><a name="local-6989586621679476340"><a href="#local-6989586621679476340"><span class="hs-identifier">num</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476340"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">14</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1435"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1436"></a><span>
</span><a name="line-1437"></a><span class="hs-comment">-- | &#20013;&#20998;&#39006;&#12300;58 &#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#34920;4&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;3&#26689;&#12391;&#20998;&#39006;</span><span>
</span><a name="line-1438"></a><span class="hs-comment">--   &#38598;&#35336;&#12375;&#12383;&#23567;&#22770;&#36009;&#22770;&#38989;&#12364;3&#12388;&#20197;&#19978;&#12354;&#12426;&#12289;&#12381;&#12398;&#12356;&#12378;&#12428;&#12418;&#12364;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12300;58&#12301;&#65288;&#39154;&#39135;&#26009;&#21697;&#23567;&#22770;&#26989;&#12395;&#23646;&#12377;</span><span>
</span><a name="line-1439"></a><span class="hs-comment">--   &#12427;&#21697;&#30446;&#65289;&#12398;&#32207;&#38989;&#12398;50&#65285;&#12395;&#28288;&#12383;&#12394;&#12356;&#20107;&#26989;&#25152;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-1440"></a><span>
</span><a name="line-1441"></a><span class="hs-identifier">less50Every&#34920;4</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1442"></a><a name="less50Every%88684"><a href="VTable.Compliation.html#less50Every%88684"><span class="hs-identifier">less50Every&#34920;4</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1443"></a><span class="hs-identifier">less50Every&#34920;4</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476341"><a href="#local-6989586621679476341"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1445"></a><span>        </span><a name="local-6989586621679476361"><a href="#local-6989586621679476361"><span class="hs-identifier">c582</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476360"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476360"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1446"></a><span>        </span><a name="local-6989586621679476363"><a href="#local-6989586621679476363"><span class="hs-identifier">c583</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476362"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476362"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span>        </span><a name="local-6989586621679476365"><a href="#local-6989586621679476365"><span class="hs-identifier">c584</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476364"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476364"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1448"></a><span>        </span><a name="local-6989586621679476367"><a href="#local-6989586621679476367"><span class="hs-identifier">c585</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476366"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476366"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1449"></a><span>        </span><a name="local-6989586621679476369"><a href="#local-6989586621679476369"><span class="hs-identifier">c586</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476368"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476368"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1450"></a><span>        </span><a name="local-6989586621679476371"><a href="#local-6989586621679476371"><span class="hs-identifier">c589</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476370"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476370"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><span>
</span><a name="line-1452"></a><span>        </span><span class="hs-identifier hs-var">V.forM</span><span> </span><a href="#local-6989586621679476341"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476343"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679476361"><span class="hs-identifier hs-var">c582</span></a><span> </span><a href="#local-6989586621679476363"><span class="hs-identifier hs-var">c583</span></a><span> </span><a href="#local-6989586621679476365"><span class="hs-identifier hs-var">c584</span></a><span> </span><a href="#local-6989586621679476367"><span class="hs-identifier hs-var">c585</span></a><span> </span><a href="#local-6989586621679476369"><span class="hs-identifier hs-var">c586</span></a><span> </span><a href="#local-6989586621679476371"><span class="hs-identifier hs-var">c589</span></a><span>
</span><a name="line-1453"></a><span>
</span><a name="line-1454"></a><span>        </span><a name="local-6989586621679476372"><a href="#local-6989586621679476372"><span class="hs-identifier">allC</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476361"><span class="hs-identifier hs-var">c582</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476363"><span class="hs-identifier hs-var">c583</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476365"><span class="hs-identifier hs-var">c584</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476367"><span class="hs-identifier hs-var">c585</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476369"><span class="hs-identifier hs-var">c586</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476371"><span class="hs-identifier hs-var">c589</span></a><span class="hs-special">]</span><span>
</span><a name="line-1455"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476373"><a href="#local-6989586621679476373"><span class="hs-identifier">more3Kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.filter</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476372"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1456"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476374"><a href="#local-6989586621679476374"><span class="hs-identifier">less50P</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476342"><span class="hs-identifier hs-var">totalTop58</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476372"><span class="hs-identifier hs-var">allC</span></a><span class="hs-special">)</span><span>
</span><a name="line-1457"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476373"><span class="hs-identifier hs-var">more3Kind</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679476374"><span class="hs-identifier hs-var">less50P</span></a><span>
</span><a name="line-1458"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1459"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476342"><a href="#local-6989586621679476342"><span class="hs-identifier">totalTop58</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span>
</span><a name="line-1460"></a><span>                </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476341"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1461"></a><span>                </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476345"><a href="#local-6989586621679476345"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476345"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;58&quot;</span><span>
</span><a name="line-1462"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1463"></a><span>    </span><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476344"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476344"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476344"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1464"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476344"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476344"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476344"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1465"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476344"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1466"></a><span>    </span><a name="local-6989586621679476343"><a href="#local-6989586621679476343"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679476346"><a href="#local-6989586621679476346"><span class="hs-identifier">c582</span></a></a><span> </span><a name="local-6989586621679476347"><a href="#local-6989586621679476347"><span class="hs-identifier">c583</span></a></a><span> </span><a name="local-6989586621679476348"><a href="#local-6989586621679476348"><span class="hs-identifier">c584</span></a></a><span> </span><a name="local-6989586621679476349"><a href="#local-6989586621679476349"><span class="hs-identifier">c585</span></a></a><span> </span><a name="local-6989586621679476350"><a href="#local-6989586621679476350"><span class="hs-identifier">c586</span></a></a><span> </span><a name="local-6989586621679476351"><a href="#local-6989586621679476351"><span class="hs-identifier">c589</span></a></a><span> </span><a name="local-6989586621679476352"><a href="#local-6989586621679476352"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-1467"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476353"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;582&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476346"><span class="hs-identifier hs-var">c582</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476354"><a href="#local-6989586621679476354"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476354"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476352"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1468"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476353"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;583&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476347"><span class="hs-identifier hs-var">c583</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476355"><a href="#local-6989586621679476355"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476355"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476352"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1469"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476353"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;584&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476348"><span class="hs-identifier hs-var">c584</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476356"><a href="#local-6989586621679476356"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476356"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476352"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476353"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;585&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476349"><span class="hs-identifier hs-var">c585</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476357"><a href="#local-6989586621679476357"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476357"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476352"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1471"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476353"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;586&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476350"><span class="hs-identifier hs-var">c586</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476358"><a href="#local-6989586621679476358"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476358"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476352"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1472"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476353"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;589&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476351"><span class="hs-identifier hs-var">c589</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476359"><a href="#local-6989586621679476359"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476359"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476352"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1473"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1474"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476353"><a href="#local-6989586621679476353"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476352"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-1475"></a><span>
</span><a name="line-1476"></a><span class="hs-comment">{- | &#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#20966;&#29702;
    &#20013;&#20998;&#39006;&#12300;60 &#12381;&#12398;&#20182;&#12398;&#23567;&#22770;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#12358;&#12385;&#12289;&#20197;&#19979;&#12398;&#12356;&#12378;&#12428;&#12363;&#12398;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12289;&#22770;&#22580;&#38754;&#31309;&#12364;500&#13217;&#20197;&#19978;&#12391;&#12289;&#37329;&#29289;&#12289;&#33618;&#29289;&#12289;&#33495;&#12539;&#31278;&#23376;&#12398;&#12356;&#12378;&#12428;&#12363;&#12434;&#23567;&#22770;&#12426;&#12375;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;

    &#12539; &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#26041;&#24335;&#12434;&#25505;&#29992;&#12375;&#12289;&#22770;&#22580;&#38754;&#31309;&#12364;500&#13217;&#20197;&#19978;&#12391;&#12289;&#12300;&#24215;&#33303;&#24418;&#24907;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#12301;&#12434;&#36984;&#25246;&#12375;&#12383;&#20107;&#26989;&#25152;

    &gt; 6021    &#37329;&#29289;&#23567;&#22770;&#26989;
    &gt; 6022    &#33618;&#29289;&#23567;&#22770;&#26989;
    &gt; 6042    &#33495;&#12539;&#31278;&#23376;&#23567;&#22770;&#26989;
    &gt; 6091    &#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;-}</span><span>
</span><a name="line-1487"></a><span>
</span><a name="line-1488"></a><span class="hs-identifier">f&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span>
</span><a name="line-1489"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span>
</span><a name="line-1490"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span>
</span><a name="line-1491"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span>
</span><a name="line-1492"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span>
</span><a name="line-1493"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1494"></a><a name="f%30DB%30FC%30E0%30BB%30F3%30BF%30FC%51E6%7406"><a href="VTable.Compliation.html#f%30DB%30FC%30E0%30BB%30F3%30BF%30FC%51E6%7406"><span class="hs-identifier">f&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476375"><a href="#local-6989586621679476375"><span class="hs-identifier">self</span></a></a><span> </span><a name="local-6989586621679476376"><a href="#local-6989586621679476376"><span class="hs-identifier">area</span></a></a><span> </span><a name="local-6989586621679476377"><a href="#local-6989586621679476377"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679476378"><a href="#local-6989586621679476378"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476379"><a href="#local-6989586621679476379"><span class="hs-identifier">sellType</span></a></a><span>
</span><a name="line-1495"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476380"><span class="hs-identifier hs-var">tempBool</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cars</span><span> </span><a href="#local-6989586621679476378"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;6091&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1496"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476378"><span class="hs-identifier hs-var">retail</span></a><span> </span><a href="#local-6989586621679476379"><span class="hs-identifier hs-var">sellType</span></a><span>  </span><a href="#local-6989586621679476376"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-1497"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1498"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476380"><a href="#local-6989586621679476380"><span class="hs-identifier">tempBool</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#is%30BB%30EB%30D5"><span class="hs-identifier hs-var">is&#12475;&#12523;&#12501;</span></a><span> </span><a href="#local-6989586621679476375"><span class="hs-identifier hs-var">self</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476382"><span class="hs-identifier hs-var">more500</span></a><span> </span><a href="#local-6989586621679476376"><span class="hs-identifier hs-var">area</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476381"><span class="hs-identifier hs-var">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span></a><span> </span><a href="#local-6989586621679476377"><span class="hs-identifier hs-var">shopType</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679476383"><span class="hs-identifier hs-var">inclued</span></a><span> </span><a href="#local-6989586621679476378"><span class="hs-identifier hs-var">retail</span></a><span class="hs-special">)</span><span>
</span><a name="line-1499"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1500"></a><span>    </span><span class="hs-identifier">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1501"></a><span>    </span><a name="local-6989586621679476381"><a href="#local-6989586621679476381"><span class="hs-identifier">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1502"></a><span>    </span><span class="hs-identifier">is&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5E97%8217%5F62%614B_%5546%696D"><span class="hs-identifier hs-var">V&#24215;&#33303;&#24418;&#24907;_&#21830;&#26989;</span></a><span> </span><a name="local-6989586621679476384"><a href="#local-6989586621679476384"><span class="hs-identifier">sk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476384"><span class="hs-identifier hs-var">sk</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%30DB%30FC%30E0%30BB%30F3%30BF%30FC"><span class="hs-identifier hs-var">E&#12507;&#12540;&#12512;&#12475;&#12531;&#12479;&#12540;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1503"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1504"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1505"></a><span>    </span><span class="hs-identifier">more500</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1506"></a><span>    </span><a name="local-6989586621679476382"><a href="#local-6989586621679476382"><span class="hs-identifier">more500</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1507"></a><span>    </span><span class="hs-identifier">more500</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476385"><a href="#local-6989586621679476385"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476385"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span>  </span><span class="hs-number">500</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1508"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1509"></a><span>    </span><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1510"></a><span>    </span><span class="hs-identifier">inclued</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1511"></a><span>    </span><a name="local-6989586621679476383"><a href="#local-6989586621679476383"><span class="hs-identifier">inclued</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1512"></a><span>    </span><span class="hs-identifier">inclued</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476386"><a href="#local-6989586621679476386"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476387"><a href="#local-6989586621679476387"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476386"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1513"></a><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">L.or</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476388"><a href="#local-6989586621679476388"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><a href="#local-6989586621679476388"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476387"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span>
</span><a name="line-1514"></a><span>                       </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;6021&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;6022&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;6042&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1515"></a><span>
</span><a name="line-1516"></a><span>
</span><a name="line-1517"></a><span class="hs-comment">-- | &#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;&#12363;&#21542;&#12363;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-1518"></a><span class="hs-identifier">is&#12475;&#12523;&#12501;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%30BB%30EB%30D5%30B5%30FC%30D3%30B9"><span class="hs-identifier hs-type">Val&#12475;&#12523;&#12501;&#12469;&#12540;&#12499;&#12473;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1519"></a><a name="is%30BB%30EB%30D5"><a href="VTable.Compliation.html#is%30BB%30EB%30D5"><span class="hs-identifier">is&#12475;&#12523;&#12501;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1520"></a><span class="hs-identifier">is&#12475;&#12523;&#12501;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><a name="local-6989586621679476389"><a href="#local-6989586621679476389"><span class="hs-identifier">bl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476389"><span class="hs-identifier hs-var">bl</span></a><span>
</span><a name="line-1521"></a><span>
</span><a name="line-1522"></a><span>
</span><a name="line-1523"></a><span class="hs-comment">{- | &#28961;&#24215;&#33303;&#20966;&#29702;
    * &#12300;61 &#28961;&#24215;&#33303;&#23567;&#22770;&#26989;&#12301;
    &#36009;&#22770;&#24418;&#24907;&#12398;&#24215;&#38957;&#36009;&#22770;&#12398;&#21106;&#21512;&#12364;0&#65285;&#21450;&#12403;&#22770;&#22580;&#38754;&#31309;&#12364;0&#13217;&#12398;&#20107;&#26989;&#25152;

    &#33258;&#21205;&#36009;&#22770;&#27231;,&#12381;&#12398;&#20182;&#12395;&#38306;&#12375;&#12390;&#12399;,&#12381;&#12398;&#12414;&#12414;Car&#12395;&#36861;&#21152;&#12377;&#12427;

    6121    &#33258;&#21205;&#36009;&#22770;&#27231;&#12395;&#12424;&#12427;&#23567;&#22770;&#26989;

    6199    &#12381;&#12398;&#20182;&#12398;&#28961;&#24215;&#33303;&#23567;&#22770;&#26989;

    &#28961;&#24215;&#33303;&#12391;&#12394;&#12356;&#12418;&#12398;&#12399;&#35519;&#26619;&#21697;&#30446;&#21517; = &#29987;&#26989;&#32048;&#20998;&#39006;&#12394;&#12398;&#12391;&#12381;&#12398;&#12414;&#12414;&#29992;&#12356;&#12427;

    -}</span><span>
</span><a name="line-1536"></a><span>
</span><a name="line-1537"></a><span class="hs-identifier">f&#28961;&#24215;&#33303;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1538"></a><a name="f%7121%5E97%8217%51E6%7406"><a href="VTable.Compliation.html#f%7121%5E97%8217%51E6%7406"><span class="hs-identifier">f&#28961;&#24215;&#33303;&#20966;&#29702;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1539"></a><span class="hs-identifier">f&#28961;&#24215;&#33303;&#20966;&#29702;</span><span> </span><a name="local-6989586621679476390"><a href="#local-6989586621679476390"><span class="hs-identifier">retail</span></a></a><span> </span><a name="local-6989586621679476391"><a href="#local-6989586621679476391"><span class="hs-identifier">sellType</span></a></a><span>  </span><a name="local-6989586621679476392"><a href="#local-6989586621679476392"><span class="hs-identifier">area</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1540"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476397"><span class="hs-identifier hs-var">is&#28961;&#24215;&#33303;</span></a><span> </span><a href="#local-6989586621679476391"><span class="hs-identifier hs-var">sellType</span></a><span> </span><a href="#local-6989586621679476392"><span class="hs-identifier hs-var">area</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1541"></a><span>            </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476391"><span class="hs-identifier hs-var">sellType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476390"><span class="hs-identifier hs-var">retail</span></a><span>
</span><a name="line-1542"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#appendVCars"><span class="hs-identifier hs-var">appendVCars</span></a><span> </span><a href="#local-6989586621679476395"><span class="hs-identifier hs-var">outAndOth</span></a><span> </span><a href="#local-6989586621679476390"><span class="hs-identifier hs-var">retail</span></a><span>
</span><a name="line-1543"></a><span>
</span><a name="line-1544"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476391"><span class="hs-identifier hs-var">sellType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>                         </span><a href="#local-6989586621679476396"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span></a><span> </span><a href="#local-6989586621679476390"><span class="hs-identifier hs-var">retail</span></a><span>
</span><a name="line-1545"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#appendVCars"><span class="hs-identifier hs-var">appendVCars</span></a><span> </span><a href="#local-6989586621679476395"><span class="hs-identifier hs-var">outAndOth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476396"><span class="hs-identifier hs-var">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span></a><span> </span><a href="#local-6989586621679476390"><span class="hs-identifier hs-var">retail</span></a><span>
</span><a name="line-1546"></a><span>
</span><a name="line-1547"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1548"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476393"><a href="#local-6989586621679476393"><span class="hs-identifier">outo</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_&#33258;&#21205;&#36009;&#22770;&#27231;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">_&#36009;&#22770;&#24418;&#24907;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476391"><span class="hs-identifier hs-var">sellType</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;6121&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1549"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476394"><a href="#local-6989586621679476394"><span class="hs-identifier">oth</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_&#12381;&#12398;&#20182;&#36009;&#22770;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">_&#36009;&#22770;&#24418;&#24907;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476391"><span class="hs-identifier hs-var">sellType</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;6199&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1550"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476395"><a href="#local-6989586621679476395"><span class="hs-identifier">outAndOth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476393"><span class="hs-identifier hs-var">outo</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476394"><span class="hs-identifier hs-var">oth</span></a><span class="hs-special">]</span><span>
</span><a name="line-1551"></a><span>
</span><a name="line-1552"></a><span>    </span><span class="hs-identifier">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5C0F%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#23567;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1553"></a><span>    </span><a name="local-6989586621679476396"><a href="#local-6989586621679476396"><span class="hs-identifier">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1554"></a><span>    </span><span class="hs-identifier">f&#28961;&#24215;&#33303;&#23567;&#22770;&#25391;&#26367;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476398"><a href="#local-6989586621679476398"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679476398"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VTable.Data.Classification.html#dd%7121%5E97%8217%5C0F%58F2%696D"><span class="hs-identifier hs-var">dd&#28961;&#24215;&#33303;&#23567;&#22770;&#26989;</span></a><span>
</span><a name="line-1555"></a><span>
</span><a name="line-1556"></a><span>    </span><span class="hs-comment">--  | &#28961;&#24215;&#33303;&#12363;&#21542;&#12363;&#12398;&#21028;&#26029;</span><span>
</span><a name="line-1557"></a><span>    </span><span class="hs-identifier">is&#28961;&#24215;&#33303;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-type">Val&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%58F2%5834%9762%7A4D"><span class="hs-identifier hs-type">Val&#22770;&#22580;&#38754;&#31309;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1558"></a><span>    </span><a name="local-6989586621679476397"><a href="#local-6989586621679476397"><span class="hs-identifier">is&#28961;&#24215;&#33303;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1559"></a><span>    </span><span class="hs-identifier">is&#28961;&#24215;&#33303;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%8CA9%58F2%5F62%614B"><span class="hs-identifier hs-var">V&#36009;&#22770;&#24418;&#24907;</span></a><span> </span><a name="local-6989586621679476399"><a href="#local-6989586621679476399"><span class="hs-identifier">sell</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#24215;&#38957;&#36009;&#22770;</span><span> </span><a href="#local-6989586621679476399"><span class="hs-identifier hs-var">sell</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1560"></a><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1561"></a><span>    </span><span class="hs-identifier">is&#28961;&#24215;&#33303;</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476400"><a href="#local-6989586621679476400"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476400"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1562"></a><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1563"></a><span>
</span><a name="line-1564"></a><span>
</span><a name="line-1565"></a><span>
</span><a name="line-1566"></a><span class="hs-comment">-- **** &#21368;&#22770;&#26989;</span><span>
</span><a name="line-1567"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-1568"></a><span class="hs-comment">{- | &#21368;&#22770;&#26989;&#12398;&#20966;&#29702;
    * &#12454; &#12300;5598 &#20195;&#29702;&#21830;&#65292;&#20210;&#31435;&#26989;&#12301;

    &#21368;&#22770;&#12398;&#21830;&#21697;&#36009;&#22770;&#38989;&#65288;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#38500;&#12367;&#12290;&#65289;&#12392;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#27604;&#36611;&#12375;&#12289;&#20210;&#31435;&#25163;&#25968;&#26009;&#12364;&#22810;&#12356;&#22580;&#21512;&#12395;&#12300;&#20195;
&#29702;&#21830;&#65292;&#20210;&#31435;&#26989;&#12301;&#12395;&#26684;&#20184;&#12369;&#12377;&#12427;&#12290;
-}</span><span>
</span><a name="line-1574"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1575"></a><a name="f%5378%58F2%51E6%7406"><a href="VTable.Compliation.html#f%5378%58F2%51E6%7406"><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1576"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;</span><span> </span><a name="local-6989586621679476401"><a href="#local-6989586621679476401"><span class="hs-identifier">middle</span></a></a><span> </span><a name="local-6989586621679476402"><a href="#local-6989586621679476402"><span class="hs-identifier">wholesale</span></a></a><span> </span><a name="local-6989586621679476403"><a href="#local-6989586621679476403"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-1577"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#canBe%5404%7A2E%5546%54C1%5378%58F2%696D"><span class="hs-identifier hs-var">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span></a><span> </span><a href="#local-6989586621679476402"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#appendVCars"><span class="hs-identifier hs-var">VDS.appendVCars</span></a><span> </span><a href="#local-6989586621679476404"><span class="hs-identifier hs-var">mid</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#f%5378%58F2%51E6%74062"><span class="hs-identifier hs-var">f&#21368;&#22770;&#20966;&#29702;2</span></a><span> </span><a href="#local-6989586621679476402"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><a href="#local-6989586621679476403"><span class="hs-identifier hs-var">worker</span></a><span>
</span><a name="line-1578"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#appendVCars"><span class="hs-identifier hs-var">VDS.appendVCars</span></a><span> </span><a href="#local-6989586621679476404"><span class="hs-identifier hs-var">mid</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476404"><span class="hs-identifier hs-var">mid</span></a><span>
</span><a name="line-1579"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476404"><a href="#local-6989586621679476404"><span class="hs-identifier">mid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#make%4EE3%7406%5546"><span class="hs-identifier hs-var">make&#20195;&#29702;&#21830;</span></a><span> </span><a href="#local-6989586621679476401"><span class="hs-identifier hs-var">middle</span></a><span>
</span><a name="line-1580"></a><span>
</span><a name="line-1581"></a><span>
</span><a name="line-1582"></a><span>
</span><a name="line-1583"></a><span class="hs-comment">{- |
    * &#12300;5011 &#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#65288;&#24467;&#26989;&#32773;&#12364;&#24120;&#26178;100&#20154;&#20197;&#19978;&#12398;&#12418;&#12398;&#65289;&#12301;
    &#34920;2&#12398;&#36001;&#21029;&#65288;&#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#65289;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#21368;&#22770;&#12426;&#12375;&#12289;&#21508;&#36001;&#12398;&#36009;&#22770;&#38989;&#12364;&#12356;&#12378;&#12428;
    &#12418;&#21368;&#22770;&#36009;&#22770;&#32207;&#38989;&#65288;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#38500;&#12367;&#12290;&#65289;&#12398;10&#65285;&#20197;&#19978;&#12391;&#12289;&#24467;&#26989;&#32773;&#12364;100&#20154;&#20197;&#19978;&#12398;&#20107;&#26989;&#25152;

    * &#12300;5019 &#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;&#12301;
    &#34920;2&#12398;&#36001;&#21029;&#65288;&#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#65289;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#21368;&#22770;&#12426;&#12375;&#12289;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#19978;&#20301;3&#26689;
    &#12398;&#36009;&#22770;&#38989;&#12391;&#20998;&#39006;&#38598;&#35336;&#12375;&#12383;&#36009;&#22770;&#38989;&#12364;&#12356;&#12378;&#12428;&#12418;&#21368;&#22770;&#36009;&#22770;&#32207;&#38989;&#65288;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#38500;&#12367;&#12290;&#65289;&#12398;50&#65285;&#26410;&#28288;&#12391;&#12289;&#24467;
    &#26989;&#32773;&#12364;100&#20154;&#26410;&#28288;&#12398;&#20107;&#26989;&#25152;

    * &#34920;2 &#36001;&#21029;&#12392;&#21830;&#21697;&#20998;&#39006;

    +--------+--------------------+-----+
    | &#21830;&#21697;&#20998;&#39006;&#30058;&#21495; | &#20197;&#19979;&#12398;&#29987;&#26989;&#20998;&#39006;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;      | &#36001;&#21029;  |
    |   &#19978;&#20301;3&#26689; |                    |     |
    +========+====================+=====+
    | 511    | &#32330;&#32173;&#21697;&#21368;&#22770;&#26989;&#65288;&#34915;&#26381;&#65292;&#36523;&#12398;&#22238;&#12426;&#21697;&#12434;&#38500;&#12367;&#65289;| &#29983;&#29987;&#36001; |
    +--------+--------------------+     |
    | 532    | &#21270;&#23398;&#35069;&#21697;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+     |
    | 533    | &#30707;&#27833;&#12539;&#37489;&#29289;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 534    | &#37444;&#37628;&#35069;&#21697;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+     |
    | 535    | &#38750;&#37444;&#37329;&#23646;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+     |
    | 536    | &#20877;&#29983;&#36039;&#28304;&#21368;&#22770;&#26989;            |     |
    +--------+--------------------+-----+
    | 531    | &#24314;&#31689;&#26448;&#26009;&#21368;&#22770;&#26989;            | &#36039;&#26412;&#36001; |
    +--------+--------------------+     |
    | 541    | &#29987;&#26989;&#27231;&#26800;&#22120;&#20855;&#21368;&#22770;&#26989;          |     |
    +--------+--------------------+     |
    | 542    | &#33258;&#21205;&#36554;&#21368;&#22770;&#26989;             |     |
    +--------+--------------------+     |
    | 543    | &#38651;&#27671;&#27231;&#26800;&#22120;&#20855;&#21368;&#22770;&#26989;          |     |
    +--------+--------------------+     |
    | 549    | &#12381;&#12398;&#20182;&#12398;&#27231;&#26800;&#22120;&#20855;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+-----+
    | 512    | &#34915;&#26381;&#21368;&#22770;&#26989;              | &#28040;&#36027;&#36001; |
    +--------+--------------------+     |
    | 513    | &#36523;&#12398;&#22238;&#12426;&#21697;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 521    | &#36786;&#30044;&#29987;&#29289;&#12539;&#27700;&#29987;&#29289;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+     |
    | 522    | &#39135;&#26009;&#12539;&#39154;&#26009;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 551    | &#23478;&#20855;&#12539;&#24314;&#20855;&#12539;&#12376;&#12421;&#12358;&#22120;&#31561;&#21368;&#22770;&#26989;     |     |
    +--------+--------------------+     |
    | 552    | &#21307;&#34220;&#21697;&#12539;&#21270;&#31911;&#21697;&#31561;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+     |
    | 553    | &#32025;&#12539;&#32025;&#35069;&#21697;&#21368;&#22770;&#26989;           |     |
    +--------+--------------------+     |
    | 559    | &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#21368;&#22770;&#26989;        |     |
    +--------+--------------------+-----+


    &#12394;&#12362;&#12289;&#19978;&#35352;&#12450;&#12289;&#12452;&#12395;&#12388;&#12356;&#12390;&#12289;&#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#25201;&#12387;&#12390;&#12356;&#12390;&#12418;&#12289;&#29983;&#29987;
    &#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12364;&#12300;536&#12301;&#65288;&#20877;&#29983;&#36039;&#28304;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12289;&#12414;&#12383;&#12399;&#12289;&#28040;&#36027;&#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;
    &#12364;&#12300;559&#12301;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12398;&#22580;&#21512;&#12395;&#12399;&#12289;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12424;&#12427;&#21368;&#22770;&#26989;&#26684;
    &#20184;&#12369;&#12392;&#12377;&#12427;&#12290;
-}</span><span>
</span><a name="line-1644"></a><span>
</span><a name="line-1645"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1646"></a><a name="f%5378%58F2%51E6%74062"><a href="VTable.Compliation.html#f%5378%58F2%51E6%74062"><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;2</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1647"></a><span class="hs-identifier">f&#21368;&#22770;&#20966;&#29702;2</span><span> </span><a name="local-6989586621679476405"><a href="#local-6989586621679476405"><span class="hs-identifier">wholesale</span></a></a><span> </span><a name="local-6989586621679476406"><a href="#local-6989586621679476406"><span class="hs-identifier">worker</span></a></a><span>
</span><a name="line-1648"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#more100%5F93%696D%54E1"><span class="hs-identifier hs-var">more100&#24467;&#26989;&#21729;</span></a><span> </span><a href="#local-6989586621679476406"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1649"></a><span>        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#less50Every3%8CA1"><span class="hs-identifier hs-var">less50Every3&#36001;</span></a><span> </span><a href="#local-6989586621679476405"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1650"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1651"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476405"><span class="hs-identifier hs-var">wholesale</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;5019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1652"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476405"><span class="hs-identifier hs-var">wholesale</span></a><span>
</span><a name="line-1653"></a><span>
</span><a name="line-1654"></a><span>        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#more10Every3%8CA1"><span class="hs-identifier hs-var">more10Every3&#36001;</span></a><span> </span><a href="#local-6989586621679476405"><span class="hs-identifier hs-var">wholesale</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1655"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1656"></a><span>                                         </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumValCars"><span class="hs-identifier hs-var">sumValCars</span></a><span> </span><a href="#local-6989586621679476405"><span class="hs-identifier hs-var">wholesale</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;5011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1657"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476405"><span class="hs-identifier hs-var">wholesale</span></a><span>
</span><a name="line-1658"></a><span>
</span><a name="line-1659"></a><span>
</span><a name="line-1660"></a><span class="hs-comment">-- | &#20195;&#29702;&#21830;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1661"></a><span class="hs-comment">-- &#21028;&#23450;&#12375;&#12394;&#12367;&#12390;&#12418;&#21213;&#25163;&#12395;,&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12391;&#20195;&#29702;&#21830;&#12395;&#12394;&#12427;&#12398;&#12391;,&#20316;&#12427;</span><span>
</span><a name="line-1662"></a><span class="hs-identifier">make&#20195;&#29702;&#21830;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4EF2%7ACB%624B%6570%6599%53CE%5165_%5546%696D"><span class="hs-identifier hs-type">Val&#20210;&#31435;&#25163;&#25968;&#26009;&#21454;&#20837;_&#21830;&#26989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-1663"></a><a name="make%4EE3%7406%5546"><a href="VTable.Compliation.html#make%4EE3%7406%5546"><span class="hs-identifier">make&#20195;&#29702;&#21830;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1664"></a><span class="hs-identifier">make&#20195;&#29702;&#21830;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476407"><a href="#local-6989586621679476407"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476407"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;5598&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1665"></a><span>
</span><a name="line-1666"></a><span class="hs-comment">{- | &#29983;&#29987;&#36001;&#12289;&#36039;&#26412;&#36001;&#21450;&#12403;&#28040;&#36027;&#36001;&#12398;3&#36001;&#12395;&#12431;&#12383;&#12427;&#21830;&#21697;&#12434;&#25201;&#12387;&#12390;&#12356;&#12427;&#12363;&#21028;&#23450;

    &#29983;&#29987;&#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;&#12364;&#12300;536&#12301;&#65288;&#20877;&#29983;&#36039;&#28304;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12289;&#12414;&#12383;&#12399;&#12289;&#28040;&#36027;&#36001;&#12398;&#21830;&#21697;&#20998;&#39006;&#30058;&#21495;
    &#12364;&#12300;559&#12301;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#21368;&#22770;&#26989;&#12395;&#23646;&#12377;&#12427;&#21697;&#30446;&#65289;&#12398;&#12415;&#12398;&#22580;&#21512;&#12395;&#12399;&#12289;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12395;&#12424;&#12427;&#21368;&#22770;&#26989;&#26684;
    &#20184;&#12369;&#12392;&#12377;&#12427;&#12290;

&#29983;&#29987;&#36001;,&#36039;&#26412;&#36001;,&#28040;&#36027;&#36001;&#12381;&#12428;&#12382;&#12428;&#12434;&#32032;&#25968;&#12395;&#22793;&#25563;&#12375;,&#12381;&#12398;&#31309;&#12395;&#23550;&#12375;&#12390;,&#26368;&#23567;&#20844;&#20493;&#25968;&#12398;&#12354;&#12414;&#12426;&#12434;&#12392;&#12387;&#12390;0&#12394;&#12425;,3&#36001;&#20840;&#12390;&#21547;&#12414;&#12428;&#12427;&#12392;&#35328;&#12358;&#21028;&#23450;.
-}</span><span>
</span><a name="line-1674"></a><span class="hs-identifier">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1675"></a><a name="canBe%5404%7A2E%5546%54C1%5378%58F2%696D"><a href="VTable.Compliation.html#canBe%5404%7A2E%5546%54C1%5378%58F2%696D"><span class="hs-identifier">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1676"></a><span class="hs-identifier">canBe&#21508;&#31278;&#21830;&#21697;&#21368;&#22770;&#26989;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476408"><a href="#local-6989586621679476408"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1677"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476409"><a href="#local-6989586621679476409"><span class="hs-identifier">cs2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476410"><a href="#local-6989586621679476410"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476410"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;536&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476410"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;559&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476408"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1678"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1679"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">mod</span><span class="hs-special">)</span><span> </span><span class="hs-number">30</span><span>
</span><a name="line-1680"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.foldl1</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span>
</span><a name="line-1681"></a><span>    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.map</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476409"><span class="hs-identifier hs-var">cs2</span></a><span>
</span><a name="line-1682"></a><span>    </span><span class="hs-operator hs-var">$</span><span>  </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476411"><a href="#local-6989586621679476411"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476411"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#ge%5378%58F2%8CA1%5225%5546%54C1"><span class="hs-identifier hs-var">VDC.ge&#21368;&#22770;&#36001;&#21029;&#21830;&#21697;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1683"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1684"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476412"><a href="#local-6989586621679476412"><span class="hs-identifier">ez</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476412"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%751F%7523%8CA1"><span class="hs-identifier hs-var">E&#29983;&#29987;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-1685"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476412"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%8CC7%672C%8CA1"><span class="hs-identifier hs-var">E&#36039;&#26412;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-1686"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476412"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%6D88%8CBB%8CA1"><span class="hs-identifier hs-var">E&#28040;&#36027;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">5</span><span>
</span><a name="line-1687"></a><span>
</span><a name="line-1688"></a><span class="hs-comment">-- | &#24467;&#26989;&#21729;(&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;)&#12364;100&#20154;&#20197;&#19978;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1689"></a><span class="hs-identifier">more100&#24467;&#26989;&#21729;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1690"></a><a name="more100%5F93%696D%54E1"><a href="VTable.Compliation.html#more100%5F93%696D%54E1"><span class="hs-identifier">more100&#24467;&#26989;&#21729;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1691"></a><span class="hs-identifier">more100&#24467;&#26989;&#21729;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679476413"><a href="#local-6989586621679476413"><span class="hs-identifier">em</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#20225;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679476413"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679476413"><span class="hs-identifier hs-var">em</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1692"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1693"></a><span>
</span><a name="line-1694"></a><span>
</span><a name="line-1695"></a><span class="hs-comment">-- | 3&#36001;&#12364;&#12381;&#12428;&#12382;&#12428;&#32207;&#38989;&#12398;10%&#20197;&#19978;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1696"></a><span class="hs-identifier">more10Every3&#36001;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1697"></a><a name="more10Every3%8CA1"><a href="VTable.Compliation.html#more10Every3%8CA1"><span class="hs-identifier">more10Every3&#36001;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1698"></a><span class="hs-identifier">more10Every3&#36001;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476414"><a href="#local-6989586621679476414"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1699"></a><span>                         </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476415"><a href="#local-6989586621679476415"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476414"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1700"></a><span>                         </span><a name="local-6989586621679476417"><a href="#local-6989586621679476417"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476416"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476416"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1701"></a><span>                         </span><a name="local-6989586621679476419"><a href="#local-6989586621679476419"><span class="hs-identifier">cap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476418"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476418"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1702"></a><span>                         </span><a name="local-6989586621679476421"><a href="#local-6989586621679476421"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476420"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476420"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1703"></a><span>                         </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679476414"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476422"><a href="#local-6989586621679476422"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1704"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476422"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#ge%5378%58F2%8CA1%5225%5546%54C1"><span class="hs-identifier hs-var">VDC.ge&#21368;&#22770;&#36001;&#21029;&#21830;&#21697;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1705"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1706"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476423"><a href="#local-6989586621679476423"><span class="hs-identifier">ez</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476423"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%751F%7523%8CA1"><span class="hs-identifier hs-var">E&#29983;&#29987;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476417"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476424"><a href="#local-6989586621679476424"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476424"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476422"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1707"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476423"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%8CC7%672C%8CA1"><span class="hs-identifier hs-var">E&#36039;&#26412;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476417"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476425"><a href="#local-6989586621679476425"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476425"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476422"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1708"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476423"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%6D88%8CBB%8CA1"><span class="hs-identifier hs-var">E&#28040;&#36027;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476417"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476426"><a href="#local-6989586621679476426"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476426"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476422"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1709"></a><span>                         </span><a name="local-6989586621679476427"><a href="#local-6989586621679476427"><span class="hs-identifier">inp'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476417"><span class="hs-identifier hs-var">inp</span></a><span>
</span><a name="line-1710"></a><span>                         </span><a name="local-6989586621679476428"><a href="#local-6989586621679476428"><span class="hs-identifier">cap'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476419"><span class="hs-identifier hs-var">cap</span></a><span>
</span><a name="line-1711"></a><span>                         </span><a name="local-6989586621679476429"><a href="#local-6989586621679476429"><span class="hs-identifier">con'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476421"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1712"></a><span>                         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476415"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476427"><span class="hs-identifier hs-var">inp'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476428"><span class="hs-identifier hs-var">cap'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476429"><span class="hs-identifier hs-var">con'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1713"></a><span>
</span><a name="line-1714"></a><span>
</span><a name="line-1715"></a><span class="hs-comment">-- | 3&#36001;&#12364;&#12381;&#12428;&#12382;&#12428;&#32207;&#38989;&#12398;50%&#20197;&#19979;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1716"></a><span class="hs-comment">-- 24&#24180;&#12399;28&#24180;&#12424;&#12426;&#21830;&#21697;&#20998;&#39006;&#12398;&#26689;&#25968;&#12364;&#19968;&#12388;&#22823;&#12365;&#12356;&#12398;&#12391;,&#19977;&#26689;&#12395;&#22793;&#25563;&#12375;&#12390;,&#21516;&#27096;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;.</span><span>
</span><a name="line-1717"></a><span class="hs-identifier">less50Every3&#36001;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%5378%58F2%984D"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#21368;&#22770;&#38989;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1718"></a><a name="less50Every3%8CA1"><a href="VTable.Compliation.html#less50Every3%8CA1"><span class="hs-identifier">less50Every3&#36001;</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1719"></a><span class="hs-identifier">less50Every3&#36001;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476430"><a href="#local-6989586621679476430"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1720"></a><span>                         </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476431"><a href="#local-6989586621679476431"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476430"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1721"></a><span>                         </span><a name="local-6989586621679476433"><a href="#local-6989586621679476433"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476432"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476432"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1722"></a><span>                         </span><a name="local-6989586621679476435"><a href="#local-6989586621679476435"><span class="hs-identifier">cap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476434"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476434"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1723"></a><span>                         </span><a name="local-6989586621679476437"><a href="#local-6989586621679476437"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476436"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476436"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-1724"></a><span>                         </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679476430"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476438"><a href="#local-6989586621679476438"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1725"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476438"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#ge%5378%58F2%8CA1%5225%5546%54C1"><span class="hs-identifier hs-var">VDC.ge&#21368;&#22770;&#36001;&#21029;&#21830;&#21697;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1726"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1727"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476439"><a href="#local-6989586621679476439"><span class="hs-identifier">ez</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476439"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%751F%7523%8CA1"><span class="hs-identifier hs-var">E&#29983;&#29987;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476433"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476440"><a href="#local-6989586621679476440"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476440"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476438"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1728"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476439"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%8CC7%672C%8CA1"><span class="hs-identifier hs-var">E&#36039;&#26412;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476433"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476441"><a href="#local-6989586621679476441"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476441"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476438"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1729"></a><span>                                         </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476439"><span class="hs-identifier hs-var">ez</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Classification.html#E%6D88%8CBB%8CA1"><span class="hs-identifier hs-var">E&#28040;&#36027;&#36001;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476433"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476442"><a href="#local-6989586621679476442"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476442"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476438"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1730"></a><span>                         </span><a name="local-6989586621679476443"><a href="#local-6989586621679476443"><span class="hs-identifier">inp'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476433"><span class="hs-identifier hs-var">inp</span></a><span>
</span><a name="line-1731"></a><span>                         </span><a name="local-6989586621679476444"><a href="#local-6989586621679476444"><span class="hs-identifier">cap'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476435"><span class="hs-identifier hs-var">cap</span></a><span>
</span><a name="line-1732"></a><span>                         </span><a name="local-6989586621679476445"><a href="#local-6989586621679476445"><span class="hs-identifier">con'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476437"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1733"></a><span>                         </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.and</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476431"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476443"><span class="hs-identifier hs-var">inp'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476444"><span class="hs-identifier hs-var">cap'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476445"><span class="hs-identifier hs-var">con'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1734"></a><span>
</span><a name="line-1735"></a><span>
</span><a name="line-1736"></a><span>
</span><a name="line-1737"></a><span class="hs-comment">-- *** &#21307;&#30274;&#65292;&#31119;&#31049;</span><span>
</span><a name="line-1738"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1739"></a><span class="hs-comment">{- |
    &#21307;&#30274;&#65292;&#31119;&#31049;&#29987;&#26989;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369;&#12399;&#24179;&#25104;24&#24180;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#20107;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#65292;
    &#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12434;&#29992;&#12356;&#12427;&#12290;

    &#12394;&#12362;&#65292;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#12418;&#35519;&#26619;&#31080;&#12398;&#27083;&#25104;&#12395;&#22823;&#12365;&#12394;&#22793;&#26356;&#12399;&#12394;&#12356;&#12371;&#12392;&#12363;&#12425;&#65292;&#20197;&#19979;&#21516;&#19968;&#12398;&#20966;&#29702;&#12434;&#24819;&#23450;&#12375;&#12390;&#35542;&#12376;&#12427;&#12290;
    &#12414;&#12383;&#65292;&#21508;&#35519;&#26619;&#31080;&#12398;&#21028;&#21029;&#12395;&#12399;&#12300;&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12301;&#12434;&#29992;&#12356;&#12427;&#12290;

    &#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#20107;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;7&#21306;&#20998;&#12373;&#12428;&#12383;&#35386;&#30274;&#21450;&#12403;&#20107;&#26989;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21448;&#12399;&#21106;&#21512;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;

    &#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12391;&#12399;,&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12392;&#23550;&#24540;&#12377;&#12427;32&#21306;&#20998;&#12398;&#20107;&#26989;&#20869;&#23481;&#12363;&#12425;&#19968;&#12388;&#12434;&#36984;&#25246;&#12377;&#12427;&#12290;

    &#20197;&#19979;&#12371;&#12398;&#31680;&#12395;&#38480;&#12426;&#65292;&#21069;&#32773;&#12434;&#12300;&#65303;&#21306;&#20998;&#12301;&#65292;&#24460;&#32773;&#12434;&#12300;32&#21306;&#20998;&#12301;&#12392;&#21628;&#31216;&#12377;&#12427;&#12290;

    &#12381;&#12428;&#12382;&#12428;&#65292;&#12487;&#12540;&#12479;&#12392;&#12375;&#12390;&#12399;,
    * 7&#21306;&#20998; E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;
    * 32&#21306;&#20998; E&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;

    &#12395;&#23550;&#24540;&#12377;&#12427;&#65294;


    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#26684;&#20184;&#12369;&#12391;&#12399;&#65292;&#21336;&#32020;&#12395;&#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12434;&#26684;&#20184;&#12369;&#12395;&#29992;&#12356;&#12390;&#12356;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12290;

    &#12371;&#12371;&#12391;&#12399;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12398;&#29983;&#29987;&#37327;&#12434;&#25226;&#25569;&#12377;&#12427;&#12383;&#12417;,&#12371;&#12371;&#12391;&#12399;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#20107;&#26989;&#12395;&#65292;
    &#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#20107;&#26989;&#12398;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12434;&#37197;&#20998;&#12375;&#65292;&#12300;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12301;&#12434;&#32076;&#12390;&#65292;&#12300;&#20107;&#26989;&#25152;&#12398;&#24418;&#24907;&#65292;&#20027;&#12394;&#20107;&#26989;&#12398;&#20869;&#23481;&#12301;
    &#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#29987;&#26989;&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12373;&#12428;&#12427;&#12424;&#12358;&#12487;&#12540;&#12479;&#12434;&#22793;&#25563;&#12377;&#12427;&#12290;

    &#12371;&#12398;&#37197;&#20998;&#20316;&#26989;&#12395;&#24403;&#12383;&#12387;&#12390;&#27880;&#24847;&#12377;&#12409;&#12365;&#20107;&#38917;&#12399;&#65292;&#20445;&#38522;&#21306;&#20998;&#12392;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#23550;&#24540;&#38306;&#20418;&#12391;&#12354;&#12427;&#12290;
    &#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920;&#32207;&#21512;&#35299;&#35500;&#32232; &#12391;&#12399;&#65292;
    &#12300;&#21307;&#30274;&#65288;&#20837;&#38498;&#35386;&#30274;&#65289;&#65292;&#21307;&#30274;&#65288;&#20837;&#38498;&#22806;&#35386;&#30274;&#65289;&#65292;&#21307;&#30274;&#65288;&#27503;&#31185;&#35386;&#30274;&#65289;&#65292;&#21307;&#30274;&#65288;&#35519;&#21092;&#65289; &#65292;&#21307;&#30274;&#65288;&#12381;&#12398;&#20182;&#12398;&#21307;&#30274;&#12469;&#12540;&#12499;&#12473;&#65289;&#65292;&#21307;&#30274;&#65288;&#12381;&#12398;&#20182;&#12398;&#21307;&#30274;&#12469;&#12540;&#12499;&#12473;&#65289;&#65292;
    &#31038;&#20250;&#31119;&#31049;&#65288;&#38750;&#21942;&#21033;&#65289;&#65292;&#31038;&#20250;&#31119;&#31049;&#65288;&#29987;&#26989;&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
    &#12300;&#30149;&#38498;&#21450;&#12403;&#19968;&#33324;&#35386;&#30274;&#25152;&#20869;&#12391;&#12398;&#27503;&#31185;&#35386;&#30274;&#12399;&#12300;&#21307;&#30274;&#65288;&#27503;&#31185;&#35386;&#30274;&#65289;&#12301;&#12395;&#21547;&#12417;&#12427;&#12301;&#65292;&#12300;&#20171;&#35703;&#20445;&#38522;&#12395;&#12424;&#12427;&#12469;&#12540;&#12499;&#12473;&#12399;&#12300;&#20171;&#35703;&#65288;&#26045;&#35373;&#12469;&#12540;&#12499;&#12473;&#65289;&#12301;&#65292;
    &#12300;&#20171;&#35703;&#65288;&#26045;&#35373;&#12469;&#12540;&#12499;&#12473;&#12434;&#38500;&#12367;&#65289;&#12301;&#12395;&#21547;&#12417;&#12427;&#12301;&#12392;&#35352;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#27503;&#31185;&#12392;&#12381;&#12428;&#20197;&#22806;&#12399;&#12450;&#12463;&#12486;&#12451;&#12499;&#12486;&#12451;&#12391;&#65292;&#20171;&#35703;&#12392;&#21307;&#30274;&#12399;&#20445;&#38522;&#21046;&#24230;&#12391;&#21306;&#20998;&#12364;&#12373;&#12428;&#12390;&#12356;&#12427;&#12290;

    &#20197;&#19979;&#65292;&#22522;&#26412;&#30340;&#12395;&#12371;&#12398;&#21306;&#20998;&#12395;&#24467;&#12387;&#12390;&#20197;&#19979;&#12398;&#25163;&#27861;&#12391;&#25353;&#20998;&#12434;&#34892;&#12358;&#12290;

    7&#21306;&#20998;&#12398;&#22770;&#19978;&#12434;&#12381;&#12428;&#12382;&#12428;&#12395;&#35442;&#24403;&#12377;&#12427;32&#21306;&#20998;&#12395;&#26696;&#20998;&#12377;&#12427;&#31532;&#19968;&#27573;&#38542;&#12392;&#12375;&#12390;&#65292;32&#21306;&#20998;&#12381;&#12428;&#12382;&#12428;&#12395;&#38306;&#12375;&#12390;&#12381;&#12398;&#22770;&#19978;&#12398;&#23550;&#35937;&#12392;&#12394;&#12426;&#12358;&#12427;7&#21306;&#20998;&#12398;&#23550;&#24540;&#38306;&#20418;&#12434;&#31574;&#23450;&#12375;&#65292;
    &#36984;&#25246;&#12373;&#12428;&#12383;32&#21306;&#20998;&#12395;,&#23550;&#24540;&#12398;&#12354;&#12427;7&#21306;&#20998;&#12398;&#21454;&#20837;&#12434;&#20840;&#38989;&#35336;&#19978;&#12371;&#12392;&#12392;&#12377;&#12427;&#12290;
    &#12394;&#12362;,&#23550;&#24540;&#38306;&#20418;&#12399;&#12300;&#34920; 1&#21307;&#30274;,&#31119;&#31049;&#20998;&#37326;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#21306;&#20998;&#12392;&#20107;&#26989;&#21306;&#20998;&#12398;&#23550;&#24540;&#12301;&#12395;&#24467;&#12358;&#12290;
    &#23550;&#24540;&#38306;&#20418;&#12398;&#12394;&#12356;&#12418;&#12398;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;7&#21306;&#20998;&#12363;&#12425;&#12394;&#12427;&#37096;&#38272;&#20998;&#39006;&#12434;&#19968;&#26178;&#30340;&#12395;&#20316;&#25104;&#12375;&#65292;&#12381;&#12371;&#12395;&#20840;&#38989;&#35336;&#19978;&#12377;&#12427;&#12290;
    &#12381;&#12398;&#24460;&#65292;&#21508;32&#21306;&#20998;&#12398;&#22770;&#19978;&#12398;&#27604;&#29575;&#12391;&#65292;&#19968;&#26178;&#30340;&#12395;&#35336;&#19978;&#12373;&#12428;&#12383;7&#21306;&#20998;&#12434;32&#21306;&#20998;&#12395;&#25353;&#20998;&#12377;&#12427;&#12290;
-}</span><span>
</span><a name="line-1780"></a><span>
</span><a name="line-1781"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1782"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%533B%7642%798F%7949"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%533B%7642%798F%7949"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21307;&#30274;&#31119;&#31049;</span></a></a><span> </span><a name="local-6989586621679476446"><a href="#local-6989586621679476446"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-1783"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1784"></a><span>    </span><a name="local-6989586621679476455"><a href="#local-6989586621679476455"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476446"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-1785"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476455"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1786"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476456"><a href="#local-6989586621679476456"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476456"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span>  </span><a href="VTable.Data.Structure.html#E%533B%7642%798F%7949"><span class="hs-identifier hs-var">E&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476447"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476446"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-1787"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1788"></a><span>        </span><span class="hs-identifier">_</span><span>                                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1789"></a><span>
</span><a name="line-1790"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1791"></a><span>    </span><span class="hs-comment">-- | &#21307;&#30274;&#31119;&#31049;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1792"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1793"></a><span>    </span><a name="local-6989586621679476447"><a href="#local-6989586621679476447"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679476448"><a href="#local-6989586621679476448"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1794"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476449"><a href="#local-6989586621679476449"><span class="hs-identifier">man</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476448"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1795"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476450"><a href="#local-6989586621679476450"><span class="hs-identifier">front</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476448"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1796"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476451"><a href="#local-6989586621679476451"><span class="hs-identifier">comm</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476448"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1797"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476452"><a href="#local-6989586621679476452"><span class="hs-identifier">e1</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476448"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span>
</span><a name="line-1798"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476453"><a href="#local-6989586621679476453"><span class="hs-identifier">e2</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476448"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span>
</span><a name="line-1799"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476454"><a href="#local-6989586621679476454"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#getValCarsFromV%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="#local-6989586621679476449"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476452"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621679476453"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1800"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476448"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476451"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476454"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476450"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T22&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1801"></a><span>
</span><a name="line-1802"></a><span>
</span><a name="line-1803"></a><span class="hs-comment">-- | &#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049; &#12392; &#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; &#12398;&#23550;&#24540;&#38306;&#20418;&#12395;&#22522;&#12389;&#12356;&#12390;Car&#12434;&#36820;&#12377;&#65294;</span><span>
</span><a name="line-1804"></a><span class="hs-comment">--</span><span>
</span><a name="line-1805"></a><span class="hs-comment">--   V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; == Null &#12398;&#22580;&#21512;&#12399;&#65292;&#26684;&#20184;&#12369;&#19981;&#33021; &quot;PZZZ&quot; &#12434;&#36820;&#12377;&#65294;</span><span>
</span><a name="line-1806"></a><span class="hs-identifier">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1807"></a><a name="getValCarsFromV%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><a href="VTable.Compliation.html#getValCarsFromV%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a></a><span> </span><a name="local-6989586621679476457"><a href="#local-6989586621679476457"><span class="hs-identifier">man</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1808"></a><span class="hs-identifier">getValCarsFromV&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><a name="local-6989586621679476458"><a href="#local-6989586621679476458"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679476459"><a href="#local-6989586621679476459"><span class="hs-identifier">e1</span></a></a><span>   </span><a name="local-6989586621679476460"><a href="#local-6989586621679476460"><span class="hs-identifier">e2</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1809"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679476458"><span class="hs-identifier hs-var">man</span></a><span> </span><span class="hs-comment">{- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#20966;&#29702; -}</span><span>
</span><a name="line-1810"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span>
</span><a name="line-1811"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476461"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1812"></a><span>                                                 </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476462"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679476459"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1813"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1814"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476461"><a href="#local-6989586621679476461"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#getIncomeE%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-var">getIncomeE&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="#local-6989586621679476460"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="#local-6989586621679476459"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-1815"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-1816"></a><span>    </span><a name="local-6989586621679476462"><a href="#local-6989586621679476462"><span class="hs-identifier">getName</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;PZZZ&quot;</span><span> </span><span class="hs-comment">-- &#26684;&#20184;&#12369;&#19981;&#21487;</span><span>
</span><a name="line-1817"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><a name="local-6989586621679476463"><a href="#local-6989586621679476463"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><a href="#local-6989586621679476463"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#edE%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">edE&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1818"></a><span>                 </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476464"><a href="#local-6989586621679476464"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476464"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1819"></a><span>                 </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;can Not find in edE&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;&quot;</span><span>
</span><a name="line-1820"></a><span>
</span><a name="line-1821"></a><span>
</span><a name="line-1822"></a><span class="hs-comment">-- | E&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; &#12395;&#23550;&#24540;&#12377;&#12427; E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049; &#12398;&#12501;&#12451;&#12540;&#12523;&#12489;&#21517;&#65288;&#38306;&#25968;&#65289;&#12434;&#36820;&#12377;</span><span>
</span><a name="line-1823"></a><span class="hs-identifier">getIncomeE&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-1824"></a><a name="getIncomeE%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><a href="VTable.Compliation.html#getIncomeE%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier">getIncomeE&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476466"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1825"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1826"></a><span>    </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%4E8B%696D%53CE%5165_%533B%7642%798F%7949"><span class="hs-identifier hs-type">E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-1827"></a><span>    </span><a name="local-6989586621679476465"><a href="#local-6989586621679476465"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679476467"><a href="#local-6989586621679476467"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476468"><a href="#local-6989586621679476468"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476468"><span class="hs-identifier hs-var">func</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049;</span><span> </span><a href="#local-6989586621679476467"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1828"></a><span>    </span><a name="local-6989586621679476466"><a href="#local-6989586621679476466"><span class="hs-identifier">f</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-identifier">_</span><span>                                                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1829"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476469"><a href="#local-6989586621679476469"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%4E00%822C%75C5%9662"><span class="hs-identifier hs-var">E&#19968;&#33324;&#30149;&#38498;</span></a><span>                          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476469"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1830"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476470"><a href="#local-6989586621679476470"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%7CBE%795E%79D1%75C5%9662"><span class="hs-identifier hs-var">E&#31934;&#31070;&#31185;&#30149;&#38498;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476470"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1831"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476471"><a href="#local-6989586621679476471"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%6709%5E8A%8A3A%7642%6240"><span class="hs-identifier hs-var">E&#26377;&#24202;&#35386;&#30274;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476471"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1832"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476472"><a href="#local-6989586621679476472"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%7121%5E8A%8A3A%7642%6240"><span class="hs-identifier hs-var">E&#28961;&#24202;&#35386;&#30274;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476472"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1833"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476473"><a href="#local-6989586621679476473"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%6B6F%79D1%8A3A%7642%6240"><span class="hs-identifier hs-var">E&#27503;&#31185;&#35386;&#30274;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476473"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1834"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476474"><a href="#local-6989586621679476474"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%52A9%7523%6240%52A9%7523%5E2B%696D"><span class="hs-identifier hs-var">E&#21161;&#29987;&#25152;&#21161;&#29987;&#24107;&#26989;</span></a><span>                    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476474"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1835"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476475"><a href="#local-6989586621679476475"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%770B%8B77%696D"><span class="hs-identifier hs-var">E&#30475;&#35703;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476475"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1836"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476476"><a href="#local-6989586621679476476"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%65BD%8853%696D"><span class="hs-identifier hs-var">E&#26045;&#34899;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476476"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1837"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476477"><a href="#local-6989586621679476477"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%7642%990A%6240"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#30274;&#39178;&#25152;</span></a><span>                    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476477"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1838"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476478"><a href="#local-6989586621679476478"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%6B6F%79D1%6280%5DE5%6240"><span class="hs-identifier hs-var">E&#27503;&#31185;&#25216;&#24037;&#25152;</span></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476478"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1839"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476479"><a href="#local-6989586621679476479"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%533B%7642%306B%9644%5E2F%3059%308B%30B5%30FC%30D3%30B9%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#21307;&#30274;&#12395;&#38468;&#24111;&#12377;&#12427;&#12469;&#12540;&#12499;&#12473;&#26989;</span></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476479"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1840"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476480"><a href="#local-6989586621679476480"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%7D50%6838%5065%5EB7%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#32080;&#26680;&#20581;&#24247;&#30456;&#35527;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476480"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1841"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476481"><a href="#local-6989586621679476481"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%7CBE%795E%4FDD%5065%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#31934;&#31070;&#20445;&#20581;&#30456;&#35527;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476481"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1842"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476482"><a href="#local-6989586621679476482"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%6BCD%5B50%5065%5EB7%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#27597;&#23376;&#20581;&#24247;&#30456;&#35527;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476482"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1843"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476483"><a href="#local-6989586621679476483"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%5065%5EB7%76F8%8AC7%65BD%8A2D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#20581;&#24247;&#30456;&#35527;&#26045;&#35373;</span></a><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476483"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1844"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476484"><a href="#local-6989586621679476484"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%691C%67FB%696D"><span class="hs-identifier hs-var">E&#26908;&#26619;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476484"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1845"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476485"><a href="#local-6989586621679476485"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%6D88%6BD2%696D"><span class="hs-identifier hs-var">E&#28040;&#27602;&#26989;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476485"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1846"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476486"><a href="#local-6989586621679476486"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%4FDD%5065%885B%751F"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#20445;&#20581;&#34907;&#29983;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476486"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1847"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476487"><a href="#local-6989586621679476487"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%793E%4F1A%4FDD%967A%4E8B%696D%56E3%4F53"><span class="hs-identifier hs-var">E&#31038;&#20250;&#20445;&#38522;&#20107;&#26989;&#22243;&#20307;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476487"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1848"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476488"><a href="#local-6989586621679476488"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%4FDD%80B2%6240"><span class="hs-identifier hs-var">E&#20445;&#32946;&#25152;</span></a><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476488"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1849"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476489"><a href="#local-6989586621679476489"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%5150%7AE5%798F%7949%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#20816;&#31461;&#31119;&#31049;&#20107;&#26989;</span></a><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476489"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1850"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476490"><a href="#local-6989586621679476490"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%7279%5225%990A%8B77%8001%4EBA%30DB%30FC%30E0"><span class="hs-identifier hs-var">E&#29305;&#21029;&#39178;&#35703;&#32769;&#20154;&#12507;&#12540;&#12512;</span></a><span>                </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476490"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1851"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476491"><a href="#local-6989586621679476491"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%4ECB%8B77%8001%4EBA%4FDD%5065%65BD%8A2D"><span class="hs-identifier hs-var">E&#20171;&#35703;&#32769;&#20154;&#20445;&#20581;&#26045;&#35373;</span></a><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476491"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1852"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476492"><a href="#local-6989586621679476492"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%901A%6240%77ED%671F%5165%6240%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#36890;&#25152;&#30701;&#26399;&#20837;&#25152;&#20171;&#35703;&#20107;&#26989;</span></a><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476492"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1853"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476493"><a href="#local-6989586621679476493"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%8A2A%554F%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#35370;&#21839;&#20171;&#35703;&#20107;&#26989;</span></a><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476493"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1854"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476494"><a href="#local-6989586621679476494"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%8A8D%77E5%75C7%8001%4EBA%30B0%30EB%30FC%30D7%30DB%30FC%30E0"><span class="hs-identifier hs-var">E&#35469;&#30693;&#30151;&#32769;&#20154;&#12464;&#12523;&#12540;&#12503;&#12507;&#12540;&#12512;</span></a><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476494"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1855"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476495"><a href="#local-6989586621679476495"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%8001%4EBA%798F%7949%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#32769;&#20154;&#31119;&#31049;&#20171;&#35703;&#20107;&#26989;</span></a><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476495"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1856"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476496"><a href="#local-6989586621679476496"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%5C45%4F4F%652F%63F4%4E8B%696D"><span class="hs-identifier hs-var">E&#23621;&#20303;&#25903;&#25588;&#20107;&#26989;</span></a><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476496"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">,</span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1857"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476497"><a href="#local-6989586621679476497"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%6709%6599%8001%4EBA%30DB%30FC%30E0"><span class="hs-identifier hs-var">E&#26377;&#26009;&#32769;&#20154;&#12507;&#12540;&#12512;</span></a><span>                    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476497"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1858"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476498"><a href="#local-6989586621679476498"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%66F4%751F%4FDD%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#26356;&#29983;&#20445;&#35703;&#20107;&#26989;</span></a><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476498"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1859"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476499"><a href="#local-6989586621679476499"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%793E%4F1A%4FDD%967A%793E%4F1A%798F%7949%4ECB%8B77%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#31038;&#20250;&#20445;&#38522;&#31038;&#20250;&#31119;&#31049;&#20171;&#35703;&#20107;&#26989;</span></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476499"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1860"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476500"><a href="#local-6989586621679476500"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%4E8B%696D%6240%5F62%614B_%533B%7642%798F%7949"><span class="hs-identifier hs-var">V&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049;</span></a><span> </span><a href="VTable.Data.Structure.html#E%305D%306E%4ED6%306E%969C%788D%8005%798F%7949%4E8B%696D"><span class="hs-identifier hs-var">E&#12381;&#12398;&#20182;&#12398;&#38556;&#30861;&#32773;&#31119;&#31049;&#20107;&#26989;</span></a><span>            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476500"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1861"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476501"><a href="#local-6989586621679476501"><span class="hs-identifier">e2</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476465"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679476501"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#35386;&#30274;&#21454;&#20837;</span><span>
</span><a name="line-1862"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#38522;&#22806;&#35386;&#30274;&#21454;&#20837;</span><span>
</span><a name="line-1863"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#26045;&#35373;&#20171;&#35703;&#21454;&#20837;</span><span>
</span><a name="line-1864"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#36890;&#25152;&#20171;&#35703;&#35370;&#21839;&#20171;&#35703;&#21454;&#20837;</span><span>
</span><a name="line-1865"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#20445;&#38522;&#20107;&#26989;&#21454;&#20837;</span><span>
</span><a name="line-1866"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#20445;&#20581;&#34907;&#29983;&#20107;&#26989;&#21454;&#20837;</span><span>
</span><a name="line-1867"></a><span>                                                                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_&#31038;&#20250;&#31119;&#31049;&#20107;&#26989;&#21454;&#20837;</span><span class="hs-special">]</span><span>
</span><a name="line-1868"></a><span>
</span><a name="line-1869"></a><span>
</span><a name="line-1870"></a><span class="hs-comment">-- *** &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B</span><span>
</span><a name="line-1871"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-1872"></a><span class="hs-comment">{- |
     &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#20027;&#26989;&#21450;&#12403;&#24467;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12398;&#25226;&#25569;&#12399;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;
     &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#65289;&#31561;&#12395;&#12362;&#12369;&#12427;&#31532;&#65298;&#38754;&#35519;&#26619;&#38917;&#30446;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#20107;&#26989;&#21454;&#20837;&#20869;&#35379;&#12301;&#65292;
     &#12300;&#26045;&#35373;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#65292;&#21450;&#12403;&#12300;&#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22770;&#19978;&#39640;&#21450;&#12403;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#12301;&#12434;&#20027;&#12395;&#29992;&#12356;&#12390;&#34892;&#12431;&#12428;&#12427;&#12290;

     &#20197;&#19979;&#65292;&#26412;&#35373;&#12395;&#38480;&#12426;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#20107;&#26989;&#21454;&#20837;&#20869;&#35379;&#12301;&#12434;&#38917;&#30446;&#65297;&#65292;
     &#12300;&#26045;&#35373;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#12434;&#38917;&#30446;&#65298;&#65292;&#12300;&#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22770;&#19978;&#39640;&#21450;&#12403;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#12301;&#12434;&#38917;&#30446;&#65299;&#12392;&#21628;&#31216;&#12377;&#12427;&#12290;

     &#38917;&#30446;&#65297;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#12300;&#39154;&#39135;&#26989;&#65292;&#23487;&#27850;&#12469;&#12540;&#12499;&#12473;&#26989;&#65292;&#29289;&#21697;&#36035;&#36024;&#26989;&#65292;&#12381;&#12398;&#20182;&#12398;&#29983;&#27963;&#38306;&#36899;&#12469;&#12540;&#12499;&#12473;&#65292;&#12473;&#12509;&#12540;&#12484;&#26045;&#35373;&#25552;&#20379;&#26989;&#12301;&#31561;&#12398;
     &#29987;&#26989;&#20013;&#20998;&#39006;&#31243;&#24230;&#12398;&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12392;&#65292;
     &#12381;&#12428;&#20197;&#22806;&#12398;&#12469;&#12540;&#12499;&#12473;&#26989;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#32048;&#20998;&#39006;&#31243;&#24230;&#12398;&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;.
     &#12394;&#12362;,&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;,&#65378;&#22770;&#19978;(&#21454;&#20837;&#37329;&#38989;) &#21448;&#12399;&#21106;&#21512;&#65379;&#12392;&#22793;&#25563;&#12373;&#12428;&#12390;&#12356;&#12427;&#12364;,&#26412;&#31295;&#12395;&#20351;&#29992;&#12373;&#12428;&#12390;&#12356;&#12427;&#12487;&#12540;&#12479;&#12399;
     &#37329;&#38989;&#12398;&#12415;&#12391;&#12354;&#12427;(&#21106;&#21512;&#12398;&#12415;&#12398;&#22238;&#31572;&#12398;&#32080;&#26524;&#12364;&#37329;&#38989;&#12398;&#20516;&#12395;&#35036;&#32180;&#12373;&#12428;&#12390;&#12356;&#12427;&#12363;&#12399;&#19981;&#26126;.)

     &#38917;&#30446;&#65298;&#12391;&#12399;&#65292;&#29987;&#26989;&#32048;&#20998;&#39006;&#31243;&#24230;&#12398;&#21306;&#20998;&#20027;&#21147;&#20107;&#26989;&#12398;&#24418;&#24907;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#12290;&#29289;&#21697;&#36035;&#36024;&#26989;&#12434;&#38500;&#12367;&#65292;
     &#29987;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#38917;&#30446;1&#12395;&#12362;&#12369;&#12427;&#21306;&#20998;&#12364;&#65292;&#12300;&#26045;&#35373;&#12539;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#12398;&#21306;&#20998;&#31684;&#22258;&#12398;&#22580;&#21512;
     (e.g &#20107;&#26989;&#20998;&#39006;&#12364;&#23487;&#27850;&#20107;&#26989;, &#24215;&#33303;&#24418;&#24907;&#12364;&#26053;&#39208;&#12394;&#12393;,&#20107;&#26989;&#20998;&#39006;&#12392;&#24215;&#33303;&#24418;&#24907;&#12364;&#12510;&#12483;&#12481;&#12375;&#12390;&#12356;&#12427;&#22580;&#21512;)
     &#12399;&#12300;&#26045;&#35373;&#12539;&#24215;&#33303;&#31561;&#24418;&#24907;&#12301;&#12398;&#21306;&#20998;&#12434;(&#29987;&#26989;&#32048;&#20998;&#39006;&#12395;&#22793;&#25563;&#12375;&#12383;&#19978;&#12391;)&#25505;&#29992;&#12375;&#65292;
     &#12381;&#12428;&#20197;&#22806;&#12398;&#22580;&#21512;&#12399;&#65292;&#20107;&#26989;&#20998;&#39006;&#12434;(&#29987;&#26989;&#32048;&#20998;&#39006;&#12395;&#22793;&#25563;&#12375;&#12383;&#19978;&#12391;)&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#65292;&#21103;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12373;&#12428;&#12427;&#12290;

     &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#24179;&#25104;24&#65292;28&#24180;&#12381;&#12428;&#12382;&#12428;&#12391;&#20966;&#29702;&#12364;&#30064;&#12394;&#12426;&#65292;&#24179;&#25104;24&#24180;&#12391;&#12399;&#65292;
     &#38917;&#30446;&#65297;&#12398;&#22238;&#31572;&#20869;&#23481;&#12395;&#12362;&#12356;&#12390;&#29987;&#26989;&#21306;&#20998;&#12364;&#12300;&#29987;&#26989;&#27231;&#26800;&#65292;&#20107;&#21209;&#29992;&#27231;&#26800;&#65292;&#33258;&#21205;&#36554;&#65292;&#12473;&#12509;&#12540;&#12484;&#12539;&#23087;&#27005;&#29992;&#21697;&#65292;
     &#12381;&#12398;&#20182;&#65288;&#26144;&#30011;&#12539;&#28436;&#21127;&#29992;&#21697;&#65292;&#38899;&#27005;&#12539;&#26144;&#20687;&#35352;&#37682;&#29289;&#65292;&#36024;&#34915;&#12375;&#12423;&#12358;&#31561;&#65289;&#12301;&#12398;&#20869;&#65299;&#21306;&#20998;&#20197;&#19978;&#12434;&#21547;&#12435;&#12391;&#12362;&#12426;&#65292;
     &#19988;&#12388;&#65292;&#24403;&#35442;&#37096;&#38272;&#12398;&#38917;&#30446;3&#12395;&#12362;&#12369;&#12427;&#12300;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22770;&#19978;&#39640;&#65379;&#12434;&#12300;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#12301;&#12364;&#19978;&#22238;&#12387;&#12383;&#22580;&#21512;&#65292;
     &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#37096;&#38272;&#12398;&#22770;&#12426;&#19978;&#12370;&#12434;&#20840;&#12390;&#12300;&#32207;&#21512;&#12522;&#12540;&#12473;&#26989;&#12301;&#12398;&#22770;&#19978;&#65292;
     &#19979;&#22238;&#12387;&#12383;&#22580;&#21512;&#12399;&#12300;&#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#22770;&#19978;&#12392;&#12377;&#12427;&#12290;&#21516;&#21015;&#12354;&#12427;&#12356;&#12399;,&#12356;&#12378;&#12428;&#12418;&#12487;&#12540;&#12479;&#12364;&#23384;&#22312;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399;&#12524;&#12531;&#12479;&#12523;&#12395;&#21106;&#12426;&#25391;&#12427;.

     &#19978;&#35352;&#12398;&#26465;&#20214;&#12434;&#28288;&#12383;&#12373;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#38917;&#30446;&#12434;&#29420;&#31435;&#12375;&#12390;&#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#12290;
     &#38917;&#30446;&#65297;&#12364;&#26410;&#35352;&#20837;&#19988;&#12388;&#65292;&#38917;&#30446;&#65299;&#12364;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#22580;&#21512;&#12399;&#65292;&#24460;&#32773;&#12398;&#21106;&#21512;&#12363;&#12425;&#37329;&#38989;&#12434;&#31639;&#23450;&#12375;&#65292;&#21516;&#27096;&#12398;&#20966;&#29702;&#12434;&#34892;&#12358;&#12290;
     &#24179;&#25104;28&#24180;&#12391;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12398;&#26465;&#20214;&#12395;&#21152;&#12360;&#12390;&#65292;&#38917;&#30446;&#65298;&#12398;&#24773;&#22577;&#12395;&#12362;&#12356;&#12390;
     &#12300;&#32207;&#21512;&#12522;&#12540;&#12473;&#26989;&#65292;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#65292;&#12381;&#12398;&#20182;&#12398;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#21029;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;
     &#12381;&#12398;&#22238;&#31572;&#12364;&#12300;&#32207;&#21512;&#12522;&#12540;&#12473;&#26989;&#65292;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#22580;&#21512;&#12399;&#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#38917;&#30446;&#65297;&#12398;&#22770;&#19978;&#39640;&#12434;&#65292;
     &#20840;&#38989;&#12381;&#12428;&#12425;&#12395;&#20998;&#37197;&#12375;&#65292;&#12300;&#12381;&#12398;&#20182;&#12398;&#29289;&#21697;&#36035;&#36024;&#26989;&#12301;&#12398;&#22580;&#21512;&#12399;&#65292;&#12381;&#12398;&#12414;&#12414;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#12290;
     &#29987;&#26989;&#32048;&#20998;&#39006;&#12399;&#38917;&#30446;2&#12395;&#12362;&#12369;&#12427;&#24773;&#22577;&#12424;&#12426;&#12418;&#33618;&#12356;&#12383;&#12417;,&#38917;&#30446;2&#12434;&#21033;&#29992;&#12377;&#12427;&#12371;&#12392;&#12391;&#23455;&#38555;&#12399;&#12424;&#12426;&#32048;&#12363;&#12356;&#24773;&#22577;&#12364;&#21462;&#12428;&#12427;&#12364;&#12371;&#12371;&#12391;&#12399;&#12381;&#12428;&#12434;&#34892;&#12431;&#12394;&#12356;.

     &#20027;&#21147;&#20107;&#26989;&#12364;&#20182;&#12398;&#29987;&#26989;&#12391;&#12354;&#12426;&#65292;&#38917;&#30446;&#65298;&#12364;&#29289;&#21697;&#36035;&#36024;&#26989;&#12391;&#12394;&#12356;&#22580;&#21512;&#65292;24&#24180;&#12392;&#21516;&#31561;&#12398;&#26465;&#20214;&#12391;
     &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#38917;&#30446;&#65297;&#12434;&#20966;&#29702;&#12375;&#65292;&#21103;&#29983;&#29987;&#29289;&#12392;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#12290;

    &#38917;&#30446;1&#21450;&#12403;,&#38917;&#30446;3&#12381;&#12428;&#12382;&#12428;&#12395;&#12362;&#12369;&#12427;&#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#20516;&#12395;&#30456;&#36949;&#12364;&#12354;&#12427;&#22580;&#21512;&#12399;,&#22522;&#26412;&#30340;&#12395;&#12399;&#38917;&#30446;1&#12434;&#20778;&#20808;&#12375;,
    &#38917;&#30446;1,&#12414;&#12383;&#12399;&#38917;&#30446;3&#12398;&#12356;&#12378;&#12428;&#12363;&#12364;&#27424;&#25613;&#12375;&#12390;&#12356;&#12427;&#22580;&#21512;&#12399;&#20182;&#26041;&#12434;&#20778;&#20808;&#12377;&#12427;.
    (&#21516;&#19968;&#12398;&#35519;&#26619;&#31080;&#20869;&#12391;&#12377;&#12425;&#37325;&#35079;&#24773;&#22577;&#12434;&#35352;&#20837;&#12373;&#12379;&#12427;&#12398;&#12399;&#12356;&#12363;&#12364;&#12394;&#12418;&#12398;&#12363;)
    (&#38917;&#30446;1&#12354;&#12426;/&#12394;&#12375; &#215; &#38917;&#30446;3&#12354;&#12426;/&#12394;&#12375; + &#37325;&#35079;&#12354;&#12426;/&#12394;&#12375; &#12391; 6 &#12497;&#12479;&#12540;&#12531;&#12395;&#20998;&#23696;. &#35443;&#32048;&#12399;,&#12467;&#12540;&#12489;&#21442;&#29031;)

    &#29987;&#26989;&#20998;&#39006;&#34920;&#12395;&#23384;&#22312;&#12375;&#12394;&#12356;&#38917;&#30446;,
    784Z &#24656;&#12425;&#12367;&#20844;&#34886;&#28020;&#22580;&#26684;&#20184;&#12369;&#19981;&#33021; &#21450;&#12403; 801Z &#26144;&#30011;&#39208;&#26684;&#20184;&#12369;&#19981;&#33021;(?)&#12398;2&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;&#36861;&#21152;&#12375;&#20844;&#34886;&#28020;&#22580;&#21450;&#12403;&#26144;&#30011;&#39208;&#12392;&#12375;&#12390;&#25201;&#12358;.


-}</span><span>
</span><a name="line-1920"></a><span>
</span><a name="line-1921"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12469;B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1922"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%30B5B"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%30B5B"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12469;B</span></a></a><span> </span><a name="local-6989586621679476502"><a href="#local-6989586621679476502"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476503"><a href="#local-6989586621679476503"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1923"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-1924"></a><span>    </span><a name="local-6989586621679476517"><a href="#local-6989586621679476517"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-1925"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476517"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1926"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476518"><a href="#local-6989586621679476518"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476518"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%30B5%30FC%30D3%30B9B"><span class="hs-identifier hs-var">E&#12469;&#12540;&#12499;&#12473;B</span></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476504"><span class="hs-identifier hs-var">ifServiceB</span></a><span> </span><a href="#local-6989586621679476502"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-1927"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1928"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1929"></a><span>
</span><a name="line-1930"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1931"></a><span>    </span><span class="hs-comment">-- &#12469;B&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-1932"></a><span>    </span><span class="hs-identifier">ifServiceB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1933"></a><span>    </span><a name="local-6989586621679476504"><a href="#local-6989586621679476504"><span class="hs-identifier">ifServiceB</span></a></a><span> </span><a name="local-6989586621679476505"><a href="#local-6989586621679476505"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476506"><a href="#local-6989586621679476506"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1934"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476507"><a href="#local-6989586621679476507"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1935"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476508"><a href="#local-6989586621679476508"><span class="hs-identifier">comm</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1936"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476509"><a href="#local-6989586621679476509"><span class="hs-identifier">front</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1937"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476510"><a href="#local-6989586621679476510"><span class="hs-identifier">shopType</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E97%8217%5F62%614B_%30B5B"><span class="hs-identifier hs-var">H&#24215;&#33303;&#24418;&#24907;_&#12469;B</span></a><span>
</span><a name="line-1938"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476511"><a href="#local-6989586621679476511"><span class="hs-identifier">sal</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%53CE%5165_%30B5B"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21454;&#20837;_&#12469;B</span></a><span>
</span><a name="line-1939"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476512"><a href="#local-6989586621679476512"><span class="hs-identifier">rTotal</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1940"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476513"><a href="#local-6989586621679476513"><span class="hs-identifier">lTotal</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-var">H&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1941"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476514"><a href="#local-6989586621679476514"><span class="hs-identifier">rSev</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%5225%30EC%30F3%30BF%30EB%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1942"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476515"><a href="#local-6989586621679476515"><span class="hs-identifier">lSev</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476503"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%5225%30EA%30FC%30B9%5951%7D04%9AD8"><span class="hs-identifier hs-var">H&#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1943"></a><span>
</span><a name="line-1944"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476516"><a href="#local-6989586621679476516"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#convNotSuiteVal"><span class="hs-identifier hs-var">convNotSuiteVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="VTable.Compliation.html#getValCarsFromV%30B5B"><span class="hs-identifier hs-var">getValCarsFromV&#12469;B</span></a><span> </span><a href="#local-6989586621679476505"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476507"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476511"><span class="hs-identifier hs-var">sal</span></a><span> </span><a href="#local-6989586621679476510"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679476512"><span class="hs-identifier hs-var">rTotal</span></a><span> </span><a href="#local-6989586621679476513"><span class="hs-identifier hs-var">lTotal</span></a><span> </span><a href="#local-6989586621679476514"><span class="hs-identifier hs-var">rSev</span></a><span> </span><a href="#local-6989586621679476515"><span class="hs-identifier hs-var">lSev</span></a><span>
</span><a name="line-1945"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476506"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476508"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476516"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476509"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T12&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T13&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T14&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T15&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T16&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T17&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T18&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T19&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T20&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-1946"></a><span>
</span><a name="line-1947"></a><span>
</span><a name="line-1948"></a><span class="hs-keyword">data</span><span> </span><a name="RentalOrLease"><a href="VTable.Compliation.html#RentalOrLease"><span class="hs-identifier">RentalOrLease</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Rental"><a href="VTable.Compliation.html#Rental"><span class="hs-identifier">Rental</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lease"><a href="VTable.Compliation.html#Lease"><span class="hs-identifier">Lease</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-1949"></a><span>
</span><a name="line-1950"></a><span class="hs-identifier">getValCarsFromV&#12469;B</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-1951"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-1952"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%30B5B"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#12469;B</span></a><span>
</span><a name="line-1953"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%30B5B"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#12469;B</span></a><span>
</span><a name="line-1954"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1955"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1956"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%30EC%30F3%30BF%30EB%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1957"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%30EA%30FC%30B9%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1958"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-1959"></a><span>
</span><a name="line-1960"></a><a name="getValCarsFromV%30B5B"><a href="VTable.Compliation.html#getValCarsFromV%30B5B"><span class="hs-identifier">getValCarsFromV&#12469;B</span></a></a><span> </span><a name="local-6989586621679476519"><a href="#local-6989586621679476519"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476520"><a href="#local-6989586621679476520"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679476521"><a href="#local-6989586621679476521"><span class="hs-identifier">sal</span></a></a><span> </span><a name="local-6989586621679476522"><a href="#local-6989586621679476522"><span class="hs-identifier">shopType</span></a></a><span> </span><a name="local-6989586621679476523"><a href="#local-6989586621679476523"><span class="hs-identifier">rTotal</span></a></a><span> </span><a name="local-6989586621679476524"><a href="#local-6989586621679476524"><span class="hs-identifier">lTotal</span></a></a><span> </span><a name="local-6989586621679476525"><a href="#local-6989586621679476525"><span class="hs-identifier">rSev</span></a></a><span> </span><a name="local-6989586621679476526"><a href="#local-6989586621679476526"><span class="hs-identifier">lSev</span></a></a><span>
</span><a name="line-1961"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679476527"><span class="hs-identifier hs-var">rateToManey</span></a><span> </span><a href="#local-6989586621679476523"><span class="hs-identifier hs-var">rTotal</span></a><span> </span><a href="#local-6989586621679476525"><span class="hs-identifier hs-var">rSev</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476609"><a href="#local-6989586621679476609"><span class="hs-identifier">rSevMoney</span></a></a><span>
</span><a name="line-1962"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476527"><span class="hs-identifier hs-var">rateToManey</span></a><span> </span><a href="#local-6989586621679476524"><span class="hs-identifier hs-var">lTotal</span></a><span> </span><a href="#local-6989586621679476526"><span class="hs-identifier hs-var">lSev</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476610"><a href="#local-6989586621679476610"><span class="hs-identifier">lSevMoney</span></a></a><span>
</span><a name="line-1963"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-1964"></a><span>              </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679476520"><span class="hs-identifier hs-var">man</span></a><span>
</span><a name="line-1965"></a><span>              </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476531"><span class="hs-identifier hs-var">convertServiceB</span></a><span> </span><a href="#local-6989586621679476519"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476521"><span class="hs-identifier hs-var">sal</span></a><span> </span><a href="#local-6989586621679476522"><span class="hs-identifier hs-var">shopType</span></a><span> </span><a href="#local-6989586621679476523"><span class="hs-identifier hs-var">rTotal</span></a><span> </span><a href="#local-6989586621679476524"><span class="hs-identifier hs-var">lTotal</span></a><span> </span><a href="#local-6989586621679476525"><span class="hs-identifier hs-var">rSev</span></a><span> </span><a href="#local-6989586621679476526"><span class="hs-identifier hs-var">lSev</span></a><span>
</span><a name="line-1966"></a><span>
</span><a name="line-1967"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1968"></a><span>    </span><span class="hs-comment">-- &#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12524;&#12531;&#12479;&#12523;&#24180;&#38291;&#22865;&#32004;&#39640;&#21450;&#12403;&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;&#12395;&#22522;&#12389;&#12356;&#12390;Cars&#12434;&#20316;&#12427;</span><span>
</span><a name="line-1969"></a><span>    </span><span class="hs-comment">-- &#12354;&#12392;&#12391;&#20107;&#26989;&#21454;&#20837;_&#12469;B&#12398;&#12392;&#12371;&#12429;&#12392;&#12510;&#12540;&#12472;(&#12371;&#12387;&#12385;&#12395;&#24773;&#22577;&#12364;&#12354;&#12428;&#12400;,&#20107;&#26989;&#21454;&#20837;&#12398;&#29289;&#21697;&#36035;&#36024;&#26989;&#37096;&#20998;&#12399;&#30772;&#26820;)</span><span>
</span><a name="line-1970"></a><span>
</span><a name="line-1971"></a><span>    </span><span class="hs-comment">-- | &#21106;&#21512;&#12398;&#37329;&#38989;&#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-1972"></a><span>    </span><span class="hs-identifier">rateToManey</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#ValDouble"><span class="hs-identifier hs-type">ValDouble</span></a><span>    </span><span class="hs-comment">{- ^ Val&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640; or Val&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640; -}</span><span>
</span><a name="line-1973"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>      </span><span class="hs-comment">{- ^ &#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640; or &#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640; -}</span><span>
</span><a name="line-1974"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>   </span><span class="hs-comment">{- ^ &#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640; or &#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640; -}</span><span>
</span><a name="line-1975"></a><span>    </span><a name="local-6989586621679476527"><a href="#local-6989586621679476527"><span class="hs-identifier">rateToManey</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1976"></a><span>    </span><span class="hs-identifier">rateToManey</span><span> </span><span class="hs-identifier">_</span><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1977"></a><span>    </span><span class="hs-identifier">rateToManey</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476533"><a href="#local-6989586621679476533"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476534"><a href="#local-6989586621679476534"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">V.mapM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476535"><a href="#local-6989586621679476535"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476536"><a href="#local-6989586621679476536"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476535"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1978"></a><span>                                                              </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476535"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">100.0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1979"></a><span>                                                                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476535"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.01</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476533"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476535"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1980"></a><span>                                                                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-string">&quot;this value should be rate:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679476535"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679476535"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476534"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-1981"></a><span>
</span><a name="line-1982"></a><span>    </span><span class="hs-comment">-- | &#32207;&#21512;&#12522;&#12540;&#12473;&#26989;(7011), &#12381;&#12398;&#20182;&#12398;&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;(7019)&#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-1983"></a><span>    </span><span class="hs-comment">-- &#19977;&#31278;&#20197;&#19978;&#21547;&#12414;&#12428;&#12390;&#12356;&#12428;&#12400;,&#32207;&#21512;&#12414;&#12383;&#12399;&#21508;&#31278;</span><span>
</span><a name="line-1984"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1985"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-1986"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%30EC%30F3%30BF%30EB%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-comment">{- ^ &#37329;&#38989;&#12395;&#22793;&#25563;&#28168;&#12415; -}</span><span>
</span><a name="line-1987"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%30EA%30FC%30B9%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640;</span></a><span>   </span><span class="hs-comment">{- ^ &#37329;&#38989;&#12395;&#22793;&#25563;&#28168;&#12415; -}</span><span>
</span><a name="line-1988"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Cars&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-1989"></a><span>
</span><a name="line-1990"></a><span>    </span><a name="local-6989586621679476528"><a href="#local-6989586621679476528"><span class="hs-identifier">convertToMulti</span></a></a><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>             </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1991"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>             </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476537"><a href="#local-6989586621679476537"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1992"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476537"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1993"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476537"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1994"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476537"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1995"></a><span>
</span><a name="line-1996"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>             </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476538"><a href="#local-6989586621679476538"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-1997"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476538"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-1998"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476538"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1999"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476538"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-2000"></a><span>
</span><a name="line-2001"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476539"><a href="#local-6989586621679476539"><span class="hs-identifier">rd</span></a></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476540"><a href="#local-6989586621679476540"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476541"><a href="#local-6989586621679476541"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2002"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476540"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2003"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476540"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2004"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476540"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-2005"></a><span>
</span><a name="line-2006"></a><span>
</span><a name="line-2007"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476542"><a href="#local-6989586621679476542"><span class="hs-identifier">ld</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476543"><a href="#local-6989586621679476543"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476544"><a href="#local-6989586621679476544"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2008"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476544"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-keyword">of</span><span>   </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2009"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476544"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2010"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476544"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2011"></a><span>
</span><a name="line-2012"></a><span>
</span><a name="line-2013"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476545"><a href="#local-6989586621679476545"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476546"><a href="#local-6989586621679476546"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2014"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476545"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476546"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2015"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2016"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476545"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-2017"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476546"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2018"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476545"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2019"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476546"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2020"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476545"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476546"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2021"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476546"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476545"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-2022"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476545"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476546"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2023"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476546"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476545"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-comment">-- &#27770;&#12417;&#12358;&#12385;</span><span>
</span><a name="line-2024"></a><span>
</span><a name="line-2025"></a><span>
</span><a name="line-2026"></a><span>    </span><span class="hs-identifier">convertToMulti</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476547"><a href="#local-6989586621679476547"><span class="hs-identifier">rd</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476548"><a href="#local-6989586621679476548"><span class="hs-identifier">ld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476549"><a href="#local-6989586621679476549"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476550"><a href="#local-6989586621679476550"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2027"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2028"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2029"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-2030"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2031"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2032"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>       </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2033"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2034"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476547"><span class="hs-identifier hs-var">rd</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679476548"><span class="hs-identifier hs-var">ld</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-2035"></a><span>                                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2036"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476547"><span class="hs-identifier hs-var">rd</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679476548"><span class="hs-identifier hs-var">ld</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2037"></a><span>                                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2038"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476547"><span class="hs-identifier hs-var">rd</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679476548"><span class="hs-identifier hs-var">ld</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-2039"></a><span>                                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476550"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476549"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-2040"></a><span>
</span><a name="line-2041"></a><span>
</span><a name="line-2042"></a><span>    </span><span class="hs-comment">-- | &#19977;&#31278;&#20197;&#19978;&#20837;&#12387;&#12390;&#12356;&#12427;&#12392;True</span><span>
</span><a name="line-2043"></a><span>    </span><span class="hs-comment">-- VIO &#12398;&#26178;&#28857;&#12391;,&#12381;&#12428;&#12382;&#12428;&#12414;&#12392;&#12417;&#12425;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;&#38263;&#12373;&#12384;&#12369;&#12391;&#12356;&#12356;.</span><span>
</span><a name="line-2044"></a><span>    </span><span class="hs-identifier">isMaybeMulti</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2045"></a><span>    </span><a name="local-6989586621679476529"><a href="#local-6989586621679476529"><span class="hs-identifier">isMaybeMulti</span></a></a><span> </span><a name="local-6989586621679476551"><a href="#local-6989586621679476551"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679476551"><span class="hs-identifier hs-var">cs</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-2046"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-6989586621679476551"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2047"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2048"></a><span>
</span><a name="line-2049"></a><span>    </span><span class="hs-comment">-- | &#32207;&#22770;&#19978;&#12363;&#12425;&#12524;&#12531;&#12479;&#12523;&#12363;&#12522;&#12540;&#12473;&#12363;&#21028;&#26029;(24&#24180;&#38480;&#23450;)</span><span>
</span><a name="line-2050"></a><span>    </span><span class="hs-comment">-- &#21516;&#21015;&#12414;&#12383;&#12399;,&#12393;&#12385;&#12425;&#12418;&#12487;&#12540;&#12479;&#12364;&#23384;&#22312;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399;&#12524;&#12531;&#12479;&#12523;</span><span>
</span><a name="line-2051"></a><span>    </span><span class="hs-identifier">totalRorL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#RentalOrLease"><span class="hs-identifier hs-type">RentalOrLease</span></a><span>
</span><a name="line-2052"></a><span>    </span><a name="local-6989586621679476530"><a href="#local-6989586621679476530"><span class="hs-identifier">totalRorL</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#Rental"><span class="hs-identifier hs-var">Rental</span></a><span>
</span><a name="line-2053"></a><span>    </span><span class="hs-identifier">totalRorL</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476552"><a href="#local-6989586621679476552"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#Lease"><span class="hs-identifier hs-var">Lease</span></a><span>
</span><a name="line-2054"></a><span>    </span><span class="hs-identifier">totalRorL</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476553"><a href="#local-6989586621679476553"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#Rental"><span class="hs-identifier hs-var">Rental</span></a><span>
</span><a name="line-2055"></a><span>    </span><span class="hs-identifier">totalRorL</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476554"><a href="#local-6989586621679476554"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476555"><a href="#local-6989586621679476555"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476554"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679476555"><span class="hs-identifier hs-var">l</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#Rental"><span class="hs-identifier hs-var">Rental</span></a><span>
</span><a name="line-2056"></a><span>                                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#Lease"><span class="hs-identifier hs-var">Lease</span></a><span>
</span><a name="line-2057"></a><span>
</span><a name="line-2058"></a><span>
</span><a name="line-2059"></a><span>    </span><span class="hs-comment">-- | &#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#38306;&#12375;&#12390;,&#37329;&#38989;&#22793;&#25563;&#12375;&#12383;&#12418;&#12398;&#12364;Null&#12394;&#12425;,&#20107;&#26989;&#21454;&#20837;&#12434;&#29992;&#12356;&#12427;,&#12371;&#12398;&#22580;&#21512;,&#32207;&#21512;&#12522;&#12540;&#12473;&#12420;&#21508;&#31278;&#12408;&#12398;&#23550;&#24540;&#12399;&#30465;&#30053; (&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12391;&#33258;&#21205;&#12391;&#12394;&#12427;&#12363;&#12425;)</span><span>
</span><a name="line-2060"></a><span>    </span><span class="hs-comment">-- &#19978;&#12364;Not Null &#12394;&#12425;,</span><span>
</span><a name="line-2061"></a><span>    </span><span class="hs-comment">-- &#19978;&#12398;&#20516;&#12434;&#29992;&#12356;&#12427;.</span><span>
</span><a name="line-2062"></a><span>    </span><span class="hs-comment">-- &#24215;&#33303;&#24418;&#24907;&#31684;&#22258;&#22806;&#12394;&#12425;&#12381;&#12398;&#12414;&#12414;&#22793;&#25563;, &#31684;&#22258;&#20869;&#12394;&#12425;&#24418;&#24907;&#30058;&#21495;&#12434;&#21442;&#29031;&#12375;&#12390;&#12510;&#12483;&#12481;&#12531;&#12464;&#12377;&#12428;&#12400;&#22793;&#25563;</span><span>
</span><a name="line-2063"></a><span>    </span><span class="hs-comment">-- &#24215;&#33303;&#24418;&#24907;&#12392;&#12510;&#12483;&#12481;&#12531;&#12464;&#12375;&#12394;&#12356;,&#24215;&#33303;&#24418;&#24907;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;,&#31684;&#22258;&#20869;&#26684;&#20184;&#12369;&#19981;&#26126;</span><span>
</span><a name="line-2064"></a><span>    </span><span class="hs-comment">-- 28&#24180;&#12398;&#24215;&#33303;&#24418;&#24907;&#12395;&#12424;&#12427;&#32207;&#21512;&#12522;&#12540;&#12473;&#26989;&#21450;&#12403;,&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#12408;&#12398;&#25391;&#26367;&#12399;&#12371;&#12371;&#12391;&#34892;&#12358;</span><span>
</span><a name="line-2065"></a><span>
</span><a name="line-2066"></a><span>    </span><span class="hs-identifier">convertServiceB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-2067"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%30B5B"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#12469;B</span></a><span>
</span><a name="line-2068"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5E97%8217%5F62%614B_%30B5B"><span class="hs-identifier hs-type">Val&#24215;&#33303;&#24418;&#24907;_&#12469;B</span></a><span>
</span><a name="line-2069"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30EC%30F3%30BF%30EB%7DCF%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#12524;&#12531;&#12479;&#12523;&#32207;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2070"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%30EA%30FC%30B9%5E74%9593%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#12522;&#12540;&#12473;&#24180;&#38291;&#22865;&#32004;&#39640;</span></a><span>
</span><a name="line-2071"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%30EC%30F3%30BF%30EB%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12524;&#12531;&#12479;&#12523;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-comment">{- ^ &#37329;&#38989;&#12395;&#22793;&#25563;&#28168;&#12415; -}</span><span>
</span><a name="line-2072"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5546%54C1%5225%30EA%30FC%30B9%5951%7D04%9AD8"><span class="hs-identifier hs-type">Val&#21830;&#21697;&#21029;&#12522;&#12540;&#12473;&#22865;&#32004;&#39640;</span></a><span>   </span><span class="hs-comment">{- ^ &#37329;&#38989;&#12395;&#22793;&#25563;&#28168;&#12415; -}</span><span>
</span><a name="line-2073"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Cars&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2074"></a><span>
</span><a name="line-2075"></a><span>    </span><a name="local-6989586621679476531"><a href="#local-6989586621679476531"><span class="hs-identifier">convertServiceB</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-identifier">_</span><span>    </span><a name="local-6989586621679476556"><a href="#local-6989586621679476556"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679476557"><a href="#local-6989586621679476557"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679476558"><a href="#local-6989586621679476558"><span class="hs-identifier">vrs</span></a></a><span> </span><a name="local-6989586621679476559"><a href="#local-6989586621679476559"><span class="hs-identifier">vls</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476528"><span class="hs-identifier hs-var">convertToMulti</span></a><span> </span><a href="#local-6989586621679476556"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476557"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679476558"><span class="hs-identifier hs-var">vrs</span></a><span> </span><a href="#local-6989586621679476559"><span class="hs-identifier hs-var">vls</span></a><span>
</span><a name="line-2076"></a><span>
</span><a name="line-2077"></a><span>    </span><span class="hs-identifier">convertServiceB</span><span> </span><span class="hs-number">24</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476560"><a href="#local-6989586621679476560"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a name="local-6989586621679476561"><a href="#local-6989586621679476561"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679476562"><a href="#local-6989586621679476562"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679476563"><a href="#local-6989586621679476563"><span class="hs-identifier">vrs</span></a></a><span> </span><a name="local-6989586621679476564"><a href="#local-6989586621679476564"><span class="hs-identifier">vls</span></a></a><span>
</span><a name="line-2078"></a><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476565"><a href="#local-6989586621679476565"><span class="hs-identifier">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476560"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2079"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476565"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2080"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476528"><span class="hs-identifier hs-var">convertToMulti</span></a><span> </span><a href="#local-6989586621679476561"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476562"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679476563"><span class="hs-identifier hs-var">vrs</span></a><span> </span><a href="#local-6989586621679476564"><span class="hs-identifier hs-var">vls</span></a><span class="hs-special">)</span><span>
</span><a name="line-2081"></a><span>                        </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476566"><a href="#local-6989586621679476566"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476566"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476560"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2082"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476567"><a href="#local-6989586621679476567"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476567"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476560"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2083"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476530"><span class="hs-identifier hs-var">totalRorL</span></a><span> </span><a href="#local-6989586621679476561"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476562"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2084"></a><span>                                </span><a href="VTable.Compliation.html#Lease"><span class="hs-identifier hs-var">Lease</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476565"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2085"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476568"><a href="#local-6989586621679476568"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476568"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-2086"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476560"><span class="hs-identifier hs-var">cb</span></a><span> </span><span class="hs-comment">-- &#20108;&#37325;&#35336;&#19978;&#12375;&#12394;&#12356;&#12383;&#12417;&#12398;filter</span><span>
</span><a name="line-2087"></a><span>
</span><a name="line-2088"></a><span>                                </span><a href="VTable.Compliation.html#Rental"><span class="hs-identifier hs-var">Rental</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476565"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2089"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476569"><a href="#local-6989586621679476569"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476569"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-2090"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476560"><span class="hs-identifier hs-var">cb</span></a><span> </span><span class="hs-comment">-- &#20108;&#37325;&#35336;&#19978;&#12375;&#12394;&#12356;&#12383;&#12417;&#12398;filter</span><span>
</span><a name="line-2091"></a><span>
</span><a name="line-2092"></a><span>    </span><span class="hs-identifier">convertServiceB</span><span> </span><span class="hs-number">24</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476570"><a href="#local-6989586621679476570"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476571"><a href="#local-6989586621679476571"><span class="hs-identifier">tx</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679476572"><a href="#local-6989586621679476572"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679476573"><a href="#local-6989586621679476573"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679476574"><a href="#local-6989586621679476574"><span class="hs-identifier">vrs</span></a></a><span> </span><a name="local-6989586621679476575"><a href="#local-6989586621679476575"><span class="hs-identifier">vls</span></a></a><span>
</span><a name="line-2093"></a><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476576"><a href="#local-6989586621679476576"><span class="hs-identifier">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476570"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2094"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476576"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2095"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476528"><span class="hs-identifier hs-var">convertToMulti</span></a><span> </span><a href="#local-6989586621679476572"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476573"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679476574"><span class="hs-identifier hs-var">vrs</span></a><span> </span><a href="#local-6989586621679476575"><span class="hs-identifier hs-var">vls</span></a><span class="hs-special">)</span><span>
</span><a name="line-2096"></a><span>                        </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476577"><a href="#local-6989586621679476577"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476577"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476571"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476570"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2097"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476578"><a href="#local-6989586621679476578"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476578"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476571"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476570"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2098"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476530"><span class="hs-identifier hs-var">totalRorL</span></a><span> </span><a href="#local-6989586621679476572"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476573"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2099"></a><span>                                </span><a href="VTable.Compliation.html#Lease"><span class="hs-identifier hs-var">Lease</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476576"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2100"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476579"><a href="#local-6989586621679476579"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476579"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476571"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-2101"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476570"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2102"></a><span>
</span><a name="line-2103"></a><span>                                </span><a href="VTable.Compliation.html#Rental"><span class="hs-identifier hs-var">Rental</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476576"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2104"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476580"><a href="#local-6989586621679476580"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476580"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476571"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B24"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;24</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540824"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;24</span></a><span class="hs-special">)</span><span>
</span><a name="line-2105"></a><span>                                       </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476570"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2106"></a><span>
</span><a name="line-2107"></a><span>    </span><span class="hs-identifier">convertServiceB</span><span> </span><span class="hs-number">28</span><span>   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476581"><a href="#local-6989586621679476581"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a name="local-6989586621679476582"><a href="#local-6989586621679476582"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679476583"><a href="#local-6989586621679476583"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679476584"><a href="#local-6989586621679476584"><span class="hs-identifier">vrs</span></a></a><span> </span><a name="local-6989586621679476585"><a href="#local-6989586621679476585"><span class="hs-identifier">vls</span></a></a><span>
</span><a name="line-2108"></a><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476586"><a href="#local-6989586621679476586"><span class="hs-identifier">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476581"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2109"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476586"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2110"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476528"><span class="hs-identifier hs-var">convertToMulti</span></a><span> </span><a href="#local-6989586621679476582"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476583"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679476584"><span class="hs-identifier hs-var">vrs</span></a><span> </span><a href="#local-6989586621679476585"><span class="hs-identifier hs-var">vls</span></a><span class="hs-special">)</span><span>
</span><a name="line-2111"></a><span>                                </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476587"><a href="#local-6989586621679476587"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679476587"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476581"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2112"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476588"><a href="#local-6989586621679476588"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679476588"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476581"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2113"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476530"><span class="hs-identifier hs-var">totalRorL</span></a><span> </span><a href="#local-6989586621679476582"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476583"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2114"></a><span>                                        </span><a href="VTable.Compliation.html#Lease"><span class="hs-identifier hs-var">Lease</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476586"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;7011&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2115"></a><span>                                               </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476589"><a href="#local-6989586621679476589"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679476589"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span>
</span><a name="line-2116"></a><span>                                               </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476581"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2117"></a><span>
</span><a name="line-2118"></a><span>                                        </span><a href="VTable.Compliation.html#Rental"><span class="hs-identifier hs-var">Rental</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">sumCars</span></a><span> </span><a href="#local-6989586621679476586"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;7019&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2119"></a><span>                                               </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476590"><a href="#local-6989586621679476590"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679476590"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span>
</span><a name="line-2120"></a><span>                                               </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476581"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2121"></a><span>
</span><a name="line-2122"></a><span>    </span><span class="hs-identifier">convertServiceB</span><span> </span><span class="hs-number">28</span><span>   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476591"><a href="#local-6989586621679476591"><span class="hs-identifier">cb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476592"><a href="#local-6989586621679476592"><span class="hs-identifier">tx</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679476593"><a href="#local-6989586621679476593"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679476594"><a href="#local-6989586621679476594"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679476595"><a href="#local-6989586621679476595"><span class="hs-identifier">vrs</span></a></a><span> </span><a name="local-6989586621679476596"><a href="#local-6989586621679476596"><span class="hs-identifier">vls</span></a></a><span>
</span><a name="line-2123"></a><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476597"><a href="#local-6989586621679476597"><span class="hs-identifier">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#is%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">VDC.is&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span>  </span><span class="hs-number">28</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476591"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2124"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476529"><span class="hs-identifier hs-var">isMaybeMulti</span></a><span> </span><a href="#local-6989586621679476597"><span class="hs-identifier hs-var">cbIs&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2125"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476528"><span class="hs-identifier hs-var">convertToMulti</span></a><span> </span><a href="#local-6989586621679476593"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679476594"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679476595"><span class="hs-identifier hs-var">vrs</span></a><span> </span><a href="#local-6989586621679476596"><span class="hs-identifier hs-var">vls</span></a><span class="hs-special">)</span><span>
</span><a name="line-2126"></a><span>                                </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476598"><a href="#local-6989586621679476598"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679476598"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476592"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476591"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2127"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476599"><a href="#local-6989586621679476599"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679476599"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476592"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476591"><span class="hs-identifier hs-var">cb</span></a><span>
</span><a name="line-2128"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476600"><a href="#local-6989586621679476600"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476532"><span class="hs-identifier hs-var">lookupShopType</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="#local-6989586621679476600"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679476592"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B28"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;28</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5B%4E8B%696D%53CE%5165_%5E97%8217%5F62%614B%4E0D%9069%540828"><span class="hs-identifier hs-var">gd&#12469;B&#20107;&#26989;&#21454;&#20837;_&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;28</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476591"><span class="hs-identifier hs-var">cb</span></a><span> </span><span class="hs-comment">-- &#24215;&#33303;&#24418;&#24907;&#30058;&#21495;&#12434;&#21033;&#29992;&#12375;&#12390;&#33258;&#21205;&#12391;&#32207;&#21512;&#12522;&#12540;&#12473;/&#21508;&#31278;&#29289;&#21697;&#36035;&#36024;&#26989;&#12434;&#20998;&#39006;</span><span>
</span><a name="line-2129"></a><span>
</span><a name="line-2130"></a><span>
</span><a name="line-2131"></a><span>    </span><span class="hs-comment">--  | &#20107;&#26989;&#21454;&#20837;&#30058;&#21495;&#12392;&#24215;&#33303;&#24418;&#24907;&#30058;&#21495;&#12364;&#12510;&#12483;&#12481;&#12375;&#12390;&#12356;&#12427;&#12363;&#12395;&#24540;&#12376;&#12390;,&#29987;&#26989;&#32048;&#20998;&#39006;&#12395;&#22793;&#25563;&#12377;&#12427;</span><span>
</span><a name="line-2132"></a><span>    </span><span class="hs-identifier">lookupShopType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#Text%5E97%8217%5F62%614B%756A%53F7"><span class="hs-identifier hs-type">Text&#24215;&#33303;&#24418;&#24907;&#30058;&#21495;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#M%5E97%8217%5F62%614B%9069%5408%30DE%30C3%30D7"><span class="hs-identifier hs-type">M&#24215;&#33303;&#24418;&#24907;&#36969;&#21512;&#12510;&#12483;&#12503;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#M%5E97%8217%5F62%614B%4E0D%9069%5408%30DE%30C3%30D7"><span class="hs-identifier hs-type">M&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;&#12510;&#12483;&#12503;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2133"></a><span>    </span><a name="local-6989586621679476532"><a href="#local-6989586621679476532"><span class="hs-identifier">lookupShopType</span></a></a><span> </span><a name="local-6989586621679476601"><a href="#local-6989586621679476601"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476602"><a href="#local-6989586621679476602"><span class="hs-identifier">ca</span></a></a><span> </span><a name="local-6989586621679476603"><a href="#local-6989586621679476603"><span class="hs-identifier">txShopNum</span></a></a><span> </span><a name="local-6989586621679476604"><a href="#local-6989586621679476604"><span class="hs-identifier">mp1</span></a></a><span> </span><a name="local-6989586621679476605"><a href="#local-6989586621679476605"><span class="hs-identifier">mp2</span></a></a><span>
</span><a name="line-2134"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Data.Classification.html#is%5E97%8217%7BC4%56F2"><span class="hs-identifier hs-var">VDC.is&#24215;&#33303;&#31684;&#22258;</span></a><span> </span><a href="#local-6989586621679476601"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476603"><span class="hs-identifier hs-var">txShopNum</span></a><span>     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679476603"><span class="hs-identifier hs-var">txShopNum</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476604"><span class="hs-identifier hs-var">mp1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2135"></a><span>                                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476606"><a href="#local-6989586621679476606"><span class="hs-identifier">newName</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476606"><span class="hs-identifier hs-var">newName</span></a><span>
</span><a name="line-2136"></a><span>                                                    </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476605"><span class="hs-identifier hs-var">mp2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2137"></a><span>                                                                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476607"><a href="#local-6989586621679476607"><span class="hs-identifier">newName2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476607"><span class="hs-identifier hs-var">newName2</span></a><span>
</span><a name="line-2138"></a><span>                                                                        </span><span class="hs-identifier hs-var">Nothing</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;R2ZZ&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2139"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476605"><span class="hs-identifier hs-var">mp2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2140"></a><span>                                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476608"><a href="#local-6989586621679476608"><span class="hs-identifier">newName</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476608"><span class="hs-identifier hs-var">newName</span></a><span>
</span><a name="line-2141"></a><span>                                                    </span><span class="hs-identifier hs-var">Nothing</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476602"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;R2ZZ&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2142"></a><span>
</span><a name="line-2143"></a><span>
</span><a name="line-2144"></a><span class="hs-keyword">type</span><span> </span><a name="Text%5E97%8217%5F62%614B%756A%53F7"><a href="VTable.Compliation.html#Text%5E97%8217%5F62%614B%756A%53F7"><span class="hs-identifier">Text&#24215;&#33303;&#24418;&#24907;&#30058;&#21495;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-2145"></a><span class="hs-keyword">type</span><span> </span><a name="Text%4E8B%696D%53CE%5165%756A%53F7"><a href="VTable.Compliation.html#Text%4E8B%696D%53CE%5165%756A%53F7"><span class="hs-identifier">Text&#20107;&#26989;&#21454;&#20837;&#30058;&#21495;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-2146"></a><span>
</span><a name="line-2147"></a><span class="hs-comment">-- | &#20107;&#26989;&#21454;&#20837;&#30058;&#21495;&#12392;&#24215;&#33303;&#24418;&#24907;&#12364;&#12510;&#12483;&#12481;(e.g &#23487;&#27850;&#26989;, &#26053;&#39208;&#12507;&#12486;&#12523;)&#12375;&#12390;&#12356;&#12427;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-2148"></a><span class="hs-keyword">type</span><span> </span><a name="M%5E97%8217%5F62%614B%9069%5408%30DE%30C3%30D7"><a href="VTable.Compliation.html#M%5E97%8217%5F62%614B%9069%5408%30DE%30C3%30D7"><span class="hs-identifier">M&#24215;&#33303;&#24418;&#24907;&#36969;&#21512;&#12510;&#12483;&#12503;</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#Text%4E8B%696D%53CE%5165%756A%53F7"><span class="hs-identifier hs-type">Text&#20107;&#26989;&#21454;&#20837;&#30058;&#21495;</span></a><span class="hs-special">,</span><a href="VTable.Compliation.html#Text%5E97%8217%5F62%614B%756A%53F7"><span class="hs-identifier hs-type">Text&#24215;&#33303;&#24418;&#24907;&#30058;&#21495;</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#IndustryDetail"><span class="hs-identifier hs-type">IndustryDetail</span></a><span>
</span><a name="line-2149"></a><span>
</span><a name="line-2150"></a><span class="hs-comment">-- | &#24215;&#33303;&#24418;&#24907;&#12392;&#20107;&#26989;&#21454;&#20837;&#12398;&#12506;&#12450;&#12364;M&#24215;&#33303;&#24418;&#24907;&#36969;&#21512;&#12510;&#12483;&#12503;&#12398;&#20013;&#12395;&#12394;&#12356;&#22580;&#21512;&#12395;,&#20107;&#26989;&#21454;&#20837;&#12434;&#29987;&#26989;&#20998;&#39006;&#32048;&#20998;&#39006;&#12395;&#25391;&#12426;&#36820;&#12427;&#12510;&#12483;&#12503;</span><span>
</span><a name="line-2151"></a><span class="hs-keyword">type</span><span> </span><a name="M%5E97%8217%5F62%614B%4E0D%9069%5408%30DE%30C3%30D7"><a href="VTable.Compliation.html#M%5E97%8217%5F62%614B%4E0D%9069%5408%30DE%30C3%30D7"><span class="hs-identifier">M&#24215;&#33303;&#24418;&#24907;&#19981;&#36969;&#21512;&#12510;&#12483;&#12503;</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VTable.Compliation.html#Text%4E8B%696D%53CE%5165%756A%53F7"><span class="hs-identifier hs-type">Text&#20107;&#26989;&#21454;&#20837;&#30058;&#21495;</span></a><span> </span><a href="VTable.Data.Classification.html#IndustryDetail"><span class="hs-identifier hs-type">IndustryDetail</span></a><span>
</span><a name="line-2152"></a><span>
</span><a name="line-2153"></a><span>
</span><a name="line-2154"></a><span class="hs-comment">-- *** &#21332;&#21516;&#32068;&#21512;</span><span>
</span><a name="line-2155"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2156"></a><span class="hs-comment">{- |
     &#21332;&#21516;&#32068;&#21512;&#12399;&#65292;&#24179;&#25104;24&#65292;28&#24180;&#20849;&#12395;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#21450;&#12403;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21332;&#21516;&#32068;&#21512;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
     &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;
     &#12300;&#36786;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#34892;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#27700;&#29987;&#21152;&#24037;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#26862;&#26519;&#32068;&#21512;&#65292;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#12381;&#12398;&#20182;&#12398;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#65288;1~5&#12398;&#21332;&#21516;&#32068;&#21512;&#20197;&#22806;&#65289;&#12301;
     &#12398;&#12358;&#12385;&#19968;&#12388;&#12434;&#22238;&#31572;&#12377;&#12427;&#24418;&#24335;&#12398;&#35519;&#26619;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;

     &#12414;&#12383;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#12381;&#12428;&#12395;&#36861;&#21152;&#12375;&#12390;&#65292;&#12300;&#20449;&#29992;&#20107;&#26989;&#21448;&#12399;&#20849;&#28168;&#20107;&#26989;&#12398;&#23455;&#26045;&#12398;&#26377;&#28961;&#12301;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#29987;&#26989;&#36899;&#38306;&#34920;&#12391;&#12399;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#21454;&#30410;&#12398;&#37197;&#20998;&#20808;&#12399;&#65292;
     &#12300;&#36786;&#26519;&#27700;&#29987;&#37329;&#34701;&#26989;&#65292;&#21368;&#22770;&#65292;&#23567;&#22770;&#65292;&#20489;&#24235;&#65292;&#23550;&#20225;&#26989;&#27665;&#38291;&#38750;&#21942;&#21033;&#22243;&#20307;&#12301;&#12398;&#65301;&#29987;&#26989;&#12391;&#12354;&#12426;&#65292;
     &#21332;&#21516;&#32068;&#21512;&#12381;&#12428;&#33258;&#20307;&#12398;&#29987;&#26989;&#21306;&#20998;&#12399;&#23384;&#22312;&#12375;&#12394;&#12356;&#65294;
     &#12381;&#12428;&#12395;&#28310;&#12376;&#12390;&#65292;&#32068;&#26367;&#38598;&#35336;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#21454;&#30410;&#12434;&#12371;&#12428;&#12425;&#12398;&#29987;&#26989;&#12395;&#21306;&#20998;&#12375;&#12390;&#35352;&#37682;&#12377;&#12427;&#65294;

     &#12300;&#35519;&#26619;&#31080;&#12398;&#35352;&#20837;&#12398;&#20181;&#26041;&#12301;&#12395;&#24467;&#12360;&#12400;&#65292;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12395;&#12362;&#12356;&#12390;&#65292;&#21332;&#21516;&#32068;&#21512;&#12398;&#36070;&#35506;&#37329;&#12399;&#65292;&#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#12398;&#27963;&#21205;&#21454;&#20837;&#12301;&#12395;&#21547;&#12414;&#12428;&#12427;&#12383;&#12417;&#65292;
     &#20998;&#39006;&#12373;&#12428;&#12383;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12395;&#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#12398;&#27963;&#21205;&#21454;&#20837;&#12301;&#12398;&#21454;&#20837;&#37329;&#38989;&#12434;&#20840;&#38989;&#35336;&#19978;&#12377;&#12427;&#65294;

     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#65292;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#36786;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#28417;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#27700;&#29987;&#21152;&#24037;&#26989;&#21332;&#21516;&#32068;&#21512;&#65292;&#26862;&#26519;&#32068;&#21512;&#12301;&#12398;&#20309;&#12428;&#12363;&#12364;&#36984;&#25246;&#12373;&#12428;&#65292;

     &#12414;&#12383;&#65292;&#12300;&#20449;&#29992;&#20107;&#26989;&#21448;&#12399;&#20849;&#28168;&#20107;&#26989;&#12398;&#23455;&#26045;&#12398;&#26377;&#28961;&#12301;&#12395;&#12362;&#12356;&#12390;&#12300;&#34892;&#12387;&#12390;&#12356;&#12427;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#22580;&#21512;&#12395;&#65292;
     &#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12434;&#20840;&#38989;&#12300;&#36786;&#26519;&#27700;&#29987;&#37329;&#34701;&#26989;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;

    &#12300;&#34892;&#12387;&#12390;&#12356;&#12394;&#12356;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#22580;&#21512;&#12399;&#65292;&#12300;&#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;

     &#12414;&#12383;&#65292;&#12300;&#21368;&#22770;&#12398;&#21830;&#21697;&#36009;&#22770;&#38989;&#65288;&#20195;&#29702;&#12539;&#20210;&#31435;&#25163;&#25968;&#26009;&#12434;&#21547;&#12416;&#65289;&#12301;&#12434;&#20840;&#12390;&#21368;&#22770;&#26989;&#65292;&#12300;&#23567;&#22770;&#12426;&#12398;&#21830;&#21697;&#36009;&#22770;&#38989;&#12301;&#12434;&#20840;&#12390;&#23567;&#22770;&#26989;&#12395;&#35352;&#37682;&#12375;&#65292;
     &#12300;&#36939;&#36664;&#12539;&#37109;&#20415;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12434;&#20840;&#12390;&#12300;&#20489;&#24235;&#26989;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;

     &#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#12381;&#12398;&#20182;&#12398;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#12301;&#12364;&#36984;&#25246;&#12373;&#12428;&#12383;&#22580;&#21512;&#12399;&#65292;
     &#12300;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#21448;&#12399;&#65292;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12398;&#21512;&#35336;&#38989;&#12434;&#12300;&#20107;&#26989;&#21332;&#21516;&#32068;&#21512;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12418;&#12398;&#65289;&#12301;&#12395;&#35352;&#37682;&#12377;&#12427;&#65294;

     &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#65292;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12398;&#22238;&#31572;&#12364;&#31561;&#12375;&#12356;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12364;&#31561;&#12375;&#12356;&#20107;&#26989;&#25152;&#12398;&#26696;&#20998;&#27604;&#29575;&#12434;&#29992;&#12356;&#12390;&#65292;
     &#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12398;&#20516;&#12434;&#25353;&#20998;&#12377;&#12427;&#65294;

     &#21452;&#26041;&#12395;&#12362;&#12356;&#12390;&#12300;&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&#12301;&#12398;&#22238;&#31572;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;
     &#12300;&#21332;&#21516;&#32068;&#21512;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12418;&#12398;&#65289; &#20869;&#26684;&#20184;&#19981;&#33021;&#12301;&#12395;&#20840;&#38989;&#12434;&#35352;&#37682;&#12375;&#65292;&#20182;&#12398;&#20107;&#26989;&#25152;&#12398;&#20027;&#26989;&#21103;&#26989;&#21103;&#29987;&#29289;&#20027;&#29983;&#29987;&#29289;&#12398;&#27604;&#29575;&#12434;&#29992;&#12356;&#12390;&#65292;&#22770;&#19978;&#39640;&#12434;&#25353;&#20998;&#12377;&#12427;&#65294;

-}</span><span>
</span><a name="line-2192"></a><span>
</span><a name="line-2193"></a><span>
</span><a name="line-2194"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21332;&#21516;&#32068;&#21512;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2195"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5354%540C%7D44%5408"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5354%540C%7D44%5408"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#21332;&#21516;&#32068;&#21512;</span></a></a><span> </span><a name="local-6989586621679476611"><a href="#local-6989586621679476611"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2196"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-2197"></a><span>    </span><a name="local-6989586621679476621"><a href="#local-6989586621679476621"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2198"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476621"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2199"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476622"><a href="#local-6989586621679476622"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476622"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5354%540C%7D44%5408"><span class="hs-identifier hs-var">E&#21332;&#21516;&#32068;&#21512;</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476612"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2200"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2201"></a><span>        </span><span class="hs-identifier">_</span><span>                                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2202"></a><span>
</span><a name="line-2203"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2204"></a><span>    </span><span class="hs-comment">-- | &#21307;&#30274;&#31119;&#31049;&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-2205"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2206"></a><span>    </span><a name="local-6989586621679476612"><a href="#local-6989586621679476612"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679476613"><a href="#local-6989586621679476613"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2207"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476614"><a href="#local-6989586621679476614"><span class="hs-identifier">man</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-2208"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476615"><a href="#local-6989586621679476615"><span class="hs-identifier">comm</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2209"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476616"><a href="#local-6989586621679476616"><span class="hs-identifier">front</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2210"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476617"><a href="#local-6989586621679476617"><span class="hs-identifier">kind</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2211"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476618"><a href="#local-6989586621679476618"><span class="hs-identifier">bl</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4FE1%7528%5171%6E08%4E8B%696D%306E%6709%7121"><span class="hs-identifier hs-var">H&#20449;&#29992;&#20849;&#28168;&#20107;&#26989;&#12398;&#26377;&#28961;</span></a><span>
</span><a name="line-2212"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476619"><a href="#local-6989586621679476619"><span class="hs-identifier">sales</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476611"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2213"></a><span>        </span><span class="hs-comment">-- &#36605;&#12367;&#12377;&#12427;&#12383;&#12417;&#65292;&#20351;&#29992;&#12375;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;Null&#12395;&#12375;&#12390;&#12418;&#12356;&#12356;&#12363;&#12418;&#12375;&#12428;&#12394;&#12356;&#65288;&#35201;&#20214;&#31561;&#65289;</span><span>
</span><a name="line-2214"></a><span>
</span><a name="line-2215"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476620"><a href="#local-6989586621679476620"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#convNotSuiteVal"><span class="hs-identifier hs-var">convNotSuiteVal</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#getValCarsFromV%5354%540C%7D44%5408"><span class="hs-identifier hs-var">getValCarsFromV&#21332;&#21516;&#32068;&#21512;</span></a><span> </span><a href="#local-6989586621679476614"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476617"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679476618"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621679476619"><span class="hs-identifier hs-var">sales</span></a><span class="hs-special">)</span><span>
</span><a name="line-2216"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476613"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476615"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476620"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476616"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T20&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2217"></a><span>
</span><a name="line-2218"></a><span>
</span><a name="line-2219"></a><span class="hs-comment">{- | E&#20107;&#26989;&#25152;&#24418;&#24907;_&#21307;&#30274;&#31119;&#31049; &#12395;&#23550;&#24540;&#12377;&#12427; E&#20107;&#26989;&#21454;&#20837;_&#21307;&#30274;&#31119;&#31049; &#12398;&#12501;&#12451;&#12540;&#12523;&#12489;&#21517;&#65288;&#38306;&#25968;&#65289;&#12434;&#36820;&#12377;

    &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12398;

    &#36939;&#36664;&#26989; -&gt; &#20489;&#24235;

    &#37329;&#34701;&#26989; -&gt; &#36786;&#26519;&#27700;&#29987;&#37329;&#34701;&#26989;

    &#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307; -&gt; &#21332;&#21516;&#32068;&#21512;

    &#12395;&#12381;&#12428;&#12382;&#12428;&#37197;&#20998;(&#21368;&#22770;&#12426;&#23567;&#22770;&#12426;&#12399;&#65292;&#19968;&#33324;&#30340;&#12394;&#26041;&#27861;&#12391;&#20998;&#35299;&#12373;&#12428;&#12427;&#12398;&#12391;&#20309;&#12418;&#12375;&#12394;&#12356;)

 -}</span><span>
</span><a name="line-2232"></a><span>
</span><a name="line-2233"></a><span class="hs-identifier">getValCarsFromV&#21332;&#21516;&#32068;&#21512;</span><span> </span><span class="hs-glyph">::</span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%4FE1%7528%5171%6E08%4E8B%696D%306E%6709%7121"><span class="hs-identifier hs-type">Val&#20449;&#29992;&#20849;&#28168;&#20107;&#26989;&#12398;&#26377;&#28961;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-2234"></a><a name="getValCarsFromV%5354%540C%7D44%5408"><a href="VTable.Compliation.html#getValCarsFromV%5354%540C%7D44%5408"><span class="hs-identifier">getValCarsFromV&#21332;&#21516;&#32068;&#21512;</span></a></a><span> </span><a name="local-6989586621679476623"><a href="#local-6989586621679476623"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679476624"><a href="#local-6989586621679476624"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679476625"><a href="#local-6989586621679476625"><span class="hs-identifier">bl</span></a></a><span> </span><a name="local-6989586621679476626"><a href="#local-6989586621679476626"><span class="hs-identifier">sales</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476632"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679476624"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679476625"><span class="hs-identifier hs-var">bl</span></a><span> </span><a href="#local-6989586621679476626"><span class="hs-identifier hs-var">sales</span></a><span>
</span><a name="line-2235"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2236"></a><span>    </span><span class="hs-comment">-- | &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12363;&#12425;&#20516;&#12434;&#25277;&#20986;</span><span>
</span><a name="line-2237"></a><span>    </span><span class="hs-identifier">projSales</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2238"></a><span>    </span><a name="local-6989586621679476627"><a href="#local-6989586621679476627"><span class="hs-identifier">projSales</span></a></a><span> </span><a name="local-6989586621679476634"><a href="#local-6989586621679476634"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621679476635"><a href="#local-6989586621679476635"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679476636"><a href="#local-6989586621679476636"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476636"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><a href="#local-6989586621679476634"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679476635"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2239"></a><span>    </span><span class="hs-comment">-- | &#36939;&#36664;</span><span>
</span><a name="line-2240"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476628"><a href="#local-6989586621679476628"><span class="hs-identifier">trans</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476627"><span class="hs-identifier hs-var">projSales</span></a><span> </span><span class="hs-string">&quot;T9&quot;</span><span>
</span><a name="line-2241"></a><span>    </span><span class="hs-comment">-- | &#37329;&#34701;&#26989;</span><span>
</span><a name="line-2242"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476629"><a href="#local-6989586621679476629"><span class="hs-identifier">fns</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476627"><span class="hs-identifier hs-var">projSales</span></a><span> </span><span class="hs-string">&quot;T10&quot;</span><span>
</span><a name="line-2243"></a><span>    </span><span class="hs-comment">-- | &#21332;&#21516;&#32068;&#21512;</span><span>
</span><a name="line-2244"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476630"><a href="#local-6989586621679476630"><span class="hs-identifier">coop</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476627"><span class="hs-identifier hs-var">projSales</span></a><span> </span><span class="hs-string">&quot;T11&quot;</span><span>
</span><a name="line-2245"></a><span>
</span><a name="line-2246"></a><span>    </span><span class="hs-comment">-- | &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2247"></a><span>    </span><a name="local-6989586621679476631"><a href="#local-6989586621679476631"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679476623"><span class="hs-identifier hs-var">man</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span>
</span><a name="line-2248"></a><span>
</span><a name="line-2249"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Structure.html#Val%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%4FE1%7528%5171%6E08%4E8B%696D%306E%6709%7121"><span class="hs-identifier hs-type">Val&#20449;&#29992;&#20849;&#28168;&#20107;&#26989;&#12398;&#26377;&#28961;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-2250"></a><span>    </span><a name="local-6989586621679476632"><a href="#local-6989586621679476632"><span class="hs-identifier">f</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2251"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476637"><a href="#local-6989586621679476637"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476630"><span class="hs-identifier hs-var">coop</span></a><span> </span><a href="#local-6989586621679476637"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2252"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2253"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2254"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476638"><a href="#local-6989586621679476638"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476628"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679476638"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476630"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679476638"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476629"><span class="hs-identifier hs-var">fns</span></a><span> </span><a href="#local-6989586621679476638"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2255"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476639"><a href="#local-6989586621679476639"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476628"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679476639"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476630"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679476639"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2256"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476640"><a href="#local-6989586621679476640"><span class="hs-identifier">k</span></a></a><span>     </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476633"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679476640"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2257"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476641"><a href="#local-6989586621679476641"><span class="hs-identifier">k</span></a></a><span>     </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476642"><a href="#local-6989586621679476642"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476628"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679476642"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476630"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679476642"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476633"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679476641"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2258"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476643"><a href="#local-6989586621679476643"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476633"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679476643"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2259"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476644"><a href="#local-6989586621679476644"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476633"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679476644"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2260"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476645"><a href="#local-6989586621679476645"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476646"><a href="#local-6989586621679476646"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476628"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679476646"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476630"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679476646"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476633"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679476645"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476629"><span class="hs-identifier hs-var">fns</span></a><span> </span><a href="#local-6989586621679476646"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;6320&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2261"></a><span>    </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679476647"><a href="#local-6989586621679476647"><span class="hs-identifier">k</span></a></a><span>     </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476648"><a href="#local-6989586621679476648"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476631"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476628"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679476648"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;4710&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476630"><span class="hs-identifier hs-var">coop</span></a><span>  </span><a href="#local-6989586621679476648"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476633"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621679476647"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2262"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-identifier">_</span><span>               </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2263"></a><span>
</span><a name="line-2264"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-2265"></a><span>    </span><a name="local-6989586621679476633"><a href="#local-6989586621679476633"><span class="hs-identifier">getName</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;87ZZ&quot;</span><span>
</span><a name="line-2266"></a><span>    </span><span class="hs-identifier">getName</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476649"><a href="#local-6989586621679476649"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476649"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VTable.Data.Classification.html#edE%5354%540C%7D44%5408%306E%7A2E%985E"><span class="hs-identifier hs-var">edE&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2267"></a><span>                                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476650"><a href="#local-6989586621679476650"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476650"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2268"></a><span>                                        </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;can Not find in edE&#21332;&#21516;&#32068;&#21512;&#12398;&#31278;&#39006;&quot;</span><span>
</span><a name="line-2269"></a><span>
</span><a name="line-2270"></a><span>
</span><a name="line-2271"></a><span class="hs-comment">-- *** &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65306;&#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#65292;&#37109;&#20415;&#23616;&#21463;&#35351;&#34892;&#65292;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;</span><span>
</span><a name="line-2272"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2273"></a><span class="hs-comment">{- | &#12469;&#12540;&#12499;&#12473;A&#12392;&#24314;&#35373;&#12399;&#21516;&#19968;&#12398;&#35519;&#26619;&#38917;&#30446;&#12395;&#38306;&#12431;&#12427;&#12398;&#12391;&#21516;&#26178;&#12395;&#20966;&#29702;&#12377;&#12427;.

    * &#12469;&#12540;&#12499;&#12473;A
     &#38651;&#27671;&#65292;&#12460;&#12473;&#65292;&#29105;&#20379;&#32102;&#65292;&#27700;&#36947;&#26989;&#65292;&#36939;&#36664;&#26989;&#65292;&#37109;&#20415;&#26989;&#65292;&#36890;&#20449;&#65292;&#25918;&#36865;&#65292;&#26144;&#20687;&#12539;&#38899;&#22768;&#12539;&#25991;&#23383;&#24773;&#22577;&#21046;&#20316;&#26989;&#12399;&#65292;
    &#24179;&#25104;24&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#65292;
    &#24179;&#25104;28&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65292;&#23398;&#26657;&#25945;&#32946;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;

    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#12434;&#36984;&#25246;&#12375;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#21450;&#12403;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#20027;&#12394;&#20107;&#26989;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12395;&#12390;&#65292;
    &#31532;10&#20301;&#12414;&#12391;&#12398;&#32048;&#20998;&#39006;&#30456;&#24403;&#12398;&#12300;&#20107;&#26989;&#20869;&#23481;&#21450;&#12403;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21448;&#12399;&#21106;&#21512;&#12301;&#12434;&#25226;&#25569;&#12375;&#12390;&#12356;&#12427;&#65294;

    &#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12354;&#12426;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12399;&#38598;&#35336;&#23550;&#35937;&#12392;&#12394;&#12425;&#12394;&#12356;&#12383;&#12417;&#65292;&#12300;&#20027;&#12394;&#20107;&#26989;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12398;&#20516;&#12434;&#30452;&#25509;&#20225;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12392;&#12375;&#12390;&#21033;&#29992;&#12377;&#12427;&#65294;


    * &#24314;&#35373;
    &#24179;&#25104;24&#65292;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#12395;&#12362;&#12369;&#12427;&#24314;&#35373;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
    &#35519;&#26619;&#31080;&#35023;&#38754;&#12300;15 &#20027;&#12394;&#20107;&#26989;&#21454;&#20837;&#12398;&#20869;&#35379;&#12301;&#12391;
    &#12300;&#22303;&#26408;&#24037;&#20107;&#65292;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#65292;&#38750;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#65292;&#27231;&#26800;&#35373;&#20633;&#24037;&#20107;&#12301;&#12398;&#12381;&#12428;&#12382;&#12428;
    &#12300;&#20803;&#35531;&#65292;&#19979;&#35531;&#12369;&#12301;&#21029;&#65288;&#20197;&#19979;&#65292;&#24314;&#31689;8&#21306;&#20998;&#12392;&#21628;&#31216;&#65289;&#12395;&#35442;&#24403;&#12377;&#12427;&#22770;&#19978;&#21454;&#20837;&#37329;&#38989;&#12414;&#12383;&#12399;&#21106;&#21512;&#12434;&#35352;&#20837;&#12377;&#12427;&#65294;

    &#12414;&#12383;&#65292;&#12300;16 &#26989;&#24907;&#21029;&#24037;&#20107;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
    &#24314;&#31689;&#26989;&#27861;&#12398;&#24037;&#31278;&#21306;&#20998;&#12434;&#19968;&#37096;&#32048;&#20998;&#21270;&#12375;&#12383;33&#31278;&#39006;&#12398;&#26989;&#24907;&#12398;&#20869;&#24180;&#38291;&#12395;&#12362;&#12369;&#12427;&#23436;&#25104;&#24037;&#20107;&#39640;&#19978;&#20301;&#65298;&#31278;&#12434;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12392;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;
    &#19968;&#26041;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
    &#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#21069;&#36848;&#12398;33&#21306;&#20998;&#24037;&#31278;&#12395;&#65292;&#12300;&#19968;&#33324;&#22303;&#26408;&#24314;&#31689;&#24037;&#20107;&#12301;&#12434;&#21152;&#12360;&#12383;34&#21306;&#20998;&#12363;&#12425;&#12398;&#36984;&#25246;&#24335;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#65294;

     &#32068;&#26367;&#38598;&#35336;&#12398;&#12383;&#12417;&#12395;&#24517;&#35201;&#12392;&#12394;&#12427;&#20316;&#26989;&#12399;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#65298;&#12388;&#12363;&#12425;&#65292;
     &#24314;&#35373;&#26989;&#12395;&#12362;&#12369;&#12427;&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12434;&#26126;&#12425;&#12363;&#12395;&#12375;&#65292;&#12381;&#12398;&#27604;&#29575;&#12434;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;A&#65289;&#21450;&#12403;&#65292;
     &#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
     &#12300;&#24314;&#35373;&#20107;&#26989;&#12398;&#21454;&#20837;&#12301;&#12395;&#35352;&#36617;&#12398;&#12354;&#12387;&#12383;&#20107;&#26989;&#25152;&#12398;&#21103;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#27604;&#29575;&#12434;&#25226;&#25569;&#12377;&#12427;&#12371;&#12392;&#12391;&#12354;&#12427;&#65294;
     &#12371;&#12371;&#12391;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#38598;&#35336;&#12395;&#12362;&#12369;&#12427;&#29987;&#26989;&#26684;&#20184;&#12369;&#12398;&#12300;&#29305;&#27530;&#12394;&#26041;&#27861;&#12301;&#12395;&#21063;&#12426;&#12394;&#12364;&#12425;&#65292;&#20027;&#26989;&#12398;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#12398;&#22770;&#19978;&#39640;&#12434;&#25226;&#25569;&#12377;&#12427;&#65294;

     &#23550;&#20966;&#26041;&#37341;&#12392;&#12375;&#12390;&#65292;&#24314;&#31689;8&#21306;&#20998;&#12398;&#22770;&#19978;&#38989;&#12434;&#24037;&#31278;&#21306;&#20998;&#12391;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#32887;&#31278;&#12395;&#37197;&#20998;&#12375;&#65292;
     &#12381;&#12398;&#24460;&#65292;&#24037;&#31278;&#21306;&#20998;&#12392;&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12398;&#23550;&#24540;&#34920;&#12434;&#21033;&#29992;&#12375;&#12390;&#12475;&#12531;&#12469;&#12473;&#23567;&#20998;&#39006;&#12395;&#37197;&#20998;&#12377;&#12427;&#65294;
     &#12394;&#12362;&#65292;&#12475;&#12531;&#12469;&#12473;&#32048;&#20998;&#39006;&#12395;&#12362;&#12369;&#12427;&#12300;&#19968;&#33324;&#22303;&#26408;&#24314;&#31689;&#24037;&#20107;&#26989;&#12301;&#12395;&#12399;&#65292;&#24314;&#31689;8&#21306;&#20998;&#12395;&#12362;&#12369;&#12427;&#12300;&#22303;&#26408;&#24037;&#20107;&#12301;&#65292;
     &#12300;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#21448;&#12399;&#38750;&#20303;&#23429;&#24314;&#31689;&#24037;&#20107;&#12539;&#21516;&#35373;&#20633;&#24037;&#20107;&#12301;&#12364;&#20849;&#12395;&#35352;&#36617;&#12373;&#12428;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;&#65292;&#12354;&#12427;&#12356;&#12399;&#65292;&#24037;&#31278;&#21306;&#20998;&#12395;&#12362;&#12356;&#12390;&#65292;
     &#12300;&#22303;&#26408;&#19968;&#24335;&#24037;&#20107;&#12301;&#21450;&#12403;&#12300;&#24314;&#31689;&#19968;&#24335;&#24037;&#20107;&#65292;&#21448;&#12399;&#26408;&#36896;&#24314;&#31689;&#19968;&#24335;&#24037;&#20107;&#12301;&#12398;&#21452;&#26041;&#12364;&#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;&#12363;&#12425;&#65292;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35352;&#36617;&#12300;&#19968;&#33324;&#22303;&#26408;&#24314;&#31689;&#24037;&#20107;&#65288;&#23436;&#25104;&#24037;&#20107;&#39640;&#12395;&#12362;&#12356;&#12390;&#24314;&#31689;&#24037;&#20107;&#12398;&#21344;&#12417;&#12427;&#21106;&#21512;&#12364;&#65298;&#21106;&#20197;&#19978;&#65292;8&#21106;&#26410;&#28288;&#65289;&#12301;&#65292;
     &#12300;&#22303;&#26408;&#19968;&#24335;&#24037;&#20107;&#65288;&#23436;&#25104;&#24037;&#20107;&#39640;&#12395;&#12362;&#12356;&#12390;&#24314;&#31689;&#24037;&#20107;&#12398;&#21344;&#12417;&#12427;&#21106;&#21512;&#12364;&#65298;&#21106;&#26410;&#28288;&#65289;&#12301;&#65292;
     &#12300;&#24314;&#31689;&#19968;&#24335;&#24037;&#20107;&#65288;&#23436;&#25104;&#24037;&#20107;&#39640;&#12395;&#12362;&#12356;&#12390;&#24314;&#31689;&#24037;&#20107;&#12398;&#21344;&#12417;&#12427;&#21106;&#21512;&#12364;8&#21106;&#20197;&#19978;&#65289;&#12301;&#12395;&#24467;&#12387;&#12390;&#65292;&#20998;&#39006;&#12377;&#12427;&#65294;

    &#12394;&#12362;,&#20107;&#26989;&#21029;&#22770;&#19978;(&#21454;&#20837;)&#37329;&#38989;&#12398;&#20869;&#35379;&#12395;&#12362;&#12369;&#12427;,&#19979;&#35531;&#12369;&#24037;&#20107;&#37096;&#20998;&#12399;,&#20108;&#37325;&#35336;&#19978;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;,&#24460;&#12395;&#21066;&#38500;&#12377;&#12427;&#12364;,&#21508;&#20107;&#26989;&#25152;&#21336;&#20301;&#12391;&#12399;&#21066;&#38500;&#12375;&#12394;&#12356;.


    * &#37329;&#34701;&#26989;,&#20445;&#38522;&#26989;
    &#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12391;&#12399;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#65292;
    &#24179;&#25104;28&#24180;&#12391;&#12399;&#65292;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65292;&#23398;&#26657;&#25945;&#32946;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
    &#12356;&#12378;&#12428;&#12398;&#22580;&#21512;&#12391;&#12418;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;&#35442;&#24403;&#12377;&#12427;&#20107;&#26989;&#31278;&#39006;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

    &#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989;&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#20225;&#26989;&#21450;&#12403;&#21336;&#29420;&#20107;&#26989;&#25152;&#12434;&#38598;&#35336;&#23550;&#35937;&#12392;&#12375;&#65292;
    &#35079;&#25968;&#20107;&#26989;&#25152;&#12363;&#12425;&#12394;&#12427;&#20225;&#26989;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#21336;&#20301;&#12391;&#12398;&#38598;&#35336;&#12399;&#34892;&#12431;&#12394;&#12356;&#65294;
     &#20225;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#25226;&#25569;&#12395;&#24403;&#12383;&#12387;&#12390;&#12399;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;
     &#22243;&#20307;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#31278;&#39006;&#12395;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#26989;&#12398;&#21454;&#20837;&#12301;&#12398;&#22238;&#31572;&#37329;&#38989;&#12434;&#20840;&#38989;&#36617;&#12379;&#12427;&#65294;
     &#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35299;&#31572;&#27396;&#12395;&#12362;&#12356;&#12390;&#35079;&#25968;&#12398;&#22238;&#31572;&#12364;&#12354;&#12387;&#12383;&#22580;&#21512;&#65292;
     &#20632;&#19979;&#20107;&#26989;&#25152;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#21029;&#12395;&#20107;&#26989;&#25152;&#21029;&#24467;&#26989;&#21729;&#25968;&#12398;&#27604;&#29575;&#12434;&#25499;&#12369;&#12390;&#20225;&#26989;&#21029;&#26989;&#31278;&#21029;&#22770;&#19978;&#39640;&#12434;&#20986;&#12377;&#65294;
     &#26696;&#20998;&#24460;&#12418;&#24046;&#12364;&#20986;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;&#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294; &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#22238;&#31572;&#12364;&#35079;&#25968;&#12392;&#12394;&#12387;&#12383;&#22580;&#21512;&#12395;&#12399;&#65292;&#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294;


    *&#23398;&#26657;&#25945;&#32946;
    &#23398;&#26657;&#25945;&#32946;&#12399;&#65292;&#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#65292;&#23398;&#26657;&#25945;&#32946;&#12399;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#23398;&#26657;&#25945;&#32946;&#65289;&#65292;
    &#20225;&#26989;&#35519;&#26619;&#31080;&#65288;&#23398;&#26657;&#25945;&#32946;&#65289;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#23398;&#26657;&#25945;&#32946;&#65289;&#12398;&#19977;&#12388;&#12398;&#35519;&#26619;&#31080;&#12395;&#12424;&#12387;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
    &#12371;&#12398;&#12358;&#12385;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#35519;&#26619;&#38917;&#30446;&#12300;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#21454;&#20837;&#20869;&#35379;&#12301;&#12395;&#12362;&#12356;&#12390;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#65292;
    &#12414;&#12383;&#12399;&#21106;&#21512;&#12434;&#35519;&#26619;&#12375;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#20197;&#22806;&#12391;&#12399;&#65292;
    &#35519;&#26619;&#38917;&#30446;&#12300;&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#20107;&#26989;&#25152;&#12398;&#20027;&#12394;&#20107;&#26989;&#12392;&#12375;&#12390;&#35442;&#24403;&#12377;&#12427;&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;&#12398;&#12415;&#12434;&#25226;&#25569;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#65292;&#23398;&#26657;&#25945;&#32946;&#12399;&#65292;&#21336;&#29420;&#20107;&#26989;&#33879;&#35519;&#26619;&#31080;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65292;&#23398;&#26657;&#25945;&#32946;&#65289;&#12395;&#12362;&#12356;&#12390;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
     &#12381;&#12398;&#12358;&#12385;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#12399;&#35519;&#26619;&#38917;&#30446;&#12300;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#21454;&#20837;&#20869;&#35379;&#12301;&#12395;&#12362;&#12356;&#12390;&#23398;&#26657;&#31561;&#31278;&#39006;&#21029;&#12398;&#65292;
     &#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21448;&#12399;&#21106;&#21512;&#12434;&#35519;&#26619;&#12375;&#12390;&#12362;&#12426;&#65292;&#12381;&#12398;&#20182;&#12398;&#35519;&#26619;&#31080;&#12391;&#12399;&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;&#12398;&#12415;&#12434;&#35519;&#26619;&#12375;&#12390;&#12356;&#12427;&#65294;

     &#12356;&#12378;&#12428;&#12398;&#24180;&#24230;&#12395;&#12362;&#12356;&#12390;&#12418;&#65292;&#23398;&#26657;&#25945;&#32946;&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#22411;&#29987;&#26989;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#20197;&#38477;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#20516;&#12434;&#29992;&#12356;&#12394;&#12356;&#65294;
     &#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#20516;&#12399;&#65292;&#12381;&#12398;&#12414;&#12414;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#65292;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#12399;&#65292;
     &#36984;&#25246;&#12373;&#12428;&#12390;&#12356;&#12427;&#23398;&#26657;&#12398;&#31278;&#39006;&#12395;&#65292;22&#21306;&#20998;&#12398;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12395;&#12362;&#12369;&#12427;&#65292;&#12300;&#23398;&#26657;&#25945;&#32946;&#12301;&#12398;&#38989;&#12434;&#20840;&#38989;&#36617;&#12379;&#12390;&#65292;
     &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12392;&#12375;&#12390;&#29992;&#12356;&#12427;&#65294;


    * &#22243;&#20307;
    &#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#12399;&#65292;&#24179;&#25104;24&#24180;&#21336;&#29420;&#20107;&#26989;&#26360;&#35519;&#26619;&#31080;&#65292;
    &#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#24314;&#35373;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;A&#65289;&#65292;
    &#24179;&#25104;28&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65292;&#22243;&#20307;&#35519;&#26619;&#31080;&#65292;
    &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#65289;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#12398;&#31278;&#39006;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
    9&#12388;&#12398;&#24418;&#24907;&#12363;&#12425;&#19968;&#12388;&#12434;&#36984;&#25246;&#12377;&#12427;&#24418;&#24335;&#12391;&#35519;&#26619;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;
    &#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#12301;&#12399;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;
    &#20225;&#26989;&#21450;&#12403;&#22243;&#20307;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#12434;&#38598;&#35336;&#23550;&#35937;&#12392;&#12375;&#65292;&#35079;&#25968;&#20107;&#26989;&#25152;&#12363;&#12425;&#12394;&#12427;&#20225;&#26989;&#65292;
    &#22243;&#20307;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#21336;&#20301;&#12391;&#12398;&#38598;&#35336;&#12399;&#34892;&#12431;&#12394;&#12356;&#65294;
     &#20225;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#25226;&#25569;&#12395;&#24403;&#12383;&#12387;&#12390;&#12399;&#20225;&#26989;&#35519;&#26619;&#31080;&#65292;
     &#22243;&#20307;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#36984;&#25246;&#12373;&#12428;&#12383;&#31278;&#39006;&#12395;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12395;&#12362;&#12369;&#12427;
     &#12300;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#65288;&#22243;&#20307;&#65289;&#12301;&#12398;&#22238;&#31572;&#37329;&#38989;&#12434;&#20840;&#38989;&#36617;&#12379;&#12427;&#65294;
     &#20225;&#26989;&#35519;&#26619;&#31080;&#65292;&#22243;&#20307;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35299;&#31572;&#27396;&#12395;&#12362;&#12356;&#12390;&#35079;&#25968;&#12398;&#22238;&#31572;&#12364;&#12354;&#12387;&#12383;&#22580;&#21512;&#65292;
     &#20632;&#19979;&#20107;&#26989;&#25152;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#35519;&#26619;&#38917;&#30446;&#12300;&#20107;&#26989;&#12398;&#31278;&#39006;&#12301;&#21029;&#12395;&#20107;&#26989;&#25152;&#21029;&#24467;&#26989;&#21729;&#25968;&#12398;&#27604;&#29575;&#12434;&#25499;&#12369;&#12390;&#20225;&#26989;&#21029;&#26989;&#31278;&#21029;&#22770;&#19978;&#39640;&#12434;&#20986;&#12377;&#65294;
     &#26696;&#20998;&#24460;&#12418;&#24046;&#12364;&#20986;&#12394;&#12356;&#22580;&#21512;&#12399;&#65292;&#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294; &#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12395;&#12362;&#12356;&#12390;&#22238;&#31572;&#12364;&#35079;&#25968;&#12392;&#12394;&#12387;&#12383;&#22580;&#21512;&#12395;&#12399;&#65292;
     &#26989;&#31278;&#20869;&#26684;&#20184;&#12369;&#19981;&#21487;&#12392;&#12377;&#12427;&#65294;
-}</span><span>
</span><a name="line-2364"></a><span>
</span><a name="line-2365"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2366"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5EFA%30B5A"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%5EFA%30B5A"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A</span></a></a><span> </span><a name="local-6989586621679476651"><a href="#local-6989586621679476651"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476652"><a href="#local-6989586621679476652"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-2367"></a><span>    </span><span class="hs-comment">-- &#35519;&#26619;&#31080;&#12398;&#31278;&#39006;&#12391;&#65292;&#20966;&#29702;&#12434;&#34892;&#12358;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-2368"></a><span>    </span><a name="local-6989586621679476667"><a href="#local-6989586621679476667"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2369"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476667"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2370"></a><span>        </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476668"><a href="#local-6989586621679476668"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476668"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476653"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476651"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2371"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476668"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A%5B66%6821"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A&#23398;&#26657;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476653"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476651"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2372"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476668"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%56E3%4F53"><span class="hs-identifier hs-var">E&#22243;&#20307;</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476653"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476651"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2373"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476668"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5B66%6821%6559%80B2"><span class="hs-identifier hs-var">E&#23398;&#26657;&#25945;&#32946;</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476653"><span class="hs-identifier hs-var">ifSuite</span></a><span> </span><a href="#local-6989586621679476651"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2374"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2375"></a><span>        </span><span class="hs-identifier">_</span><span>                                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2376"></a><span>
</span><a name="line-2377"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2378"></a><span>    </span><span class="hs-comment">-- | &#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A&#12384;&#12387;&#12383;&#22580;&#21512;&#12398;&#20966;&#29702;</span><span>
</span><a name="line-2379"></a><span>    </span><span class="hs-identifier">ifSuite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2380"></a><span>    </span><a name="local-6989586621679476653"><a href="#local-6989586621679476653"><span class="hs-identifier">ifSuite</span></a></a><span> </span><a name="local-6989586621679476654"><a href="#local-6989586621679476654"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476655"><a href="#local-6989586621679476655"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2381"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476656"><a href="#local-6989586621679476656"><span class="hs-identifier">man</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">H&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-2382"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476657"><a href="#local-6989586621679476657"><span class="hs-identifier">comm</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2383"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476658"><a href="#local-6989586621679476658"><span class="hs-identifier">consKind</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">H&#24037;&#20107;&#31278;&#39006;</span></a><span>
</span><a name="line-2384"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476659"><a href="#local-6989586621679476659"><span class="hs-identifier">sal</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span>
</span><a name="line-2385"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476660"><a href="#local-6989586621679476660"><span class="hs-identifier">front</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2386"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476661"><a href="#local-6989586621679476661"><span class="hs-identifier">orgKind</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2387"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476662"><a href="#local-6989586621679476662"><span class="hs-identifier">finKind</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%91D1%878D%696D%4FDD%967A%696D%306E%4E8B%696D%7A2E%985E"><span class="hs-identifier hs-var">H&#37329;&#34701;&#26989;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;</span></a><span>
</span><a name="line-2388"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476663"><a href="#local-6989586621679476663"><span class="hs-identifier">schKind</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5B66%6821%7B49%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2389"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476664"><a href="#local-6989586621679476664"><span class="hs-identifier">schIncome</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%53CE%5165%5185%8A33_%5B66%6821"><span class="hs-identifier hs-var">H&#21454;&#20837;&#20869;&#35379;_&#23398;&#26657;</span></a><span>
</span><a name="line-2390"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476665"><a href="#local-6989586621679476665"><span class="hs-identifier">mainKind</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476652"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E3B%306A%4E8B%696D%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2391"></a><span>
</span><a name="line-2392"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476666"><a href="#local-6989586621679476666"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#convNotSuiteVal"><span class="hs-identifier hs-var">convNotSuiteVal</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#getValCarsFromV%5EFA%30B5A"><span class="hs-identifier hs-var">getValCarsFromV&#24314;&#12469;A</span></a><span> </span><a href="#local-6989586621679476654"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476656"><span class="hs-identifier hs-var">man</span></a><span> </span><a href="#local-6989586621679476658"><span class="hs-identifier hs-var">consKind</span></a><span> </span><a href="#local-6989586621679476659"><span class="hs-identifier hs-var">sal</span></a><span> </span><a href="#local-6989586621679476660"><span class="hs-identifier hs-var">front</span></a><span> </span><a href="#local-6989586621679476661"><span class="hs-identifier hs-var">orgKind</span></a><span> </span><a href="#local-6989586621679476662"><span class="hs-identifier hs-var">finKind</span></a><span> </span><a href="#local-6989586621679476663"><span class="hs-identifier hs-var">schKind</span></a><span> </span><a href="#local-6989586621679476664"><span class="hs-identifier hs-var">schIncome</span></a><span> </span><a href="#local-6989586621679476665"><span class="hs-identifier hs-var">mainKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-2393"></a><span>        </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476655"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476657"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476666"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476660"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T6&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T7&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T8&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T9&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2394"></a><span>
</span><a name="line-2395"></a><span class="hs-comment">-- | f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#24314;&#12469;A &#12398;&#20869;&#37096;&#38306;&#25968;</span><span>
</span><a name="line-2396"></a><span class="hs-comment">--</span><span>
</span><a name="line-2397"></a><span class="hs-comment">-- H&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A  &#12399;&#24314;&#35373;&#12392;&#12469;A&#12434;&#20966;&#29702;,&#12381;&#12428;&#20197;&#22806;&#12398;&#38917;&#30446;&#12399;&#29420;&#33258;&#12395;&#20966;&#29702;&#12375;&#12390;&#26368;&#24460;&#12395;&#32080;&#21512;</span><span>
</span><a name="line-2398"></a><span class="hs-comment">--</span><span>
</span><a name="line-2399"></a><span class="hs-comment">-- &#38306;&#25968;&#12372;&#12392;&#12395;&#20998;&#21106;&#12377;&#12427;&#12409;&#12365;&#65288;&#35506;&#38988;&#65289;</span><span>
</span><a name="line-2400"></a><span>
</span><a name="line-2401"></a><span>
</span><a name="line-2402"></a><span class="hs-identifier">getValCarsFromV&#24314;&#12469;A</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-2403"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-type">Val&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span>
</span><a name="line-2404"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-type">Val&#24037;&#20107;&#31278;&#39006;</span></a><span>
</span><a name="line-2405"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span>
</span><a name="line-2406"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2407"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2408"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%91D1%878D%696D%4FDD%967A%696D%306E%4E8B%696D%7A2E%985E"><span class="hs-identifier hs-type">Val&#37329;&#34701;&#26989;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;</span></a><span>
</span><a name="line-2409"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5B66%6821%7B49%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2410"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%53CE%5165%5185%8A33_%5B66%6821"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#20869;&#35379;_&#23398;&#26657;</span></a><span>
</span><a name="line-2411"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E3B%306A%4E8B%696D%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2412"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#ValCars"><span class="hs-identifier hs-type">ValCars</span></a><span>
</span><a name="line-2413"></a><span>
</span><a name="line-2414"></a><a name="getValCarsFromV%5EFA%30B5A"><a href="VTable.Compliation.html#getValCarsFromV%5EFA%30B5A"><span class="hs-identifier">getValCarsFromV&#24314;&#12469;A</span></a></a><span> </span><a name="local-6989586621679476669"><a href="#local-6989586621679476669"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476670"><a href="#local-6989586621679476670"><span class="hs-identifier">man</span></a></a><span> </span><a name="local-6989586621679476671"><a href="#local-6989586621679476671"><span class="hs-identifier">consKind</span></a></a><span> </span><a name="local-6989586621679476672"><a href="#local-6989586621679476672"><span class="hs-identifier">sal</span></a></a><span> </span><a name="local-6989586621679476673"><a href="#local-6989586621679476673"><span class="hs-identifier">sev</span></a></a><span> </span><a name="local-6989586621679476674"><a href="#local-6989586621679476674"><span class="hs-identifier">orgKind</span></a></a><span> </span><a name="local-6989586621679476675"><a href="#local-6989586621679476675"><span class="hs-identifier">finKind</span></a></a><span> </span><a name="local-6989586621679476676"><a href="#local-6989586621679476676"><span class="hs-identifier">schKind</span></a></a><span> </span><a name="local-6989586621679476677"><a href="#local-6989586621679476677"><span class="hs-identifier">schIncome</span></a></a><span> </span><a name="local-6989586621679476678"><a href="#local-6989586621679476678"><span class="hs-identifier">mainKind</span></a></a><span>
</span><a name="line-2415"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476681"><span class="hs-identifier hs-var">seARes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476682"><span class="hs-identifier hs-var">cnsRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476683"><span class="hs-identifier hs-var">orgRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476684"><span class="hs-identifier hs-var">finRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476685"><span class="hs-identifier hs-var">schRes</span></a><span> </span><span class="hs-operator hs-var">V.++</span><span> </span><a href="#local-6989586621679476686"><span class="hs-identifier hs-var">sinRes</span></a><span>
</span><a name="line-2416"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2417"></a><span>    </span><span class="hs-comment">-- | &#24314;&#35373;&#20998;&#12384;&#12369;&#12434;&#25244;&#12365;&#20986;&#12377;</span><span>
</span><a name="line-2418"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">~</span><a name="local-6989586621679476679"><a href="#local-6989586621679476679"><span class="hs-identifier">cns</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679476680"><a href="#local-6989586621679476680"><span class="hs-identifier">seA</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476688"><span class="hs-identifier hs-var">partCns</span></a><span> </span><a href="#local-6989586621679476669"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476672"><span class="hs-identifier hs-var">sal</span></a><span>
</span><a name="line-2419"></a><span>    </span><span class="hs-comment">-- | &#12469;A&#37096;&#20998;</span><span>
</span><a name="line-2420"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476681"><a href="#local-6989586621679476681"><span class="hs-identifier">seARes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476689"><span class="hs-identifier hs-var">convOther</span></a><span> </span><a href="#local-6989586621679476669"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476680"><span class="hs-identifier hs-var">seA</span></a><span>
</span><a name="line-2421"></a><span>    </span><span class="hs-comment">-- | &#24314;&#35373;&#37096;&#20998;</span><span>
</span><a name="line-2422"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476682"><a href="#local-6989586621679476682"><span class="hs-identifier">cnsRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476691"><span class="hs-identifier hs-var">convCns</span></a><span> </span><a href="#local-6989586621679476669"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476671"><span class="hs-identifier hs-var">consKind</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476679"><span class="hs-identifier hs-var">cns</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476673"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2423"></a><span>    </span><span class="hs-comment">-- | &#22243;&#20307;&#12398;&#31278;&#39006;&#37096;&#20998;</span><span>
</span><a name="line-2424"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476683"><a href="#local-6989586621679476683"><span class="hs-identifier">orgRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476694"><span class="hs-identifier hs-var">convOrg</span></a><span> </span><a href="#local-6989586621679476674"><span class="hs-identifier hs-var">orgKind</span></a><span> </span><a href="#local-6989586621679476673"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2425"></a><span>    </span><span class="hs-comment">-- | &#37329;&#34701;&#20445;&#38522;&#26989;&#37096;&#20998;</span><span>
</span><a name="line-2426"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476684"><a href="#local-6989586621679476684"><span class="hs-identifier">finRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476696"><span class="hs-identifier hs-var">convFin</span></a><span> </span><a href="#local-6989586621679476675"><span class="hs-identifier hs-var">finKind</span></a><span> </span><a href="#local-6989586621679476673"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2427"></a><span>    </span><span class="hs-comment">-- | &#23398;&#26657;&#25945;&#32946;&#12398;&#37096;&#20998;</span><span>
</span><a name="line-2428"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476685"><a href="#local-6989586621679476685"><span class="hs-identifier">schRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476698"><span class="hs-identifier hs-var">convSch</span></a><span> </span><a href="#local-6989586621679476677"><span class="hs-identifier hs-var">schIncome</span></a><span> </span><a href="#local-6989586621679476673"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2429"></a><span>    </span><span class="hs-comment">-- | &#12381;&#12398;&#20182;</span><span>
</span><a name="line-2430"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476686"><a href="#local-6989586621679476686"><span class="hs-identifier">sinRes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476699"><span class="hs-identifier hs-var">convForSingles</span></a><span> </span><a href="#local-6989586621679476669"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476676"><span class="hs-identifier hs-var">schKind</span></a><span> </span><a href="#local-6989586621679476678"><span class="hs-identifier hs-var">mainKind</span></a><span>
</span><a name="line-2431"></a><span>
</span><a name="line-2432"></a><span>    </span><span class="hs-comment">-- &#20197;&#19979;, &#38306;&#25968; -----------------------------------------------------</span><span>
</span><a name="line-2433"></a><span>    </span><span class="hs-comment">-- | &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2434"></a><span>    </span><a name="local-6989586621679476687"><a href="#local-6989586621679476687"><span class="hs-identifier">forMC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#convMCinCars"><span class="hs-identifier hs-var">convMCinCars</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679476670"><span class="hs-identifier hs-var">man</span></a><span>
</span><a name="line-2435"></a><span>
</span><a name="line-2436"></a><span>    </span><span class="hs-comment">-- | &#24314;&#35373;&#26989;&#12392;&#12381;&#12428;&#20197;&#22806;&#12391;&#20998;&#38626;&#12377;&#12427;</span><span>
</span><a name="line-2437"></a><span>    </span><span class="hs-identifier">partCns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span class="hs-special">)</span><span>
</span><a name="line-2438"></a><span>    </span><a name="local-6989586621679476688"><a href="#local-6989586621679476688"><span class="hs-identifier">partCns</span></a></a><span> </span><a name="local-6989586621679476700"><a href="#local-6989586621679476700"><span class="hs-identifier">year</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-2439"></a><span>    </span><span class="hs-identifier">partCns</span><span> </span><a name="local-6989586621679476701"><a href="#local-6989586621679476701"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476702"><a href="#local-6989586621679476702"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476703"><a href="#local-6989586621679476703"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679476704"><a href="#local-6989586621679476704"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Classification.html#is%5EFA%8A2D"><span class="hs-identifier hs-var">is&#24314;&#35373;</span></a><span> </span><a href="#local-6989586621679476701"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476704"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><a href="#local-6989586621679476703"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679476702"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679476703"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476702"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2440"></a><span>    </span><span class="hs-identifier">partCns</span><span> </span><a name="local-6989586621679476705"><a href="#local-6989586621679476705"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span class="hs-special">)</span><span>
</span><a name="line-2441"></a><span>
</span><a name="line-2442"></a><span>
</span><a name="line-2443"></a><span>    </span><span class="hs-comment">-- | &#24314;&#35373;&#20197;&#22806;&#12398;&#37096;&#20998;&#12398;&#22793;&#25563; (seA&#12395;&#36969;&#29992;&#12377;&#12427;)</span><span>
</span><a name="line-2444"></a><span>    </span><span class="hs-identifier">convOther</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2445"></a><span>    </span><a name="local-6989586621679476689"><a href="#local-6989586621679476689"><span class="hs-identifier">convOther</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679476706"><a href="#local-6989586621679476706"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679476706"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5%30FC%30D3%30B9A24"><span class="hs-identifier hs-var">gd&#12469;&#12540;&#12499;&#12473;A24</span></a><span>
</span><a name="line-2446"></a><span>    </span><span class="hs-identifier">convOther</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679476707"><a href="#local-6989586621679476707"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#lookupCarsNameErr"><span class="hs-identifier hs-var">lookupCarsNameErr</span></a><span> </span><a href="#local-6989586621679476707"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="VTable.Data.Classification.html#gd%30B5%30FC%30D3%30B9A28"><span class="hs-identifier hs-var">gd&#12469;&#12540;&#12499;&#12473;A28</span></a><span>
</span><a name="line-2447"></a><span>
</span><a name="line-2448"></a><span>
</span><a name="line-2449"></a><span>
</span><a name="line-2450"></a><span>    </span><span class="hs-comment">-- | &#24314;&#35373;&#12384;&#12369;&#12398;Cars&#12434;&#20316;&#12427; &gt;&gt; &#12469;A&#12384;&#12369;&#12398;Cars&#12392;&#32080;&#21512;&#12375;&#12383;&#19978;&#12391;,convMCinCars&#12434;&#36969;&#29992;&#12375;&#12390;&#32080;&#26524;&#12395;&#12377;&#12427;.</span><span>
</span><a name="line-2451"></a><span>    </span><span class="hs-comment">-- 33&#21306;&#20998;&#12395;8&#21306;&#20998;&#12434;&#37197;&#20998;&#12377;&#12427;.</span><span>
</span><a name="line-2452"></a><span>    </span><span class="hs-comment">-- 8&#21306;&#20998;&#12372;&#12392;&#12395;,1&#30058;&#30446;&#12392;2&#30058;&#30446;&#12395;&#12394;&#12428;&#12427;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-2453"></a><span>    </span><span class="hs-comment">-- &#29255;&#26041;&#12395;&#12398;&#12415;&#12394;&#12428;&#12427;&#22580;&#21512;&#12399;&#20840;&#38989;&#12381;&#12385;&#12425;&#12395;&#37197;&#20998;</span><span>
</span><a name="line-2454"></a><span>    </span><span class="hs-comment">-- &#20001;&#26041;&#12395;&#12394;&#12428;&#12427;&#22580;&#21512;&#12399;1&#30058;&#12417;&#12395;60%,&#20108;&#30058;&#30446;&#12395;40%&#12434;&#37197;&#20998;&#12377;&#12427;</span><span>
</span><a name="line-2455"></a><span>    </span><span class="hs-comment">-- &#12356;&#12378;&#12428;&#12395;&#12418;&#12394;&#12428;&#12394;&#12356;&#22580;&#21512;&#12399;,&#26684;&#20184;&#12369;&#19981;&#33021;&#12395;&#37197;&#20998;</span><span>
</span><a name="line-2456"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476690"><a href="#local-6989586621679476690"><span class="hs-identifier">cnsCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;DZZ0&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2457"></a><span>
</span><a name="line-2458"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-type">Val&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%53CE%5165_%5EFA%30B5A"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21454;&#20837;_&#24314;&#12469;A</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2459"></a><span>    </span><a name="local-6989586621679476691"><a href="#local-6989586621679476691"><span class="hs-identifier">convCns</span></a></a><span> </span><a name="local-6989586621679476708"><a href="#local-6989586621679476708"><span class="hs-identifier">year</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2460"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679476709"><a href="#local-6989586621679476709"><span class="hs-identifier">year</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476710"><a href="#local-6989586621679476710"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sumCars"><span class="hs-identifier hs-var">VDS.sumCars</span></a><span> </span><a href="#local-6989586621679476710"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;DZZ0&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2461"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679476711"><a href="#local-6989586621679476711"><span class="hs-identifier">year</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476712"><a href="#local-6989586621679476712"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476713"><a href="#local-6989586621679476713"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T6&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476712"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2462"></a><span>                                                </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476713"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;DZZ0&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2463"></a><span>
</span><a name="line-2464"></a><span>
</span><a name="line-2465"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679476714"><a href="#local-6989586621679476714"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">V&#24037;&#20107;&#31278;&#39006;</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">E&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476715"><a href="#local-6989586621679476715"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679476716"><a href="#local-6989586621679476716"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2466"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476715"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476716"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2467"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476717"><a href="#local-6989586621679476717"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476718"><a href="#local-6989586621679476718"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476717"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2468"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476719"><a href="#local-6989586621679476719"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476719"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2469"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476720"><a href="#local-6989586621679476720"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476720"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-2470"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><a href="#local-6989586621679476690"><span class="hs-identifier hs-var">cnsCNC</span></a><span>
</span><a name="line-2471"></a><span>
</span><a name="line-2472"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679476721"><a href="#local-6989586621679476721"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">V&#24037;&#20107;&#31278;&#39006;</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">E&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476722"><a href="#local-6989586621679476722"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679476723"><a href="#local-6989586621679476723"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476724"><a href="#local-6989586621679476724"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2473"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476725"><a href="#local-6989586621679476725"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T6&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476724"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2474"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476722"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476723"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2475"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476726"><a href="#local-6989586621679476726"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476727"><a href="#local-6989586621679476727"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.6</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476725"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476726"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.4</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476725"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476727"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-2476"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476728"><a href="#local-6989586621679476728"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476725"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679476728"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2477"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476729"><a href="#local-6989586621679476729"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476725"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679476729"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-2478"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><a href="#local-6989586621679476690"><span class="hs-identifier hs-var">cnsCNC</span></a><span>
</span><a name="line-2479"></a><span>
</span><a name="line-2480"></a><span>    </span><span class="hs-identifier">convCns</span><span> </span><a name="local-6989586621679476730"><a href="#local-6989586621679476730"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">V&#24037;&#20107;&#31278;&#39006;</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%5DE5%4E8B%7A2E%985E"><span class="hs-identifier hs-var">E&#24037;&#20107;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476731"><a href="#local-6989586621679476731"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679476732"><a href="#local-6989586621679476732"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476733"><a href="#local-6989586621679476733"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-identifier">_</span><span>
</span><a name="line-2481"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2482"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476731"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476732"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5EFA%8A2D"><span class="hs-identifier hs-var">gd&#24314;&#35373;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2483"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476734"><a href="#local-6989586621679476734"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476735"><a href="#local-6989586621679476735"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2484"></a><span>                    </span><a name="local-6989586621679476737"><a href="#local-6989586621679476737"><span class="hs-identifier">car1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476734"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476736"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476736"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2485"></a><span>                    </span><a name="local-6989586621679476739"><a href="#local-6989586621679476739"><span class="hs-identifier">car2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476735"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476738"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476738"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2486"></a><span>                    </span><a name="local-6989586621679476741"><a href="#local-6989586621679476741"><span class="hs-identifier">cnc</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><a href="#local-6989586621679476690"><span class="hs-identifier hs-var">cnsCNC</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476740"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476740"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2487"></a><span>                    </span><span class="hs-identifier hs-var">forM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.toList</span><span> </span><a href="#local-6989586621679476733"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476742"><a href="#local-6989586621679476742"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2488"></a><span>                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476743"><a href="#local-6989586621679476743"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476742"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2489"></a><span>                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476744"><a href="#local-6989586621679476744"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span>  </span><a href="#local-6989586621679476742"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2490"></a><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476692"><span class="hs-identifier hs-var">canBe33</span></a><span> </span><a href="#local-6989586621679476730"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476744"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679476731"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476692"><span class="hs-identifier hs-var">canBe33</span></a><span> </span><a href="#local-6989586621679476730"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476744"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679476732"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2491"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476741"><span class="hs-identifier hs-var">cnc</span></a><span>  </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476743"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2492"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476737"><span class="hs-identifier hs-var">car1</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476743"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2493"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476739"><span class="hs-identifier hs-var">car2</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476743"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2494"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476737"><span class="hs-identifier hs-var">car1</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.6</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476743"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2495"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476739"><span class="hs-identifier hs-var">car2</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0.4</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476743"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2496"></a><span>                    </span><a name="local-6989586621679476745"><a href="#local-6989586621679476745"><span class="hs-identifier">res1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476737"><span class="hs-identifier hs-var">car1</span></a><span>
</span><a name="line-2497"></a><span>                    </span><a name="local-6989586621679476746"><a href="#local-6989586621679476746"><span class="hs-identifier">res2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476739"><span class="hs-identifier hs-var">car2</span></a><span>
</span><a name="line-2498"></a><span>                    </span><a name="local-6989586621679476747"><a href="#local-6989586621679476747"><span class="hs-identifier">res3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476741"><span class="hs-identifier hs-var">cnc</span></a><span>
</span><a name="line-2499"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476745"><span class="hs-identifier hs-var">res1</span></a><span class="hs-special">,</span><a href="#local-6989586621679476746"><span class="hs-identifier hs-var">res2</span></a><span class="hs-special">,</span><a href="#local-6989586621679476747"><span class="hs-identifier hs-var">res3</span></a><span class="hs-special">]</span><span>
</span><a name="line-2500"></a><span>
</span><a name="line-2501"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476748"><a href="#local-6989586621679476748"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2502"></a><span>                        </span><a name="local-6989586621679476750"><a href="#local-6989586621679476750"><span class="hs-identifier">car1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476748"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476749"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476749"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2503"></a><span>                        </span><a name="local-6989586621679476752"><a href="#local-6989586621679476752"><span class="hs-identifier">cnc</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><a href="#local-6989586621679476690"><span class="hs-identifier hs-var">cnsCNC</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476751"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476751"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2504"></a><span>                        </span><span class="hs-identifier hs-var">forM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.toList</span><span> </span><a href="#local-6989586621679476733"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476753"><a href="#local-6989586621679476753"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2505"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476754"><a href="#local-6989586621679476754"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476753"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2506"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476755"><a href="#local-6989586621679476755"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span>  </span><a href="#local-6989586621679476753"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2507"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476692"><span class="hs-identifier hs-var">canBe33</span></a><span> </span><a href="#local-6989586621679476730"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476755"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679476731"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2508"></a><span>                                </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476752"><span class="hs-identifier hs-var">cnc</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476754"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2509"></a><span>                                </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476750"><span class="hs-identifier hs-var">car1</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476754"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2510"></a><span>
</span><a name="line-2511"></a><span>                        </span><a name="local-6989586621679476756"><a href="#local-6989586621679476756"><span class="hs-identifier">res1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476750"><span class="hs-identifier hs-var">car1</span></a><span>
</span><a name="line-2512"></a><span>                        </span><a name="local-6989586621679476757"><a href="#local-6989586621679476757"><span class="hs-identifier">res3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476752"><span class="hs-identifier hs-var">cnc</span></a><span>
</span><a name="line-2513"></a><span>                        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476756"><span class="hs-identifier hs-var">res1</span></a><span class="hs-special">,</span><a href="#local-6989586621679476757"><span class="hs-identifier hs-var">res3</span></a><span class="hs-special">]</span><span>
</span><a name="line-2514"></a><span>
</span><a name="line-2515"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476758"><a href="#local-6989586621679476758"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2516"></a><span>                        </span><a name="local-6989586621679476760"><a href="#local-6989586621679476760"><span class="hs-identifier">car2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476758"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476759"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476759"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2517"></a><span>                        </span><a name="local-6989586621679476762"><a href="#local-6989586621679476762"><span class="hs-identifier">cnc</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><a href="#local-6989586621679476690"><span class="hs-identifier hs-var">cnsCNC</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476761"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476761"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2518"></a><span>                        </span><span class="hs-identifier hs-var">forM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.toList</span><span> </span><a href="#local-6989586621679476733"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476763"><a href="#local-6989586621679476763"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2519"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476764"><a href="#local-6989586621679476764"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476763"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2520"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476765"><a href="#local-6989586621679476765"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span>  </span><a href="#local-6989586621679476763"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2521"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476692"><span class="hs-identifier hs-var">canBe33</span></a><span> </span><a href="#local-6989586621679476730"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476765"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679476731"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2522"></a><span>                                </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476762"><span class="hs-identifier hs-var">cnc</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476764"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2523"></a><span>                                </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476760"><span class="hs-identifier hs-var">car2</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476764"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2524"></a><span>
</span><a name="line-2525"></a><span>                        </span><a name="local-6989586621679476766"><a href="#local-6989586621679476766"><span class="hs-identifier">res2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476760"><span class="hs-identifier hs-var">car2</span></a><span>
</span><a name="line-2526"></a><span>                        </span><a name="local-6989586621679476767"><a href="#local-6989586621679476767"><span class="hs-identifier">res3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476762"><span class="hs-identifier hs-var">cnc</span></a><span>
</span><a name="line-2527"></a><span>                        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679476766"><span class="hs-identifier hs-var">res2</span></a><span class="hs-special">,</span><a href="#local-6989586621679476767"><span class="hs-identifier hs-var">res3</span></a><span class="hs-special">]</span><span>
</span><a name="line-2528"></a><span>
</span><a name="line-2529"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2530"></a><span>                        </span><a name="local-6989586621679476769"><a href="#local-6989586621679476769"><span class="hs-identifier">cnc</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><a href="#local-6989586621679476690"><span class="hs-identifier hs-var">cnsCNC</span></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476768"><span class="hs-identifier hs-type">s0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476768"><span class="hs-identifier hs-type">s0</span></a><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">)</span><span>
</span><a name="line-2531"></a><span>                        </span><span class="hs-identifier hs-var">forM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.toList</span><span> </span><a href="#local-6989586621679476733"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476770"><a href="#local-6989586621679476770"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2532"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476771"><a href="#local-6989586621679476771"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476770"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2533"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476772"><a href="#local-6989586621679476772"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">name</span><span>  </span><a href="#local-6989586621679476770"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2534"></a><span>                            </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476769"><span class="hs-identifier hs-var">cnc</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><a href="#local-6989586621679476771"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-2535"></a><span>
</span><a name="line-2536"></a><span>                        </span><a name="local-6989586621679476773"><a href="#local-6989586621679476773"><span class="hs-identifier">res3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476769"><span class="hs-identifier hs-var">cnc</span></a><span>
</span><a name="line-2537"></a><span>                        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><a href="#local-6989586621679476773"><span class="hs-identifier hs-var">res3</span></a><span>
</span><a name="line-2538"></a><span>
</span><a name="line-2539"></a><span>    </span><span class="hs-comment">-- |                 8&#21306;&#20998;      33&#21306;&#20998;</span><span>
</span><a name="line-2540"></a><span>    </span><span class="hs-identifier">canBe33</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2541"></a><span>    </span><a name="local-6989586621679476692"><a href="#local-6989586621679476692"><span class="hs-identifier">canBe33</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679476774"><a href="#local-6989586621679476774"><span class="hs-identifier">c8</span></a></a><span> </span><a name="local-6989586621679476775"><a href="#local-6989586621679476775"><span class="hs-identifier">c33</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679476776"><a href="#local-6989586621679476776"><span class="hs-identifier">looked</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476774"><span class="hs-identifier hs-var">c8</span></a><span> </span><a href="VTable.Data.Classification.html#ss%5EFA%8A2D%5206%914D24"><span class="hs-identifier hs-var">ss&#24314;&#35373;&#20998;&#37197;24</span></a><span>
</span><a name="line-2542"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476776"><span class="hs-identifier hs-var">looked</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2543"></a><span>                         </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476777"><a href="#local-6989586621679476777"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><a href="#local-6989586621679476775"><span class="hs-identifier hs-var">c33</span></a><span> </span><a href="#local-6989586621679476777"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2544"></a><span>                         </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-string">&quot;error :&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679476774"><span class="hs-identifier hs-var">c8</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;is not a correct value&quot;</span><span>
</span><a name="line-2545"></a><span>    </span><span class="hs-identifier">canBe33</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679476778"><a href="#local-6989586621679476778"><span class="hs-identifier">c8</span></a></a><span> </span><a name="local-6989586621679476779"><a href="#local-6989586621679476779"><span class="hs-identifier">c33</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679476780"><a href="#local-6989586621679476780"><span class="hs-identifier">looked</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476778"><span class="hs-identifier hs-var">c8</span></a><span> </span><a href="VTable.Data.Classification.html#ss%5EFA%8A2D%5206%914D28"><span class="hs-identifier hs-var">ss&#24314;&#35373;&#20998;&#37197;28</span></a><span>
</span><a name="line-2546"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476780"><span class="hs-identifier hs-var">looked</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2547"></a><span>                         </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476781"><a href="#local-6989586621679476781"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><a href="#local-6989586621679476779"><span class="hs-identifier hs-var">c33</span></a><span> </span><a href="#local-6989586621679476781"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2548"></a><span>                         </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-string">&quot;error :&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679476778"><span class="hs-identifier hs-var">c8</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;is not a correct value&quot;</span><span>
</span><a name="line-2549"></a><span>
</span><a name="line-2550"></a><span>
</span><a name="line-2551"></a><span>
</span><a name="line-2552"></a><span>    </span><span class="hs-comment">-- | &#22243;&#20307;&#12398;&#31278;&#39006;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2553"></a><span>    </span><span class="hs-comment">-- &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12434;&#20837;&#12428;&#12427;&#12384;&#12369;</span><span>
</span><a name="line-2554"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476693"><a href="#local-6989586621679476693"><span class="hs-identifier">orgCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;9390&quot;</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#38750;&#21942;&#21033;&#30340;&#22243;&#20307;</span><span>
</span><a name="line-2555"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2556"></a><span>    </span><a name="local-6989586621679476694"><a href="#local-6989586621679476694"><span class="hs-identifier">convOrg</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2557"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476782"><a href="#local-6989586621679476782"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476782"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476693"><span class="hs-identifier hs-var">orgCNC</span></a><span>
</span><a name="line-2558"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476783"><a href="#local-6989586621679476783"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476783"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VTable.Data.Classification.html#edE%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">edE&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2559"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476784"><a href="#local-6989586621679476784"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476784"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2560"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476693"><span class="hs-identifier hs-var">orgCNC</span></a><span>
</span><a name="line-2561"></a><span>
</span><a name="line-2562"></a><span>    </span><span class="hs-identifier">convOrg</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476785"><a href="#local-6989586621679476785"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476786"><a href="#local-6989586621679476786"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476785"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VTable.Data.Classification.html#edE%56E3%4F53%306E%7A2E%985E"><span class="hs-identifier hs-var">edE&#22243;&#20307;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2563"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476787"><a href="#local-6989586621679476787"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476786"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476787"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2564"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476786"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476693"><span class="hs-identifier hs-var">orgCNC</span></a><span>
</span><a name="line-2565"></a><span>
</span><a name="line-2566"></a><span>    </span><span class="hs-comment">-- | &#37329;&#34701;&#20445;&#38522;&#26989;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2567"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476695"><a href="#local-6989586621679476695"><span class="hs-identifier">finCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;JZZ0&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-comment">--  &#37329;&#34701;&#26989;&#65292;&#20445;&#38522;&#26989; &#20869;&#26684;&#20184;&#19981;&#33021;</span><span>
</span><a name="line-2568"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%91D1%878D%696D%4FDD%967A%696D%306E%4E8B%696D%7A2E%985E"><span class="hs-identifier hs-type">Val&#37329;&#34701;&#26989;&#20445;&#38522;&#26989;&#12398;&#20107;&#26989;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2569"></a><span>    </span><a name="local-6989586621679476696"><a href="#local-6989586621679476696"><span class="hs-identifier">convFin</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2570"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476788"><a href="#local-6989586621679476788"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476788"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476695"><span class="hs-identifier hs-var">finCNC</span></a><span>
</span><a name="line-2571"></a><span>
</span><a name="line-2572"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476789"><a href="#local-6989586621679476789"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>   </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476789"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VTable.Data.Classification.html#gd%91D1%878D%4FDD%967A"><span class="hs-identifier hs-var">gd&#37329;&#34701;&#20445;&#38522;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2573"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476790"><a href="#local-6989586621679476790"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476790"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2574"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476695"><span class="hs-identifier hs-var">finCNC</span></a><span>
</span><a name="line-2575"></a><span>
</span><a name="line-2576"></a><span>    </span><span class="hs-identifier">convFin</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476791"><a href="#local-6989586621679476791"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476792"><a href="#local-6989586621679476792"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476791"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VTable.Data.Classification.html#gd%91D1%878D%4FDD%967A"><span class="hs-identifier hs-var">gd&#37329;&#34701;&#20445;&#38522;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2577"></a><span>                                             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476793"><a href="#local-6989586621679476793"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476792"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476793"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2578"></a><span>                                             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476792"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476695"><span class="hs-identifier hs-var">finCNC</span></a><span>
</span><a name="line-2579"></a><span>
</span><a name="line-2580"></a><span>    </span><span class="hs-comment">-- | &#23398;&#26657;&#25945;&#32946;&#12398;&#23550;&#24540;</span><span>
</span><a name="line-2581"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679476697"><a href="#local-6989586621679476697"><span class="hs-identifier">schCNC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;81ZZ&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#23398;&#26657;&#25945;&#32946; &#20869;&#26684;&#20184;&#19981;&#33021;</span><span>
</span><a name="line-2582"></a><span>    </span><span class="hs-comment">-- | &#20107;&#26989;&#21029;&#21454;&#20837;_&#23398;&#26657;&#25945;&#32946;&#12399;&#12381;&#12398;&#12414;&#12414;&#20351;&#12360;&#12427;. &#20107;&#26989;&#20998;&#39006;&#23567;&#20998;&#39006;&#12395;&#22793;&#25563;&#28168;&#12415;</span><span>
</span><a name="line-2583"></a><span>    </span><span class="hs-identifier">convSch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%53CE%5165%5185%8A33_%5B66%6821"><span class="hs-identifier hs-type">Val&#21454;&#20837;&#20869;&#35379;_&#23398;&#26657;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2584"></a><span>    </span><a name="local-6989586621679476698"><a href="#local-6989586621679476698"><span class="hs-identifier">convSch</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476697"><span class="hs-identifier hs-var">schCNC</span></a><span>
</span><a name="line-2585"></a><span>    </span><span class="hs-identifier">convSch</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476794"><a href="#local-6989586621679476794"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#addValueCar"><span class="hs-identifier hs-var">addValueCar</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#getValofCars"><span class="hs-identifier hs-var">VDS.getValofCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T21&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476794"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476697"><span class="hs-identifier hs-var">schCNC</span></a><span>
</span><a name="line-2586"></a><span>    </span><span class="hs-identifier">convSch</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476795"><a href="#local-6989586621679476795"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679476795"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2587"></a><span>
</span><a name="line-2588"></a><span>
</span><a name="line-2589"></a><span>    </span><span class="hs-comment">-- | &#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;&#23550;&#24540;, &#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span><span>
</span><a name="line-2590"></a><span>    </span><span class="hs-comment">--  (&#12371;&#12428;&#12364;Null&#12391;&#12394;&#12356; = &#20107;&#26989;&#25152;&#35519;&#26619;&#31080; &#20516;&#12364;&#25163;&#12395;&#20837;&#12425;&#12394;&#12356;&#12398;&#12391;&#12381;&#12398;&#12414;&#12414;,&#20516;&#12476;&#12525;&#12398;&#12418;&#12398;&#12434;&#20316;&#12427;</span><span>
</span><a name="line-2591"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5B66%6821%7B49%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#23398;&#26657;&#31561;&#12398;&#31278;&#39006;</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E3B%306A%4E8B%696D%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span>
</span><a name="line-2592"></a><span>    </span><a name="local-6989586621679476699"><a href="#local-6989586621679476699"><span class="hs-identifier">convForSingles</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476796"><a href="#local-6989586621679476796"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476796"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VTable.Data.Classification.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2593"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476797"><a href="#local-6989586621679476797"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476797"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2594"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2595"></a><span>
</span><a name="line-2596"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-number">28</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476798"><a href="#local-6989586621679476798"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476798"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VTable.Data.Classification.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2597"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476799"><a href="#local-6989586621679476799"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476799"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2598"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2599"></a><span>
</span><a name="line-2600"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-number">24</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476800"><a href="#local-6989586621679476800"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476801"><a href="#local-6989586621679476801"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476800"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5B66%6821%6559%80B224"><span class="hs-identifier hs-var">gd&#23398;&#26657;&#25945;&#32946;24</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476801"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VTable.Data.Classification.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2601"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476802"><a href="#local-6989586621679476802"><span class="hs-identifier">xn</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476803"><a href="#local-6989586621679476803"><span class="hs-identifier">yn</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476802"><span class="hs-identifier hs-var">xn</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476803"><span class="hs-identifier hs-var">yn</span></a><span class="hs-special">]</span><span>
</span><a name="line-2602"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476804"><a href="#local-6989586621679476804"><span class="hs-identifier">xn</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476804"><span class="hs-identifier hs-var">xn</span></a><span>
</span><a name="line-2603"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476805"><a href="#local-6989586621679476805"><span class="hs-identifier">yn</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476805"><span class="hs-identifier hs-var">yn</span></a><span>
</span><a name="line-2604"></a><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2605"></a><span>
</span><a name="line-2606"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-number">28</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476806"><a href="#local-6989586621679476806"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476807"><a href="#local-6989586621679476807"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476807"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="VTable.Data.Classification.html#gd%4E3B%306A%4E8B%696D%306E%7A2E%985E24"><span class="hs-identifier hs-var">gd&#20027;&#12394;&#20107;&#26989;&#12398;&#31278;&#39006;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2607"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476808"><a href="#local-6989586621679476808"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476808"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2608"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2609"></a><span>
</span><a name="line-2610"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476809"><a href="#local-6989586621679476809"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476809"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="VTable.Data.Classification.html#gd%5B66%6821%6559%80B224"><span class="hs-identifier hs-var">gd&#23398;&#26657;&#25945;&#32946;24</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2611"></a><span>                                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476810"><a href="#local-6989586621679476810"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476687"><span class="hs-identifier hs-var">forMC</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">V.singleton</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679476810"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2612"></a><span>                                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2613"></a><span>
</span><a name="line-2614"></a><span>    </span><span class="hs-identifier">convForSingles</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span>
</span><a name="line-2615"></a><span>
</span><a name="line-2616"></a><span>
</span><a name="line-2617"></a><span class="hs-comment">-- *** &#12381;&#12398;&#20182;&#20840;&#12390;</span><span>
</span><a name="line-2618"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-2619"></a><span class="hs-comment">-- | &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12434;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12395;&#25391;&#12426;&#26367;&#12360;&#12427;</span><span>
</span><a name="line-2620"></a><span>
</span><a name="line-2621"></a><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12381;&#12398;&#20182;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2622"></a><a name="f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%305D%306E%4ED6"><a href="VTable.Compliation.html#f%7523%696D%683C%4ED8_%7279%6B8A%306A%65B9%6CD5_%305D%306E%4ED6"><span class="hs-identifier">f&#29987;&#26989;&#26684;&#20184;_&#29305;&#27530;&#12394;&#26041;&#27861;_&#12381;&#12398;&#20182;</span></a></a><span> </span><a name="local-6989586621679476811"><a href="#local-6989586621679476811"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476812"><a href="#local-6989586621679476812"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2623"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679476819"><a href="#local-6989586621679476819"><span class="hs-identifier">kind</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>
</span><a name="line-2624"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476819"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2625"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476813"><span class="hs-identifier hs-var">forOther</span></a><span> </span><a href="#local-6989586621679476811"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2626"></a><span>            </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476820"><a href="#local-6989586621679476820"><span class="hs-identifier">x</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#35519;&#26619;&#31080;</span><span> </span><a href="#local-6989586621679476820"><span class="hs-identifier hs-var">x</span></a><span>   </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%5171%901A%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#29987;&#26989;&#20849;&#36890;&#35519;&#26619;&#31080;</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476813"><span class="hs-identifier hs-var">forOther</span></a><span> </span><a href="#local-6989586621679476811"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2627"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476820"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5168%7523%696D"><span class="hs-identifier hs-var">E&#20840;&#29987;&#26989;</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476813"><span class="hs-identifier hs-var">forOther</span></a><span> </span><a href="#local-6989586621679476811"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2628"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476820"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%306A%3057"><span class="hs-identifier hs-var">E&#29987;&#26989;&#12394;&#12375;</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476813"><span class="hs-identifier hs-var">forOther</span></a><span> </span><a href="#local-6989586621679476811"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2629"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679476820"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5171%901A"><span class="hs-identifier hs-var">E&#20849;&#36890;</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476813"><span class="hs-identifier hs-var">forOther</span></a><span> </span><a href="#local-6989586621679476811"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-2630"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2631"></a><span>            </span><span class="hs-identifier">_</span><span>                                                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2632"></a><span>
</span><a name="line-2633"></a><span>
</span><a name="line-2634"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2635"></a><span>        </span><span class="hs-identifier">forOther</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2636"></a><span>        </span><a name="local-6989586621679476813"><a href="#local-6989586621679476813"><span class="hs-identifier">forOther</span></a></a><span> </span><a name="local-6989586621679476814"><a href="#local-6989586621679476814"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476815"><a href="#local-6989586621679476815"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2637"></a><span>            </span><span class="hs-glyph">!</span><a name="local-6989586621679476816"><a href="#local-6989586621679476816"><span class="hs-identifier">comm</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2638"></a><span>            </span><span class="hs-glyph">!</span><a name="local-6989586621679476817"><a href="#local-6989586621679476817"><span class="hs-identifier">front</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476812"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2639"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476818"><a href="#local-6989586621679476818"><span class="hs-identifier">behind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#convertB2D"><span class="hs-identifier hs-var">convertB2D</span></a><span> </span><a href="#local-6989586621679476817"><span class="hs-identifier hs-var">front</span></a><span>
</span><a name="line-2640"></a><span>            </span><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier hs-var">mergeFrontAndBehind</span></a><span> </span><a href="#local-6989586621679476815"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476816"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679476818"><span class="hs-identifier hs-var">behind</span></a><span> </span><a href="#local-6989586621679476817"><span class="hs-identifier hs-var">front</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2641"></a><span>
</span><a name="line-2642"></a><span class="hs-comment">-- | &#34920;&#38754;&#24773;&#22577;&#12434;&#35023;&#38754;&#24773;&#22577;&#12395;&#22793;&#25563;&#12377;&#12427;</span><span>
</span><a name="line-2643"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">convertB2D</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2644"></a><span class="hs-identifier">convertB2D</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2645"></a><a name="convertB2D"><a href="VTable.Compliation.html#convertB2D"><span class="hs-identifier">convertB2D</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2646"></a><span class="hs-identifier">convertB2D</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476821"><a href="#local-6989586621679476821"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-2647"></a><span>                      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.map</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476821"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2648"></a><span>                      </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679476822"><a href="#local-6989586621679476822"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679476823"><a href="#local-6989586621679476823"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679476823"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="VTable.Data.Classification.html#bd%683C%4ED8%3051%4E0D%80FD"><span class="hs-identifier hs-var">VDC.bd&#26684;&#20184;&#12369;&#19981;&#33021;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2649"></a><span>                                        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&#9651;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2650"></a><span>                                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476824"><a href="#local-6989586621679476824"><span class="hs-identifier">newN</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476822"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679476824"><span class="hs-identifier hs-var">newN</span></a><span>
</span><a name="line-2651"></a><span>
</span><a name="line-2652"></a><span class="hs-comment">-- | &#21103;&#26989;&#12398;&#20998;&#35299;&#12392;&#12398;&#37325;&#35079;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;&#12395;&#35023;&#38754;&#12398;&#20869;&#23481;&#12395;&#38306;&#36899;&#12377;&#12427;&#12418;&#12398;&#12398;&#12415;&#12434;&#22793;&#25563;&#12375;&#12383;&#12418;&#12398;&#12434;&#36820;&#12377;</span><span>
</span><a name="line-2653"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">convertB2DExclude</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2654"></a><span class="hs-identifier">convertB2DExclude</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#IndustryBusiness"><span class="hs-identifier hs-type">IndustryBusiness</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2655"></a><a name="convertB2DExclude"><a href="VTable.Compliation.html#convertB2DExclude"><span class="hs-identifier">convertB2DExclude</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2656"></a><span class="hs-identifier">convertB2DExclude</span><span> </span><a name="local-6989586621679476825"><a href="#local-6989586621679476825"><span class="hs-identifier">x</span></a></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2657"></a><span class="hs-identifier">convertB2DExclude</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476826"><a href="#local-6989586621679476826"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679476827"><a href="#local-6989586621679476827"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#convertB2D"><span class="hs-identifier hs-var">convertB2D</span></a><span>
</span><a name="line-2658"></a><span>                                </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>
</span><a name="line-2659"></a><span>                                </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476826"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2660"></a><span>                                </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679476828"><a href="#local-6989586621679476828"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679476829"><a href="#local-6989586621679476829"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.elem</span><span> </span><a href="#local-6989586621679476829"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679476827"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2661"></a><span>
</span><a name="line-2662"></a><span>
</span><a name="line-2663"></a><span>
</span><a name="line-2664"></a><span>
</span><a name="line-2665"></a><span class="hs-comment">-- | &#35023;&#38754;&#12398;&#21462;&#24471;&#24773;&#22577;&#12392;&#34920;&#38754;&#12398;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12434;&#32080;&#21512;&#12373;&#12379;&#12427;</span><span>
</span><a name="line-2666"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mergeFrontAndBehind</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2667"></a><span class="hs-identifier">mergeFrontAndBehind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-2668"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>    </span><span class="hs-comment">-- ^ &#12418;&#12392;&#12418;&#12392;&#12398;&#12418;&#12398;</span><span>
</span><a name="line-2669"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>    </span><span class="hs-comment">-- ^ &#35023;&#38754;&#12363;&#12425;&#21462;&#24471;&#12373;&#12428;&#12383;&#12418;&#12398;</span><span>
</span><a name="line-2670"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2671"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#IndustryBusiness"><span class="hs-identifier hs-type">IndustryBusiness</span></a><span class="hs-special">]</span><span>           </span><span class="hs-comment">-- ^ &#35023;&#38754;&#12391;&#25201;&#12387;&#12390;&#12356;&#12427;&#34920;&#38754;&#12398;&#20998;&#39006;</span><span>
</span><a name="line-2672"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2673"></a><span>
</span><a name="line-2674"></a><a name="mergeFrontAndBehind"><a href="VTable.Compliation.html#mergeFrontAndBehind"><span class="hs-identifier">mergeFrontAndBehind</span></a></a><span> </span><a name="local-6989586621679476830"><a href="#local-6989586621679476830"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-identifier">_</span><span>           </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-identifier">_</span><span>
</span><a name="line-2675"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2676"></a><span>
</span><a name="line-2677"></a><span class="hs-identifier">mergeFrontAndBehind</span><span> </span><a name="local-6989586621679476831"><a href="#local-6989586621679476831"><span class="hs-identifier">icr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476832"><a href="#local-6989586621679476832"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679476833"><a href="#local-6989586621679476833"><span class="hs-identifier">front</span></a></a><span>         </span><a name="local-6989586621679476834"><a href="#local-6989586621679476834"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-2678"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679476832"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2679"></a><span>        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476831"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476832"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-2680"></a><span>        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convertB2DExclude"><span class="hs-identifier hs-var">convertB2DExclude</span></a><span> </span><a href="#local-6989586621679476833"><span class="hs-identifier hs-var">front</span></a><span> </span><a href="#local-6989586621679476834"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2681"></a><span>                    </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476831"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2682"></a><span>                    </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476835"><a href="#local-6989586621679476835"><span class="hs-identifier">fromSev</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476831"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476835"><span class="hs-identifier hs-var">fromSev</span></a><span class="hs-special">)</span><span>
</span><a name="line-2683"></a><span>
</span><a name="line-2684"></a><span class="hs-identifier">mergeFrontAndBehind</span><span> </span><a name="local-6989586621679476836"><a href="#local-6989586621679476836"><span class="hs-identifier">icr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a name="local-6989586621679476837"><a href="#local-6989586621679476837"><span class="hs-identifier">front</span></a></a><span>         </span><a name="local-6989586621679476838"><a href="#local-6989586621679476838"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-2685"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476836"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convertB2DExclude"><span class="hs-identifier hs-var">convertB2DExclude</span></a><span> </span><a href="#local-6989586621679476837"><span class="hs-identifier hs-var">front</span></a><span> </span><a href="#local-6989586621679476838"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2686"></a><span>
</span><a name="line-2687"></a><span class="hs-identifier">mergeFrontAndBehind</span><span> </span><a name="local-6989586621679476839"><a href="#local-6989586621679476839"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476840"><a href="#local-6989586621679476840"><span class="hs-identifier">old</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476841"><a href="#local-6989586621679476841"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-identifier">_</span><span>
</span><a name="line-2688"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476839"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476840"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679476841"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2689"></a><span>
</span><a name="line-2690"></a><span class="hs-identifier">mergeFrontAndBehind</span><span> </span><a name="local-6989586621679476842"><a href="#local-6989586621679476842"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476843"><a href="#local-6989586621679476843"><span class="hs-identifier">old</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476844"><a href="#local-6989586621679476844"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476845"><a href="#local-6989586621679476845"><span class="hs-identifier">seb</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-6989586621679476846"><a href="#local-6989586621679476846"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-2691"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679476844"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2692"></a><span>        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476842"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>  </span><span class="hs-operator hs-var">$</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476843"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679476844"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-2693"></a><span>        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convertB2DExclude"><span class="hs-identifier hs-var">convertB2DExclude</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679476845"><span class="hs-identifier hs-var">seb</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476846"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2694"></a><span>                    </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2695"></a><span>                    </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476847"><a href="#local-6989586621679476847"><span class="hs-identifier">fromSev</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476842"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476843"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679476847"><span class="hs-identifier hs-var">fromSev</span></a><span>
</span><a name="line-2696"></a><span>
</span><a name="line-2697"></a><span>
</span><a name="line-2698"></a><span>
</span><a name="line-2699"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2700"></a><span class="hs-comment">-- *  &#20385;&#26684;&#22793;&#25563;</span><span>
</span><a name="line-2701"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2702"></a><span class="hs-comment">-- | &#24179;&#25104;24&#24180;&#28040;&#36027;&#31246;&#29575;</span><span>
</span><a name="line-2703"></a><a name="ctr24"><a href="VTable.Compliation.html#ctr24"><span class="hs-identifier">ctr24</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1.05</span><span>
</span><a name="line-2704"></a><span>
</span><a name="line-2705"></a><span>
</span><a name="line-2706"></a><span class="hs-comment">-- | &#12501;&#12449;&#12452;&#12523;&#12434;&#21463;&#12369;&#21462;&#12387;&#12390;&#20385;&#26684;&#22793;&#25563;&#12434;&#34892;&#12387;&#12383;&#12354;&#12392;&#20986;&#21147;</span><span>
</span><a name="line-2707"></a><span class="hs-identifier">full&#20385;&#26684;&#22793;&#25563;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2708"></a><a name="full%4FA1%683C%5909%63DB"><a href="VTable.Compliation.html#full%4FA1%683C%5909%63DB"><span class="hs-identifier">full&#20385;&#26684;&#22793;&#25563;</span></a></a><span> </span><a name="local-6989586621679476848"><a href="#local-6989586621679476848"><span class="hs-identifier">inputFile</span></a></a><span> </span><a name="local-6989586621679476849"><a href="#local-6989586621679476849"><span class="hs-identifier">maxRowNum</span></a></a><span> </span><a name="local-6989586621679476850"><a href="#local-6989586621679476850"><span class="hs-identifier">year</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runConduitRes</span><span>
</span><a name="line-2709"></a><span>                                        </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679476848"><span class="hs-identifier hs-var">inputFile</span></a><span>
</span><a name="line-2710"></a><span>                                        </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;</span></a><span> </span><a href="#local-6989586621679476850"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Data.Structure.html#sinkCensus"><span class="hs-identifier hs-var">sinkCensus</span></a><span> </span><a href="#local-6989586621679476849"><span class="hs-identifier hs-var">maxRowNum</span></a><span> </span><a href="#local-6989586621679476851"><span class="hs-identifier hs-var">outputFile</span></a><span>
</span><a name="line-2711"></a><span>                                </span><span class="hs-keyword">where</span><span>
</span><a name="line-2712"></a><span>                                </span><a name="local-6989586621679476851"><a href="#local-6989586621679476851"><span class="hs-identifier">outputFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476848"><span class="hs-identifier hs-var">inputFile</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;ConvertPrice.csv&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-2713"></a><span>
</span><a name="line-2714"></a><span class="hs-comment">{-| *&#12300;&#32113;&#35336;&#35519;&#26619;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#39640;&#31561;&#12398;&#38598;&#35336;&#12395;&#20418;&#12427;&#28040;&#36027;&#31246;&#12398;&#21462;&#12426;&#25201;&#12356;&#12395;&#38306;&#12377;&#12427;&#12460;&#12452;&#12489;&#12521;&#12452;&#12531;&#65288;
    &#24179;&#25104;27&#24180;&#65301;&#26376;19&#26085; &#21508;&#24220;&#30465;&#32113;&#35336;&#20027;&#31649;&#35506;&#38263;&#31561;&#20250;&#35696;&#30003;&#12375;&#21512;&#12379;&#65289;&#12301;&#12395;&#22522;&#12389;&#12365;&#20966;&#29702;&#12434;&#34892;&#12358;
    -}</span><span>
</span><a name="line-2717"></a><span>
</span><a name="line-2718"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475903"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475903"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2719"></a><a name="f%4FA1%683C%5909%63DB"><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;</span></a></a><span> </span><span class="hs-number">28</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476852"><a href="#local-6989586621679476852"><span class="hs-identifier">maybeIcd</span></a></a><span>
</span><a name="line-2720"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476852"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2721"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2722"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476853"><a href="#local-6989586621679476853"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679476853"><span class="hs-identifier hs-var">icd</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;</span></a><span> </span><span class="hs-number">28</span><span>
</span><a name="line-2723"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;</span><span> </span><span class="hs-number">24</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476854"><a href="#local-6989586621679476854"><span class="hs-identifier">maybeIcd</span></a></a><span>
</span><a name="line-2724"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476854"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2725"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2726"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476855"><a href="#local-6989586621679476855"><span class="hs-identifier">icr</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>              </span><a href="VTable.Compliation.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679476855"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2727"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%7DCF%58F2%4E0A"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#32207;&#22770;&#19978;</span></a><span>                    </span><a href="VTable.Compliation.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679476855"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2728"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span>              </span><a href="VTable.Compliation.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679476855"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2729"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="VTable.Compliation.html#ctr24"><span class="hs-identifier hs-var">ctr24</span></a><span> </span><a href="#local-6989586621679476855"><span class="hs-identifier hs-var">icr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2730"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679476855"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-2731"></a><span>                              </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB"><span class="hs-identifier hs-var">f&#20385;&#26684;&#22793;&#25563;</span></a><span> </span><span class="hs-number">24</span><span>
</span><a name="line-2732"></a><span>
</span><a name="line-2733"></a><span>
</span><a name="line-2734"></a><span class="hs-comment">-- | &#28040;&#36027;&#31246;&#29575;</span><span>
</span><a name="line-2735"></a><span class="hs-keyword">type</span><span> </span><a name="ConsumeTaxRate"><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier">ConsumeTaxRate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2736"></a><span>
</span><a name="line-2737"></a><span>
</span><a name="line-2738"></a><span class="hs-comment">-- ** H&#32207;&#22770;&#19978;&#65292;H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span><span>
</span><a name="line-2739"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2740"></a><span class="hs-comment">{- | H&#32207;&#22770;&#19978;&#65292;H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;
    *&#12300;&#37329;&#34701;&#65292;&#20445;&#38522;&#26989;&#65292;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#22243;&#20307;&#12398;&#27963;&#21205;&#65292;&#19981;&#21205;&#29987;&#20107;&#26989;&#12301;
    &#12434;&#38500;&#12356;&#12383;&#20107;&#26989;&#12398;&#22770;&#19978;&#12395;&#12399;&#65292;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#215;&#31246;&#29575;&#12434;&#36275;&#12377;&#65294;

    *&#12377;&#12409;&#12390;&#12398;&#22770;&#12426;&#19978;&#12370;&#12364;&#28040;&#36027;&#31246;&#12398;&#35506;&#31246;&#23550;&#35937;&#12391;&#12354;&#12427;&#12431;&#12369;&#12391;&#12399;&#12394;&#12356;&#12398;&#12391;&#65292;
    &#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12364;&#26410;&#35352;&#20837;&#12398;&#22580;&#21512;&#12399;&#65292;
    &#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#215;&#31246;&#29575;&#12434;&#21152;&#31639;&#65294;
    &#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12364;&#35352;&#20837;&#12373;&#12428;&#12390;&#12356;&#12390;&#19988;&#12388;
    &#12381;&#12398;&#32207;&#21644;&#12364;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12424;&#12426;&#22823;&#12365;&#12356;&#22580;&#21512;&#12399;&#65292;
    &#28040;&#36027;&#31246;&#21152;&#31639;&#24460;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12398;&#21644;&#12391;&#20837;&#12428;&#26367;&#12360;&#12427;&#65294;
-}</span><span>
</span><a name="line-2751"></a><span>
</span><a name="line-2752"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2753"></a><a name="f%4FA1%683C%5909%63DB_%4E8B%696D%5225%58F2%4E0A%9AD8"><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a></a><span> </span><a name="local-6989586621679476856"><a href="#local-6989586621679476856"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679476857"><a href="#local-6989586621679476857"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2754"></a><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476857"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476858"><a href="#local-6989586621679476858"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2755"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476858"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2756"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2757"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2758"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476857"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476859"><a href="#local-6989586621679476859"><span class="hs-identifier">sev</span></a></a><span>
</span><a name="line-2759"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476860"><a href="#local-6989586621679476860"><span class="hs-identifier">addedSev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%4E8B%696D%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97"><span class="hs-identifier hs-var">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span></a><span> </span><a href="#local-6989586621679476856"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476859"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-2760"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476857"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679476860"><span class="hs-identifier hs-var">addedSev</span></a><span>
</span><a name="line-2761"></a><span>
</span><a name="line-2762"></a><span class="hs-comment">-- | &#31246;&#29575;&#12434;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-2763"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2764"></a><a name="f%4E8B%696D%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97"><a href="VTable.Compliation.html#f%4E8B%696D%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97"><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span></a></a><span> </span><a name="local-6989586621679476861"><a href="#local-6989586621679476861"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2765"></a><span class="hs-identifier">f&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;</span><span> </span><a name="local-6989586621679476862"><a href="#local-6989586621679476862"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476863"><a href="#local-6989586621679476863"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476864"><span class="hs-identifier hs-var">multipleCar</span></a><span> </span><a href="#local-6989586621679476862"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476863"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2766"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2767"></a><span>    </span><a name="local-6989586621679476864"><a href="#local-6989586621679476864"><span class="hs-identifier">multipleCar</span></a></a><span> </span><a name="local-6989586621679476866"><a href="#local-6989586621679476866"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679476867"><a href="#local-6989586621679476867"><span class="hs-identifier">car</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476865"><span class="hs-identifier hs-var">shouldConvert</span></a><span> </span><a href="#local-6989586621679476867"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476867"><span class="hs-identifier hs-var">car</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476867"><span class="hs-identifier hs-var">car</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476866"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">}</span><span>
</span><a name="line-2768"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476867"><span class="hs-identifier hs-var">car</span></a><span>
</span><a name="line-2769"></a><span>
</span><a name="line-2770"></a><span>    </span><span class="hs-comment">-- &#37329;&#34701;&#65292;&#20445;&#38522;&#26989;&#65292;&#25919;&#27835;&#12539;&#32076;&#28168;&#12539;&#25991;&#21270;&#22243;&#20307;&#65292;&#23447;&#25945;&#22243;&#20307;&#12398;&#27963;&#21205;&#65292;&#19981;&#21205;&#29987;&#20107;&#26989; &#12391;&#12399;&#12394;&#12356;&#12371;&#12392;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-2771"></a><span>    </span><span class="hs-identifier">shouldConvert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2772"></a><span>    </span><a name="local-6989586621679476865"><a href="#local-6989586621679476865"><span class="hs-identifier">shouldConvert</span></a></a><span> </span><a name="local-6989586621679476868"><a href="#local-6989586621679476868"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476868"><span class="hs-identifier hs-var">tx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.map</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T10&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;T11&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;T13&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2773"></a><span>
</span><a name="line-2774"></a><span class="hs-comment">-- | &#32207;&#22770;&#19978;&#12395;&#28040;&#36027;&#31246;&#12434;&#21152;&#31639;</span><span>
</span><a name="line-2775"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#32207;&#22770;&#19978;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2776"></a><a name="f%4FA1%683C%5909%63DB_%7DCF%58F2%4E0A"><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%7DCF%58F2%4E0A"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#32207;&#22770;&#19978;</span></a></a><span> </span><a name="local-6989586621679476869"><a href="#local-6989586621679476869"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679476870"><a href="#local-6989586621679476870"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2777"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476870"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476871"><a href="#local-6989586621679476871"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2778"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476871"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2779"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2780"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2781"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679476870"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7DCF%58F2%4E0A"><span class="hs-identifier hs-var">H&#32207;&#22770;&#19978;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476872"><a href="#local-6989586621679476872"><span class="hs-identifier">sales</span></a></a><span>
</span><a name="line-2782"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476872"><span class="hs-identifier hs-var">sales</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2783"></a><span>                                </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2784"></a><span>                                </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476873"><a href="#local-6989586621679476873"><span class="hs-identifier">bl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476870"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7DCF%58F2%4E0A"><span class="hs-identifier hs-var">H&#32207;&#22770;&#19978;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476873"><span class="hs-identifier hs-var">bl</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476869"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2785"></a><span>
</span><a name="line-2786"></a><span class="hs-comment">-- ** H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span><span>
</span><a name="line-2787"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2788"></a><span class="hs-comment">{- | H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;

![&#36027;&#29992;&#31561;&#12398;&#28040;&#36027;&#31246;&#21152;&#31639;&#20966;&#29702;&#22259;](consumeTaxCoset.png)

&#65288;&#12300;&#32113;&#35336;&#35519;&#26619;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#39640;&#31561;&#12398;&#38598;&#35336;&#12395;&#20418;&#12427;&#28040;&#36027;&#31246;&#12398;&#21462;&#12426;&#25201;&#12356;&#12395;&#38306;&#12377;&#12427;&#12460;&#12452;&#12489;&#12521;&#12452;&#12531;
&#24179;&#25104;24&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12434;&#12514;&#12487;&#12523;&#12392;&#12375;&#12383;&#28040;&#36027;&#31246;&#21152;&#31639;&#20966;&#29702;&#65288;&#35519;&#26619;&#21697;&#30446;&#20197;&#22806;&#65289;&#12301;&#12424;&#12426;&#65292;&#25244;&#31883;&#65288;&#19968;&#37096;&#31558;&#32773;&#32232;&#38598;&#65289;

-}</span><span>
</span><a name="line-2796"></a><span>
</span><a name="line-2797"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2798"></a><a name="f%4FA1%683C%5909%63DB_%8CBB%7528%7B49%306E%5185%8A33"><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a></a><span> </span><a name="local-6989586621679476874"><a href="#local-6989586621679476874"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679476875"><a href="#local-6989586621679476875"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2799"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476875"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476879"><a href="#local-6989586621679476879"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2800"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476879"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2801"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2802"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2803"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476875"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-var">H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span>   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476880"><a href="#local-6989586621679476880"><span class="hs-identifier">costsDetail</span></a></a><span>
</span><a name="line-2804"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476875"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span>       </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476881"><a href="#local-6989586621679476881"><span class="hs-identifier">kind</span></a></a><span>
</span><a name="line-2805"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476882"><a href="#local-6989586621679476882"><span class="hs-identifier">newCost</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%8CBB%7528%7B49%306E%5185%8A33%7A0E%52A0%7B97"><span class="hs-identifier hs-var">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476876"><span class="hs-identifier hs-var">isCommerce</span></a><span> </span><a href="#local-6989586621679476881"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476874"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476880"><span class="hs-identifier hs-var">costsDetail</span></a><span>
</span><a name="line-2806"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476875"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-var">H&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span> </span><a href="#local-6989586621679476882"><span class="hs-identifier hs-var">newCost</span></a><span>
</span><a name="line-2807"></a><span>
</span><a name="line-2808"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2809"></a><span>    </span><span class="hs-identifier">isCommerce</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2810"></a><span>    </span><a name="local-6989586621679476876"><a href="#local-6989586621679476876"><span class="hs-identifier">isCommerce</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2811"></a><span>    </span><span class="hs-identifier">isCommerce</span><span> </span><a name="local-6989586621679476877"><a href="#local-6989586621679476877"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476878"><a href="#local-6989586621679476878"><span class="hs-identifier">lClass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-identifier">_&#29987;&#26989;&#26684;&#20184;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476877"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-2812"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476878"><span class="hs-identifier hs-var">lClass</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T4&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679476878"><span class="hs-identifier hs-var">lClass</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;T5&quot;</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2813"></a><span>
</span><a name="line-2814"></a><span class="hs-identifier">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#IsCommerce"><span class="hs-identifier hs-type">IsCommerce</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-type">Val&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8CBB%7528%7B49%306E%5185%8A33"><span class="hs-identifier hs-type">Val&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;</span></a><span>
</span><a name="line-2815"></a><a name="f%8CBB%7528%7B49%306E%5185%8A33%7A0E%52A0%7B97"><a href="VTable.Compliation.html#f%8CBB%7528%7B49%306E%5185%8A33%7A0E%52A0%7B97"><span class="hs-identifier">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span></a></a><span> </span><a name="local-6989586621679476883"><a href="#local-6989586621679476883"><span class="hs-identifier">bl</span></a></a><span> </span><a name="local-6989586621679476884"><a href="#local-6989586621679476884"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-2816"></a><span class="hs-identifier">f&#36027;&#29992;&#31561;&#12398;&#20869;&#35379;&#31246;&#21152;&#31639;</span><span> </span><a name="local-6989586621679476885"><a href="#local-6989586621679476885"><span class="hs-identifier">bl</span></a></a><span> </span><a name="local-6989586621679476886"><a href="#local-6989586621679476886"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476887"><a href="#local-6989586621679476887"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2817"></a><span>                                </span><a name="local-6989586621679476888"><a href="#local-6989586621679476888"><span class="hs-identifier">stResult</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2818"></a><span>                                </span><a name="local-6989586621679476890"><a href="#local-6989586621679476890"><span class="hs-identifier">stTotal</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476889"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476889"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#36027;&#29992;&#32207;&#38989;</span><span>
</span><a name="line-2819"></a><span>                                </span><a name="local-6989586621679476892"><a href="#local-6989586621679476892"><span class="hs-identifier">stSCost</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476891"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476891"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#22770;&#19978;&#21407;&#20385;</span><span>
</span><a name="line-2820"></a><span>                                </span><a name="local-6989586621679476894"><a href="#local-6989586621679476894"><span class="hs-identifier">stToMinus</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679476893"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679476893"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-2821"></a><span>                                </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679476887"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%8CBB%7528%5225%51E6%7406"><span class="hs-identifier hs-var">f&#36027;&#29992;&#21029;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476888"><span class="hs-identifier hs-var">stResult</span></a><span> </span><a href="#local-6989586621679476890"><span class="hs-identifier hs-var">stTotal</span></a><span> </span><a href="#local-6989586621679476892"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><a href="#local-6989586621679476894"><span class="hs-identifier hs-var">stToMinus</span></a><span> </span><a href="#local-6989586621679476886"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2822"></a><span>
</span><a name="line-2823"></a><span>                                </span><a name="local-6989586621679476895"><a href="#local-6989586621679476895"><span class="hs-identifier">result</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476888"><span class="hs-identifier hs-var">stResult</span></a><span>
</span><a name="line-2824"></a><span>                                </span><a name="local-6989586621679476896"><a href="#local-6989586621679476896"><span class="hs-identifier">total</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476890"><span class="hs-identifier hs-var">stTotal</span></a><span>
</span><a name="line-2825"></a><span>                                </span><a name="local-6989586621679476897"><a href="#local-6989586621679476897"><span class="hs-identifier">sCost</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476892"><span class="hs-identifier hs-var">stSCost</span></a><span>
</span><a name="line-2826"></a><span>                                </span><a name="local-6989586621679476898"><a href="#local-6989586621679476898"><span class="hs-identifier">toMinus</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476894"><span class="hs-identifier hs-var">stToMinus</span></a><span>
</span><a name="line-2827"></a><span>                                </span><a name="local-6989586621679476899"><a href="#local-6989586621679476899"><span class="hs-identifier">stAdded</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2828"></a><span>
</span><a name="line-2829"></a><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476896"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679476885"><span class="hs-identifier hs-var">bl</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2830"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476900"><a href="#local-6989586621679476900"><span class="hs-identifier">added</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679476896"><span class="hs-identifier hs-var">total</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476898"><span class="hs-identifier hs-var">toMinus</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476886"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 3 - {3/2 * (4 + 5 + 8)} * &#31246;&#29575;</span><span>
</span><a name="line-2831"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476900"><span class="hs-identifier hs-var">added</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2832"></a><span>                                                        </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476892"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span>
</span><a name="line-2833"></a><span>                                                        </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476892"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679476900"><span class="hs-identifier hs-var">added</span></a><span class="hs-special">)</span><span>
</span><a name="line-2834"></a><span>                                                                </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476899"><span class="hs-identifier hs-var">stAdded</span></a><span> </span><a href="#local-6989586621679476900"><span class="hs-identifier hs-var">added</span></a><span>
</span><a name="line-2835"></a><span>
</span><a name="line-2836"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476892"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476886"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2837"></a><span>                                                    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476899"><span class="hs-identifier hs-var">stAdded</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476886"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2838"></a><span>
</span><a name="line-2839"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476892"><span class="hs-identifier hs-var">stSCost</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476886"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2840"></a><span>                                                    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476899"><span class="hs-identifier hs-var">stAdded</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476897"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476886"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2841"></a><span>                                </span><a name="local-6989586621679476901"><a href="#local-6989586621679476901"><span class="hs-identifier">resultSCost</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476892"><span class="hs-identifier hs-var">stSCost</span></a><span>
</span><a name="line-2842"></a><span>                                </span><a name="local-6989586621679476902"><a href="#local-6989586621679476902"><span class="hs-identifier">added</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679476899"><span class="hs-identifier hs-var">stAdded</span></a><span>
</span><a name="line-2843"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476903"><a href="#local-6989586621679476903"><span class="hs-identifier">sCostCar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#22770;&#19978;&#21407;&#20385;&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476901"><span class="hs-identifier hs-var">resultSCost</span></a><span>
</span><a name="line-2844"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476904"><a href="#local-6989586621679476904"><span class="hs-identifier">totalCar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#36027;&#29992;&#32207;&#38989;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476896"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679476896"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679476898"><span class="hs-identifier hs-var">toMinus</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476886"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679476902"><span class="hs-identifier hs-var">added</span></a><span class="hs-special">)</span><span>
</span><a name="line-2845"></a><span>                                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679476903"><span class="hs-identifier hs-var">sCostCar</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679476904"><span class="hs-identifier hs-var">totalCar</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679476895"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-2846"></a><span>
</span><a name="line-2847"></a><span>
</span><a name="line-2848"></a><span class="hs-identifier">f&#36027;&#29992;&#21029;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679475902"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679475902"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679475902"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">STRef</span><span> </span><a href="#local-6989586621679475902"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ST</span><span> </span><a href="#local-6989586621679475902"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2849"></a><a name="f%8CBB%7528%5225%51E6%7406"><a href="VTable.Compliation.html#f%8CBB%7528%5225%51E6%7406"><span class="hs-identifier">f&#36027;&#29992;&#21029;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476905"><a href="#local-6989586621679476905"><span class="hs-identifier">result</span></a></a><span> </span><a name="local-6989586621679476906"><a href="#local-6989586621679476906"><span class="hs-identifier">total</span></a></a><span> </span><a name="local-6989586621679476907"><a href="#local-6989586621679476907"><span class="hs-identifier">sCost</span></a></a><span> </span><a name="local-6989586621679476908"><a href="#local-6989586621679476908"><span class="hs-identifier">toMinus</span></a></a><span> </span><a name="local-6989586621679476909"><a href="#local-6989586621679476909"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679476910"><a href="#local-6989586621679476910"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-2850"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#31199;&#31246;&#20844;&#35506;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2851"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2852"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476908"><span class="hs-identifier hs-var">toMinus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2853"></a><span>
</span><a name="line-2854"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#32102;&#19982;&#32207;&#38989;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2855"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476908"><span class="hs-identifier hs-var">toMinus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2856"></a><span>
</span><a name="line-2857"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#31119;&#21033;&#21402;&#29983;&#36027;&quot;</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2858"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2859"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476908"><span class="hs-identifier hs-var">toMinus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2860"></a><span>
</span><a name="line-2861"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#25903;&#25173;&#21033;&#24687;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2862"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2863"></a><span>
</span><a name="line-2864"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#22320;&#20195;&#23478;&#36035;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679476909"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2865"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2866"></a><span>
</span><a name="line-2867"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#28187;&#20385;&#20767;&#21364;&#36027;&quot;</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679476909"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2868"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2869"></a><span>
</span><a name="line-2870"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#21205;&#29987;&#19981;&#21205;&#29987;&#36035;&#20511;&#26009;&quot;</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679476909"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2871"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2872"></a><span>
</span><a name="line-2873"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#22320;&#20195;&#23478;&#36035;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476905"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#multipleValueCar"><span class="hs-identifier hs-var">multipleValueCar</span></a><span> </span><a href="#local-6989586621679476909"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-2874"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2875"></a><span>
</span><a name="line-2876"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#22770;&#19978;&#21407;&#20385;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">writeSTRef</span><span> </span><a href="#local-6989586621679476907"><span class="hs-identifier hs-var">sCost</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-2877"></a><span>                                           </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679476906"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-2878"></a><span>
</span><a name="line-2879"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476910"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;&#36027;&#29992;&#32207;&#38989;&quot;</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2880"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                            </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2881"></a><span>
</span><a name="line-2882"></a><span>
</span><a name="line-2883"></a><span>
</span><a name="line-2884"></a><span>
</span><a name="line-2885"></a><span class="hs-comment">-- ** &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span><span>
</span><a name="line-2886"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2887"></a><span class="hs-comment">{- |
    * &#35519;&#26619;&#21697;&#30446;&#21029;&#12398;&#28040;&#36027;&#31246;&#12398;&#21152;&#31639;&#20966;&#29702;&#12399;&#65292;&#35506;&#31246;&#65292;&#30452;&#25509;&#36664;&#20986;&#65292;&#12398;&#26377;&#28961;&#12394;&#12393;&#12395;&#12424;&#12387;&#12390;&#20197;&#19979;&#12398;&#65299;&#12497;&#12479;&#12540;&#12531;&#12395;&#21306;&#20998;&#12373;&#12428;&#12427;&#65294;

    &#9312; &#21152;&#31639;&#65297;&#65288;&#35069;&#36896;&#26989;&#12398;&#19968;&#37096;&#12398;&#21697;&#30446;&#65289;

        &gt; &#21152;&#31639;&#38989; &#65309;&#65288;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;-&#35519;&#26619;&#21697;&#30446;&#21029;&#30452;&#25509;&#36664;&#20986;&#38989;&#65289;&#215;&#31246;&#29575;

    &#9313; &#21152;&#31639;&#65298;&#65288;&#12300;&#21307;&#30274;&#65292;&#31119;&#31049;&#12301;&#21450;&#12403;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12301;&#35519;&#26619;&#31080;&#12398;&#19968;&#37096;&#12398;&#21697;&#30446;&#65289;

        &gt; &#21152;&#31639;&#38989;&#65309;&#65288;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;-&#35519;&#26619;&#21697;&#30446;&#21029;&#28023;&#22806;&#21462;&#24341;&#38989;&#65289;&#215;&#31246;&#29575;

    &#9314; &#21152;&#31639;&#65299;

        &gt; &#21152;&#31639;&#38989;&#65309;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;&#215;&#31246;&#29575;

    * &#35069;&#36896;&#26989;&#12395;&#12362;&#12369;&#12427;&#35069;&#36896;&#21697;&#20986;&#33655;&#38989;
    &gt; &#21152;&#31639;&#38989;&#65309;&#35519;&#26619;&#21697;&#30446;&#21029;&#28040;&#36027;&#31246;&#12398;&#21152;&#31639;&#20966;&#29702;&#12395;&#12362;&#12369;&#12427;&#21508;&#35069;&#36896;&#21697;&#12398;&#21152;&#31639;&#38989;&#12398;&#21512;&#35336;

    * &#35069;&#36896;&#26989;&#12399;&#65292;&quot;H&#36664;&#20837;&#21106;&#21512;&quot;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#12399;&#65292;&quot;H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B&quot;&#12362;&#12424;&#12403;&quot;H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#21307;&#30274;&#31119;&#31049;&quot;&#12391;&#21028;&#23450;
    * &#31777;&#21336;&#12398;&#12383;&#12417;&#35069;&#36896;&#26989;&#21450;&#12403;,&#21307;&#30274;&#31119;&#31049;,&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B &#12399;&#20840;&#12390;&#30452;&#25509;&#36664;&#20986;&#12354;&#12426;&#12392;&#12375;&#12390;&#25201;&#12358;
-}</span><span>
</span><a name="line-2908"></a><span>
</span><a name="line-2909"></a><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2910"></a><a name="f%4FA1%683C%5909%63DB_%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><a href="VTable.Compliation.html#f%4FA1%683C%5909%63DB_%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier">f&#20385;&#26684;&#22793;&#25563;_&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a></a><span> </span><a name="local-6989586621679476911"><a href="#local-6989586621679476911"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476912"><a href="#local-6989586621679476912"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679476913"><a href="#local-6989586621679476913"><span class="hs-identifier">icr</span></a></a><span>
</span><a name="line-2911"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476913"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%6D88%8CBB%7A0E%8A18%5165%306E%5225"><span class="hs-identifier hs-var">H&#28040;&#36027;&#31246;&#35352;&#20837;&#12398;&#21029;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476914"><a href="#local-6989586621679476914"><span class="hs-identifier">taxBool</span></a></a><span>
</span><a name="line-2912"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476914"><span class="hs-identifier hs-var">taxBool</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2913"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2914"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2915"></a><span>            </span><a href="VTable.Data.Structure.html#VBool"><span class="hs-identifier hs-var">VBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476913"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476915"><a href="#local-6989586621679476915"><span class="hs-identifier">valTar</span></a></a><span>
</span><a name="line-2916"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476913"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8F38%51FA%5272%5408"><span class="hs-identifier hs-var">H&#36664;&#20986;&#21106;&#21512;</span></a><span>                   </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476916"><a href="#local-6989586621679476916"><span class="hs-identifier">valEx</span></a></a><span>
</span><a name="line-2917"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476913"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-var">H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>       </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476917"><a href="#local-6989586621679476917"><span class="hs-identifier">valSB</span></a></a><span>
</span><a name="line-2918"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476913"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%76F8%624B%5148%5225%53CE%5165%5272%5408_%533B%7642%798F%7949"><span class="hs-identifier hs-var">H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#21307;&#30274;&#31119;&#31049;</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476918"><a href="#local-6989586621679476918"><span class="hs-identifier">valMed</span></a></a><span>
</span><a name="line-2919"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97%51E6%7406"><span class="hs-identifier hs-var">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679476911"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476913"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679476912"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476915"><span class="hs-identifier hs-var">valTar</span></a><span> </span><a href="#local-6989586621679476916"><span class="hs-identifier hs-var">valEx</span></a><span> </span><a href="#local-6989586621679476917"><span class="hs-identifier hs-var">valSB</span></a><span> </span><a href="#local-6989586621679476918"><span class="hs-identifier hs-var">valMed</span></a><span>
</span><a name="line-2920"></a><span>
</span><a name="line-2921"></a><span class="hs-comment">-- | &#36664;&#20986;&#21106;&#21512;</span><span>
</span><a name="line-2922"></a><span class="hs-keyword">type</span><span> </span><a name="ExportRate"><a href="VTable.Compliation.html#ExportRate"><span class="hs-identifier">ExportRate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2923"></a><span>
</span><a name="line-2924"></a><span>
</span><a name="line-2925"></a><span class="hs-comment">-- Null&#12398;&#12392;&#12365;&#12398;&#20966;&#29702;&#12399;,&#36664;&#20986;&#20837;&#12394;&#12375;&#12392;&#12375;&#12390;&#25201;&#12358;( &#20462;&#27491;&#26696; :&#24179;&#22343;&#31561;)</span><span>
</span><a name="line-2926"></a><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-2927"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-2928"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span>
</span><a name="line-2929"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-2930"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8F38%51FA%5272%5408"><span class="hs-identifier hs-type">Val&#36664;&#20986;&#21106;&#21512;</span></a><span>
</span><a name="line-2931"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-2932"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span>
</span><a name="line-2933"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2934"></a><a name="f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97%51E6%7406"><a href="VTable.Compliation.html#f%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8%7A0E%52A0%7B97%51E6%7406"><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679476919"><a href="#local-6989586621679476919"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476920"><a href="#local-6989586621679476920"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679476921"><a href="#local-6989586621679476921"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><a name="local-6989586621679476922"><a href="#local-6989586621679476922"><span class="hs-identifier">valEx</span></a></a><span> </span><a name="local-6989586621679476923"><a href="#local-6989586621679476923"><span class="hs-identifier">valSB</span></a></a><span> </span><a name="local-6989586621679476924"><a href="#local-6989586621679476924"><span class="hs-identifier">valMed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2935"></a><span class="hs-identifier">f&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#31246;&#21152;&#31639;&#20966;&#29702;</span><span> </span><a name="local-6989586621679476925"><a href="#local-6989586621679476925"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679476926"><a href="#local-6989586621679476926"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679476927"><a href="#local-6989586621679476927"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679476928"><a href="#local-6989586621679476928"><span class="hs-identifier">tar</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679476929"><a href="#local-6989586621679476929"><span class="hs-identifier">valEx</span></a></a><span> </span><a name="local-6989586621679476930"><a href="#local-6989586621679476930"><span class="hs-identifier">valSB</span></a></a><span> </span><a name="local-6989586621679476931"><a href="#local-6989586621679476931"><span class="hs-identifier">valMed</span></a></a><span>
</span><a name="line-2936"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476932"><a href="#local-6989586621679476932"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%751F%7523%7269%7A0E%52A0%7B97"><span class="hs-identifier hs-var">f&#29983;&#29987;&#29289;&#31246;&#21152;&#31639;</span></a><span> </span><a href="#local-6989586621679476925"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679476927"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476929"><span class="hs-identifier hs-var">valEx</span></a><span> </span><a href="#local-6989586621679476930"><span class="hs-identifier hs-var">valSB</span></a><span> </span><a href="#local-6989586621679476931"><span class="hs-identifier hs-var">valMed</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476928"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-2937"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679476926"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><a href="#local-6989586621679476932"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-2938"></a><span>
</span><a name="line-2939"></a><span class="hs-identifier">f&#29983;&#29987;&#29289;&#31246;&#21152;&#31639;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-2940"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span>
</span><a name="line-2941"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8F38%51FA%5272%5408"><span class="hs-identifier hs-type">Val&#36664;&#20986;&#21106;&#21512;</span></a><span>
</span><a name="line-2942"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-2943"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%533B%7642%798F%7949"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#21307;&#30274;&#31119;&#31049;</span></a><span>
</span><a name="line-2944"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2945"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2946"></a><span>
</span><a name="line-2947"></a><a name="f%751F%7523%7269%7A0E%52A0%7B97"><a href="VTable.Compliation.html#f%751F%7523%7269%7A0E%52A0%7B97"><span class="hs-identifier">f&#29983;&#29987;&#29289;&#31246;&#21152;&#31639;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679476933"><a href="#local-6989586621679476933"><span class="hs-identifier">ctr</span></a></a><span> </span><a name="local-6989586621679476934"><a href="#local-6989586621679476934"><span class="hs-identifier">ex</span></a></a><span> </span><a name="local-6989586621679476935"><a href="#local-6989586621679476935"><span class="hs-identifier">sb</span></a></a><span> </span><a name="local-6989586621679476936"><a href="#local-6989586621679476936"><span class="hs-identifier">med</span></a></a><span> </span><a name="local-6989586621679476937"><a href="#local-6989586621679476937"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-2948"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#is%88FD%9020%696D"><span class="hs-identifier hs-var">is&#35069;&#36896;&#26989;</span></a><span> </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476937"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%52A0%7B971"><span class="hs-identifier hs-var">f&#21152;&#31639;1</span></a><span> </span><a href="#local-6989586621679476933"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476934"><span class="hs-identifier hs-var">ex</span></a><span>  </span><a href="#local-6989586621679476937"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2949"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#is%30B5B"><span class="hs-identifier hs-var">is&#12469;B</span></a><span>    </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476937"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%52A0%7B972"><span class="hs-identifier hs-var">f&#21152;&#31639;2</span></a><span> </span><a href="#local-6989586621679476933"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476935"><span class="hs-identifier hs-var">sb</span></a><span>  </span><a href="#local-6989586621679476937"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2950"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#is%533B%7642"><span class="hs-identifier hs-var">is&#21307;&#30274;</span></a><span>   </span><span class="hs-number">24</span><span> </span><a href="#local-6989586621679476937"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%52A0%7B972"><span class="hs-identifier hs-var">f&#21152;&#31639;2</span></a><span> </span><a href="#local-6989586621679476933"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476936"><span class="hs-identifier hs-var">med</span></a><span> </span><a href="#local-6989586621679476937"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2951"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%52A0%7B973"><span class="hs-identifier hs-var">f&#21152;&#31639;3</span></a><span> </span><a href="#local-6989586621679476933"><span class="hs-identifier hs-var">ctr</span></a><span> </span><a href="#local-6989586621679476937"><span class="hs-identifier hs-var">ca</span></a><span>
</span><a name="line-2952"></a><span>
</span><a name="line-2953"></a><span class="hs-identifier">f&#21152;&#31639;1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8F38%51FA%5272%5408"><span class="hs-identifier hs-type">Val&#36664;&#20986;&#21106;&#21512;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2954"></a><a name="f%52A0%7B971"><a href="VTable.Compliation.html#f%52A0%7B971"><span class="hs-identifier">f&#21152;&#31639;1</span></a></a><span> </span><a name="local-6989586621679476938"><a href="#local-6989586621679476938"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679476939"><a href="#local-6989586621679476939"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679476940"><a href="#local-6989586621679476940"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476939"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679476940"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2955"></a><span class="hs-identifier">f&#21152;&#31639;1</span><span> </span><a name="local-6989586621679476941"><a href="#local-6989586621679476941"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476942"><a href="#local-6989586621679476942"><span class="hs-identifier">ex</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679476943"><a href="#local-6989586621679476943"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679476944"><a href="#local-6989586621679476944"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679476943"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476943"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679476944"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2956"></a><span>                                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476943"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476943"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476943"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476942"><span class="hs-identifier hs-var">ex</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476941"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476944"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2957"></a><span>
</span><a name="line-2958"></a><span class="hs-identifier">f&#21152;&#31639;2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2959"></a><a name="f%52A0%7B972"><a href="VTable.Compliation.html#f%52A0%7B972"><span class="hs-identifier">f&#21152;&#31639;2</span></a></a><span> </span><a name="local-6989586621679476945"><a href="#local-6989586621679476945"><span class="hs-identifier">ctr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                   </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679476946"><a href="#local-6989586621679476946"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679476947"><a href="#local-6989586621679476947"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679476946"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679476947"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2960"></a><span class="hs-identifier">f&#21152;&#31639;2</span><span> </span><a name="local-6989586621679476948"><a href="#local-6989586621679476948"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-var">V&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><a name="local-6989586621679476949"><a href="#local-6989586621679476949"><span class="hs-identifier">ex</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679476950"><a href="#local-6989586621679476950"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679476951"><a href="#local-6989586621679476951"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476950"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476950"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476950"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#28023;&#22806;&#21462;&#24341;</span><span> </span><a href="#local-6989586621679476949"><span class="hs-identifier hs-var">ex</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476948"><span class="hs-identifier hs-var">ctr</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476951"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2961"></a><span>
</span><a name="line-2962"></a><span>
</span><a name="line-2963"></a><span class="hs-identifier">f&#21152;&#31639;3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ConsumeTaxRate"><span class="hs-identifier hs-type">ConsumeTaxRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span>
</span><a name="line-2964"></a><a name="f%52A0%7B973"><a href="VTable.Compliation.html#f%52A0%7B973"><span class="hs-identifier">f&#21152;&#31639;3</span></a></a><span> </span><a name="local-6989586621679476952"><a href="#local-6989586621679476952"><span class="hs-identifier">ctr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679476953"><a href="#local-6989586621679476953"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679476954"><a href="#local-6989586621679476954"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476953"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679476952"><span class="hs-identifier hs-var">ctr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476954"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2965"></a><span>
</span><a name="line-2966"></a><span class="hs-comment">-- | &#12469;B&#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-2967"></a><span class="hs-identifier">is&#12469;B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2968"></a><a name="is%30B5B"><a href="VTable.Compliation.html#is%30B5B"><span class="hs-identifier">is&#12469;B</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679476955"><a href="#local-6989586621679476955"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;39&quot;</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2969"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;40&quot;</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2970"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;83&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;85&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2971"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476955"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;95&quot;</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2972"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2973"></a><span>
</span><a name="line-2974"></a><span class="hs-comment">-- | &#21307;&#30274;&#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-2975"></a><span class="hs-identifier">is&#21307;&#30274;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2976"></a><a name="is%533B%7642"><a href="VTable.Compliation.html#is%533B%7642"><span class="hs-identifier">is&#21307;&#30274;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679476956"><a href="#local-6989586621679476956"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476956"><span class="hs-identifier hs-var">ca</span></a><span>             </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;PZZZ&quot;</span><span>                                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2977"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476956"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;68&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476956"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;92&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2978"></a><span>             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2979"></a><span>
</span><a name="line-2980"></a><span class="hs-comment">-- | &#35069;&#36896;&#26989;&#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-2981"></a><span class="hs-identifier">is&#35069;&#36896;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2982"></a><a name="is%88FD%9020%696D"><a href="VTable.Compliation.html#is%88FD%9020%696D"><span class="hs-identifier">is&#35069;&#36896;&#26989;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679476957"><a href="#local-6989586621679476957"><span class="hs-identifier">ca</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476957"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;09&quot;</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2983"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476957"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;10&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>  </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679476957"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;32&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-2984"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2985"></a><span>
</span><a name="line-2986"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2987"></a><span class="hs-comment">-- * &#21517;&#23492;&#12379;</span><span>
</span><a name="line-2988"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-2989"></a><span>
</span><a name="line-2990"></a><span class="hs-keyword">type</span><span> </span><a name="EnDivideMap"><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier">EnDivideMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#Header"><span class="hs-identifier hs-type">Header</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-2991"></a><span>
</span><a name="line-2992"></a><span>
</span><a name="line-2993"></a><span class="hs-comment">{- |

    V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#24517;&#35201;&#12394;&#38917;&#30446;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#12300;&#20225;&#26989;&#20840;&#20307;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#65292;
     &#36027;&#29992;&#32207;&#38989;&#21450;&#12403;&#36027;&#29992;&#20869;&#35379;&#12301;&#65288;&#22770;&#19978;&#39640;&#26410;&#25226;&#25569;&#20107;&#26989;&#25152;&#12398;&#35036;&#23450;&#65292;VAT&#25512;&#35336;&#21450;&#12403;&#12510;&#12540;&#12472;&#12531;&#38989;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#65292;
     &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;&#65292;&#12300;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#65292;&#12300;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#12301;&#65288;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#12398;&#65299;&#38917;&#30446;&#65294;

    &#35036;&#23450;&#12399;&#26082;&#12395;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;,&#12371;&#12371;&#12391;&#12399;,&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#29992;&#12395;
    &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#65292;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65292;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#65379;&#12392;&#65292;&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;&#12398;&#12510;&#12483;&#12503;&#12434;&#20316;&#25104;&#12377;&#12427;&#65294;

    &#21830;&#26989;&#12398;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#22580;&#21512;&#12398;&#12415;

-}</span><span>
</span><a name="line-3005"></a><span>
</span><a name="line-3006"></a><span class="hs-identifier">f&#21517;&#23492;&#12379;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475901"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679475901"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span>
</span><a name="line-3007"></a><a name="f%540D%5BC4%305B"><a href="VTable.Compliation.html#f%540D%5BC4%305B"><span class="hs-identifier">f&#21517;&#23492;&#12379;</span></a></a><span> </span><a name="local-6989586621679476958"><a href="#local-6989586621679476958"><span class="hs-identifier">edm</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476959"><a href="#local-6989586621679476959"><span class="hs-identifier">maybeIcd</span></a></a><span>
</span><a name="line-3008"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476959"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3009"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476958"><span class="hs-identifier hs-var">edm</span></a><span>
</span><a name="line-3010"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679476960"><a href="#local-6989586621679476960"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476960"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476961"><a href="#local-6989586621679476961"><span class="hs-identifier">kind</span></a></a><span>
</span><a name="line-3011"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#isEN"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679476961"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3012"></a><span>                                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Compliation.html#f%5546%696D%4F01%696D%9805%76EE%53D6%5F97"><span class="hs-identifier hs-var">f&#21830;&#26989;&#20225;&#26989;&#38917;&#30446;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679476960"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679476958"><span class="hs-identifier hs-var">edm</span></a><span>
</span><a name="line-3013"></a><span>                                 </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3014"></a><span>                         </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%540D%5BC4%305B"><span class="hs-identifier hs-var">f&#21517;&#23492;&#12379;</span></a><span> </span><a href="#local-6989586621679476958"><span class="hs-identifier hs-var">edm</span></a><span>
</span><a name="line-3015"></a><span>
</span><a name="line-3016"></a><span>
</span><a name="line-3017"></a><span class="hs-comment">-- | &#20225;&#26989;&#12414;&#12383;&#12399;&#65292;&#22243;&#20307;&#12363;&#12434;&#21028;&#26029;&#12377;&#12427;</span><span>
</span><a name="line-3018"></a><span class="hs-comment">--   Nothing &#12398;&#26178;&#12399;&#38500;&#22806;</span><span>
</span><a name="line-3019"></a><span>
</span><a name="line-3020"></a><span class="hs-identifier">isEN</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3021"></a><a name="isEN"><a href="VTable.Compliation.html#isEN"><span class="hs-identifier">isEN</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                                                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-3022"></a><span class="hs-identifier">isEN</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679476962"><a href="#local-6989586621679476962"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679476963"><a href="#local-6989586621679476963"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679476964"><a href="#local-6989586621679476964"><span class="hs-identifier">subject</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3023"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476962"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%4F01%696D%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#20225;&#26989;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476962"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%56E3%4F53%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#22243;&#20307;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476964"><span class="hs-identifier hs-var">subject</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%56E3%4F53%6CD5%4EBA%7528"><span class="hs-identifier hs-var">E&#22243;&#20307;&#27861;&#20154;&#29992;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3024"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3025"></a><span>
</span><a name="line-3026"></a><span>
</span><a name="line-3027"></a><span class="hs-identifier">f&#21830;&#26989;&#20225;&#26989;&#38917;&#30446;&#21462;&#24471;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3028"></a><a name="f%5546%696D%4F01%696D%9805%76EE%53D6%5F97"><a href="VTable.Compliation.html#f%5546%696D%4F01%696D%9805%76EE%53D6%5F97"><span class="hs-identifier">f&#21830;&#26989;&#20225;&#26989;&#38917;&#30446;&#21462;&#24471;</span></a></a><span> </span><a name="local-6989586621679476965"><a href="#local-6989586621679476965"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679476966"><a href="#local-6989586621679476966"><span class="hs-identifier">edm</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476965"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476967"><a href="#local-6989586621679476967"><span class="hs-identifier">link</span></a></a><span>
</span><a name="line-3029"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476967"><span class="hs-identifier hs-var">link</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3030"></a><span>                                </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3031"></a><span>                                </span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476968"><a href="#local-6989586621679476968"><span class="hs-identifier">tx</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476969"><a href="#local-6989586621679476969"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476968"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-3032"></a><span>                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476970"><a href="#local-6989586621679476970"><span class="hs-identifier">h</span></a></a><span>
</span><a name="line-3033"></a><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679476965"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679476970"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679476971"><a href="#local-6989586621679476971"><span class="hs-identifier">tmpVal</span></a></a><span>
</span><a name="line-3034"></a><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679476971"><span class="hs-identifier hs-var">tmpVal</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3035"></a><span>                                                        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3036"></a><span>                                                        </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476972"><a href="#local-6989586621679476972"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679476966"><span class="hs-identifier hs-var">edm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476969"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679476970"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476972"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-3037"></a><span>
</span><a name="line-3038"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">getDoubleFromVal</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3039"></a><span class="hs-identifier">getDoubleFromVal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#ValDouble"><span class="hs-identifier hs-type">ValDouble</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3040"></a><a name="getDoubleFromVal"><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier">getDoubleFromVal</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-3041"></a><span class="hs-identifier">getDoubleFromVal</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679476973"><a href="#local-6989586621679476973"><span class="hs-identifier">dl</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679476973"><span class="hs-identifier hs-var">dl</span></a><span>
</span><a name="line-3042"></a><span>
</span><a name="line-3043"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3044"></a><span class="hs-comment">-- * &#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;</span><span>
</span><a name="line-3045"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3046"></a><span>
</span><a name="line-3047"></a><span class="hs-comment">-- | &#12501;&#12449;&#12452;&#12523;&#12434;&#21463;&#12369;&#21462;&#12387;&#12390;&#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;&#12434;&#12377;&#12427;.</span><span>
</span><a name="line-3048"></a><span class="hs-identifier">full&#20225;&#26989;&#20998;&#21106;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3049"></a><a name="full%4F01%696D%5206%5272"><a href="VTable.Compliation.html#full%4F01%696D%5206%5272"><span class="hs-identifier">full&#20225;&#26989;&#20998;&#21106;</span></a></a><span> </span><a name="local-6989586621679476974"><a href="#local-6989586621679476974"><span class="hs-identifier">inputFile</span></a></a><span> </span><a name="local-6989586621679476975"><a href="#local-6989586621679476975"><span class="hs-identifier">maxRowNum</span></a></a><span> </span><a name="local-6989586621679476976"><a href="#local-6989586621679476976"><span class="hs-identifier">year</span></a></a><span>
</span><a name="line-3050"></a><span>    </span><span class="hs-glyph">=</span><span>   </span><a href="VTable.Compliation.html#getWeightAndLink"><span class="hs-identifier hs-var">getWeightAndLink</span></a><span> </span><a href="#local-6989586621679476974"><span class="hs-identifier hs-var">inputFile</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679476978"><a href="#local-6989586621679476978"><span class="hs-identifier">iwm</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679476979"><a href="#local-6989586621679476979"><span class="hs-identifier">edm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3051"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span>         </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476980"><a href="#local-6989586621679476980"><span class="hs-identifier">empDenomiMap</span></a></a><span>
</span><a name="line-3052"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">runConduitRes</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span>  </span><a href="#local-6989586621679476974"><span class="hs-identifier hs-var">inputFile</span></a><span>  </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#getDenomiMap"><span class="hs-identifier hs-var">getDenomiMap</span></a><span> </span><a href="#local-6989586621679476978"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679476980"><span class="hs-identifier hs-var">empDenomiMap</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679476981"><a href="#local-6989586621679476981"><span class="hs-identifier">denomi</span></a></a><span>
</span><a name="line-3053"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">runConduitRes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679476974"><span class="hs-identifier hs-var">inputFile</span></a><span>  </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#f%4F01%696D%5206%5272"><span class="hs-identifier hs-var">f&#20225;&#26989;&#20998;&#21106;</span></a><span> </span><a href="#local-6989586621679476978"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679476979"><span class="hs-identifier hs-var">edm</span></a><span> </span><a href="#local-6989586621679476981"><span class="hs-identifier hs-var">denomi</span></a><span>  </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Data.Structure.html#sinkCensus"><span class="hs-identifier hs-var">sinkCensus</span></a><span> </span><a href="#local-6989586621679476975"><span class="hs-identifier hs-var">maxRowNum</span></a><span> </span><a href="#local-6989586621679476977"><span class="hs-identifier hs-var">outputFile</span></a><span>
</span><a name="line-3054"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679476977"><a href="#local-6989586621679476977"><span class="hs-identifier">outputFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476974"><span class="hs-identifier hs-var">inputFile</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;Divide.csv&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-3055"></a><span>
</span><a name="line-3056"></a><span>
</span><a name="line-3057"></a><span class="hs-comment">{- |&#31532;12&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12395;&#12362;&#12369;&#12427;&#65288;&#32068;&#26367;&#65289;&#38598;&#35336;&#19978;&#12398;&#30041;&#24847;&#20107;&#38917;&#12398;&#19968;&#12388;&#12395;&#65292;
    &#12300;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12375;&#12363;&#12487;&#12540;&#12479;&#12364;&#12394;&#12356;&#38917;&#30446;&#65288;&#35373;&#20633;&#25237;&#36039;&#65292;&#36027;&#29992;&#12395;&#20418;&#12427;&#38917;&#30446;&#12394;&#12393;&#65289;&#12395;&#12388;&#12356;&#12390;&#12399;&#65292;
    &#20107;&#26989;&#25152;&#21029;&#24467;&#26989;&#32773;&#25968;&#31561;&#12391;&#26696;&#20998;&#12375;&#12390;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#65292;&#20107;&#26989;&#25152;&#21029;&#12487;&#12540;&#12479;&#12395;&#22793;&#25563;&#12375;&#12390;&#12363;&#12425;&#32068;&#26367;&#38598;&#35336;&#12434;&#23455;&#26045;&#12301;
    &#12300;&#12383;&#12384;&#12375;&#65292;&#35079;&#25968;&#20107;&#26989;&#25152;&#12434;&#26377;&#12377;&#12427;&#20225;&#26989;&#12391;&#12354;&#12387;&#12390;&#65292;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#22411;&#29987;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#12418;&#12398;&#12395;&#12388;&#12356;&#12390;&#12399;&#65292;
    &#22770;&#19978;&#39640;&#21450;&#12403;&#36027;&#29992;&#20849;&#12395;&#20107;&#26989;&#25152;&#31080;&#12391;&#25226;&#25569;&#12373;&#12428;&#12394;&#12356;&#12371;&#12392;&#12363;&#12425;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12301;&#12392;&#12398;&#35352;&#36617;&#12364;&#12354;&#12427;&#65294;

     V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#24517;&#35201;&#12394;&#38917;&#30446;&#12399;&#65292;&#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#12300;&#20225;&#26989;&#20840;&#20307;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#65292;
     &#36027;&#29992;&#32207;&#38989;&#21450;&#12403;&#36027;&#29992;&#20869;&#35379;&#12301;&#65288;&#22770;&#19978;&#39640;&#26410;&#25226;&#25569;&#20107;&#26989;&#25152;&#12398;&#35036;&#23450;&#65292;VAT&#25512;&#35336;&#21450;&#12403;&#12510;&#12540;&#12472;&#12531;&#38989;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#65292;
     &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;&#65292;&#12300;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#65292;&#12300;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#12301;&#65288;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12395;&#21033;&#29992;&#65289;&#12398;&#65299;&#38917;&#30446;&#65294;

    &#35036;&#23450;&#12399;&#26082;&#12395;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;,&#12371;&#12371;&#12391;&#12399;,&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#29992;&#12395;
    &#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#65292;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65292;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#65379;&#12398;&#12415;&#20998;&#21106;&#12377;&#12427;.

     &#12381;&#12398;&#20855;&#20307;&#30340;&#12394;&#25163;&#27861;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#31558;&#32773;&#12398;&#35519;&#12409;&#12427;&#38480;&#12426;&#36039;&#26009;&#12364;&#23384;&#22312;&#12375;&#12394;&#12356;&#12364;&#65292;
     &#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#12395;&#38306;&#12377;&#12427;&#35430;&#31639;&#12364;HP&#12300;&#65288;&#21442;&#32771;&#65289;&#20840;&#29987;&#26989;&#12398;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12395;&#38306;&#12377;&#12427;&#35430;&#31639;&#20516;&#12301;
     &#12395;&#12362;&#12356;&#12390;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

    \(X[v],x_i [v]\)&#12364;&#12381;&#12428;&#12382;&#12428;&#65292;&#20225;&#26989;&#12398;v&#12398;&#20516;&#65292;&#20225;&#26989;&#20632;&#19979;&#20107;&#26989;&#25152;&#12398;&#20869;&#25972;&#29702;&#30058;&#21495;i&#12398;v&#12398;&#20516;&#12434;&#34920;&#12377;&#12392;&#12375;&#65292;
    &#12354;&#12427;&#20225;&#26989;&#12395;&#23646;&#12377;&#12409;&#12390;&#12398;&#20107;&#26989;&#25152;&#12398;&#25972;&#29702;&#30058;&#21495;&#12434;I&#12392;&#12377;&#12427;&#65294;I&#12398;&#12358;&#12385;&#65292;&#20998;&#21106;&#23550;&#35937;&#12395;&#23646;&#12377;&#12427;&#37096;&#20998;&#12434;IN,&#12381;&#12428;&#12356;&#12364;&#12356;&#12434;OUT&#12392;&#12377;&#12427;&#65294;
    &#12414;&#12383;&#65292;&#12354;&#12427;&#20107;&#26989;&#25152;i&#12398;&#20027;&#26989;&#12398;&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#12434;weight[i]&#12392;&#12377;&#12427;&#12392;&#65292;&#20225;&#26989;&#12363;&#12425;&#20998;&#21106;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#20516;&#12399;&#65292;

    \[  x_i= (X[v] - \sum_{j \in OUT} x_j [v]) \times \frac{x_i [w] \times weight[i]}{\sum_{i \in I}{x_i [w] \times weight[i]}} \]

    &#12392;&#12394;&#12427;&#65294;&#12394;&#12362;&#65292;&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#12399;&#65292;&#29987;&#26989;&#22823;&#20998;&#39006;&#12372;&#12392;&#12395;&#65292;&#20027;&#29987;&#26989;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;&#21512;&#35336;&#12364;&#65292;
    &#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;70%&#20197;&#19978;&#12392;&#12394;&#12427;&#20225;&#26989;&#65288;&#21336;&#19968;&#29987;&#26989;&#20225;&#26989;&#65289;&#20840;&#20307;&#12398;&#22770;&#19978;&#39640;&#12434;&#65292;&#24403;&#35442;&#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#12391;&#38500;&#12375;&#12390;&#27714;&#12417;&#12427;&#65294;

    &#12371;&#12371;&#12391;&#65292;&#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#65292;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65292;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#65379;&#12399;&#21830;&#26989;&#12434;&#34892;&#12387;&#12390;&#12356;&#12394;&#12356;&#20107;&#26989;&#25152;&#12391;&#12399;&#30330;&#29983;&#12375;&#12394;&#12356;&#12383;&#12417;

    \[ \sum_{j \in OUT} x_j [v] = 0 \]

    &#12391;&#12354;&#12427;&#12363;&#12425;

    \[  x_i= X[v] \times \frac{x_i [w] \times weight[i]}{\sum_{i \in I}{x_i [w] \times weight[i]}} \]

    &#12364;&#25104;&#12426;&#31435;&#12388;&#65294;

-}</span><span>
</span><a name="line-3094"></a><span>
</span><a name="line-3095"></a><span>
</span><a name="line-3096"></a><span class="hs-identifier">f&#20225;&#26989;&#20998;&#21106;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span>  </span><a href="#local-6989586621679475900"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475900"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3097"></a><a name="f%4F01%696D%5206%5272"><a href="VTable.Compliation.html#f%4F01%696D%5206%5272"><span class="hs-identifier">f&#20225;&#26989;&#20998;&#21106;</span></a></a><span> </span><a name="local-6989586621679476982"><a href="#local-6989586621679476982"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679476983"><a href="#local-6989586621679476983"><span class="hs-identifier">edm</span></a></a><span> </span><a name="local-6989586621679476984"><a href="#local-6989586621679476984"><span class="hs-identifier">dm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3098"></a><span>        </span><a name="local-6989586621679477012"><a href="#local-6989586621679477012"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-3099"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477012"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3100"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;end &#20225;&#26989;&#20998;&#21106;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3101"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477013"><a href="#local-6989586621679477013"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3102"></a><span>                </span><a name="local-6989586621679477014"><a href="#local-6989586621679477014"><span class="hs-identifier">valLink</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477013"><span class="hs-identifier hs-var">icd</span></a><span>  </span><a href="VTable.Data.Structure.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span>
</span><a name="line-3103"></a><span>                </span><a name="local-6989586621679477015"><a href="#local-6989586621679477015"><span class="hs-identifier">valEmp</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477013"><span class="hs-identifier hs-var">icd</span></a><span>  </span><a href="VTable.Data.Structure.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span>
</span><a name="line-3104"></a><span>                </span><a name="local-6989586621679477016"><a href="#local-6989586621679477016"><span class="hs-identifier">valClass</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477013"><span class="hs-identifier hs-var">icd</span></a><span>  </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-3105"></a><span>                </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477017"><a href="#local-6989586621679477017"><span class="hs-identifier">h</span></a></a><span>
</span><a name="line-3106"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679476985"><span class="hs-identifier hs-var">culc</span></a><span> </span><a href="#local-6989586621679477013"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679476982"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679476983"><span class="hs-identifier hs-var">edm</span></a><span> </span><a href="#local-6989586621679476984"><span class="hs-identifier hs-var">dm</span></a><span> </span><a href="#local-6989586621679477014"><span class="hs-identifier hs-var">valLink</span></a><span> </span><a href="#local-6989586621679477016"><span class="hs-identifier hs-var">valClass</span></a><span> </span><a href="#local-6989586621679477015"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679477017"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3107"></a><span>                </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477013"><span class="hs-identifier hs-var">icd</span></a><span>
</span><a name="line-3108"></a><span>                </span><a href="VTable.Compliation.html#f%4F01%696D%5206%5272"><span class="hs-identifier hs-var">f&#20225;&#26989;&#20998;&#21106;</span></a><span> </span><a href="#local-6989586621679476982"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679476983"><span class="hs-identifier hs-var">edm</span></a><span> </span><a href="#local-6989586621679476984"><span class="hs-identifier hs-var">dm</span></a><span>
</span><a name="line-3109"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-3110"></a><span>    </span><span class="hs-identifier">culc</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3111"></a><span>    </span><a name="local-6989586621679476985"><a href="#local-6989586621679476985"><span class="hs-identifier">culc</span></a></a><span> </span><a name="local-6989586621679476987"><a href="#local-6989586621679476987"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679476988"><a href="#local-6989586621679476988"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679476989"><a href="#local-6989586621679476989"><span class="hs-identifier">edm</span></a></a><span> </span><a name="local-6989586621679476990"><a href="#local-6989586621679476990"><span class="hs-identifier">dm</span></a></a><span> </span><a name="local-6989586621679476991"><a href="#local-6989586621679476991"><span class="hs-identifier">valLink</span></a></a><span> </span><a name="local-6989586621679476992"><a href="#local-6989586621679476992"><span class="hs-identifier">valKind</span></a></a><span> </span><a name="local-6989586621679476993"><a href="#local-6989586621679476993"><span class="hs-identifier">valEmp</span></a></a><span> </span><a name="local-6989586621679476994"><a href="#local-6989586621679476994"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679476993"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">,</span><a href="#local-6989586621679476992"><span class="hs-identifier hs-var">valKind</span></a><span class="hs-special">,</span><a href="#local-6989586621679476991"><span class="hs-identifier hs-var">valLink</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3112"></a><span>        </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679476995"><a href="#local-6989586621679476995"><span class="hs-identifier">emp</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679476996"><a href="#local-6989586621679476996"><span class="hs-identifier">kind</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679476997"><a href="#local-6989586621679476997"><span class="hs-identifier">tx</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476998"><a href="#local-6989586621679476998"><span class="hs-identifier">worker</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679476995"><span class="hs-identifier hs-var">emp</span></a><span class="hs-special">)</span><span>
</span><a name="line-3113"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679476999"><a href="#local-6989586621679476999"><span class="hs-identifier">lInd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679476996"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-3114"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477000"><a href="#local-6989586621679477000"><span class="hs-identifier">top</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.init</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679476997"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-3115"></a><span>                                                    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679476986"><span class="hs-identifier hs-var">ifNotNull</span></a><span> </span><a href="#local-6989586621679476987"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679476988"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679476989"><span class="hs-identifier hs-var">edm</span></a><span> </span><a href="#local-6989586621679476990"><span class="hs-identifier hs-var">dm</span></a><span> </span><a href="#local-6989586621679477000"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679476999"><span class="hs-identifier hs-var">lInd</span></a><span> </span><a href="#local-6989586621679476998"><span class="hs-identifier hs-var">worker</span></a><span> </span><a href="#local-6989586621679476994"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-3116"></a><span>        </span><span class="hs-identifier">_</span><span>                                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3117"></a><span>
</span><a name="line-3118"></a><span>    </span><span class="hs-identifier">ifNotNull</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3119"></a><span>    </span><a name="local-6989586621679476986"><a href="#local-6989586621679476986"><span class="hs-identifier">ifNotNull</span></a></a><span> </span><a name="local-6989586621679477001"><a href="#local-6989586621679477001"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477002"><a href="#local-6989586621679477002"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679477003"><a href="#local-6989586621679477003"><span class="hs-identifier">edm</span></a></a><span> </span><a name="local-6989586621679477004"><a href="#local-6989586621679477004"><span class="hs-identifier">dm</span></a></a><span> </span><a name="local-6989586621679477005"><a href="#local-6989586621679477005"><span class="hs-identifier">top</span></a></a><span> </span><a name="local-6989586621679477006"><a href="#local-6989586621679477006"><span class="hs-identifier">lInd</span></a></a><span> </span><a name="local-6989586621679477007"><a href="#local-6989586621679477007"><span class="hs-identifier">worker</span></a></a><span> </span><a name="local-6989586621679477008"><a href="#local-6989586621679477008"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477006"><span class="hs-identifier hs-var">lInd</span></a><span class="hs-special">,</span><a href="#local-6989586621679477008"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477002"><span class="hs-identifier hs-var">iwm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477005"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679477008"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477003"><span class="hs-identifier hs-var">edm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477005"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477008"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477004"><span class="hs-identifier hs-var">dm</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3120"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477009"><a href="#local-6989586621679477009"><span class="hs-identifier">weight</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477010"><a href="#local-6989586621679477010"><span class="hs-identifier">enV</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477011"><a href="#local-6989586621679477011"><span class="hs-identifier">denomi</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477011"><span class="hs-identifier hs-var">denomi</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3121"></a><span>                                                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477001"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477008"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621679477010"><span class="hs-identifier hs-var">enV</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477007"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679477009"><span class="hs-identifier hs-var">weight</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477011"><span class="hs-identifier hs-var">denomi</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3122"></a><span>                                                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3123"></a><span>        </span><span class="hs-identifier">_</span><span>                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3124"></a><span>
</span><a name="line-3125"></a><span>
</span><a name="line-3126"></a><span class="hs-comment">-- | &#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#12392;&#65292;&#21517;&#23492;&#12379;&#12434;&#21516;&#26178;&#12395;&#34892;&#12358;</span><span>
</span><a name="line-3127"></a><span class="hs-identifier">getWeightAndLink</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#InputFile"><span class="hs-identifier hs-type">InputFile</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#EnDivideMap"><span class="hs-identifier hs-type">EnDivideMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3128"></a><a name="getWeightAndLink"><a href="VTable.Compliation.html#getWeightAndLink"><span class="hs-identifier">getWeightAndLink</span></a></a><span> </span><a name="local-6989586621679477018"><a href="#local-6989586621679477018"><span class="hs-identifier">input</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477019"><a href="#local-6989586621679477019"><span class="hs-identifier">empMap1</span></a></a><span>
</span><a name="line-3129"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477020"><a href="#local-6989586621679477020"><span class="hs-identifier">empMap2</span></a></a><span>
</span><a name="line-3130"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">runConduitRes</span><span>
</span><a name="line-3131"></a><span>                        </span><span class="hs-operator hs-var">$</span><span>  </span><a href="VTable.Data.Structure.html#sourceCensus"><span class="hs-identifier hs-var">sourceCensus</span></a><span> </span><a href="#local-6989586621679477018"><span class="hs-identifier hs-var">input</span></a><span>
</span><a name="line-3132"></a><span>                        </span><span class="hs-operator hs-var">.|</span><span> </span><span class="hs-identifier">getZipSink</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">ZipSink</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679477019"><span class="hs-identifier hs-var">empMap1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">ZipSink</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%540D%5BC4%305B"><span class="hs-identifier hs-var">f&#21517;&#23492;&#12379;</span></a><span> </span><a href="#local-6989586621679477020"><span class="hs-identifier hs-var">empMap2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3133"></a><span>
</span><a name="line-3134"></a><span>
</span><a name="line-3135"></a><span class="hs-comment">-- | &#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;&#12398;&#19979;&#65298;&#26689;&#24847;&#22806;&#12392;&#65292;&#20998;&#27597; [\ \sum_{i &#8712; I}{x_i [w]&#215; weight[i]} \] &#12398;Map</span><span>
</span><a name="line-3136"></a><span class="hs-keyword">type</span><span> </span><a name="DenomiMap"><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier">DenomiMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Header"><span class="hs-identifier hs-type">Header</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3137"></a><span>
</span><a name="line-3138"></a><span>
</span><a name="line-3139"></a><span class="hs-comment">-- | &#20225;&#26989;&#21029;&#12398;&#20998;&#27597; [\ \sum_{i &#8712; I}{x_i [w]&#215; weight[i]} \] &#12434;&#27714;&#12417;&#12427;</span><span>
</span><a name="line-3140"></a><span class="hs-identifier">getDenomiMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475899"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679475899"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span>
</span><a name="line-3141"></a><a name="getDenomiMap"><a href="VTable.Compliation.html#getDenomiMap"><span class="hs-identifier">getDenomiMap</span></a></a><span> </span><a name="local-6989586621679477021"><a href="#local-6989586621679477021"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679477022"><a href="#local-6989586621679477022"><span class="hs-identifier">dmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3142"></a><span>        </span><a name="local-6989586621679477046"><a href="#local-6989586621679477046"><span class="hs-identifier">maybeIcd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-3143"></a><span>        </span><a name="local-6989586621679477047"><a href="#local-6989586621679477047"><span class="hs-identifier">tmpMap</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span class="hs-special">)</span><span>
</span><a name="line-3144"></a><span>        </span><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3145"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477046"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3146"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477022"><span class="hs-identifier hs-var">dmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-3147"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477048"><a href="#local-6989586621679477048"><span class="hs-identifier">icd</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3148"></a><span>                </span><a name="local-6989586621679477049"><a href="#local-6989586621679477049"><span class="hs-identifier">valLink</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477048"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3149"></a><span>                </span><a name="local-6989586621679477050"><a href="#local-6989586621679477050"><span class="hs-identifier">valType</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477048"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3150"></a><span>                </span><a name="local-6989586621679477051"><a href="#local-6989586621679477051"><span class="hs-identifier">valEmp</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477048"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3151"></a><span>                </span><a name="local-6989586621679477052"><a href="#local-6989586621679477052"><span class="hs-identifier">valKind</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477048"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3152"></a><span>                </span><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3153"></a><span>                </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#isEN"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679477050"><span class="hs-identifier hs-var">valType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3154"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477023"><span class="hs-identifier hs-var">ifNotEn</span></a><span> </span><a href="#local-6989586621679477047"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><a href="#local-6989586621679477049"><span class="hs-identifier hs-var">valLink</span></a><span> </span><a href="#local-6989586621679477051"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679477052"><span class="hs-identifier hs-var">valKind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#getDenomiMap"><span class="hs-identifier hs-var">getDenomiMap</span></a><span> </span><a href="#local-6989586621679477021"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679477022"><span class="hs-identifier hs-var">dmp</span></a><span>
</span><a name="line-3155"></a><span>                    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#getDenomiMap"><span class="hs-identifier hs-var">getDenomiMap</span></a><span> </span><a href="#local-6989586621679477021"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679477022"><span class="hs-identifier hs-var">dmp</span></a><span>
</span><a name="line-3156"></a><span>
</span><a name="line-3157"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-3158"></a><span>    </span><span class="hs-identifier">ifNotEn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3159"></a><span>    </span><a name="local-6989586621679477023"><a href="#local-6989586621679477023"><span class="hs-identifier">ifNotEn</span></a></a><span> </span><a name="local-6989586621679477026"><a href="#local-6989586621679477026"><span class="hs-identifier">tmpMap</span></a></a><span> </span><a name="local-6989586621679477027"><a href="#local-6989586621679477027"><span class="hs-identifier">valLink</span></a></a><span> </span><a name="local-6989586621679477028"><a href="#local-6989586621679477028"><span class="hs-identifier">valEmp</span></a></a><span> </span><a name="local-6989586621679477029"><a href="#local-6989586621679477029"><span class="hs-identifier">valKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477027"><span class="hs-identifier hs-var">valLink</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3160"></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3161"></a><span>        </span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679477030"><a href="#local-6989586621679477030"><span class="hs-identifier">link</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477031"><a href="#local-6989586621679477031"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.init</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477030"><span class="hs-identifier hs-var">link</span></a><span>
</span><a name="line-3162"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477026"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477032"><a href="#local-6989586621679477032"><span class="hs-identifier">redMap</span></a></a><span>
</span><a name="line-3163"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477033"><a href="#local-6989586621679477033"><span class="hs-identifier">h</span></a></a><span>
</span><a name="line-3164"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477031"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679477033"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477032"><span class="hs-identifier hs-var">redMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3165"></a><span>                        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477024"><span class="hs-identifier hs-var">modifyPart</span></a><span> </span><a href="#local-6989586621679477033"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679477029"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679477021"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679477026"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><a href="#local-6989586621679477028"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679477031"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-3166"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477034"><a href="#local-6989586621679477034"><span class="hs-identifier">num</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477024"><span class="hs-identifier hs-var">modifyPart</span></a><span> </span><a href="#local-6989586621679477033"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679477029"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679477021"><span class="hs-identifier hs-var">iwm</span></a><span> </span><a href="#local-6989586621679477026"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><a href="#local-6989586621679477028"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679477031"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679477034"><span class="hs-identifier hs-var">num</span></a><span>
</span><a name="line-3167"></a><span>
</span><a name="line-3168"></a><span>    </span><span class="hs-identifier">modifyPart</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#DenomiMap"><span class="hs-identifier hs-type">DenomiMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3169"></a><span>    </span><a name="local-6989586621679477024"><a href="#local-6989586621679477024"><span class="hs-identifier">modifyPart</span></a></a><span> </span><a name="local-6989586621679477035"><a href="#local-6989586621679477035"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679477036"><a href="#local-6989586621679477036"><span class="hs-identifier">valKind</span></a></a><span> </span><a name="local-6989586621679477037"><a href="#local-6989586621679477037"><span class="hs-identifier">iwm</span></a></a><span> </span><a name="local-6989586621679477038"><a href="#local-6989586621679477038"><span class="hs-identifier">tmpMap</span></a></a><span> </span><a name="local-6989586621679477039"><a href="#local-6989586621679477039"><span class="hs-identifier">valEmp</span></a></a><span> </span><a name="local-6989586621679477040"><a href="#local-6989586621679477040"><span class="hs-identifier">top</span></a></a><span> </span><a name="local-6989586621679477041"><a href="#local-6989586621679477041"><span class="hs-identifier">num</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477036"><span class="hs-identifier hs-var">valKind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3170"></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3171"></a><span>        </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477042"><a href="#local-6989586621679477042"><span class="hs-identifier">kind</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477043"><a href="#local-6989586621679477043"><span class="hs-identifier">lInd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477042"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-3172"></a><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477043"><span class="hs-identifier hs-var">lInd</span></a><span class="hs-special">,</span><a href="#local-6989586621679477035"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477037"><span class="hs-identifier hs-var">iwm</span></a><span>  </span><span class="hs-keyword">of</span><span>
</span><a name="line-3173"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3174"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477044"><a href="#local-6989586621679477044"><span class="hs-identifier">weight</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477038"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477040"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><a href="#local-6989586621679477035"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477041"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477025"><span class="hs-identifier hs-var">getWorker</span></a><span> </span><a href="#local-6989586621679477039"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679477044"><span class="hs-identifier hs-var">weight</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3175"></a><span>
</span><a name="line-3176"></a><span>    </span><span class="hs-comment">-- | &#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#12434;&#12392;&#12427;</span><span>
</span><a name="line-3177"></a><span>    </span><span class="hs-identifier">getWorker</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3178"></a><span>    </span><a name="local-6989586621679477025"><a href="#local-6989586621679477025"><span class="hs-identifier">getWorker</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-3179"></a><span>    </span><span class="hs-identifier">getWorker</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679477045"><a href="#local-6989586621679477045"><span class="hs-identifier">emp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679477045"><span class="hs-identifier hs-var">emp</span></a><span class="hs-special">)</span><span>
</span><a name="line-3180"></a><span>
</span><a name="line-3181"></a><span>
</span><a name="line-3182"></a><span class="hs-comment">{- | &#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;
    &#29987;&#26989;&#22823;&#20998;&#39006;&#12372;&#12392;&#12395;&#65292;&#20027;&#29987;&#26989;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;&#21512;&#35336;&#12364;&#65292;
    &#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#20107;&#32773;&#25968;&#12398;70%&#20197;&#19978;&#12392;&#12394;&#12427;&#20225;&#26989;&#65288;&#21336;&#19968;&#29987;&#26989;&#20225;&#26989;&#65289;&#20840;&#20307;&#12398;&#23550;&#35937;&#12398;&#20516;&#12434;&#65292;&#24403;&#35442;&#20225;&#26989;&#20840;&#20307;&#12398;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#12391;&#38500;&#12375;&#12390;&#27714;&#12417;&#12427;

    &#22823;&#20998;&#39006;&#20197;&#19979;&#12398;&#32048;&#12363;&#12356;&#20998;&#39006;&#12391;&#12371;&#12428;&#12434;&#34892;&#12387;&#12390;&#12418;&#12424;&#12356;&#65288;&#35201;&#20462;&#27491;&#65289;

-}</span><span>
</span><a name="line-3189"></a><span>
</span><a name="line-3190"></a><span class="hs-keyword">type</span><span> </span><a name="IndWeightMap"><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier">IndWeightMap</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span class="hs-special">,</span><a href="VTable.Data.Structure.html#Header"><span class="hs-identifier hs-type">Header</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3191"></a><span>
</span><a name="line-3192"></a><span>
</span><a name="line-3193"></a><span>
</span><a name="line-3194"></a><span class="hs-comment">-- | &#20225;&#26989;&#21029;&#12398;&#24773;&#22577;&#12434;&#38598;&#12417;&#12383;Map</span><span>
</span><a name="line-3195"></a><span class="hs-keyword">type</span><span> </span><a name="EnWeightInfoMap"><a href="VTable.Compliation.html#EnWeightInfoMap"><span class="hs-identifier">EnWeightInfoMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VTable.Data.Structure.html#E%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-type">E&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span> </span><a href="VTable.Compliation.html#EnWeightInfo"><span class="hs-identifier hs-type">EnWeightInfo</span></a><span>
</span><a name="line-3196"></a><span>
</span><a name="line-3197"></a><span>
</span><a name="line-3198"></a><span class="hs-comment">{- | &#20225;&#26989;&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;&#65292;&#20225;&#26989;&#21029;&#20027;&#29987;&#26989;&#65292;&#20840;&#20307;&#22770;&#19978;&#39640;&#65292;&#20840;&#20307;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#65292;&#35442;&#24403;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;
    &#12434;&#35352;&#37682;&#12377;&#12427;&#12383;&#12417;&#12398;&#12487;&#12540;&#12479;&#22411;

-}</span><span>
</span><a name="line-3202"></a><span class="hs-keyword">data</span><span> </span><a name="EnWeightInfo"><a href="VTable.Compliation.html#EnWeightInfo"><span class="hs-identifier">EnWeightInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EWI"><a href="VTable.Compliation.html#EWI"><span class="hs-identifier">EWI</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="lInd"><a href="VTable.Compliation.html#lInd"><span class="hs-identifier">lInd</span></a></a><span>      </span><span class="hs-glyph">::</span><span>                </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>     </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#29987;&#26989;&#22823;&#20998;&#39006;</span><span>
</span><a name="line-3203"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enCost"><a href="VTable.Compliation.html#enCost"><span class="hs-identifier">enCost</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span><span>
</span><a name="line-3204"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enBought"><a href="VTable.Compliation.html#enBought"><span class="hs-identifier">enBought</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#24180;&#38291;&#20181;&#20837;&#38989;</span><span>
</span><a name="line-3205"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enBegin"><a href="VTable.Compliation.html#enBegin"><span class="hs-identifier">enBegin</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span><span>
</span><a name="line-3206"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="enEnd"><a href="VTable.Compliation.html#enEnd"><span class="hs-identifier">enEnd</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier hs-type">Double</span><span>       </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span><span>
</span><a name="line-3207"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="totalEmp"><a href="VTable.Compliation.html#totalEmp"><span class="hs-identifier">totalEmp</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ &#20225;&#26989;&#12398;&#20840;&#20307;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;(&#20998;&#27597;)</span><span>
</span><a name="line-3208"></a><span>                        </span><span class="hs-special">,</span><span> </span><a name="targetEmp"><a href="VTable.Compliation.html#targetEmp"><span class="hs-identifier">targetEmp</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-identifier hs-type">Int</span><span>          </span><span class="hs-comment">-- ^ &#35442;&#24403;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968; (&#20998;&#23376;)</span><span>
</span><a name="line-3209"></a><span>                        </span><span class="hs-special">}</span><span>
</span><a name="line-3210"></a><span>
</span><a name="line-3211"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Header"><span class="hs-identifier hs-type">Header</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#EnWeightInfo"><span class="hs-identifier hs-type">EnWeightInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-3212"></a><a name="getDataFromEWI"><a href="VTable.Compliation.html#getDataFromEWI"><span class="hs-identifier">getDataFromEWI</span></a></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enCost</span><span>
</span><a name="line-3213"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enBought</span><span>
</span><a name="line-3214"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enBegin</span><span>
</span><a name="line-3215"></a><span class="hs-identifier">getDataFromEWI</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">enEnd</span><span>
</span><a name="line-3216"></a><span>
</span><a name="line-3217"></a><span>
</span><a name="line-3218"></a><span class="hs-comment">{- | Nothing&#12395;&#12394;&#12427;&#12414;&#12391; STRef&#12391;EnWeightInfo&#12434;&#21454;&#38598;&#12375;&#65292;Nothing&#12391;&#12381;&#12428;&#12434;EnWeightInfoMap &#12395;&#22793;&#25563;&#12375;&#12390;&#36820;&#12377;

&#20225;&#26989;&#12363;&#65292;&#22243;&#20307;&#12398;&#22580;&#21512;&#12399;&#65292;&#20840;&#20307;&#12398;&#22770;&#19978;&#39640;&#12434;&#35352;&#20837; &#22770;&#12426;&#19978;&#12370;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;&#22793;&#25563;&#12398;&#27573;&#38542;&#12391;&#38500;&#22806;&#65294;
&#65288;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12391;&#12418;&#65292;&#22770;&#19978;&#39640;&#12398;&#12415;&#65289;

&#20107;&#26989;&#25152;&#12398;&#22580;&#21512;&#12399;&#65292;&#35442;&#24403;&#12377;&#12427;&#12394;&#12425;&#30452;&#36676;&#20225;&#26989;&#12395;&#35442;&#24403;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;&#21450;&#12403;&#65292;&#24467;&#26989;&#32773;&#25968;&#12434;&#35352;&#20837;


&#20491;&#20154;&#32076;&#21942;&#65292;&#21336;&#29420;&#20107;&#26989;&#25152;&#12399;&#65292;&#23550;&#35937;&#12363;&#12425;&#38500;&#12367;

-}</span><span>
</span><a name="line-3229"></a><span>
</span><a name="line-3230"></a><span class="hs-identifier">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475898"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679475898"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span>
</span><a name="line-3231"></a><a name="f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><a href="VTable.Compliation.html#f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><span class="hs-identifier">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span></a></a><span> </span><a name="local-6989586621679477053"><a href="#local-6989586621679477053"><span class="hs-identifier">imap</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3232"></a><span>        </span><a name="local-6989586621679477054"><a href="#local-6989586621679477054"><span class="hs-identifier">maybeIcd</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-3233"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477054"><span class="hs-identifier hs-var">maybeIcd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3234"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3235"></a><span>                     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="VTable.Compliation.html#makeIndWeightMap"><span class="hs-identifier hs-var">makeIndWeightMap</span></a><span>
</span><a name="line-3236"></a><span>
</span><a name="line-3237"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477055"><a href="#local-6989586621679477055"><span class="hs-identifier">icd</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3238"></a><span>
</span><a name="line-3239"></a><span>                </span><span class="hs-glyph">!</span><a name="local-6989586621679477056"><a href="#local-6989586621679477056"><span class="hs-identifier">kind</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-3240"></a><span>                </span><span class="hs-glyph">!</span><a name="local-6989586621679477057"><a href="#local-6989586621679477057"><span class="hs-identifier">triple</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-var">H&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3241"></a><span>
</span><a name="line-3242"></a><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#isEN"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679477056"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#isSingle"><span class="hs-identifier hs-var">isSingle</span></a><span> </span><a href="#local-6989586621679477056"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621679477057"><span class="hs-identifier hs-var">triple</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3243"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#whenIsSi"><span class="hs-identifier hs-var">whenIsSi</span></a><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3244"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#whenIsES"><span class="hs-identifier hs-var">whenIsES</span></a><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3245"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#whenIsSi"><span class="hs-identifier hs-var">whenIsSi</span></a><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3246"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#whenIsEN"><span class="hs-identifier hs-var">whenIsEN</span></a><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3247"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#whenIsSi"><span class="hs-identifier hs-var">whenIsSi</span></a><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3248"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#whenIsES"><span class="hs-identifier hs-var">whenIsES</span></a><span> </span><a href="#local-6989586621679477055"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">)</span><span>
</span><a name="line-3249"></a><span>
</span><a name="line-3250"></a><span>                </span><a href="VTable.Compliation.html#f%7523%696D%5225%30A6%30A7%30A4%30C8%53D6%5F97"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#12454;&#12455;&#12452;&#12488;&#21462;&#24471;</span></a><span> </span><a href="#local-6989586621679477053"><span class="hs-identifier hs-var">imap</span></a><span>
</span><a name="line-3251"></a><span>
</span><a name="line-3252"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">whenIsEN</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3253"></a><span class="hs-identifier">whenIsEN</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3254"></a><a name="whenIsEN"><a href="VTable.Compliation.html#whenIsEN"><span class="hs-identifier">whenIsEN</span></a></a><span> </span><a name="local-6989586621679477058"><a href="#local-6989586621679477058"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679477059"><a href="#local-6989586621679477059"><span class="hs-identifier">smap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3255"></a><span>        </span><a name="local-6989586621679477060"><a href="#local-6989586621679477060"><span class="hs-identifier">tmpMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477059"><span class="hs-identifier hs-var">smap</span></a><span>
</span><a name="line-3256"></a><span>        </span><a name="local-6989586621679477061"><a href="#local-6989586621679477061"><span class="hs-identifier">valCode</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3257"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477061"><span class="hs-identifier hs-var">valCode</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3258"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3259"></a><span>            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679477062"><a href="#local-6989586621679477062"><span class="hs-identifier">code</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3260"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477063"><a href="#local-6989586621679477063"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.init</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">T.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477062"><span class="hs-identifier hs-var">code</span></a><span>
</span><a name="line-3261"></a><span>
</span><a name="line-3262"></a><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477063"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679477060"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3263"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3264"></a><span>                        </span><a name="local-6989586621679477064"><a href="#local-6989586621679477064"><span class="hs-identifier">valInd</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3265"></a><span>                        </span><a name="local-6989586621679477065"><a href="#local-6989586621679477065"><span class="hs-identifier">cost</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3266"></a><span>                        </span><a name="local-6989586621679477066"><a href="#local-6989586621679477066"><span class="hs-identifier">bought</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3267"></a><span>                        </span><a name="local-6989586621679477067"><a href="#local-6989586621679477067"><span class="hs-identifier">begin</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3268"></a><span>                        </span><a name="local-6989586621679477068"><a href="#local-6989586621679477068"><span class="hs-identifier">end</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3269"></a><span>                        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477064"><span class="hs-identifier hs-var">valInd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3270"></a><span>                            </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477069"><a href="#local-6989586621679477069"><span class="hs-identifier">ind</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477059"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477063"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#EWI"><span class="hs-identifier hs-var">EWI</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477069"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477065"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679477066"><span class="hs-identifier hs-var">bought</span></a><span> </span><a href="#local-6989586621679477067"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679477068"><span class="hs-identifier hs-var">end</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3271"></a><span>                            </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3272"></a><span>
</span><a name="line-3273"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477070"><a href="#local-6989586621679477070"><span class="hs-identifier">ewi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-3274"></a><span>                        </span><a name="local-6989586621679477071"><a href="#local-6989586621679477071"><span class="hs-identifier">valInd</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3275"></a><span>                        </span><a name="local-6989586621679477072"><a href="#local-6989586621679477072"><span class="hs-identifier">cost</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3276"></a><span>                        </span><a name="local-6989586621679477073"><a href="#local-6989586621679477073"><span class="hs-identifier">bought</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3277"></a><span>                        </span><a name="local-6989586621679477074"><a href="#local-6989586621679477074"><span class="hs-identifier">begin</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3278"></a><span>                        </span><a name="local-6989586621679477075"><a href="#local-6989586621679477075"><span class="hs-identifier">end</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VTable.Compliation.html#getDoubleFromVal"><span class="hs-identifier hs-var">getDoubleFromVal</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477058"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3279"></a><span>                        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477071"><span class="hs-identifier hs-var">valInd</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3280"></a><span>                            </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477076"><a href="#local-6989586621679477076"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3281"></a><span>                                    </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679477077"><a href="#local-6989586621679477077"><span class="hs-identifier">tmpIndustry</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lInd</span><span>      </span><a href="#local-6989586621679477070"><span class="hs-identifier hs-var">ewi</span></a><span>
</span><a name="line-3282"></a><span>                                    </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679477078"><a href="#local-6989586621679477078"><span class="hs-identifier">tmpTotalEmp</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">totalEmp</span><span>  </span><a href="#local-6989586621679477070"><span class="hs-identifier hs-var">ewi</span></a><span>
</span><a name="line-3283"></a><span>                                    </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679477079"><a href="#local-6989586621679477079"><span class="hs-identifier">tmpTargetEmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679477070"><span class="hs-identifier hs-var">ewi</span></a><span>
</span><a name="line-3284"></a><span>                                    </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679477080"><a href="#local-6989586621679477080"><span class="hs-identifier">tmpEwi</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#EWI"><span class="hs-identifier hs-var">EWI</span></a><span> </span><a href="#local-6989586621679477077"><span class="hs-identifier hs-var">tmpIndustry</span></a><span> </span><a href="#local-6989586621679477072"><span class="hs-identifier hs-var">cost</span></a><span> </span><a href="#local-6989586621679477073"><span class="hs-identifier hs-var">bought</span></a><span> </span><a href="#local-6989586621679477074"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679477075"><span class="hs-identifier hs-var">end</span></a><span> </span><a href="#local-6989586621679477078"><span class="hs-identifier hs-var">tmpTotalEmp</span></a><span> </span><a href="#local-6989586621679477079"><span class="hs-identifier hs-var">tmpTargetEmp</span></a><span>
</span><a name="line-3285"></a><span>                                    </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477059"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477063"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679477080"><span class="hs-identifier hs-var">tmpEwi</span></a><span class="hs-special">)</span><span>
</span><a name="line-3286"></a><span>                            </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3287"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">whenIsES</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3288"></a><span class="hs-identifier">whenIsES</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3289"></a><a name="whenIsES"><a href="VTable.Compliation.html#whenIsES"><span class="hs-identifier">whenIsES</span></a></a><span> </span><a name="local-6989586621679477081"><a href="#local-6989586621679477081"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679477082"><a href="#local-6989586621679477082"><span class="hs-identifier">smap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3290"></a><span>        </span><a name="local-6989586621679477083"><a href="#local-6989586621679477083"><span class="hs-identifier">tmpMap</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477082"><span class="hs-identifier hs-var">smap</span></a><span>
</span><a name="line-3291"></a><span>        </span><a name="local-6989586621679477084"><a href="#local-6989586621679477084"><span class="hs-identifier">valCode</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477081"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%76F4%8F44%4F01%696D%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#30452;&#36676;&#20225;&#26989;&#12467;&#12540;&#12489;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3292"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477084"><span class="hs-identifier hs-var">valCode</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3293"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3294"></a><span>            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679477085"><a href="#local-6989586621679477085"><span class="hs-identifier">code</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3295"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477086"><a href="#local-6989586621679477086"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.init</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">T.init</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477085"><span class="hs-identifier hs-var">code</span></a><span>
</span><a name="line-3296"></a><span>
</span><a name="line-3297"></a><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477086"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679477083"><span class="hs-identifier hs-var">tmpMap</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3298"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3299"></a><span>                        </span><a name="local-6989586621679477087"><a href="#local-6989586621679477087"><span class="hs-identifier">valInd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477081"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3300"></a><span>                        </span><a name="local-6989586621679477088"><a href="#local-6989586621679477088"><span class="hs-identifier">valEmp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477081"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3301"></a><span>
</span><a name="line-3302"></a><span>                        </span><span class="hs-keyword">case</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679477087"><span class="hs-identifier hs-var">valInd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477088"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3303"></a><span>                            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477089"><a href="#local-6989586621679477089"><span class="hs-identifier">ind</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679477090"><a href="#local-6989586621679477090"><span class="hs-identifier">emp</span></a></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3304"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477091"><a href="#local-6989586621679477091"><span class="hs-identifier">totalEmpToAdd</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#38599;&#29992;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679477090"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-3305"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477092"><a href="#local-6989586621679477092"><span class="hs-identifier">targetEmpToAdd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679477090"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-3306"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477093"><a href="#local-6989586621679477093"><span class="hs-identifier">tmpEwi</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#EWI"><span class="hs-identifier hs-var">EWI</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477089"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679477091"><span class="hs-identifier hs-var">totalEmpToAdd</span></a><span> </span><a href="#local-6989586621679477092"><span class="hs-identifier hs-var">targetEmpToAdd</span></a><span>
</span><a name="line-3307"></a><span>                                </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477082"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477086"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679477093"><span class="hs-identifier hs-var">tmpEwi</span></a><span class="hs-special">)</span><span>
</span><a name="line-3308"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span>               </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3309"></a><span>
</span><a name="line-3310"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477094"><a href="#local-6989586621679477094"><span class="hs-identifier">ewi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-3311"></a><span>                        </span><a name="local-6989586621679477095"><a href="#local-6989586621679477095"><span class="hs-identifier">valInd</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477081"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3312"></a><span>                        </span><a name="local-6989586621679477096"><a href="#local-6989586621679477096"><span class="hs-identifier">valEmp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477081"><span class="hs-identifier hs-var">icd</span></a><span> </span><a href="VTable.Data.Structure.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3313"></a><span>
</span><a name="line-3314"></a><span>                        </span><span class="hs-keyword">case</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679477095"><span class="hs-identifier hs-var">valInd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477096"><span class="hs-identifier hs-var">valEmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3315"></a><span>                            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477097"><a href="#local-6989586621679477097"><span class="hs-identifier">ind</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679477098"><a href="#local-6989586621679477098"><span class="hs-identifier">emp</span></a></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3316"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477099"><a href="#local-6989586621679477099"><span class="hs-identifier">totalEmpToAdd</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#38599;&#29992;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679477098"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-3317"></a><span>                                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477100"><a href="#local-6989586621679477100"><span class="hs-identifier">targetEmpToAdd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">_&#20107;&#20107;&#26989;&#24467;&#26989;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679477098"><span class="hs-identifier hs-var">emp</span></a><span>
</span><a name="line-3318"></a><span>                                </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679477094"><span class="hs-identifier hs-var">ewi</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#22823;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477097"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3319"></a><span>                                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477082"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477086"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477094"><span class="hs-identifier hs-var">ewi</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">totalEmp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">totalEmp</span><span>  </span><a href="#local-6989586621679477094"><span class="hs-identifier hs-var">ewi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477099"><span class="hs-identifier hs-var">totalEmpToAdd</span></a><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3320"></a><span>                                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477082"><span class="hs-identifier hs-var">smap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477086"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477094"><span class="hs-identifier hs-var">ewi</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">totalEmp</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">totalEmp</span><span>  </span><a href="#local-6989586621679477094"><span class="hs-identifier hs-var">ewi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477099"><span class="hs-identifier hs-var">totalEmpToAdd</span></a><span>
</span><a name="line-3321"></a><span>                                                                                </span><span class="hs-special">,</span><span class="hs-identifier">targetEmp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679477094"><span class="hs-identifier hs-var">ewi</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477100"><span class="hs-identifier hs-var">targetEmpToAdd</span></a><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3322"></a><span>                            </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3323"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">whenIsSi</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3324"></a><span class="hs-identifier">whenIsSi</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3325"></a><a name="whenIsSi"><a href="VTable.Compliation.html#whenIsSi"><span class="hs-identifier">whenIsSi</span></a></a><span> </span><a name="local-6989586621679477101"><a href="#local-6989586621679477101"><span class="hs-identifier">icd</span></a></a><span> </span><a name="local-6989586621679477102"><a href="#local-6989586621679477102"><span class="hs-identifier">smap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3326"></a><span>
</span><a name="line-3327"></a><span class="hs-identifier">makeIndWeightMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#EnWeightInfoMap"><span class="hs-identifier hs-type">EnWeightInfoMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Compliation.html#IndWeightMap"><span class="hs-identifier hs-type">IndWeightMap</span></a><span>
</span><a name="line-3328"></a><a name="makeIndWeightMap"><a href="VTable.Compliation.html#makeIndWeightMap"><span class="hs-identifier">makeIndWeightMap</span></a></a><span> </span><a name="local-6989586621679477103"><a href="#local-6989586621679477103"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">runST</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3329"></a><span>                </span><a name="local-6989586621679477106"><a href="#local-6989586621679477106"><span class="hs-identifier">tmpMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newSTRef</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span>
</span><a name="line-3330"></a><span>                </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477104"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477107"><a href="#local-6989586621679477107"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3331"></a><span>                    </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477108"><a href="#local-6989586621679477108"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3332"></a><span>
</span><a name="line-3333"></a><span>                        </span><a name="local-6989586621679477109"><a href="#local-6989586621679477109"><span class="hs-identifier">redMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679477106"><span class="hs-identifier hs-var">tmpMap</span></a><span>
</span><a name="line-3334"></a><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477108"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477109"><span class="hs-identifier hs-var">redMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3335"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3336"></a><span>                                </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Compliation.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679477108"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">(</span><span>
</span><a name="line-3337"></a><span>                                     </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679477106"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679477108"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Compliation.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679477108"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3338"></a><span>
</span><a name="line-3339"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477110"><a href="#local-6989586621679477110"><span class="hs-identifier">tup</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3340"></a><span>                                </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Compliation.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679477108"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">)</span><span class="hs-special">(</span><span>
</span><a name="line-3341"></a><span>                                     </span><span class="hs-identifier hs-var">modifySTRef</span><span> </span><a href="#local-6989586621679477106"><span class="hs-identifier hs-var">tmpMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lInd</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679477108"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679477110"><span class="hs-identifier hs-var">tup</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#getDataFromEWI"><span class="hs-identifier hs-var">getDataFromEWI</span></a><span> </span><a href="#local-6989586621679477108"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-3342"></a><span>                                                                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679477110"><span class="hs-identifier hs-var">tup</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">targetEmp</span><span> </span><a href="#local-6989586621679477107"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3343"></a><span>                </span><a name="local-6989586621679477111"><a href="#local-6989586621679477111"><span class="hs-identifier">resultMap</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readSTRef</span><span> </span><a href="#local-6989586621679477106"><span class="hs-identifier hs-var">tmpMap</span></a><span>
</span><a name="line-3344"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679477112"><a href="#local-6989586621679477112"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679477112"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679477112"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477112"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477111"><span class="hs-identifier hs-var">resultMap</span></a><span>
</span><a name="line-3345"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-3346"></a><span>    </span><span class="hs-glyph">~</span><a name="local-6989586621679477104"><a href="#local-6989586621679477104"><span class="hs-identifier">ys</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Map.elems</span><span>
</span><a name="line-3347"></a><span>        </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">Map.filter</span><span>
</span><a name="line-3348"></a><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679477105"><a href="#local-6989586621679477105"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">totalEmp</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477105"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">targetEmp</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477105"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">totalEmp</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477105"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0.7</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477103"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-3349"></a><span>
</span><a name="line-3350"></a><span>
</span><a name="line-3351"></a><span>
</span><a name="line-3352"></a><span class="hs-comment">-- | &#20491;&#20154;&#32076;&#21942;&#32773;,&#12354;&#12427;&#12356;&#12399;&#21336;&#29420;&#20107;&#26989;&#25152;&#12363;&#21542;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-3353"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">isSingle</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3354"></a><span class="hs-identifier">isSingle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-type">Val&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3355"></a><a name="isSingle"><a href="VTable.Compliation.html#isSingle"><span class="hs-identifier">isSingle</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3356"></a><span class="hs-identifier">isSingle</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679477113"><a href="#local-6989586621679477113"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679477114"><a href="#local-6989586621679477114"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679477115"><a href="#local-6989586621679477115"><span class="hs-identifier">subject</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>
</span><a name="line-3357"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477113"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5358%72EC%4E8B%696D%6240%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679477113"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span>  </span><a href="VTable.Data.Structure.html#E%500B%4EBA%7D4C%55B6%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477115"><span class="hs-identifier hs-var">subject</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%500B%4EBA%7D4C%55B6%8005%7528"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#32773;&#29992;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3358"></a><span class="hs-identifier">isSingle</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679477116"><a href="#local-6989586621679477116"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679477117"><a href="#local-6989586621679477117"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679477118"><a href="#local-6989586621679477118"><span class="hs-identifier">subject</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-var">V&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span> </span><a name="local-6989586621679477119"><a href="#local-6989586621679477119"><span class="hs-identifier">triple</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3359"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477116"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5358%72EC%4E8B%696D%6240%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679477116"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span>  </span><a href="VTable.Data.Structure.html#E%500B%4EBA%7D4C%55B6%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#35519;&#26619;&#31080;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477118"><span class="hs-identifier hs-var">subject</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%500B%4EBA%7D4C%55B6%8005%7528"><span class="hs-identifier hs-var">E&#20491;&#20154;&#32076;&#21942;&#32773;&#29992;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477119"><span class="hs-identifier hs-var">triple</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5358%72EC%4E8B%696D%6240"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3360"></a><span class="hs-identifier">isSingle</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%5358%72EC%672C%6240%652F%6240%533A%5206"><span class="hs-identifier hs-var">V&#21336;&#29420;&#26412;&#25152;&#25903;&#25152;&#21306;&#20998;</span></a><span> </span><a name="local-6989586621679477120"><a href="#local-6989586621679477120"><span class="hs-identifier">triple</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3361"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477120"><span class="hs-identifier hs-var">triple</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5358%72EC%4E8B%696D%6240"><span class="hs-identifier hs-var">E&#21336;&#29420;&#20107;&#26989;&#25152;</span></a><span class="hs-special">)</span><span>
</span><a name="line-3362"></a><span>
</span><a name="line-3363"></a><span>
</span><a name="line-3364"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3365"></a><span class="hs-comment">-- * &#12510;&#12540;&#12472;&#12531;&#25512;&#35336;</span><span>
</span><a name="line-3366"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3367"></a><span>
</span><a name="line-3368"></a><span class="hs-comment">-- | &#12501;&#12449;&#12452;&#12523;&#12434;&#21463;&#12369;&#21462;&#12387;&#12390;</span><span>
</span><a name="line-3369"></a><span>
</span><a name="line-3370"></a><span>
</span><a name="line-3371"></a><span class="hs-comment">{- | &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;

    JSNA&#12395;&#12362;&#12369;&#12427;V&#34920;&#12399;&#22269;&#36899;&#22522;&#28310;&#12391;&#12354;&#12427;&#65292;&#22522;&#26412;&#20385;&#26684;&#34920;&#31034;&#12392;&#12399;&#30064;&#12394;&#12426;&#65292;&#36939;&#36664;&#12539;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12434;&#12381;&#12428;&#12382;&#12428;&#12398;&#29987;&#26989;&#12398;&#33258;&#20132;&#28857;&#12395;&#35336;&#19978;&#12375;&#12390;&#12356;&#12427;&#65294;
    SUT&#20307;&#31995;&#12408;&#12398;&#31227;&#34892;&#24460;&#12398;S&#34920;&#12395;&#12362;&#12356;&#12390;&#12393;&#12398;&#12424;&#12358;&#12394;&#20385;&#26684;&#12434;&#25505;&#29992;&#12377;&#12427;&#12363;&#12399;&#29694;&#34892;&#26410;&#23450;&#12391;&#12354;&#12427;&#12398;&#12391;&#65292;
    &#26412;&#31295;&#12391;&#12399;&#29694;&#34892;V&#34920;&#12395;&#21512;&#12431;&#12379;&#12390;&#65292;&#25512;&#35336;&#12373;&#12428;&#12383;&#12510;&#12540;&#12472;&#12531;&#12399;&#12381;&#12428;&#12382;&#12428;&#12398;&#33258;&#20132;&#28857;&#12395;&#35336;&#19978;&#12377;&#12427;&#65294;
    &#20197;&#38477;&#21508;&#12510;&#12540;&#12472;&#12531;&#12398;&#25512;&#35336;&#25163;&#27861;&#12395;&#38306;&#12375;&#12390;&#22806;&#35251;&#65292;&#32771;&#23519;&#12377;&#12427;&#65294;

     &#24179;&#25104;23&#24180;V&#34920;&#12395;&#12362;&#12369;&#12427;&#21508;&#29987;&#26989;&#12398;&#32207;&#29983;&#29987;&#38989;&#12399;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#21462;&#24341;&#22522;&#26412;&#34920;&#12398;&#34892;&#21644;&#12364;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12427;&#65294;
     &#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#32207;&#21512;&#35299;&#35500;&#32232; &#12395;&#12424;&#12428;&#12400;&#65292;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12369;&#12427;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12399;

     &#12300;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#65309;&#22770;&#19978;&#38989;&#65288;&#21830;&#26989;&#36009;&#22770;&#38989;&#65289;&#65293; &#20181;&#20837;&#38989;&#12301;

     &#12395;&#12424;&#12387;&#12390;&#23450;&#32681;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#24179;&#25104;23&#24180;&#34920;&#12391;&#12399;&#12300;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12301;&#12398;&#32068;&#26367;&#38598;&#35336;&#32080;&#26524;&#65288;&#37096;&#20869;&#36039;&#26009;&#65289;&#12424;&#12426;&#25512;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

     &#19968;&#26041;&#65292;&#31532;52&#22238;&#12469;&#12540;&#12499;&#12473;&#32113;&#35336;&#12539;&#20225;&#26989;&#32113;&#35336;&#37096;&#20250;&#37197;&#24067;&#36039;&#26009; &#12391;&#12399;&#65292;
     &#24179;&#25104;24&#24180;&#12395;&#12362;&#12369;&#12427;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#12398;&#25512;&#35336;&#25163;&#27861;&#12399;&#65292;&#21830;&#21697;&#36009;&#22770;&#38989;&#12363;&#12425;&#20225;&#26989;&#35519;&#26619;&#31080;&#31561;&#12398;&#35519;&#26619;&#38917;&#30446;&#12391;&#12354;&#12427;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12434;&#24341;&#12367;&#24418;&#12391;&#27714;&#12417;&#12390;&#12356;&#12427;&#12392;&#35500;&#26126;&#12375;&#12390;&#12356;&#12427;&#65294;

    &#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#65288;&#20027;&#26989;&#65292;&#24467;&#26989;&#65289;=&#24180;&#38291;&#21830;&#21697;&#36009;&#22770;&#38989;-&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;

    &#12414;&#12383;&#65292;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#12399;&#35519;&#26619;&#22996;&#38917;&#30446;&#12395;&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;&#12364;&#36861;&#21152;&#12373;&#12428;&#65292;
    &#20182;&#12398;&#35352;&#20837;&#38917;&#30446;&#12363;&#12425;&#35336;&#31639;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12383;&#12417;&#65292;&#22770;&#19978;&#21407;&#20385;&#12395;&#23550;&#12377;&#12427;&#35519;&#26619;&#38917;&#30446;&#12364;&#24259;&#27490;&#12373;&#12428;&#65292;
    &#12414;&#12383;&#24179;&#25104;24&#24180;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#65292;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12398;&#22823;&#21322;&#12434;&#20027;&#26989;&#12364;&#21344;&#12417;&#12390;&#12356;&#12383;&#12371;&#12392;&#12363;&#12425;&#24467;&#26989;&#12395;&#38306;&#12377;&#12427;&#22770;&#19978;&#21407;&#20385;&#12398;&#25226;&#25569;&#12434;&#21462;&#12426;&#12420;&#12417;&#65292;
    &#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#25512;&#35336;&#12377;&#12427;&#12392;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#24179;&#25104;&#65298;8&#24180;&#12475;&#12531;&#12469;&#12473;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#65288;&#20027;&#26989;&#65289;&#65309;&#24180;&#38291;&#21830;&#21697;&#36009;&#22770;&#38989;- &#65288;&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;&#65291;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#38989;-&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#65289;

     &#20197;&#19979;&#22522;&#26412;&#30340;&#12395;&#12399;&#19978;&#35352;&#36039;&#26009;&#12395;&#24467;&#12356;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#38917;&#30446;&#12364;&#21462;&#24471;&#12391;&#12365;&#12394;&#12356;&#22580;&#21512;&#12395;&#12362;&#12369;&#12427;&#22580;&#21512;&#12434;&#32771;&#24942;&#12375;&#12390;&#65292;
     &#24179;&#25104;24&#24180;&#65292;&#24179;&#25104;28&#24180;&#12381;&#12428;&#12382;&#12428;&#12398;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#25163;&#27861;&#12434;&#35373;&#35336;&#12377;&#12427;&#65294;

     &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12398;&#25512;&#35336;&#12395;&#29992;&#12356;&#12427;&#38917;&#30446;&#12399;&#65292;

    &#12539;&#24179;&#25104;24&#24180;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#9312;&#12300;&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;&#12301;

    &#12539;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#9313;&#12300;&#24180;&#21021;&#21450;&#12403;&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;&#12301;&#65292;&#9314;&#12300;&#24180;&#38291;&#21830;&#21697;&#20181;&#20837;&#38989;&#12301;

    &#12539;&#24179;&#25104;24&#24180;&#65292;28&#24180;&#21336;&#29420;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#21450;&#12403;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#65289;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#9315;&#12300;&#24180;&#38291;&#21830;&#21697;&#36009;&#22770;&#38989;&#12301;&#65292;
    &#9316;&#12300;&#36027;&#29992;&#32207;&#38989;&#21450;&#12403;&#36027;&#29992;&#20869;&#35379;&#12301;&#12398;&#12358;&#12385;&#12300;&#22770;&#19978;&#21407;&#20385;&#12301;

    &#12539;&#12381;&#12398;&#20182;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#9317;&#12300;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#12301;&#12398;&#12358;&#12385;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12398;&#22238;&#31572;&#38989;

    &#12392;&#12394;&#12427;&#65294;&#21508;&#38917;&#30446;&#12398;&#35519;&#26619;&#31080;&#21029;&#12398;&#26377;&#28961;&#12399;&#65292;&#12300;&#34920; 2 &#21508;&#24180;&#24230;&#21029;&#35519;&#26619;&#31080;&#12395;&#21547;&#12414;&#12428;&#12427;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12395;&#21033;&#29992;&#12373;&#12428;&#12427;&#38917;&#30446;&#12392;&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#25163;&#27861;&#12301;&#12395;&#12414;&#12392;&#12417;&#12383;&#65294;
    &#20197;&#38477;&#65292;&#26410;&#22238;&#31572;&#12398;&#22580;&#21512;&#12434;&#21547;&#12417;&#12390;&#65292;&#21508;&#24773;&#22577;&#12398;&#35352;&#36617;&#12398;&#26377;&#28961;&#12395;&#12381;&#12387;&#12390;&#12300;&#22259; 7 &#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#21462;&#24471;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#12301;&#12395;&#24467;&#12387;&#12390;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12434;&#27714;&#12417;&#12427;&#65294;


    ![&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#21462;&#24471;&#12527;&#12540;&#12463;&#12501;&#12525;&#12540;&#22259;](margin.png)

    &#20966;&#29702;&#12392;&#12375;&#12390;&#12399;&#65292;&#65298;&#65298;&#21306;&#20998;&#12398;&#22770;&#19978;&#39640;&#12398;&#20516;&#21450;&#12403;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12398;&#12358;&#12385;&#21830;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#12418;&#12398;&#12395;&#20966;&#29702;&#12434;&#26045;&#12375;&#12390;&#12356;&#12367;&#65294;
    &#39006;&#20284;&#35519;&#26619;&#31080;&#20966;&#29702;&#12364;&#24517;&#35201;&#12395;&#12394;&#12387;&#12383;&#12418;&#12398;&#12399; IORef [IOCensusRow] &#12391;&#20445;&#23384;&#12375;&#65292;&#32066;&#20102;&#24460;&#12377;&#12409;&#12390;&#20966;&#29702;&#12375;&#12390;yield&#12377;&#12427;&#65294;

    &#26412;&#24403;&#12399;&#33258;&#23478;&#20489;&#24235;&#12420;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#20998;&#12395;&#12399;&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#20055;&#12376;&#12427;&#12409;&#12365;&#12391;&#12399;&#12394;&#12356;(&#26410;&#23550;&#24540;)

    &#21516;&#19968;&#29987;&#26989;&#20966;&#29702;&#12399;,&#24517;&#35201;&#12394;&#22580;&#21512;List&#12395;&#12383;&#12417;&#12390;&#12362;&#12365;,&#26368;&#24460;&#12395;&#12414;&#12392;&#12417;&#12390;&#20966;&#29702;&#12434;&#34892;&#12358;.
-}</span><span>
</span><a name="line-3424"></a><span>
</span><a name="line-3425"></a><span>
</span><a name="line-3426"></a><span class="hs-identifier">f&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679475897"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475897"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#ToMakeMarginMap"><span class="hs-identifier hs-type">ToMakeMarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-special">[</span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475897"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3427"></a><a name="f%5546%696D%30DE%30FC%30B8%30F3%51E6%7406"><a href="VTable.Compliation.html#f%5546%696D%30DE%30FC%30B8%30F3%51E6%7406"><span class="hs-identifier">f&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#20966;&#29702;</span></a></a><span>  </span><a name="local-6989586621679477121"><a href="#local-6989586621679477121"><span class="hs-identifier">refTmm</span></a></a><span> </span><a name="local-6989586621679477122"><a href="#local-6989586621679477122"><span class="hs-identifier">icrList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3428"></a><span>        </span><a name="local-6989586621679477123"><a href="#local-6989586621679477123"><span class="hs-identifier">maybeIcr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-3429"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477123"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3430"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477122"><span class="hs-identifier hs-var">icrList</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477124"><a href="#local-6989586621679477124"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-3431"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477121"><span class="hs-identifier hs-var">refTmm</span></a><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477125"><a href="#local-6989586621679477125"><span class="hs-identifier">tm</span></a></a><span>
</span><a name="line-3432"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-string">&quot;start f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-3433"></a><span>                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">CL.sourceList</span><span> </span><a href="#local-6989586621679477124"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-operator hs-var">.|</span><span> </span><a href="VTable.Compliation.html#f%540C%4E00%7523%696D%51E6%7406"><span class="hs-identifier hs-var">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#makeMarginMap"><span class="hs-identifier hs-var">makeMarginMap</span></a><span> </span><a href="#local-6989586621679477125"><span class="hs-identifier hs-var">tm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3434"></a><span>
</span><a name="line-3435"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477126"><a href="#local-6989586621679477126"><span class="hs-identifier">icr</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477127"><a href="#local-6989586621679477127"><span class="hs-identifier">valSev</span></a></a><span>
</span><a name="line-3436"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5546%54C1%58F2%4E0A%539F%4FA1"><span class="hs-identifier hs-var">H&#21830;&#21697;&#22770;&#19978;&#21407;&#20385;</span></a><span class="hs-special">)</span><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477128"><a href="#local-6989586621679477128"><span class="hs-identifier">valCost</span></a></a><span>
</span><a name="line-3437"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477129"><a href="#local-6989586621679477129"><span class="hs-identifier">valTar</span></a></a><span>
</span><a name="line-3438"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%521D%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#21021;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>         </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477130"><a href="#local-6989586621679477130"><span class="hs-identifier">valBegin</span></a></a><span>
</span><a name="line-3439"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%672B%5546%54C1%624B%6301%984D"><span class="hs-identifier hs-var">H&#24180;&#26411;&#21830;&#21697;&#25163;&#25345;&#38989;</span></a><span class="hs-special">)</span><span>         </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477131"><a href="#local-6989586621679477131"><span class="hs-identifier">valEnd</span></a></a><span>
</span><a name="line-3440"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5E74%9593%4ED5%5165%984D"><span class="hs-identifier hs-var">H&#24180;&#38291;&#20181;&#20837;&#38989;</span></a><span class="hs-special">)</span><span>             </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477132"><a href="#local-6989586621679477132"><span class="hs-identifier">valBought</span></a></a><span>
</span><a name="line-3441"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477133"><a href="#local-6989586621679477133"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-3442"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477127"><span class="hs-identifier hs-var">valSev</span></a><span class="hs-special">,</span><a href="#local-6989586621679477128"><span class="hs-identifier hs-var">valCost</span></a><span class="hs-special">,</span><a href="#local-6989586621679477130"><span class="hs-identifier hs-var">valBegin</span></a><span class="hs-special">,</span><a href="#local-6989586621679477131"><span class="hs-identifier hs-var">valEnd</span></a><span class="hs-special">,</span><a href="#local-6989586621679477132"><span class="hs-identifier hs-var">valBought</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3443"></a><span>                            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3444"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477122"><span class="hs-identifier hs-var">icrList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3445"></a><span>
</span><a name="line-3446"></a><span>                            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477134"><a href="#local-6989586621679477134"><span class="hs-identifier">sev</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679477135"><a href="#local-6989586621679477135"><span class="hs-identifier">cost</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3447"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477136"><a href="#local-6989586621679477136"><span class="hs-identifier">cSales</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><a href="VTable.Compliation.html#isCommerceDetail"><span class="hs-identifier hs-var">isCommerceDetail</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477134"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-3448"></a><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477136"><span class="hs-identifier hs-var">cSales</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3449"></a><span>                                     </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477137"><a href="#local-6989586621679477137"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477136"><span class="hs-identifier hs-var">cSales</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477135"><span class="hs-identifier hs-var">cost</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477136"><span class="hs-identifier hs-var">cSales</span></a><span>
</span><a name="line-3450"></a><span>                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477137"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477137"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3451"></a><span>                                                </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3452"></a><span>                                                </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%8868%9762%88CF%9762%51E6%7406"><span class="hs-identifier hs-var">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477137"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477127"><span class="hs-identifier hs-var">valSev</span></a><span> </span><a href="#local-6989586621679477129"><span class="hs-identifier hs-var">valTar</span></a><span> </span><a href="#local-6989586621679477133"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679477121"><span class="hs-identifier hs-var">refTmm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3453"></a><span>                                                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3454"></a><span>                                     </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477122"><span class="hs-identifier hs-var">icrList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3455"></a><span>
</span><a name="line-3456"></a><span>                            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477138"><a href="#local-6989586621679477138"><span class="hs-identifier">sev</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679477139"><a href="#local-6989586621679477139"><span class="hs-identifier">begin</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679477140"><a href="#local-6989586621679477140"><span class="hs-identifier">end</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679477141"><a href="#local-6989586621679477141"><span class="hs-identifier">bought</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3457"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477142"><a href="#local-6989586621679477142"><span class="hs-identifier">cSales</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.filter</span><span> </span><a href="VTable.Compliation.html#isCommerceDetail"><span class="hs-identifier hs-var">isCommerceDetail</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477138"><span class="hs-identifier hs-var">sev</span></a><span>
</span><a name="line-3458"></a><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477143"><a href="#local-6989586621679477143"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679477142"><span class="hs-identifier hs-var">cSales</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477139"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477140"><span class="hs-identifier hs-var">end</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477141"><span class="hs-identifier hs-var">bought</span></a><span>
</span><a name="line-3459"></a><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477143"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477143"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3460"></a><span>                                    </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3461"></a><span>                                    </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%8868%9762%88CF%9762%51E6%7406"><span class="hs-identifier hs-var">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477143"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477127"><span class="hs-identifier hs-var">valSev</span></a><span> </span><a href="#local-6989586621679477129"><span class="hs-identifier hs-var">valTar</span></a><span> </span><a href="#local-6989586621679477133"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679477121"><span class="hs-identifier hs-var">refTmm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3462"></a><span>                                            </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3463"></a><span>
</span><a name="line-3464"></a><span>                            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477144"><a href="#local-6989586621679477144"><span class="hs-identifier">sev</span></a></a><span class="hs-special">,</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3465"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477122"><span class="hs-identifier hs-var">icrList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477126"><span class="hs-identifier hs-var">icr</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3466"></a><span>
</span><a name="line-3467"></a><span>                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%5546%696D%30DE%30FC%30B8%30F3%51E6%7406"><span class="hs-identifier hs-var">f&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#20966;&#29702;</span></a><span>  </span><a href="#local-6989586621679477121"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><a href="#local-6989586621679477122"><span class="hs-identifier hs-var">icrList</span></a><span>
</span><a name="line-3468"></a><span>
</span><a name="line-3469"></a><span class="hs-comment">-- | &#12510;&#12540;&#12472;&#12531;&#29575;</span><span>
</span><a name="line-3470"></a><span class="hs-keyword">type</span><span> </span><a name="MarginRate"><a href="VTable.Compliation.html#MarginRate"><span class="hs-identifier">MarginRate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3471"></a><span>
</span><a name="line-3472"></a><span class="hs-comment">-- | &#21516;&#19968;&#12398;&#22823;&#20998;&#39006;&#12395;&#26684;&#20184;&#12369;&#12373;&#12428;&#12390;&#12356;&#12427;&#20107;&#26989;&#25152;&#12398;&#24179;&#22343;&#12510;&#12540;&#12472;&#12531;&#29575;</span><span>
</span><a name="line-3473"></a><span class="hs-keyword">type</span><span> </span><a name="MarginMap"><a href="VTable.Compliation.html#MarginMap"><span class="hs-identifier">MarginMap</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><a href="VTable.Compliation.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span>
</span><a name="line-3474"></a><span>
</span><a name="line-3475"></a><span class="hs-comment">-- | MarginMap&#12434;&#20316;&#12427;&#12383;&#12417;&#12398;&#20013;&#38291;&#12487;&#12540;&#12479;&#22411;</span><span>
</span><a name="line-3476"></a><span class="hs-keyword">type</span><span> </span><a name="ToMakeMarginMap"><a href="VTable.Compliation.html#ToMakeMarginMap"><span class="hs-identifier">ToMakeMarginMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-3477"></a><span>
</span><a name="line-3478"></a><span>
</span><a name="line-3479"></a><span class="hs-identifier">makeMarginMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ToMakeMarginMap"><span class="hs-identifier hs-type">ToMakeMarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#MarginMap"><span class="hs-identifier hs-type">MarginMap</span></a><span>
</span><a name="line-3480"></a><a name="makeMarginMap"><a href="VTable.Compliation.html#makeMarginMap"><span class="hs-identifier">makeMarginMap</span></a></a><span> </span><a name="local-6989586621679477145"><a href="#local-6989586621679477145"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679477146"><a href="#local-6989586621679477146"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679477147"><a href="#local-6989586621679477147"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679477147"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679477146"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477147"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477145"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-3481"></a><span>
</span><a name="line-3482"></a><span>
</span><a name="line-3483"></a><span class="hs-comment">-- | &#20107;&#26989;&#20998;&#39006;&#12398;&#21830;&#26989;&#21450;&#12403;,&#35023;&#38754;&#12398;&#21830;&#26989;&#12434;&#12510;&#12540;&#12472;&#12531;&#21270;&#12377;&#12427;</span><span>
</span><a name="line-3484"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3485"></a><span class="hs-identifier">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475896"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Compliation.html#MarginMap"><span class="hs-identifier hs-type">MarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475896"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3486"></a><a name="f%540C%4E00%7523%696D%51E6%7406"><a href="VTable.Compliation.html#f%540C%4E00%7523%696D%51E6%7406"><span class="hs-identifier">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679477148"><a href="#local-6989586621679477148"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3487"></a><span>    </span><a name="local-6989586621679477163"><a href="#local-6989586621679477163"><span class="hs-identifier">maybeIcr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">await</span><span>
</span><a name="line-3488"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477163"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3489"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3490"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477164"><a href="#local-6989586621679477164"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621679477149"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679477164"><span class="hs-identifier hs-var">icr</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477164"><span class="hs-identifier hs-var">icr</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%540C%4E00%7523%696D%51E6%7406"><span class="hs-identifier hs-var">f&#21516;&#19968;&#29987;&#26989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477148"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-3491"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-3492"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3493"></a><span>    </span><a name="local-6989586621679477149"><a href="#local-6989586621679477149"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679477151"><a href="#local-6989586621679477151"><span class="hs-identifier">icr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477151"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477152"><a href="#local-6989586621679477152"><span class="hs-identifier">sev</span></a></a><span>
</span><a name="line-3494"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477151"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477153"><a href="#local-6989586621679477153"><span class="hs-identifier">tar</span></a></a><span>
</span><a name="line-3495"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477151"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477154"><a href="#local-6989586621679477154"><span class="hs-identifier">kind</span></a></a><span>
</span><a name="line-3496"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477154"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3497"></a><span>                </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477155"><a href="#local-6989586621679477155"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679477156"><a href="#local-6989586621679477156"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679477157"><a href="#local-6989586621679477157"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679477158"><a href="#local-6989586621679477158"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679477159"><a href="#local-6989586621679477159"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679477160"><a href="#local-6989586621679477160"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3498"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Maybe.isJust</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477155"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679477148"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3499"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477161"><a href="#local-6989586621679477161"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477155"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679477148"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3500"></a><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477151"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convMarginSev"><span class="hs-identifier hs-var">convMarginSev</span></a><span>  </span><a href="#local-6989586621679477161"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679477152"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>
</span><a name="line-3501"></a><span>                            </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477151"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convMarginComm"><span class="hs-identifier hs-var">convMarginComm</span></a><span> </span><a href="#local-6989586621679477161"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679477153"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-3502"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>
</span><a name="line-3503"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477151"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convMarginSev"><span class="hs-identifier hs-var">convMarginSev</span></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679477150"><span class="hs-identifier hs-var">mm2mr</span></a><span> </span><a href="#local-6989586621679477148"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477152"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>
</span><a name="line-3504"></a><span>                            </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477151"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convMarginComm"><span class="hs-identifier hs-var">convMarginComm</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477150"><span class="hs-identifier hs-var">mm2mr</span></a><span> </span><a href="#local-6989586621679477148"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477153"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-3505"></a><span>
</span><a name="line-3506"></a><span>    </span><span class="hs-comment">-- | &#29987;&#26989;&#20998;&#39006;&#12364;&#12431;&#12363;&#12425;&#12394;&#12356;&#12392;&#12365;&#29992;&#12395;,&#20840;&#20307;&#12398;&#24179;&#22343;&#12398;&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#29992;&#12356;&#12427;</span><span>
</span><a name="line-3507"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mm2mr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3508"></a><span>    </span><span class="hs-identifier">mm2mr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#MarginMap"><span class="hs-identifier hs-type">MarginMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3509"></a><span>    </span><a name="local-6989586621679477150"><a href="#local-6989586621679477150"><span class="hs-identifier">mm2mr</span></a></a><span> </span><a name="local-6989586621679477162"><a href="#local-6989586621679477162"><span class="hs-identifier">mm</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Map.size</span><span> </span><a href="#local-6989586621679477162"><span class="hs-identifier hs-var">mm</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map.elems</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477162"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map.size</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477162"><span class="hs-identifier hs-var">mm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3510"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-comment">-- error &quot;Error: mm2MR, in module V; MarginMap is empty&quot; &#12371;&#12371;&#12398;&#20966;&#29702;&#12418;&#35201;&#27880;&#24847;</span><span>
</span><a name="line-3511"></a><span>
</span><a name="line-3512"></a><span class="hs-comment">-- | &#21830;&#26989;&#12398;&#12415;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;(&#32048;&#20998;&#39006;)&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-3513"></a><span>
</span><a name="line-3514"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">convMarginSev</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3515"></a><span class="hs-identifier">convMarginSev</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3516"></a><a name="convMarginSev"><a href="VTable.Compliation.html#convMarginSev"><span class="hs-identifier">convMarginSev</span></a></a><span> </span><a name="local-6989586621679477165"><a href="#local-6989586621679477165"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477166"><a href="#local-6989586621679477166"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477165"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477165"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3517"></a><span>                                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.map</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477166"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-3518"></a><span>                                                    </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477167"><a href="#local-6989586621679477167"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477167"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;T5&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477167"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;T4&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477167"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679477167"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679477165"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-3519"></a><span>                                                                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477167"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3520"></a><span>
</span><a name="line-3521"></a><span>                                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679477166"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-3522"></a><span class="hs-identifier">convMarginSev</span><span> </span><a name="local-6989586621679477168"><a href="#local-6989586621679477168"><span class="hs-identifier">mr</span></a></a><span> </span><a name="local-6989586621679477169"><a href="#local-6989586621679477169"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679477169"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3523"></a><span>
</span><a name="line-3524"></a><span class="hs-comment">-- | &#21830;&#26989;&#12398;&#12415;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;(&#32048;&#20998;&#39006;)&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-3525"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">convMarginComm</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3526"></a><span class="hs-identifier">convMarginComm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3527"></a><a name="convMarginComm"><a href="VTable.Compliation.html#convMarginComm"><span class="hs-identifier">convMarginComm</span></a></a><span> </span><a name="local-6989586621679477170"><a href="#local-6989586621679477170"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477171"><a href="#local-6989586621679477171"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477170"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477170"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3528"></a><span>                                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">V.map</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477171"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-3529"></a><span>                                                   </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477172"><a href="#local-6989586621679477172"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="VTable.Compliation.html#isCommerceDetail"><span class="hs-identifier hs-var">isCommerceDetail</span></a><span> </span><a href="#local-6989586621679477172"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477172"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679477172"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679477170"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-3530"></a><span>                                                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477172"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3531"></a><span>                                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679477171"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-3532"></a><span class="hs-identifier">convMarginComm</span><span> </span><a name="local-6989586621679477173"><a href="#local-6989586621679477173"><span class="hs-identifier">mr</span></a></a><span> </span><a name="local-6989586621679477174"><a href="#local-6989586621679477174"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679477174"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3533"></a><span>
</span><a name="line-3534"></a><span>
</span><a name="line-3535"></a><span class="hs-comment">-- | &#29987;&#26989;&#32048;&#20998;&#39006;&#12398;&#21830;&#26989;&#12363;&#21542;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-3536"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">isCommerceDetail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3537"></a><span class="hs-identifier">isCommerceDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3538"></a><a name="isCommerceDetail"><a href="VTable.Compliation.html#isCommerceDetail"><span class="hs-identifier">isCommerceDetail</span></a></a><span> </span><a name="local-6989586621679477175"><a href="#local-6989586621679477175"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;51&quot;</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477175"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477175"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-string">&quot;61&quot;</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3539"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477175"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;I1ZZ&quot;</span><span>                                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3540"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477175"><span class="hs-identifier hs-var">ca</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;I2ZZ&quot;</span><span>                                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3541"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3542"></a><span>
</span><a name="line-3543"></a><span class="hs-comment">-- | 22&#21306;&#20998;&#12398;&#12510;&#12540;&#12472;&#12531;&#29575;&#12434;&#29983;&#29987;&#29289;&#21029;&#21029;&#22770;&#19978;&#39640;&#12395;&#20055;&#12376;&#12427;</span><span>
</span><a name="line-3544"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3545"></a><span class="hs-identifier">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#MarginRate"><span class="hs-identifier hs-type">MarginRate</span></a><span>
</span><a name="line-3546"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-3547"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3548"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3549"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-3550"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#ToMakeMarginMap"><span class="hs-identifier hs-type">ToMakeMarginMap</span></a><span>
</span><a name="line-3551"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3552"></a><span>
</span><a name="line-3553"></a><a name="f%8868%9762%88CF%9762%51E6%7406"><a href="VTable.Compliation.html#f%8868%9762%88CF%9762%51E6%7406"><span class="hs-identifier">f&#34920;&#38754;&#35023;&#38754;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679477176"><a href="#local-6989586621679477176"><span class="hs-identifier">mr</span></a></a><span> </span><a name="local-6989586621679477177"><a href="#local-6989586621679477177"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477178"><a href="#local-6989586621679477178"><span class="hs-identifier">sev</span></a></a><span> </span><a name="local-6989586621679477179"><a href="#local-6989586621679477179"><span class="hs-identifier">tar</span></a></a><span> </span><a name="local-6989586621679477180"><a href="#local-6989586621679477180"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679477181"><a href="#local-6989586621679477181"><span class="hs-identifier">refTmm</span></a></a><span>
</span><a name="line-3554"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477177"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convMarginSev"><span class="hs-identifier hs-var">convMarginSev</span></a><span>  </span><a href="#local-6989586621679477176"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679477178"><span class="hs-identifier hs-var">sev</span></a><span class="hs-special">)</span><span>
</span><a name="line-3555"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477177"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#convMarginComm"><span class="hs-identifier hs-var">convMarginComm</span></a><span> </span><a href="#local-6989586621679477176"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679477179"><span class="hs-identifier hs-var">tar</span></a><span class="hs-special">)</span><span>
</span><a name="line-3556"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477180"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3557"></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3558"></a><span>        </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477182"><a href="#local-6989586621679477182"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679477183"><a href="#local-6989586621679477183"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679477184"><a href="#local-6989586621679477184"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679477185"><a href="#local-6989586621679477185"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679477186"><a href="#local-6989586621679477186"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679477187"><a href="#local-6989586621679477187"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477181"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477188"><a href="#local-6989586621679477188"><span class="hs-identifier">tmm</span></a></a><span>
</span><a name="line-3559"></a><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477182"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679477188"><span class="hs-identifier hs-var">tmm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3560"></a><span>                                                    </span><span class="hs-identifier hs-var">Nothing</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477181"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477182"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477176"><span class="hs-identifier hs-var">mr</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3561"></a><span>                                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679477189"><a href="#local-6989586621679477189"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><a name="local-6989586621679477190"><a href="#local-6989586621679477190"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477181"><span class="hs-identifier hs-var">refTmm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477182"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477189"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477176"><span class="hs-identifier hs-var">mr</span></a><span class="hs-special">,</span><a href="#local-6989586621679477190"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3562"></a><span>
</span><a name="line-3563"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3564"></a><span class="hs-comment">-- * &#37325;&#35079;&#12398;&#21066;&#38500;</span><span>
</span><a name="line-3565"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3566"></a><span class="hs-comment">-- ** &#20225;&#26989;&#20869;&#21462;&#24341;&#21450;&#12403;&#19979;&#35531;&#12369;&#27083;&#36896;</span><span>
</span><a name="line-3567"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-3568"></a><span>
</span><a name="line-3569"></a><span class="hs-comment">{- |  &#20225;&#26989;&#20869;&#21462;&#24341;&#21450;&#12403;&#19979;&#35531;&#12369;&#27083;&#36896;

 &#31532;21&#22238;&#12469;&#12540;&#12499;&#12473;&#32113;&#35336;&#12539;&#20225;&#26989;&#32113;&#35336;&#37096;&#20250;&#37197;&#24067;&#36039;&#26009; &#12391;&#12399;&#65292;
 &#12300;&#35069;&#36896;&#26989;&#12398;&#20225;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#37096;&#21697;&#24037;&#22580;&#12363;&#12425;&#23436;&#25104;&#21697;&#32068;&#12415;&#31435;&#12390;&#24037;&#22580;&#12408;&#12398;&#37096;&#21697;&#20379;&#32102;&#12398;&#12424;&#12358;&#12395;&#20225;&#26989;&#20869;&#21462;&#24341;&#12364;&#23384;&#22312;&#12375;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12301;&#12392;&#12375;&#65292;
 &#12381;&#12398;&#21462;&#12426;&#25201;&#12356;&#12395;&#12362;&#12356;&#12390;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#38989;&#12392;&#65292;
 &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#22770;&#19978;&#38989;&#12398;&#24046;&#38989;&#12434;&#20225;&#26989;&#20869;&#21462;&#24341;&#12392;&#12375;&#12390;&#25226;&#25569;&#12375;&#12383;&#19978;&#12391;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#38598;&#35336;&#12398;&#20225;&#26989;&#38598;&#35336;&#34920;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
 &#20225;&#26989;&#20869;&#21462;&#24341;&#12434;&#35336;&#19978;&#12375;&#12394;&#12356;&#24418;&#12391;&#65292;&#20107;&#26989;&#25152;&#38598;&#35336;&#34920;&#12395;&#12362;&#12356;&#12390;&#12399;&#20225;&#26989;&#20869;&#21462;&#24341;&#12434;&#35336;&#19978;&#12377;&#12427;&#24418;&#12391;&#34920;&#35937;&#12377;&#12427;&#12392;&#12356;&#12358;&#26041;&#37341;&#12364;&#25522;&#12370;&#12425;&#12428;&#12390;&#12356;&#12427;&#65294;
 &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#20107;&#26989;&#25152;&#12434;&#38598;&#35336;&#21336;&#20301;&#12392;&#12377;&#12427;&#35069;&#36896;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#29694;&#34892;&#12398;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12356;&#12390;&#65292;&#20225;&#26989;&#20869;&#21462;&#24341;&#12399;&#29983;&#29987;&#38989;&#12395;&#38598;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

 SNA&#12395;&#12362;&#12369;&#12427;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#21450;&#12403;&#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#12394;&#12393;&#12398;&#29983;&#29987;&#38989;&#12434;&#25512;&#35336;&#12377;&#12427;&#12395;&#12399;&#65292;
 &#12381;&#12398;&#22770;&#19978;&#39640;&#12363;&#12425;OEM&#65288;&#30456;&#25163;&#20808;&#12502;&#12521;&#12531;&#12489;&#21517;&#35069;&#36896;&#65289;&#12394;&#12393;&#12395;&#12424;&#12387;&#12390;&#37325;&#35079;&#12377;&#12427;&#20998;&#12398;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#38989;&#21450;&#12403;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#38989;&#12434;&#38500;&#22806;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#12290;
 &#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12369;&#12427;&#12381;&#12398;&#12381;&#12428;&#12425;&#12398;&#29987;&#26989;&#12395;&#21462;&#12426;&#25201;&#12356;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#12300;&#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920; &#32207;&#21512;&#35299;&#35500;&#32232;&#12301;&#12395;&#12362;&#12356;&#12390;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#65292;
 &#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473; &#65292;&#24195;&#21578; &#65292;&#35686;&#20633;&#26989;&#65292;&#12503;&#12521;&#12531;&#12488;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;&#26989;&#21450;&#12403;&#37489;&#29289;&#25506;&#26619;&#20197;&#22806;&#12398;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473;
 &#12399;&#12356;&#12378;&#12428;&#12418;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12434;&#36039;&#26009;&#12392;&#12375;&#12390;&#12300;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#21450;&#12403;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#38989;&#12434;&#38500;&#22806;&#12375;&#12390;&#29983;&#29987;&#38989;&#12434;&#27714;&#12417;&#12383;&#12301;&#12392;&#12398;&#35352;&#36848;&#12364;&#12354;&#12427;&#65294;

 &#12371;&#12398;&#20869;&#65292;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#38989;&#12395;&#30456;&#24403;&#12377;&#12427;&#12398;&#12364;&#20225;&#26989;&#20869;&#21462;&#24341;&#12392;&#12415;&#12394;&#12373;&#12428;&#12427;&#12418;&#12398;&#12391;&#12354;&#12426;&#65292;
 &#19978;&#35352;&#12398;&#20107;&#26989;&#12399;&#20840;&#12390;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12301;&#12395;&#38306;&#12377;&#12427;&#35519;&#26619;&#31080;&#12391;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#65288;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#65289;&#12395;&#12399;&#65292;
 &#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;&#12301;&#12392;&#12356;&#12358;&#38917;&#30446;&#12364;&#23384;&#22312;&#12375;&#65292;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#21450;&#12403;&#65292;
 &#24773;&#22577;&#21033;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#12434;&#38500;&#12367;&#20107;&#26989;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
 &#35519;&#26619;&#38917;&#30446;&#12398;&#20869;&#12300;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#12301;&#12395;&#12424;&#12387;&#12390;&#25226;&#25569;&#12373;&#12428;&#12383;&#21516;&#19968;&#20225;&#26989;&#20869;&#21462;&#24341;&#38989;&#12434;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#39640;&#12363;&#12425;&#38500;&#22806;&#12377;&#12427;&#20966;&#29702;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;
 &#12477;&#12501;&#12488;&#12454;&#12455;&#26989;&#21450;&#12403;&#65292;&#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
 &#21516;&#35519;&#26619;&#31080;&#12395;&#12362;&#12369;&#12427;&#35519;&#26619;&#38917;&#30446;&#12300;&#29305;&#23450;&#12398;&#12469;&#12540;&#12499;&#12473;&#26989;&#12395;&#12362;&#12369;&#12427;&#21516;&#26989;&#32773;&#12392;&#12398;&#22865;&#32004;&#21106;&#21512;&#12301;&#12395;&#24403;&#12383;&#12427;&#22770;&#19978;&#39640;&#12434;&#38500;&#22806;&#12377;&#12427;&#20966;&#29702;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#65294;
 &#12414;&#12383;&#65292;&#12300;&#29289;&#21697;&#36035;&#36024;&#26989;&#65288;&#36024;&#12375;&#33258;&#21205;&#36554;&#12434;&#38500;&#12367;&#65294;&#65289;&#12301;&#12395;&#38306;&#12375;&#12390;&#12418;&#65292;&#29305;&#23450;&#12469;&#12540;&#12499;&#12473;&#29987;&#26989;&#23455;&#24907;&#35519;&#26619;&#12434;&#21033;&#29992;&#12375;&#12390;&#65292;
 &#21463;&#27880;&#12375;&#12383;&#26989;&#21209;&#12398;&#22806;&#37096;&#22996;&#35351;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#38989;&#12434;&#24046;&#12375;&#24341;&#12356;&#12383;&#12392;&#12398;&#35352;&#36848;&#12364;&#12354;&#12427;&#12364;&#65292;
 &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12391;&#12399;&#29289;&#21697;&#36035;&#36024;&#26989;&#12395;&#20418;&#12427;&#21516;&#26989;&#32773;&#38291;&#21462;&#24341;&#12434;&#25226;&#25569;&#12391;&#12365;&#12394;&#12356;&#12371;&#12392;&#12363;&#12425;&#65292;
 &#20195;&#26367;&#12392;&#12375;&#12390;&#12300;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12398;&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;&#12301;&#12395;&#12362;&#12369;&#12427;&#12300;&#21516;&#19968;&#20225;&#26989;&#20869;&#21462;&#24341;&#12301;&#20998;&#12434;&#38500;&#22806;&#12377;&#12427;&#12371;&#12392;&#12392;&#12377;&#12427;&#65294;

 2021&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#38477;&#65292;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12364;&#20225;&#26989;&#35519;&#26619;&#31080;&#12392;&#12394;&#12387;&#12383;&#22580;&#21512;&#65292;
 &#12371;&#12428;&#12425;&#12398;&#20966;&#29702;&#12398;&#20869;&#20225;&#26989;&#20869;&#21462;&#24341;&#12399;&#12381;&#12418;&#12381;&#12418;&#35519;&#26619;&#31080;&#12395;&#29694;&#12428;&#12394;&#12367;&#12394;&#12427;&#12383;&#12417;&#65292;&#20966;&#29702;&#12364;&#19981;&#24517;&#35201;&#12392;&#12394;&#12427;&#12364;&#65292;
 &#29694;&#34892;&#12398;&#12300;&#30456;&#25163;&#20808;&#21454;&#20837;&#21106;&#21512;&#12301;&#21450;&#12403;&#12300;&#21516;&#26989;&#32773;&#12392;&#12398;&#22865;&#32004;&#21106;&#21512;&#12301;&#12395;&#12424;&#12387;&#12390;&#25512;&#35336;&#12373;&#12428;&#12427;&#38989;&#12392;&#21516;&#31561;&#12398;&#12418;&#12398;&#12392;&#12394;&#12427;&#12363;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#35696;&#35542;&#12364;&#24517;&#35201;&#12391;&#12354;&#12427;&#65294;
-}</span><span>
</span><a name="line-3600"></a><span>
</span><a name="line-3601"></a><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475895"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475895"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3602"></a><a name="f%4F01%696D%5185%53D6%5F15%524A%9664"><a href="VTable.Compliation.html#f%4F01%696D%5185%53D6%5F15%524A%9664"><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679477191"><a href="#local-6989586621679477191"><span class="hs-identifier">year</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477192"><a href="#local-6989586621679477192"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-3603"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477192"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3604"></a><span>                        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3605"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477193"><a href="#local-6989586621679477193"><span class="hs-identifier">icr</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477193"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-var">H&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477194"><a href="#local-6989586621679477194"><span class="hs-identifier">valTarget</span></a></a><span>
</span><a name="line-3606"></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477193"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%540C%696D%8005%5272%5408_%30B5B"><span class="hs-identifier hs-var">H&#21516;&#26989;&#32773;&#21106;&#21512;_&#12469;B</span></a><span>          </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477195"><a href="#local-6989586621679477195"><span class="hs-identifier">valSame</span></a></a><span>
</span><a name="line-3607"></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477193"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>            </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477196"><a href="#local-6989586621679477196"><span class="hs-identifier">valBusi</span></a></a><span>
</span><a name="line-3608"></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477193"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477197"><a href="#local-6989586621679477197"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-3609"></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%4F01%696D%5185%53D6%5F15%524A%9664%51E6%7406"><span class="hs-identifier hs-var">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477191"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679477193"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477194"><span class="hs-identifier hs-var">valTarget</span></a><span> </span><a href="#local-6989586621679477195"><span class="hs-identifier hs-var">valSame</span></a><span> </span><a href="#local-6989586621679477196"><span class="hs-identifier hs-var">valBusi</span></a><span> </span><a href="#local-6989586621679477197"><span class="hs-identifier hs-var">valComm</span></a><span class="hs-special">)</span><span>
</span><a name="line-3610"></a><span>                                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477193"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3611"></a><span>                                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%4F01%696D%5185%53D6%5F15%524A%9664"><span class="hs-identifier hs-var">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;</span></a><span> </span><a href="#local-6989586621679477191"><span class="hs-identifier hs-var">year</span></a><span>
</span><a name="line-3612"></a><span>
</span><a name="line-3613"></a><span>
</span><a name="line-3614"></a><span class="hs-comment">{- | &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#21450;&#12403;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12363;&#12425;&#20225;&#26989;&#20869;&#21462;&#24341;&#12392;&#21516;&#19968;&#20225;&#26989;&#38291;&#21462;&#24341;&#12434;&#21066;&#38500;&#12377;&#12427;

&#20516;&#12398;&#12394;&#12356;&#12418;&#12398;&#12398;&#20107;&#26989;&#20998;&#39006;&#12395;&#38306;&#12375;&#12390;&#12399;&#21462;&#24341;&#12398;&#21066;&#38500;&#12434;&#34892;&#12431;&#12394;&#12356;(&#24179;&#22343;&#20516;&#20351;&#12358;&#12392;&#12363;&#35201;&#20462;&#27491;)

&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12363;&#12425;&#12399;,&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12391;&#24341;&#12356;&#12383;&#32207;&#38989;&#12434;&#24341;&#12367;
-}</span><span>
</span><a name="line-3620"></a><span>
</span><a name="line-3621"></a><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;&#20966;&#29702;</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span>
</span><a name="line-3622"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span>
</span><a name="line-3623"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-3624"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%540C%696D%8005%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#21516;&#26989;&#32773;&#21106;&#21512;_&#12469;B</span></a><span>
</span><a name="line-3625"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3626"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3627"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3628"></a><span>
</span><a name="line-3629"></a><a name="f%4F01%696D%5185%53D6%5F15%524A%9664%51E6%7406"><a href="VTable.Compliation.html#f%4F01%696D%5185%53D6%5F15%524A%9664%51E6%7406"><span class="hs-identifier">f&#20225;&#26989;&#20869;&#21462;&#24341;&#21066;&#38500;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679477198"><a href="#local-6989586621679477198"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477199"><a href="#local-6989586621679477199"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477200"><a href="#local-6989586621679477200"><span class="hs-identifier">valTarget</span></a></a><span> </span><a name="local-6989586621679477201"><a href="#local-6989586621679477201"><span class="hs-identifier">valSame</span></a></a><span> </span><a name="local-6989586621679477202"><a href="#local-6989586621679477202"><span class="hs-identifier">valBusi</span></a></a><span> </span><a name="local-6989586621679477203"><a href="#local-6989586621679477203"><span class="hs-identifier">valComm</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3630"></a><span>        </span><a name="local-6989586621679477210"><a href="#local-6989586621679477210"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-comment">-- &#24773;&#22577;&#29987;&#26989;&#12398;&#12510;&#12452;&#12490;&#12473;&#20998;</span><span>
</span><a name="line-3631"></a><span>        </span><a name="local-6989586621679477211"><a href="#local-6989586621679477211"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-comment">-- &#29289;&#21697;&#36035;&#36024;&#26989;&#12398;&#12510;&#12452;&#12490;&#12473;&#20998;</span><span>
</span><a name="line-3632"></a><span>        </span><a name="local-6989586621679477212"><a href="#local-6989586621679477212"><span class="hs-identifier">toMinusOth</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-comment">-- &#19978;&#35352;&#20197;&#22806;&#12398;&#12469;&#12540;&#12499;&#12473;&#26989;&#12398;&#12510;&#12452;&#12490;&#12473;&#20998;</span><span>
</span><a name="line-3633"></a><span>        </span><span class="hs-comment">--  &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span><span>
</span><a name="line-3634"></a><span>        </span><a href="VTable.Compliation.html#f%60C5%5831%7523%696D%524A%9664"><span class="hs-identifier hs-var">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span></a><span>    </span><a href="#local-6989586621679477198"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679477199"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477210"><span class="hs-identifier hs-var">toMinusInfo</span></a><span> </span><a href="#local-6989586621679477201"><span class="hs-identifier hs-var">valSame</span></a><span>   </span><a href="#local-6989586621679477203"><span class="hs-identifier hs-var">valComm</span></a><span>
</span><a name="line-3635"></a><span>        </span><a href="VTable.Compliation.html#f%7269%54C1%8CC3%8CB8%696D%524A%9664"><span class="hs-identifier hs-var">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span></a><span>  </span><a href="#local-6989586621679477198"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679477199"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477211"><span class="hs-identifier hs-var">toMinusRent</span></a><span> </span><a href="#local-6989586621679477200"><span class="hs-identifier hs-var">valTarget</span></a><span> </span><a href="#local-6989586621679477203"><span class="hs-identifier hs-var">valComm</span></a><span>
</span><a name="line-3636"></a><span>        </span><a href="VTable.Compliation.html#f%305D%306E%4ED6%306E%30B5B%524A%9664"><span class="hs-identifier hs-var">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span></a><span> </span><a href="#local-6989586621679477198"><span class="hs-identifier hs-var">year</span></a><span> </span><a href="#local-6989586621679477199"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477212"><span class="hs-identifier hs-var">toMinusOth</span></a><span>  </span><a href="#local-6989586621679477200"><span class="hs-identifier hs-var">valTarget</span></a><span> </span><a href="#local-6989586621679477203"><span class="hs-identifier hs-var">valComm</span></a><span>
</span><a name="line-3637"></a><span>        </span><span class="hs-comment">--  &#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#20966;&#29702;</span><span>
</span><a name="line-3638"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477202"><span class="hs-identifier hs-var">valBusi</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3639"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3640"></a><span>            </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477213"><a href="#local-6989586621679477213"><span class="hs-identifier">busi</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477210"><span class="hs-identifier hs-var">toMinusInfo</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477214"><a href="#local-6989586621679477214"><span class="hs-identifier">minusInfo</span></a></a><span>
</span><a name="line-3641"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477211"><span class="hs-identifier hs-var">toMinusRent</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477215"><a href="#local-6989586621679477215"><span class="hs-identifier">minusRent</span></a></a><span>
</span><a name="line-3642"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477212"><span class="hs-identifier hs-var">toMinusOth</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477216"><a href="#local-6989586621679477216"><span class="hs-identifier">minusOth</span></a></a><span>
</span><a name="line-3643"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477199"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477204"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679477214"><span class="hs-identifier hs-var">minusInfo</span></a><span> </span><a href="#local-6989586621679477215"><span class="hs-identifier hs-var">minusRent</span></a><span> </span><a href="#local-6989586621679477216"><span class="hs-identifier hs-var">minusOth</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477213"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3644"></a><span>
</span><a name="line-3645"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-3646"></a><span>        </span><a name="local-6989586621679477204"><a href="#local-6989586621679477204"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679477205"><a href="#local-6989586621679477205"><span class="hs-identifier">minusInfo</span></a></a><span> </span><a name="local-6989586621679477206"><a href="#local-6989586621679477206"><span class="hs-identifier">minusRent</span></a></a><span> </span><a name="local-6989586621679477207"><a href="#local-6989586621679477207"><span class="hs-identifier">minusOth</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679477208"><a href="#local-6989586621679477208"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679477209"><a href="#local-6989586621679477209"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3647"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;T12&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477205"><span class="hs-identifier hs-var">minusInfo</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3648"></a><span>                                </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477205"><span class="hs-identifier hs-var">minusInfo</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3649"></a><span>                                </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3650"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;T14&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477206"><span class="hs-identifier hs-var">minusRent</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3651"></a><span>                                </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477206"><span class="hs-identifier hs-var">minusRent</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3652"></a><span>                                </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3653"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;T20&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477207"><span class="hs-identifier hs-var">minusOth</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3654"></a><span>                                </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679477207"><span class="hs-identifier hs-var">minusOth</span></a><span class="hs-special">)</span><span>  </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3655"></a><span>                                </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3656"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477208"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477209"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-3657"></a><span>
</span><a name="line-3658"></a><span>
</span><a name="line-3659"></a><span>
</span><a name="line-3660"></a><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%540C%696D%8005%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#21516;&#26989;&#32773;&#21106;&#21512;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3661"></a><a name="f%60C5%5831%7523%696D%524A%9664"><a href="VTable.Compliation.html#f%60C5%5831%7523%696D%524A%9664"><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679477217"><a href="#local-6989586621679477217"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477218"><a href="#local-6989586621679477218"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477219"><a href="#local-6989586621679477219"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3662"></a><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679477220"><a href="#local-6989586621679477220"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477221"><a href="#local-6989586621679477221"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477222"><a href="#local-6989586621679477222"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3663"></a><span class="hs-identifier">f&#24773;&#22577;&#29987;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679477223"><a href="#local-6989586621679477223"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477224"><a href="#local-6989586621679477224"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477225"><a href="#local-6989586621679477225"><span class="hs-identifier">toMinusInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679477226"><a href="#local-6989586621679477226"><span class="hs-identifier">same</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477227"><a href="#local-6989586621679477227"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3664"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477228"><a href="#local-6989586621679477228"><span class="hs-identifier">result</span></a></a><span>
</span><a name="line-3665"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679477227"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679477229"><a href="#local-6989586621679477229"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679477230"><a href="#local-6989586621679477230"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3666"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477226"><span class="hs-identifier hs-var">same</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3667"></a><span>            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3668"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#isDetail%60C5%5831%7523%696D"><span class="hs-identifier hs-var">isDetail&#24773;&#22577;&#29987;&#26989;</span></a><span> </span><a href="#local-6989586621679477223"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477229"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477230"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3669"></a><span>                        </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477228"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477229"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477230"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3670"></a><span>                        </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477228"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477229"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477226"><span class="hs-identifier hs-var">same</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477230"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3671"></a><span>                                </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477225"><span class="hs-identifier hs-var">toMinusInfo</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477229"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477226"><span class="hs-identifier hs-var">same</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3672"></a><span>
</span><a name="line-3673"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477228"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477224"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3674"></a><span>
</span><a name="line-3675"></a><span>
</span><a name="line-3676"></a><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3677"></a><a name="f%7269%54C1%8CC3%8CB8%696D%524A%9664"><a href="VTable.Compliation.html#f%7269%54C1%8CC3%8CB8%696D%524A%9664"><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679477231"><a href="#local-6989586621679477231"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477232"><a href="#local-6989586621679477232"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477233"><a href="#local-6989586621679477233"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3678"></a><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679477234"><a href="#local-6989586621679477234"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477235"><a href="#local-6989586621679477235"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477236"><a href="#local-6989586621679477236"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3679"></a><span class="hs-identifier">f&#29289;&#21697;&#36035;&#36024;&#26989;&#21066;&#38500;</span><span> </span><a name="local-6989586621679477237"><a href="#local-6989586621679477237"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477238"><a href="#local-6989586621679477238"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477239"><a href="#local-6989586621679477239"><span class="hs-identifier">toMinusRent</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-var">V&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><a name="local-6989586621679477240"><a href="#local-6989586621679477240"><span class="hs-identifier">eRate</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477241"><a href="#local-6989586621679477241"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3680"></a><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477242"><a href="#local-6989586621679477242"><span class="hs-identifier">rate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#21516;&#19968;&#20225;&#26989;</span><span> </span><a href="#local-6989586621679477240"><span class="hs-identifier hs-var">eRate</span></a><span>
</span><a name="line-3681"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477243"><a href="#local-6989586621679477243"><span class="hs-identifier">result</span></a></a><span>
</span><a name="line-3682"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679477241"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679477244"><a href="#local-6989586621679477244"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679477245"><a href="#local-6989586621679477245"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3683"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477242"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3684"></a><span>            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3685"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#isDetail%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier hs-var">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span></a><span> </span><a href="#local-6989586621679477237"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477244"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477245"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3686"></a><span>                        </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477243"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477244"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477245"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3687"></a><span>                        </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477243"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477244"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477242"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477245"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3688"></a><span>                                </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477239"><span class="hs-identifier hs-var">toMinusRent</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477244"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477242"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3689"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477243"><span class="hs-identifier hs-var">result</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477238"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3690"></a><span>
</span><a name="line-3691"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IORef</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Data.Structure.html#Val%76F8%624B%5148%5225%53CE%5165%5272%5408_%30B5B"><span class="hs-identifier hs-type">Val&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;_&#12469;B</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3692"></a><a name="f%305D%306E%4ED6%306E%30B5B%524A%9664"><a href="VTable.Compliation.html#f%305D%306E%4ED6%306E%30B5B%524A%9664"><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span></a></a><span> </span><a name="local-6989586621679477246"><a href="#local-6989586621679477246"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477247"><a href="#local-6989586621679477247"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477248"><a href="#local-6989586621679477248"><span class="hs-identifier">toMinusOth</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3693"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span><span> </span><a name="local-6989586621679477249"><a href="#local-6989586621679477249"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477250"><a href="#local-6989586621679477250"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477251"><a href="#local-6989586621679477251"><span class="hs-identifier">toMinusOth</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3694"></a><span class="hs-identifier">f&#12381;&#12398;&#20182;&#12398;&#12469;B&#21066;&#38500;</span><span> </span><a name="local-6989586621679477252"><a href="#local-6989586621679477252"><span class="hs-identifier">year</span></a></a><span> </span><a name="local-6989586621679477253"><a href="#local-6989586621679477253"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477254"><a href="#local-6989586621679477254"><span class="hs-identifier">toMinusOth</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%76F8%624B%5148%5225%53CE%5165%5272%5408"><span class="hs-identifier hs-var">V&#30456;&#25163;&#20808;&#21029;&#21454;&#20837;&#21106;&#21512;</span></a><span> </span><a name="local-6989586621679477255"><a href="#local-6989586621679477255"><span class="hs-identifier">eRate</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477256"><a href="#local-6989586621679477256"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3695"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477257"><a href="#local-6989586621679477257"><span class="hs-identifier">rate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_&#21516;&#19968;&#20225;&#26989;</span><span> </span><a href="#local-6989586621679477255"><span class="hs-identifier hs-var">eRate</span></a><span>
</span><a name="line-3696"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-identifier hs-var">V.empty</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477258"><a href="#local-6989586621679477258"><span class="hs-identifier">result</span></a></a><span>
</span><a name="line-3697"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679477256"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679477259"><a href="#local-6989586621679477259"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679477260"><a href="#local-6989586621679477260"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3698"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477257"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3699"></a><span>            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3700"></a><span>            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#isDetail%305D%306E%4ED6%306E%30B5B"><span class="hs-identifier hs-var">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span></a><span> </span><a href="#local-6989586621679477252"><span class="hs-identifier hs-var">year</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477259"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477260"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3701"></a><span>                        </span><span class="hs-identifier hs-var">False</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477258"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a href="#local-6989586621679477259"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679477260"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3702"></a><span>                        </span><span class="hs-identifier hs-var">True</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477258"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.cons</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477259"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477257"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477260"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3703"></a><span>                                </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477254"><span class="hs-identifier hs-var">toMinusOth</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477259"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477257"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3704"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477258"><span class="hs-identifier hs-var">result</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477253"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3705"></a><span>
</span><a name="line-3706"></a><span>
</span><a name="line-3707"></a><span class="hs-comment">-- | 22&#21306;&#20998;&#21450;&#12403;&#32048;&#20998;&#39006;&#12391;&#12477;&#12501;&#12488;&#12454;&#12455;&#12450;&#26989;&#65292;&#24773;&#22577;&#20966;&#29702;&#12539;&#25552;&#20379;&#12469;&#12540;&#12499;&#12473;&#26989;&#12363;&#21028;&#23450;</span><span>
</span><a name="line-3708"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">isDetail&#24773;&#22577;&#29987;&#26989;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3709"></a><span class="hs-identifier">isDetail&#24773;&#22577;&#29987;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3710"></a><a name="isDetail%60C5%5831%7523%696D"><a href="VTable.Compliation.html#isDetail%60C5%5831%7523%696D"><span class="hs-identifier">isDetail&#24773;&#22577;&#29987;&#26989;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679477261"><a href="#local-6989586621679477261"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477261"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;39&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3711"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477261"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;40&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3712"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3713"></a><span>
</span><a name="line-3714"></a><span class="hs-identifier">isDetail&#24773;&#22577;&#29987;&#26989;</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679477262"><a href="#local-6989586621679477262"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477262"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;39&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3715"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477262"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;40&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3716"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3717"></a><span>
</span><a name="line-3718"></a><span>
</span><a name="line-3719"></a><span class="hs-comment">-- | &#32048;&#20998;&#39006;&#12391;&#29289;&#21697;&#36035;&#36024;&#26989;&#12363;&#21028;&#23450;</span><span>
</span><a name="line-3720"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3721"></a><span class="hs-identifier">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3722"></a><a name="isDetail%7269%54C1%8CC3%8CB8%696D"><a href="VTable.Compliation.html#isDetail%7269%54C1%8CC3%8CB8%696D"><span class="hs-identifier">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679477263"><a href="#local-6989586621679477263"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477263"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;70&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3723"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3724"></a><span>
</span><a name="line-3725"></a><span class="hs-identifier">isDetail&#29289;&#21697;&#36035;&#36024;&#26989;</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679477264"><a href="#local-6989586621679477264"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477264"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;70&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-3726"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3727"></a><span>
</span><a name="line-3728"></a><span>
</span><a name="line-3729"></a><span>
</span><a name="line-3730"></a><span class="hs-comment">-- | &#32048;&#20998;&#39006;&#12391;&#24195;&#21578; &#65292;&#35686;&#20633;&#26989;&#65292;&#12503;&#12521;&#12531;&#12488;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;&#26989;&#21450;&#12403;&#37489;&#29289;&#25506;&#26619;&#20197;&#22806;&#12398;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473;&#12363;&#12434;&#21028;&#23450;</span><span>
</span><a name="line-3731"></a><span class="hs-comment">--</span><span>
</span><a name="line-3732"></a><span class="hs-comment">-- &#12503;&#12521;&#12531;&#12488;&#12456;&#12531;&#12472;&#12491;&#12450;&#12522;&#12531;&#12464;,&#37489;&#29289;&#25506;&#26619;&#12398;&#21306;&#21029;&#12399;&#19981;&#21487;&#12394;&#12398;&#12391;,&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473;&#20840;&#20307;&#12391;&#36969;&#29992;</span><span>
</span><a name="line-3733"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3734"></a><span class="hs-identifier">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Year"><span class="hs-identifier hs-type">Year</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-type">Car</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-3735"></a><a name="isDetail%305D%306E%4ED6%306E%30B5B"><a href="VTable.Compliation.html#isDetail%305D%306E%4ED6%306E%30B5B"><span class="hs-identifier">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span></a></a><span> </span><span class="hs-number">24</span><span> </span><a name="local-6989586621679477265"><a href="#local-6989586621679477265"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477265"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;73&quot;</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#24195;&#21578;</span><span>
</span><a name="line-3736"></a><span>                          </span><span class="hs-glyph">|</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477265"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;9231&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#35686;&#20633;&#26989;</span><span>
</span><a name="line-3737"></a><span>                          </span><span class="hs-glyph">|</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477265"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;9299&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473;</span><span>
</span><a name="line-3738"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3739"></a><span>
</span><a name="line-3740"></a><span class="hs-identifier">isDetail&#12381;&#12398;&#20182;&#12398;&#12469;B</span><span> </span><span class="hs-number">28</span><span> </span><a name="local-6989586621679477266"><a href="#local-6989586621679477266"><span class="hs-identifier">ca</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477266"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;73&quot;</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#24195;&#21578;</span><span>
</span><a name="line-3741"></a><span>                          </span><span class="hs-glyph">|</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477266"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;9231&quot;</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#35686;&#20633;&#26989;</span><span>
</span><a name="line-3742"></a><span>                          </span><span class="hs-glyph">|</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477266"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;9299&quot;</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">-- &#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12381;&#12398;&#20182;&#12398;&#23550;&#20107;&#26989;&#25152;&#12469;&#12540;&#12499;&#12473;</span><span>
</span><a name="line-3743"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-3744"></a><span>
</span><a name="line-3745"></a><span>
</span><a name="line-3746"></a><span>
</span><a name="line-3747"></a><span>
</span><a name="line-3748"></a><span>
</span><a name="line-3749"></a><span class="hs-comment">-- ** &#20225;&#26989;&#35519;&#26619;&#12398;&#21462;&#25201;</span><span>
</span><a name="line-3750"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-3751"></a><span class="hs-comment">{- |

    * &#9312; &#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12398;&#20225;&#26989;&#12398;&#20632;&#19979;&#12395;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#23384;&#22312;&#12377;&#12427;&#12465;&#12540;&#12473;

     &#12371;&#12398;&#12465;&#12540;&#12473;&#12391;&#12399;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20225;&#26989;&#12398;&#20632;&#19979;&#20107;&#26989;&#25152;&#12391;&#12354;&#12427;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#38989;&#31561;&#12398;&#24773;&#22577;&#12399;&#65292;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#35519;&#26619;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#19988;&#12388;&#12381;&#12398;&#20516;&#12399;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12434;&#20803;&#12395;&#38598;&#35336;&#12364;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#65294;
     &#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#20516;&#20840;&#12390;&#12434;&#38598;&#35336;&#12377;&#12427;&#12392;&#65292;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#38598;&#35336;&#12373;&#12428;&#12390;&#12356;&#12427;&#37096;&#20998;&#12395;&#38306;&#12375;&#12390;&#37325;&#35079;&#12364;&#30330;&#29983;&#12377;&#12427;&#65294;
     &#12371;&#12398;&#37325;&#35079;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;&#12395;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#38598;&#35336;&#21336;&#20301;&#12434;&#20225;&#26989;&#12391;&#12399;&#12394;&#12367;&#65292;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12427;&#37096;&#20998;&#12434;&#38500;&#12356;&#12383;&#37096;&#20998;&#12434;&#19968;&#12388;&#12398;&#20107;&#26989;&#25152;&#12392;&#12415;&#12394;&#12375;&#12383;&#20206;&#24819;&#20107;&#26989;&#25152;&#12392;&#12375;&#12390;&#38598;&#35336;&#12434;&#34892;&#12358;&#65294;
     &#12394;&#12362;&#65292;&#12371;&#12398;&#12424;&#12358;&#12394;&#20966;&#29702;&#12364;&#29694;&#34892;&#12398;&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#12371;&#12392;&#12434;&#31034;&#12377;&#36039;&#26009;&#12434;&#31558;&#32773;&#12399;&#35211;&#12388;&#12369;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12394;&#12363;&#12387;&#12383;&#12383;&#12417;&#65292;
     &#12371;&#12398;&#35430;&#31639;&#12399;&#20170;&#24460;&#12398;&#35506;&#38988;&#12392;&#12375;&#12383;&#12356;&#65294;


    * &#9313; &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12398;&#20225;&#26989;&#12398;&#20632;&#19979;&#12395;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#23384;&#22312;&#12377;&#12427;&#22580;&#21512;&#65294;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20225;&#26989;&#12398;&#65292;&#20225;&#26989;&#35519;&#26619;&#31080;&#12398;&#20516;&#12399;&#65292;&#36890;&#24120;&#38598;&#35336;&#12395;&#12399;&#29992;&#12356;&#12425;&#12428;&#12394;&#12356;&#12364;&#65292;
     &#12371;&#12398;&#20225;&#26989;&#12398;&#20632;&#19979;&#20107;&#26989;&#25152;&#12395;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#23384;&#22312;&#12375;&#12383;&#22580;&#21512;&#65292;&#12381;&#12398;&#20107;&#26989;&#25152;&#12398;&#22770;&#19978;&#39640;&#31561;&#12398;&#20516;&#12399;&#65292;
     &#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12391;&#12399;&#35519;&#26619;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#65294;&#12375;&#12383;&#12364;&#12387;&#12390;&#65292;&#12371;&#12398;&#20225;&#26989;&#12395;&#38306;&#12375;&#12390;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#12415;&#12434;&#38598;&#35336;&#12395;&#29992;&#12356;&#12383;&#22580;&#21512;&#65292;
     &#12381;&#12398;&#20225;&#26989;&#20632;&#19979;&#12398;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12398;&#20516;&#12364;&#38598;&#35336;&#12363;&#12425;&#27424;&#25613;&#12377;&#12427;&#12371;&#12392;&#12392;&#12394;&#12427;&#65294;
     &#12371;&#12428;&#12434;&#36991;&#12369;&#12427;&#12383;&#12417;&#65292;&#12371;&#12398;&#20225;&#26989;&#20632;&#19979;&#12398;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12398;&#20516;&#12434;&#38500;&#12356;&#12383;&#37096;&#20998;&#12434;&#20206;&#24819;&#20107;&#26989;&#25152;&#12392;&#12375;&#12390;&#38598;&#35336;&#12395;&#21152;&#12360;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#65294;
     &#12371;&#12398;&#28857;&#12395;&#38306;&#12375;&#12390;&#21839;&#38988;&#12392;&#12394;&#12427;&#12398;&#12399;&#65292;&#29305;&#12395;&#12469;&#12540;&#12499;&#12473;&#38306;&#36899;&#29987;&#26989;B&#12364;&#20225;&#26989;&#35519;&#26619;&#31080;&#29987;&#26989;&#12392;&#12394;&#12427;&#12371;&#12392;&#12391;&#65292;&#12393;&#12398;&#31243;&#24230;&#24433;&#38911;&#12364;&#12391;&#12427;&#12363;&#12391;&#12354;&#12427;&#12364;&#65292;
     &#12371;&#12398;&#28857;&#12395;&#38306;&#12375;&#12390;&#12418;&#20170;&#24460;&#12398;&#35430;&#31639;&#12395;&#12424;&#12427;&#35506;&#38988;&#12392;&#12375;&#12383;&#12356;&#65294;-}</span><span>
</span><a name="line-3772"></a><span>
</span><a name="line-3773"></a><a name="f%4F01%696D%8ABF%67FB%7968%51E6%7406"><a href="VTable.Compliation.html#f%4F01%696D%8ABF%67FB%7968%51E6%7406"><span class="hs-identifier">f&#20225;&#26989;&#35519;&#26619;&#31080;&#20966;&#29702;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-3774"></a><span>
</span><a name="line-3775"></a><span>
</span><a name="line-3776"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3777"></a><span class="hs-comment">-- * &#21103;&#26989;&#12398;&#20998;&#35299;</span><span>
</span><a name="line-3778"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-3779"></a><span>
</span><a name="line-3780"></a><span class="hs-comment">-- | &#30476; 1-47</span><span>
</span><a name="line-3781"></a><span class="hs-keyword">type</span><span> </span><a name="PrefInt"><a href="VTable.Compliation.html#PrefInt"><span class="hs-identifier">PrefInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-3782"></a><span>
</span><a name="line-3783"></a><span class="hs-comment">-- | 22&#21306;&#20998;&#12398;&#20107;&#26989; 1 - 22</span><span>
</span><a name="line-3784"></a><span class="hs-keyword">type</span><span> </span><a name="BusiInt"><a href="VTable.Compliation.html#BusiInt"><span class="hs-identifier">BusiInt</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-3785"></a><span>
</span><a name="line-3786"></a><span class="hs-comment">-- | &#29987;&#26989;&#32048;&#20998;&#39006; 1- 1617 &#20313;&#35029;&#12418;&#12383;&#12379;&#12390;2000</span><span>
</span><a name="line-3787"></a><span class="hs-keyword">type</span><span> </span><a name="DetaInt"><a href="VTable.Compliation.html#DetaInt"><span class="hs-identifier">DetaInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-3788"></a><span>
</span><a name="line-3789"></a><span class="hs-comment">-- | &#30476;&#21029;22&#21306;&#20998;&#21029;&#29987;&#26989;&#32048;&#20998;&#39006;&#21029;&#12398;&#12395;&#23550;&#12377;&#12427;&#27604;&#29575;&#12398;Map</span><span>
</span><a name="line-3790"></a><span class="hs-keyword">type</span><span> </span><a name="SubRateArray"><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier">SubRateArray</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#PrefInt"><span class="hs-identifier hs-type">PrefInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#BusiInt"><span class="hs-identifier hs-type">BusiInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#DetaInt"><span class="hs-identifier hs-type">DetaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-3791"></a><span>
</span><a name="line-3792"></a><span class="hs-comment">-- | &#12363;&#12425;&#12398;&#21103;&#26989;&#27604;&#29575;</span><span>
</span><a name="line-3793"></a><span class="hs-identifier">empSubRateArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span>
</span><a name="line-3794"></a><a name="empSubRateArray"><a href="VTable.Compliation.html#empSubRateArray"><span class="hs-identifier">empSubRateArray</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">newArray</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-number">47</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf22%5206%985E"><span class="hs-identifier hs-var">VDC.numOf22&#20998;&#39006;</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%7D30%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#32048;&#20998;&#39006;</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-3795"></a><span>
</span><a name="line-3796"></a><span class="hs-comment">-- | &#38750;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;</span><span>
</span><a name="line-3797"></a><span class="hs-comment">--</span><span>
</span><a name="line-3798"></a><span class="hs-comment">-- &#12371;&#12428;&#12391;&#12523;&#12540;&#12503;&#12434;&#22238;&#12377;&#12371;&#12392;&#12391;&#23455;&#36074;&#30340;&#12395;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12434;&#25244;&#12356;&#12390;&#12356;&#12427;&#12371;&#12392;&#12392;&#21516;&#12376;&#12395;&#12377;&#12427;.</span><span>
</span><a name="line-3799"></a><span class="hs-comment">--</span><span>
</span><a name="line-3800"></a><span class="hs-comment">--  &#20170;&#12399;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12394;&#12375;(&#35201;&#20462;&#27491;)</span><span>
</span><a name="line-3801"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">canBeSub</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3802"></a><span class="hs-identifier">canBeSub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-3803"></a><a name="canBeSub"><a href="VTable.Compliation.html#canBeSub"><span class="hs-identifier">canBeSub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%7D30%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#32048;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-3804"></a><span>
</span><a name="line-3805"></a><span class="hs-comment">-- | &#22320;&#22495;&#12467;&#12540;&#12489;&#12363;&#12425;&#30476;&#12398;&#30058;&#21495;&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-3806"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">area2Int</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3807"></a><span class="hs-identifier">area2Int</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#PrefInt"><span class="hs-identifier hs-type">PrefInt</span></a><span>
</span><a name="line-3808"></a><a name="area2Int"><a href="VTable.Compliation.html#area2Int"><span class="hs-identifier">area2Int</span></a></a><span> </span><a name="local-6989586621679477267"><a href="#local-6989586621679477267"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.Conversion.html#textToInt"><span class="hs-identifier hs-var">VCC.textToInt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.take</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679477267"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-3809"></a><span>
</span><a name="line-3810"></a><span class="hs-comment">-- | &#20107;&#26989;&#20998;&#39006;&#12363;&#12425;BusiInt&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-3811"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">busi2Int</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3812"></a><span class="hs-identifier">busi2Int</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Classification.html#IndustryBusiness"><span class="hs-identifier hs-type">IndustryBusiness</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#BusiInt"><span class="hs-identifier hs-type">BusiInt</span></a><span>
</span><a name="line-3813"></a><a name="busi2Int"><a href="VTable.Compliation.html#busi2Int"><span class="hs-identifier">busi2Int</span></a></a><span> </span><a name="local-6989586621679477268"><a href="#local-6989586621679477268"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477268"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#ci22%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9%6B63%9806"><span class="hs-identifier hs-var">VDC.ci22&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#27491;&#38918;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3814"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477269"><a href="#local-6989586621679477269"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679477269"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-3815"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;error : busi2Int : Can not find deta &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679477268"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-3816"></a><span>
</span><a name="line-3817"></a><span>
</span><a name="line-3818"></a><span class="hs-comment">-- | Int&#12363;&#12425;Business&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;</span><span>
</span><a name="line-3819"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">int2Busi</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3820"></a><span class="hs-identifier">int2Busi</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#BusiInt"><span class="hs-identifier hs-type">BusiInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>
</span><a name="line-3821"></a><a name="int2Busi"><a href="VTable.Compliation.html#int2Busi"><span class="hs-identifier">int2Busi</span></a></a><span> </span><a name="local-6989586621679477270"><a href="#local-6989586621679477270"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">9</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;T0&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span>
</span><a name="line-3822"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">22</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;T&quot;</span><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span>
</span><a name="line-3823"></a><span>
</span><a name="line-3824"></a><span class="hs-comment">-- | &#32048;&#20998;&#39006;&#12363;&#12425;DetaIot &#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-3825"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">deta2Int</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3826"></a><span class="hs-identifier">deta2Int</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#DetaInt"><span class="hs-identifier hs-type">DetaInt</span></a><span>
</span><a name="line-3827"></a><a name="deta2Int"><a href="VTable.Compliation.html#deta2Int"><span class="hs-identifier">deta2Int</span></a></a><span> </span><a name="local-6989586621679477271"><a href="#local-6989586621679477271"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477271"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#ci%7D30%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9%6B63%9806"><span class="hs-identifier hs-var">VDC.ci&#32048;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#27491;&#38918;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3828"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477272"><a href="#local-6989586621679477272"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679477272"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-3829"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;error : deta2Int : Can not find deta &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679477271"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-3830"></a><span>
</span><a name="line-3831"></a><span class="hs-comment">-- | DetaIot &#12363;&#12425; &#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-3832"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">int2Deta</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3833"></a><span class="hs-identifier">int2Deta</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Compliation.html#DetaInt"><span class="hs-identifier hs-type">DetaInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>
</span><a name="line-3834"></a><a name="int2Deta"><a href="VTable.Compliation.html#int2Deta"><span class="hs-identifier">int2Deta</span></a></a><span> </span><a name="local-6989586621679477273"><a href="#local-6989586621679477273"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679477273"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#ic%7D30%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9%6B63%9806"><span class="hs-identifier hs-var">VDC.ic&#32048;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#27491;&#38918;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3835"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477274"><a href="#local-6989586621679477274"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477274"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-3836"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;error : int2Deta : Can not find deta &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679477273"><span class="hs-identifier hs-var">num</span></a><span>
</span><a name="line-3837"></a><span>
</span><a name="line-3838"></a><span>
</span><a name="line-3839"></a><span class="hs-comment">{- |
    &#12371;&#12428;&#12414;&#12391;&#12395;&#34892;&#12431;&#12428;&#12383;&#20966;&#29702;&#12434;&#32076;&#12390;&#65292;&#21508;&#20107;&#26989;&#25152;&#12398;22&#21306;&#20998;&#12398;&#20107;&#26989;&#21029;&#22770;&#19978;&#65288;&#21454;&#20837;&#65289;&#37329;&#38989;&#21450;&#12403;&#65292;
    &#20027;&#26989;&#12395;&#38306;&#12377;&#12427;&#20107;&#26989;&#21029;&#21830;&#21697;&#21029;&#29987;&#20986;&#38989;&#12364;&#25226;&#25569;&#12373;&#12428;&#12383;&#12371;&#12392;&#12392;&#12394;&#12427;&#65294;

    &#12375;&#12363;&#12375;&#65292;22&#21306;&#20998;&#12398;&#20027;&#26989;&#20197;&#22806;&#12398;&#20107;&#26989;&#65292;&#21363;&#12385;&#21103;&#26989;&#12398;&#20869;&#35379;&#65288;&#20027;&#29983;&#29987;&#29289;&#21450;&#12403;&#21103;&#29983;&#29987;&#29289;&#65289;&#12395;&#38306;&#12377;&#12427;&#35443;&#32048;&#12399;&#25226;&#25569;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#65294;
    &#23455;&#38555;&#12398;&#21508;&#20107;&#26989;&#25152;&#12398;&#21103;&#26989;&#12398;&#20869;&#35379;&#12399;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#35519;&#26619;&#32080;&#26524;&#12363;&#12425;&#25226;&#25569;&#12373;&#12428;&#12394;&#12356;&#12383;&#12417;&#65292;
    &#12371;&#12371;&#12391;&#12399;&#65292;&#29305;&#23450;&#12398;&#20107;&#26989;&#25152;&#12398;&#21103;&#26989;&#12395;&#38306;&#12375;&#12390;&#65292;&#12381;&#12398;&#21103;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12398;&#12487;&#12540;&#12479;&#12434;&#22522;&#12395;&#21103;&#26989;&#12398;&#20516;&#12434;&#25353;&#20998;&#12377;&#12427;&#12371;&#12392;&#12392;&#12377;&#12427;&#65294;
    &#21103;&#26989;&#12398;&#20998;&#35299;&#12398;&#25163;&#27861;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
    &#12300;&#24179;&#25104;23&#24180;&#65288;2011&#24180;&#65289;&#29987;&#26989;&#36899;&#38306;&#34920; &#31532;13&#22238; &#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696; &#37197;&#24067;&#36039;&#26009;&#65288;&#65297;&#65289;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;-&#27963;&#21205;&#35519;&#26619;&#12398;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12375;&#12383;&#22269;&#20869;&#29983;&#29987;&#38989;&#12398;&#25512;&#35336;&#12395;&#12388;&#12356;&#12390;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#24471;&#12425;&#12428;&#12427;&#21103;&#26989;&#12487;&#12540;&#12479;&#12434;IO&#37096;&#38272;&#12395;&#20998;&#35299;&#12377;&#12427;&#26041;&#27861;&#26696;&#21450;&#12403;&#30041;&#24847;&#28857; &#8544; &#22522;&#26412;&#30340;&#12394;&#35336;&#31639;&#26041;&#27861;&#12301;
    &#12395;&#12362;&#12356;&#12390;&#65292;&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#32068;&#26367;&#38598;&#35336;&#12363;&#12425;&#24471;&#12425;&#12428;&#12427;&#20027;&#26989;&#12505;&#12540;&#12473;&#12398;&#37096;&#38272;&#21029;&#22770;&#19978;&#39640;A&#12434;&#29992;&#12356;&#12390;&#37096;&#38272;&#21029;&#12398;&#27604;&#29575;B&#12434;&#20316;&#12427;&#65292;
    &#12371;&#12398;&#27604;&#29575;&#12434;&#65292;&#12402;&#12394;&#24418;&#12539;&#32113;&#21512;&#20998;&#39006;&#12505;&#12540;&#12473;&#12398;&#32207;&#38989;&#12375;&#12363;&#20998;&#12363;&#12425;&#12394;&#12356;&#21103;&#26989;&#12398;&#22770;&#19978;&#39640;C&#12395;&#20055;&#12376;&#12390;&#65292;&#37096;&#38272;&#21029;&#12398;&#21103;&#26989;&#25512;&#35336;&#20516;D&#12434;&#35336;&#31639;&#12377;&#12427;&#65294;
    &#30041;&#24847;&#28857;

    &#9312; &#22320;&#22495;&#34920;&#20316;&#25104;&#12398;&#35251;&#28857;&#12418;&#36367;&#12414;&#12360;&#65292;&#21487;&#33021;&#12394;&#31684;&#22258;&#12391;&#37117;&#36947;&#24220;&#30476;&#21029;&#12395;&#35336;&#31639;&#12375;&#65292;&#12381;&#12398;&#31309;&#12415;&#19978;&#12370;&#12434;&#12418;&#12387;&#12390;&#20840;&#22269;&#20516;&#12392;&#12377;&#12427;&#65294;

    &#9313; &#21103;&#26989;&#12392;&#12375;&#12390;&#34892;&#12360;&#12394;&#12356;&#12371;&#12392;&#12364;&#26126;&#30333;&#12394;&#37096;&#38272;&#12395;&#12388;&#12356;&#12390;&#12399;&#65292;&#27604;&#29575;&#35336;&#31639;&#12363;&#12425;&#38500;&#22806;&#12377;&#12427;&#65294;

    &#21516;&#36039;&#26009;&#12363;&#12425;&#24341;&#29992; &#19968;&#37096;&#31558;&#32773;&#32232;&#38598;

     &#12371;&#12398;&#12300;&#21103;&#26989;&#12392;&#12375;&#12390;&#34892;&#12360;&#12394;&#12356;&#12371;&#12392;&#12364;&#26126;&#30333;&#12394;&#37096;&#38272;&#12301;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
     &#21516;&#36039;&#26009;&#20013; &#12300;&#21442;&#32771;&#36039;&#26009;&#65297; CT&#25512;&#35336;&#12395;&#12362;&#12369;&#12427;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12398;&#21033;&#29992;&#20104;&#23450;&#65288;&#29694;&#26178;&#28857;&#12391;&#12398;&#35211;&#36796;&#12415;&#65294;&#20170;&#24460;&#12398;&#22793;&#26356;&#26377;&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;&#65292;
     &#22522;&#26412;&#20998;&#39006;&#12372;&#12392;&#12395;&#12381;&#12428;&#12364;&#65292;&#12300;&#20182;&#29987;&#26989;&#12434;&#20027;&#26989;&#12392;&#12377;&#12427;&#20107;&#26989;&#25152;&#12364;&#65292;&#21103;&#26989;&#12392;&#12375;&#12390;&#34892;&#12358;&#12371;&#12392;&#12364;&#22256;&#38627;&#12301;&#12363;&#21542;&#12363;&#12364;&#19968;&#35239;&#34920;&#12398;&#24418;&#12391;&#25522;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;
     &#29539;&#21307;&#26989;&#65292;&#19979;&#27700;&#36947;&#65292;&#20844;&#20849;&#25918;&#36865;&#12394;&#12393;&#12364;&#65292;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12392;&#12375;&#12390;&#35373;&#23450;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;
     &#12383;&#12384;&#12375;&#65292;&#24403;&#35442;&#36039;&#26009;&#12399;&#65292;&#34920;&#38988;&#12398;&#36890;&#12426;&#30906;&#23450;&#21069;&#12398;&#35211;&#36796;&#12415;&#12391;&#12354;&#12426;&#65292;&#23455;&#38555;&#12398;&#35373;&#23450;&#12399;&#30064;&#12394;&#12387;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#65294;
     &#23455;&#38555;&#65292;&#21516;&#20250;&#12395;&#12362;&#12369;&#12427;&#35696;&#20107;&#27010;&#35201;&#12391;&#12399;&#65292;

    &gt; &#20363;&#12360;&#12400;&#12289;&#12300;&#12488;&#12521;&#12483;&#12463;&#12539;&#12496;&#12473;&#12539;&#12381;&#12398;&#20182;&#12398;&#33258;&#21205;&#36554;&#12301;&#12395;&#12388;&#12356;&#12390;&#12289;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12392;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12364;&#12289;
    &gt; &#35069;&#36896;&#26989;&#20197;&#22806;&#12398;&#20107;&#26989;&#25152;&#12391;&#12300;&#12488;&#12521;&#12483;&#12463;&#12539;&#12496;&#12473;&#12539;&#12381;&#12398;&#20182;&#12398;&#33258;&#21205;&#36554;&#12301;&#12398;&#29983;&#29987;&#12364;&#21487;&#33021;&#12392;&#12356;&#12358;&#12371;&#12392;&#12363;&#12290;
    &gt; &#29305;&#12395;&#35069;&#36896;&#26989;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#26412;&#26085;&#12398;&#36039;&#26009;&#12391;&#31034;&#12373;&#12428;&#12383;&#12418;&#12398;&#12398;&#12411;&#12363;&#12395;&#12418;&#12289;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12364;&#12354;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12290;
    &gt;
    &gt; &#8594;  &#29987;&#26989;&#26684;&#20184;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#19968;&#27425;&#32113;&#35336;&#12395;&#12362;&#12356;&#12390;&#12418;&#38627;&#12375;&#12356;&#35506;&#38988;&#12391;&#12354;&#12427;&#12290;
    &gt; &#20363;&#12360;&#12400;&#12289;&#22823;&#35215;&#27169;&#12395;&#38651;&#27671;&#35069;&#21697;&#12398;&#29983;&#29987;&#12539;&#36009;&#22770;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#20225;&#26989;&#12395;&#12388;&#12356;&#12390;&#12289;&#29987;&#26989;&#26684;&#20184;&#19978;&#12289;&#21830;&#26989;&#12392;&#12373;&#12428;&#12383;&#22580;&#21512;&#12289;
    &gt; &#20225;&#26989;&#27963;&#21205;&#12398;&#22522;&#26412;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#35069;&#36896;&#26989;&#12398;&#27963;&#21205;&#12399;&#21103;&#26989;&#12394;&#12398;&#12363;&#12392;&#12356;&#12358;&#21839;&#38988;&#12418;&#12354;&#12427;&#12290;&#12381;&#12358;&#12356;&#12387;&#12383;&#24847;&#21619;&#12391;&#12289;&#20027;&#26989;&#12539;&#21103;&#26989;&#12398;&#21306;&#20998;&#12399;&#12289;
    &gt; &#27096;&#12293;&#12394;&#35506;&#38988;&#12434;&#12399;&#12425;&#12435;&#12391;&#12356;&#12427;&#12290;
    &gt; &#8594;&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12395;&#12388;&#12356;&#12390;&#12399;&#12289;&#26412;&#26085;&#12398;&#24481;&#25351;&#25688;&#12434;&#36367;&#12414;&#12360;&#12390;&#12289;&#23450;&#32681;&#12418;&#21547;&#12417;&#12289;&#25913;&#12417;&#12390;&#25972;&#29702;&#12373;&#12379;&#12390;&#38914;&#12367;&#12290;
    &gt;
    &gt; &#21516;&#36039;&#26009;&#65292;pp&#65294;3&#12424;&#12426;&#24341;&#29992;

    &#12392;&#12356;&#12387;&#12383;&#35696;&#35542;&#12364;&#25522;&#36617;&#12373;&#12428;&#12390;&#12362;&#12426;&#65292;&#23455;&#38555;&#12398;&#25512;&#35336;&#26178;&#12395;&#12399;&#22823;&#12365;&#12367;&#22793;&#26356;&#12373;&#12428;&#12390;&#12356;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12364;&#65292;
    &#31558;&#32773;&#12398;&#25506;&#12377;&#38480;&#12426;&#12391;&#12399;&#12371;&#12398;&#28857;&#12395;&#38306;&#12377;&#12427;&#20844;&#34920;&#36039;&#26009;&#12399;&#23384;&#22312;&#12375;&#12394;&#12356;&#12418;&#12398;&#12392;&#24605;&#12431;&#12428;&#12427;&#65294;
    &#22522;&#26412;&#30340;&#12394;&#25512;&#35336;&#25163;&#27861;&#12399;&#65292;&#20808;&#12395;&#12415;&#12383;&#12424;&#12358;&#12395;&#65292;&#30476;&#12372;&#12392;&#12395;&#65292;&#21103;&#26989;&#21029;&#12398;&#32207;&#22770;&#19978;&#39640;&#12395;&#65292;
    &#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#12539;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;&#39640;&#12398;&#27604;&#29575;&#12434;&#25499;&#12369;&#12427;&#12371;&#12392;&#12391;&#65292;&#21103;&#26989;&#12398;&#20998;&#35299;&#12364;&#12394;&#12373;&#12428;&#12427;&#12364;&#65292;
    &#21516;&#36039;&#26009; &#12300;&#8546;&#12381;&#12398;&#20182;&#12398;&#30041;&#24847;&#28857;&#12301;&#12391;&#12399;&#65292;22&#21306;&#20998;&#12398;&#20869;&#65292;CT&#25512;&#35336;&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12364;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12394;&#12356;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
    &#21103;&#26989;&#12487;&#12540;&#12479;&#12398;&#20998;&#35299;&#20316;&#26989;&#12399;&#34892;&#12431;&#12394;&#12356;&#12392;&#12375;&#12390;&#12356;&#12427;&#65294;&#26412;&#31295;&#12391;&#12399;&#65292;&#12371;&#12428;&#12425;&#12398;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12418;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12434;&#29992;&#12356;&#12390;&#65292;
    &#21103;&#26989;&#12398;&#20998;&#35299;&#12434;&#34892;&#12358;&#12424;&#12358;&#35373;&#35336;&#12377;&#12427;&#65294;

    &#29694;&#27573;&#38542;&#12391;&#12399;,&#21103;&#26989;&#22256;&#38627;&#37096;&#38272;&#12398;&#35373;&#23450;&#12399;&#34892;&#12387;&#12390;&#12356;&#12394;&#12356;(&#35201;&#20462;&#27491;)
-}</span><span>
</span><a name="line-3891"></a><span>
</span><a name="line-3892"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475894"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><a href="#local-6989586621679475894"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3893"></a><a name="f%526F%696D%306E%5206%89E3"><a href="VTable.Compliation.html#f%526F%696D%306E%5206%89E3"><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;</span></a></a><span> </span><a name="local-6989586621679477275"><a href="#local-6989586621679477275"><span class="hs-identifier">sra</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477276"><a href="#local-6989586621679477276"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-3894"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477276"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3895"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3896"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477277"><a href="#local-6989586621679477277"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477277"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477278"><a href="#local-6989586621679477278"><span class="hs-identifier">valBusi</span></a></a><span>
</span><a name="line-3897"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477277"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477279"><a href="#local-6989586621679477279"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-3898"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477277"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span>             </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477280"><a href="#local-6989586621679477280"><span class="hs-identifier">valArea</span></a></a><span>
</span><a name="line-3899"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477277"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477281"><a href="#local-6989586621679477281"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-3900"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span>   </span><a href="VTable.Compliation.html#f%526F%696D%306E%5206%89E3%51E6%7406"><span class="hs-identifier hs-var">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477275"><span class="hs-identifier hs-var">sra</span></a><span> </span><a href="#local-6989586621679477277"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="#local-6989586621679477280"><span class="hs-identifier hs-var">valArea</span></a><span> </span><a href="#local-6989586621679477278"><span class="hs-identifier hs-var">valBusi</span></a><span> </span><a href="#local-6989586621679477279"><span class="hs-identifier hs-var">valComm</span></a><span> </span><a href="#local-6989586621679477281"><span class="hs-identifier hs-var">valKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-3901"></a><span>                             </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">yield</span><span> </span><a href="#local-6989586621679477277"><span class="hs-identifier hs-var">icr</span></a><span>
</span><a name="line-3902"></a><span>                             </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%526F%696D%306E%5206%89E3"><span class="hs-identifier hs-var">f&#21103;&#26989;&#12398;&#20998;&#35299;</span></a><span> </span><a href="#local-6989586621679477275"><span class="hs-identifier hs-var">sra</span></a><span>
</span><a name="line-3903"></a><span class="hs-comment">{- |
&#22320;&#22495;&#12467;&#12540;&#12489;&#12364;&#12394;&#12356;&#22580;&#21512;,&#26032;&#28511;(15)&#12398;&#21106;&#21512;&#12434;&#20351;&#12358;(&#22320;&#22495;&#12467;&#12540;&#12489;&#12364;&#12394;&#12356;&#12371;&#12392;&#12399;&#12411;&#12412;&#12394;&#12356;&#12399;&#12378;)

&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;&#20309;&#12418;&#12375;&#12394;&#12356;
 -}</span><span>
</span><a name="line-3908"></a><span>
</span><a name="line-3909"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3910"></a><a name="f%526F%696D%306E%5206%89E3%51E6%7406"><a href="VTable.Compliation.html#f%526F%696D%306E%5206%89E3%51E6%7406"><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679477282"><a href="#local-6989586621679477282"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679477283"><a href="#local-6989586621679477283"><span class="hs-identifier">icr</span></a></a><span> </span><a name="local-6989586621679477284"><a href="#local-6989586621679477284"><span class="hs-identifier">valArea</span></a></a><span>      </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><a name="local-6989586621679477285"><a href="#local-6989586621679477285"><span class="hs-identifier">valComm</span></a></a><span>  </span><a name="local-6989586621679477286"><a href="#local-6989586621679477286"><span class="hs-identifier">valKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3911"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span><span> </span><a name="local-6989586621679477287"><a href="#local-6989586621679477287"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679477288"><a href="#local-6989586621679477288"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679477289"><a href="#local-6989586621679477289"><span class="hs-identifier">area</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477290"><a href="#local-6989586621679477290"><span class="hs-identifier">busi</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679477291"><a href="#local-6989586621679477291"><span class="hs-identifier">valComm</span></a></a><span>  </span><a name="local-6989586621679477292"><a href="#local-6989586621679477292"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-3912"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477293"><a href="#local-6989586621679477293"><span class="hs-identifier">prefInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#area2Int"><span class="hs-identifier hs-var">area2Int</span></a><span> </span><a href="#local-6989586621679477289"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-3913"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477294"><a href="#local-6989586621679477294"><span class="hs-identifier">refToAdd</span></a></a><span>
</span><a name="line-3914"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#deleteMain"><span class="hs-identifier hs-var">deleteMain</span></a><span> </span><a href="#local-6989586621679477292"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679477291"><span class="hs-identifier hs-var">valComm</span></a><span> </span><a href="#local-6989586621679477290"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679477295"><a href="#local-6989586621679477295"><span class="hs-identifier">va</span></a></a><span> </span><a name="local-6989586621679477296"><a href="#local-6989586621679477296"><span class="hs-identifier">na</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3915"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477297"><a href="#local-6989586621679477297"><span class="hs-identifier">busiInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#busi2Int"><span class="hs-identifier hs-var">busi2Int</span></a><span> </span><a href="#local-6989586621679477296"><span class="hs-identifier hs-var">na</span></a><span>
</span><a name="line-3916"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">CMP.forM_</span><span> </span><a href="VTable.Compliation.html#canBeSub"><span class="hs-identifier hs-var">canBeSub</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477298"><a href="#local-6989586621679477298"><span class="hs-identifier">detaInt</span></a></a><span>
</span><a name="line-3917"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477287"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477293"><span class="hs-identifier hs-var">prefInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477297"><span class="hs-identifier hs-var">busiInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477298"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477299"><a href="#local-6989586621679477299"><span class="hs-identifier">rate</span></a></a><span>
</span><a name="line-3918"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477300"><a href="#local-6989586621679477300"><span class="hs-identifier">newName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#int2Deta"><span class="hs-identifier hs-var">int2Deta</span></a><span> </span><a href="#local-6989586621679477298"><span class="hs-identifier hs-var">detaInt</span></a><span>
</span><a name="line-3919"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477299"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477294"><span class="hs-identifier hs-var">refToAdd</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477299"><span class="hs-identifier hs-var">rate</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679477295"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477300"><span class="hs-identifier hs-var">newName</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3920"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477294"><span class="hs-identifier hs-var">refToAdd</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477301"><a href="#local-6989586621679477301"><span class="hs-identifier">toAdd</span></a></a><span>
</span><a name="line-3921"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477291"><span class="hs-identifier hs-var">valComm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3922"></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477288"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><a href="#local-6989586621679477301"><span class="hs-identifier hs-var">toAdd</span></a><span>
</span><a name="line-3923"></a><span>        </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477302"><a href="#local-6989586621679477302"><span class="hs-identifier">comm</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477288"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">V.++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477302"><span class="hs-identifier hs-var">comm</span></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><a href="#local-6989586621679477301"><span class="hs-identifier hs-var">toAdd</span></a><span>
</span><a name="line-3924"></a><span>
</span><a name="line-3925"></a><span class="hs-identifier">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span><span> </span><a name="local-6989586621679477303"><a href="#local-6989586621679477303"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679477304"><a href="#local-6989586621679477304"><span class="hs-identifier">icr</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477305"><a href="#local-6989586621679477305"><span class="hs-identifier">busi</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679477306"><a href="#local-6989586621679477306"><span class="hs-identifier">valComm</span></a></a><span>  </span><a name="local-6989586621679477307"><a href="#local-6989586621679477307"><span class="hs-identifier">valKind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%526F%696D%306E%5206%89E3%51E6%7406"><span class="hs-identifier hs-var">f&#21103;&#26989;&#12398;&#20998;&#35299;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477303"><span class="hs-identifier hs-var">sra</span></a><span> </span><a href="#local-6989586621679477304"><span class="hs-identifier hs-var">icr</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;15&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a href="#local-6989586621679477305"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477306"><span class="hs-identifier hs-var">valComm</span></a><span>  </span><a href="#local-6989586621679477307"><span class="hs-identifier hs-var">valKind</span></a><span> </span><span class="hs-comment">-- &#26032;&#28511;</span><span>
</span><a name="line-3926"></a><span>
</span><a name="line-3927"></a><span>
</span><a name="line-3928"></a><span class="hs-comment">-- | &#20027;&#26989;&#20998;&#12418;&#20998;&#35299;&#12375;&#12394;&#12356;&#12424;&#12358;&#12395;&#20027;&#26989;&#12434;&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;&#12363;&#12425;&#21066;&#38500;&#12377;&#12427;</span><span>
</span><a name="line-3929"></a><span class="hs-comment">--</span><span>
</span><a name="line-3930"></a><span class="hs-comment">--   &#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;&#12364;&#12394;&#12356;&#22580;&#21512;&#12399;&#20027;&#26989;&#20998;&#12418;&#20837;&#12428;&#12427;</span><span>
</span><a name="line-3931"></a><span class="hs-identifier">deleteMain</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Cars&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars%4E8B%696D%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Cars&#20107;&#26989;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3932"></a><a name="deleteMain"><a href="VTable.Compliation.html#deleteMain"><span class="hs-identifier">deleteMain</span></a></a><span> </span><span class="hs-identifier">_</span><span>                 </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>        </span><a name="local-6989586621679477308"><a href="#local-6989586621679477308"><span class="hs-identifier">busi</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679477308"><span class="hs-identifier hs-var">busi</span></a><span>
</span><a name="line-3933"></a><span class="hs-identifier">deleteMain</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477309"><a href="#local-6989586621679477309"><span class="hs-identifier">kind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477310"><a href="#local-6989586621679477310"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679477311"><a href="#local-6989586621679477311"><span class="hs-identifier">busi</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">V.null</span><span> </span><a href="#local-6989586621679477310"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679477311"><span class="hs-identifier hs-var">busi</span></a><span>
</span><a name="line-3934"></a><span>                                              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#elevateStratum"><span class="hs-identifier hs-var">elevateStratum</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_15&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477309"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#Business"><span class="hs-identifier hs-var">Business</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3935"></a><span>                                                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477312"><a href="#local-6989586621679477312"><span class="hs-identifier">tt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679477313"><a href="#local-6989586621679477313"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477313"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">tt</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477311"><span class="hs-identifier hs-var">busi</span></a><span>
</span><a name="line-3936"></a><span>                                                                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477311"><span class="hs-identifier hs-var">busi</span></a><span>
</span><a name="line-3937"></a><span class="hs-identifier">deleteMain</span><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>             </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477314"><a href="#local-6989586621679477314"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679477315"><a href="#local-6989586621679477315"><span class="hs-identifier">busi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679477315"><span class="hs-identifier hs-var">busi</span></a><span>
</span><a name="line-3938"></a><span>
</span><a name="line-3939"></a><span>
</span><a name="line-3940"></a><span>
</span><a name="line-3941"></a><span>
</span><a name="line-3942"></a><span>
</span><a name="line-3943"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475893"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679475893"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span>
</span><a name="line-3944"></a><a name="f%526F%696D%6BD4%7387%4F5C%6210"><a href="VTable.Compliation.html#f%526F%696D%6BD4%7387%4F5C%6210"><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span></a></a><span> </span><a name="local-6989586621679477316"><a href="#local-6989586621679477316"><span class="hs-identifier">sra</span></a></a><span>
</span><a name="line-3945"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477328"><a href="#local-6989586621679477328"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-3946"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477328"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3947"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477317"><span class="hs-identifier hs-var">culcSRA</span></a><span> </span><a href="#local-6989586621679477316"><span class="hs-identifier hs-var">sra</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-3948"></a><span>
</span><a name="line-3949"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477329"><a href="#local-6989586621679477329"><span class="hs-identifier">icr</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span>  </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477329"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span>               </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477330"><a href="#local-6989586621679477330"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-3950"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477329"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-var">H&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span>             </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477331"><a href="#local-6989586621679477331"><span class="hs-identifier">valArea</span></a></a><span>
</span><a name="line-3951"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477329"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477332"><a href="#local-6989586621679477332"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-3952"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%526F%696D%6BD4%7387%4F5C%6210%51E6%7406"><span class="hs-identifier hs-var">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477316"><span class="hs-identifier hs-var">sra</span></a><span> </span><a href="#local-6989586621679477330"><span class="hs-identifier hs-var">valKind</span></a><span> </span><a href="#local-6989586621679477331"><span class="hs-identifier hs-var">valArea</span></a><span> </span><a href="#local-6989586621679477332"><span class="hs-identifier hs-var">valComm</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-3953"></a><span>                  </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%526F%696D%6BD4%7387%4F5C%6210"><span class="hs-identifier hs-var">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;</span></a><span> </span><a href="#local-6989586621679477316"><span class="hs-identifier hs-var">sra</span></a><span>
</span><a name="line-3954"></a><span>
</span><a name="line-3955"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-3956"></a><span>    </span><span class="hs-comment">-- &#32207;&#38989;&#12395;&#12394;&#12387;&#12390;&#12356;&#12427;&#12392;&#12371;&#12429;&#12434;&#27604;&#29575;&#12395;&#27835;&#12377;</span><span>
</span><a name="line-3957"></a><span>    </span><span class="hs-identifier">culcSRA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span>
</span><a name="line-3958"></a><span>    </span><a name="local-6989586621679477317"><a href="#local-6989586621679477317"><span class="hs-identifier">culcSRA</span></a></a><span> </span><a name="local-6989586621679477318"><a href="#local-6989586621679477318"><span class="hs-identifier">sra</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679477318"><span class="hs-identifier hs-var">sra</span></a><span>
</span><a name="line-3959"></a><span>                </span><span class="hs-operator hs-var">&lt;*</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3960"></a><span>                </span><span class="hs-identifier hs-var">CMP.forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">47</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477319"><a href="#local-6989586621679477319"><span class="hs-identifier">pref</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3961"></a><span>                    </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf22%5206%985E"><span class="hs-identifier hs-var">VDC.numOf22&#20998;&#39006;</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477320"><a href="#local-6989586621679477320"><span class="hs-identifier">busi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3962"></a><span>                        </span><a name="local-6989586621679477321"><a href="#local-6989586621679477321"><span class="hs-identifier">refTotal</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-3963"></a><span>                        </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="VTable.Compliation.html#canBeSub"><span class="hs-identifier hs-var">canBeSub</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477322"><a href="#local-6989586621679477322"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3964"></a><span>                                </span><a name="local-6989586621679477323"><a href="#local-6989586621679477323"><span class="hs-identifier">tmoVal</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477318"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477319"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477320"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477322"><span class="hs-identifier hs-var">deta</span></a><span class="hs-special">)</span><span>
</span><a name="line-3965"></a><span>                                </span><a name="local-6989586621679477324"><a href="#local-6989586621679477324"><span class="hs-identifier">total</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477321"><span class="hs-identifier hs-var">refTotal</span></a><span>
</span><a name="line-3966"></a><span>                                </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477321"><span class="hs-identifier hs-var">refTotal</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477324"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-3967"></a><span>
</span><a name="line-3968"></a><span>                        </span><a name="local-6989586621679477325"><a href="#local-6989586621679477325"><span class="hs-identifier">total</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477321"><span class="hs-identifier hs-var">refTotal</span></a><span>
</span><a name="line-3969"></a><span>                        </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="VTable.Compliation.html#canBeSub"><span class="hs-identifier hs-var">canBeSub</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477326"><a href="#local-6989586621679477326"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-3970"></a><span>                                </span><a name="local-6989586621679477327"><a href="#local-6989586621679477327"><span class="hs-identifier">tmpVal</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477318"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477319"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477320"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477326"><span class="hs-identifier hs-var">deta</span></a><span class="hs-special">)</span><span>
</span><a name="line-3971"></a><span>                                </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679477325"><span class="hs-identifier hs-var">total</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477318"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477319"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477320"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477326"><span class="hs-identifier hs-var">deta</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477327"><span class="hs-identifier hs-var">tmpVal</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477325"><span class="hs-identifier hs-var">total</span></a><span class="hs-special">)</span><span>
</span><a name="line-3972"></a><span>                                                </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477318"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477319"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477320"><span class="hs-identifier hs-var">busi</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477326"><span class="hs-identifier hs-var">deta</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-3973"></a><span>
</span><a name="line-3974"></a><span>
</span><a name="line-3975"></a><span>
</span><a name="line-3976"></a><span>
</span><a name="line-3977"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#SubRateArray"><span class="hs-identifier hs-type">SubRateArray</span></a><span>
</span><a name="line-3978"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span>
</span><a name="line-3979"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%5730%57DF%30B3%30FC%30C9"><span class="hs-identifier hs-type">Val&#22320;&#22495;&#12467;&#12540;&#12489;</span></a><span>
</span><a name="line-3980"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span>
</span><a name="line-3981"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3982"></a><a name="f%526F%696D%6BD4%7387%4F5C%6210%51E6%7406"><a href="VTable.Compliation.html#f%526F%696D%6BD4%7387%4F5C%6210%51E6%7406"><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679477333"><a href="#local-6989586621679477333"><span class="hs-identifier">sra</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>              </span><a name="local-6989586621679477334"><a href="#local-6989586621679477334"><span class="hs-identifier">valArea</span></a></a><span>      </span><a name="local-6989586621679477335"><a href="#local-6989586621679477335"><span class="hs-identifier">valComm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3983"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span> </span><a name="local-6989586621679477336"><a href="#local-6989586621679477336"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679477337"><a href="#local-6989586621679477337"><span class="hs-identifier">valKind</span></a></a><span>           </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><a name="local-6989586621679477338"><a href="#local-6989586621679477338"><span class="hs-identifier">valComm</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3984"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span> </span><a name="local-6989586621679477339"><a href="#local-6989586621679477339"><span class="hs-identifier">sra</span></a></a><span> </span><a name="local-6989586621679477340"><a href="#local-6989586621679477340"><span class="hs-identifier">valKind</span></a></a><span>           </span><a name="local-6989586621679477341"><a href="#local-6989586621679477341"><span class="hs-identifier">valArea</span></a></a><span>      </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-3985"></a><span class="hs-identifier">f&#21103;&#26989;&#27604;&#29575;&#20316;&#25104;&#20966;&#29702;</span><span> </span><a name="local-6989586621679477342"><a href="#local-6989586621679477342"><span class="hs-identifier">sra</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477343"><a href="#local-6989586621679477343"><span class="hs-identifier">eKind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VText"><span class="hs-identifier hs-var">VText</span></a><span> </span><a name="local-6989586621679477344"><a href="#local-6989586621679477344"><span class="hs-identifier">area</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477345"><a href="#local-6989586621679477345"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-3986"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-glyph">~</span><a name="local-6989586621679477346"><a href="#local-6989586621679477346"><span class="hs-identifier">busiTx</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Data.Classification.html#elevateStratum"><span class="hs-identifier hs-var">VDC.elevateStratum</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_15&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477343"><span class="hs-identifier hs-var">eKind</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#Business"><span class="hs-identifier hs-var">VDC.Business</span></a><span> </span><span class="hs-comment">-- &#20803;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369;&#12434;&#20351;&#12387;&#12390;&#12427;&#22580;&#21512;15,35&#12391;&#12456;&#12521;&#12540;&#12395;&#12394;&#12427;</span><span>
</span><a name="line-3987"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477347"><a href="#local-6989586621679477347"><span class="hs-identifier">busiInt</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#busi2Int"><span class="hs-identifier hs-var">busi2Int</span></a><span> </span><a href="#local-6989586621679477346"><span class="hs-identifier hs-var">busiTx</span></a><span>
</span><a name="line-3988"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477348"><a href="#local-6989586621679477348"><span class="hs-identifier">prefInt</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#area2Int"><span class="hs-identifier hs-var">area2Int</span></a><span> </span><a href="#local-6989586621679477344"><span class="hs-identifier hs-var">area</span></a><span>
</span><a name="line-3989"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477349"><a href="#local-6989586621679477349"><span class="hs-identifier">notSub</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679477350"><a href="#local-6989586621679477350"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477350"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="VTable.Data.Classification.html#isMemberOf"><span class="hs-identifier hs-var">VDC.isMemberOf</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679477346"><span class="hs-identifier hs-var">busiTx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679477345"><span class="hs-identifier hs-var">comm</span></a><span>
</span><a name="line-3990"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679477349"><span class="hs-identifier hs-var">notSub</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477351"><a href="#local-6989586621679477351"><span class="hs-identifier">ca</span></a></a><span>
</span><a name="line-3991"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477352"><a href="#local-6989586621679477352"><span class="hs-identifier">detaInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#deta2Int"><span class="hs-identifier hs-var">deta2Int</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679477351"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-3992"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477342"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477348"><span class="hs-identifier hs-var">prefInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477347"><span class="hs-identifier hs-var">busiInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477352"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477353"><a href="#local-6989586621679477353"><span class="hs-identifier">curVal</span></a></a><span>
</span><a name="line-3993"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477342"><span class="hs-identifier hs-var">sra</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477348"><span class="hs-identifier hs-var">prefInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477347"><span class="hs-identifier hs-var">busiInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477352"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span>
</span><a name="line-3994"></a><span>        </span><span class="hs-operator hs-var">$</span><span>  </span><a href="#local-6989586621679477353"><span class="hs-identifier hs-var">curVal</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">value</span><span> </span><a href="#local-6989586621679477351"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span>
</span><a name="line-3995"></a><span>
</span><a name="line-3996"></a><span class="hs-comment">{- |
    &#26412;&#31295;&#12398;&#20027;&#38988;&#12398;&#19968;&#12388;&#12364;&#65292;&#29694;&#34892;&#12398;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12434;&#29992;&#12356;&#12390;&#65292;&#12393;&#12398;&#31243;&#24230;&#32048;&#12363;&#12356;&#37096;&#38272;&#12398;V&#34920;&#12364;&#25512;&#35336;&#12391;&#12365;&#12427;&#12363;&#12392;&#12356;&#12358;&#28857;&#12395;&#38306;&#12377;&#12427;&#12418;&#12398;&#12391;&#12354;&#12427;&#12364;&#65292;
    &#21516;&#36039;&#26009;&#12395;&#12362;&#12356;&#12390;&#65292;&#12300;&#32048;&#21697;&#30446;&#12398;&#27083;&#25104;&#12395;&#12388;&#12356;&#12390;CT&#12398;&#27083;&#25104;&#36942;&#31243;&#12391;&#22793;&#21205;&#12377;&#12427;&#21487;&#33021;&#24615;&#12364;&#12354;&#12427;&#12371;&#12392;&#12301;&#65292;
    &#12300;&#21103;&#26989;&#12364;&#22256;&#38627;&#12363;&#21542;&#12363;&#12395;&#12388;&#12356;&#12390;&#65292;&#22522;&#26412;&#20998;&#39006;&#12372;&#12392;&#12395;&#12375;&#12363;&#21028;&#26029;&#12375;&#12390;&#12356;&#12394;&#12356;&#12371;&#12392;&#12301;&#12363;&#12425;&#65292;
    &#12300;&#21103;&#26989;&#12487;&#12540;&#12479;&#12398;&#20998;&#35299;&#12399;&#65292;&#22522;&#26412;&#20998;&#39006;&#12398;&#21336;&#20301;&#12391;&#34892;&#12358;&#12301;&#12418;&#12398;&#12392;&#12375;&#12390;&#12356;&#12427;&#65294;&#24467;&#12387;&#12390;&#65292;&#29694;&#34892;&#12398;&#12475;&#12531;&#12469;&#12473;&#12398;&#32068;&#26367;&#38598;&#35336;&#12398;&#31684;&#22258;&#12391;&#12399;&#65292;
    &#22522;&#26412;&#20998;&#39006;&#12364;V&#34920;&#65288;S&#34920;&#65289;&#12434;&#27083;&#25104;&#21487;&#33021;&#12394;&#26368;&#23567;&#12398;&#37096;&#38272;&#20998;&#39006;&#12391;&#12354;&#12427;&#12392;&#12356;&#12360;&#12427;&#65294;&#12375;&#12363;&#12375;&#65292;&#12371;&#12398;&#65298;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#20107;&#21069;&#12395;&#12381;&#12428;&#12382;&#12428;&#12434;&#23450;&#32681;&#12377;&#12427;&#12371;&#12392;&#12391;&#65292;
    &#35299;&#27770;&#12391;&#12365;&#12427;&#12371;&#12392;&#12363;&#12425;&#65292;&#21407;&#29702;&#30340;&#12395;&#12399;&#12424;&#12426;&#32048;&#12363;&#12356;&#37096;&#38272;&#12391;&#12398;&#25512;&#35336;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12371;&#12392;&#12418;&#31034;&#21766;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;

    &#30476;&#21029;&#12395;&#38598;&#35336;&#12377;&#12427;&#12371;&#12392;&#12395;&#38306;&#12375;&#12390;&#65292;&#21516;&#36039;&#26009; &#12300;&#8545; &#27604;&#36611;&#12487;&#12540;&#12479;&#12398;&#20316;&#25104;&#12301;&#12391;&#12399;&#65292;
    &#12300;&#30476;&#12372;&#12392;&#12395;&#35336;&#31639;&#12375;&#12383;&#32080;&#26524;&#12434;&#31309;&#12415;&#19978;&#12370;&#12390;&#20840;&#22269;&#20516;&#12395;&#12377;&#12427;&#12371;&#12392;&#12392;&#12375;&#12390;&#12356;&#12427;&#12364;&#65292;&#30476;&#12372;&#12392;&#12398;&#29305;&#24500;&#12364;&#65292;
    &#12393;&#12398;&#31243;&#24230;&#24433;&#38911;&#12434;&#21450;&#12412;&#12375;&#12390;&#12356;&#12427;&#12363;&#12395;&#12388;&#12356;&#12390;&#65292;&#29694;&#26178;&#28857;&#12391;&#26908;&#35388;&#12377;&#12427;&#12371;&#12392;&#12399;&#12391;&#12365;&#12394;&#12356;&#12301;&#12392;&#12354;&#12427;&#65294;

    &#12371;&#12398;&#29694;&#26178;&#28857;&#12392;&#12356;&#12358;&#12398;&#12399;&#65292;&#24179;&#25104;28&#24180;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#38598;&#35336;&#21069;&#12392;&#12356;&#12358;&#24847;&#21619;&#12391;&#12354;&#12429;&#12358;&#12363;&#12425;&#29694;&#22312;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;
    &#26082;&#12395;&#30476;&#21029;&#12398;&#29305;&#24500;&#12364;&#26908;&#35388;&#12373;&#12428;&#12390;&#12356;&#12427;&#12418;&#12398;&#12392;&#24605;&#12431;&#12428;&#12427;&#12364;&#65292;&#12381;&#12398;&#32080;&#26524;&#12395;&#38306;&#12377;&#12427;&#36039;&#26009;&#12399;&#35211;&#12388;&#12369;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12394;&#12363;&#12387;&#12383;&#65294;
    &#12356;&#12378;&#12428;&#12395;&#12379;&#12424;&#65292;&#12371;&#12398;&#12424;&#12358;&#12395;&#38598;&#35336;&#21336;&#20301;&#12434;&#12354;&#12427;&#31243;&#24230;&#12398;&#21516;&#36074;&#24615;&#12434;&#20206;&#23450;&#12375;&#12390;&#23567;&#12373;&#12367;&#12377;&#12427;&#12371;&#12392;&#12399;&#38598;&#35336;&#19978;&#26377;&#29992;&#12391;&#12354;&#12427;&#12392;&#24605;&#12431;&#12428;&#65292;
    &#22320;&#22495;&#12372;&#12392;&#12395;&#29987;&#26989;&#12399;&#30064;&#12394;&#12427;&#29305;&#24500;&#12434;&#25345;&#12388;&#12392;&#12356;&#12358;&#12398;&#12399;&#26696;&#12395;&#29987;&#26989;&#25216;&#34899;&#20206;&#23450;&#12434;&#21542;&#23450;&#12375;&#12390;&#12356;&#12427;&#12371;&#12392;&#12392;&#12394;&#12427;&#65294;&#12381;&#12398;&#35251;&#28857;&#12363;&#12425;&#12377;&#12427;&#12392;&#65292;
    &#19968;&#28857;&#29694;&#34892;&#12398;&#25512;&#35336;&#26041;&#27861;&#12395;&#12399;&#19981;&#21512;&#29702;&#12394;&#28857;&#12364;&#35211;&#21463;&#12369;&#12425;&#12428;&#12427;&#65294;&#12381;&#12428;&#12399;&#65292;V&#34920;&#12398;&#25512;&#35336;&#12395;&#24403;&#12383;&#12387;&#12390;&#32068;&#26367;&#38598;&#35336;&#12434;&#32076;&#30001;&#12375;&#12390;&#65292;
    &#19968;&#24230;&#38598;&#35336;&#12373;&#12428;&#12383;&#12418;&#12398;&#12434;&#32232;&#32386;&#12377;&#12427;&#12392;&#12356;&#12358;&#24418;&#12434;&#12392;&#12387;&#12390;&#12356;&#12427;&#28857;&#12391;&#12354;&#12427;&#65294;&#29694;&#22312;&#12391;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20491;&#31080;&#12524;&#12505;&#12523;&#12398;&#24773;&#22577;&#12434;
    &#19968;&#24230;&#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#20107;&#26989;&#21029;&#22770;&#19978;&#38989;&#21450;&#12403;&#65292;&#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#35519;&#26619;&#21697;&#30446;&#22770;&#19978;&#38989;&#12398;&#24418;&#12391;&#38598;&#35336;&#12375;&#65292;&#12381;&#12398;&#27604;&#29575;&#12434;&#29992;&#12356;&#12390;V&#34920;&#12434;&#20316;&#25104;&#12375;&#12390;&#12356;&#12427;&#65294;
    &#12371;&#12428;&#12399;&#12356;&#12358;&#12394;&#12428;&#12400;&#21516;&#19968;&#12398;&#29987;&#26989;&#12395;&#23646;&#12377;&#12427;&#21830;&#21697;&#12399;&#21516;&#19968;&#12398;&#25216;&#34899;&#27083;&#36896;&#12434;&#25345;&#12388;&#12392;&#12356;&#12358;&#21830;&#21697;&#25216;&#34899;&#20206;&#23450;&#12434;&#29992;&#12356;&#12390;&#12356;&#12427;&#12371;&#12392;&#12434;&#24847;&#21619;&#12377;&#12427;&#12364;&#65292;
    &#20808;&#12398;&#22320;&#22495;&#21306;&#20998;&#12395;&#12424;&#12387;&#12390;&#29987;&#26989;&#25216;&#34899;&#20206;&#23450;&#12434;&#21542;&#23450;&#12375;&#12383;&#12398;&#12392;&#21516;&#27096;&#12395;&#65292;&#21830;&#21697;&#25216;&#34899;&#20206;&#23450;&#12434;&#32622;&#12363;&#12394;&#12356;&#12424;&#12358;&#12394;&#25512;&#35336;&#25163;&#27861;&#12434;&#21462;&#12426;&#20837;&#12428;&#12427;&#24907;&#24230;&#12398;&#26041;&#12364;
    &#19968;&#36011;&#24615;&#12364;&#12354;&#12427;&#12392;&#12356;&#12360;&#12427;&#65294;&#29694;&#22312;&#12371;&#12398;&#12424;&#12358;&#12394;&#24418;&#12434;&#12392;&#12387;&#12390;&#12356;&#12427;&#12398;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#38598;&#35336;&#12434;&#29420;&#31435;&#34892;&#25919;&#27861;&#20154; &#32113;&#35336;&#12475;&#12531;&#12479;&#12540;&#12364;&#35531;&#12369;&#36000;&#12356;&#65292;
    &#32068;&#26367;&#38598;&#35336;&#12434;&#29992;&#12356;&#12390;V&#34920;&#12398;&#25512;&#35336;&#12434;&#32207;&#21209;&#30465;&#12364;&#34892;&#12358;&#12392;&#12356;&#12358;&#20307;&#21046;&#12395;&#12424;&#12427;&#12418;&#12398;&#12391;&#12354;&#12427;&#12392;&#32771;&#12360;&#12425;&#12428;&#12427;&#12364;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#19968;&#36011;&#12375;&#12390;&#65292;
    V&#34920;&#12434;&#25512;&#35336;&#12375;&#65292;&#20107;&#26989;&#25152;&#27598;&#12398;&#29305;&#24615;&#12395;&#12424;&#12387;&#12390;&#19968;&#23450;&#12398;&#21306;&#20998;&#12434;&#12388;&#12369;&#12383;&#19978;&#12391;&#65292;&#21103;&#26989;&#12398;&#20998;&#35299;&#31561;&#12434;&#34892;&#12358;&#12371;&#12392;&#12391;&#65292;
    &#21830;&#21697;&#25216;&#34899;&#20206;&#23450;&#12434;&#32622;&#12363;&#12394;&#12356;V&#34920;&#12398;&#25512;&#35336;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12392;&#24605;&#12431;&#12428;&#12427;&#65294;&#26412;&#31295;&#12391;&#12399;&#65292;&#12381;&#12398;&#23455;&#38555;&#12398;&#35430;&#31639;&#12434;&#34892;&#12431;&#12394;&#12356;&#12364;&#65292;
    &#20170;&#24460;&#12398;&#30740;&#31350;&#35506;&#38988;&#12392;&#12375;&#12390;&#65292;&#27531;&#12375;&#12390;&#12362;&#12365;&#12383;&#12356;&#65294;-}</span><span>
</span><a name="line-4022"></a><span>
</span><a name="line-4023"></a><a name="f%526F%696D%628A%63E1%6539%5584%7248"><a href="VTable.Compliation.html#f%526F%696D%628A%63E1%6539%5584%7248"><span class="hs-identifier">f&#21103;&#26989;&#25226;&#25569;&#25913;&#21892;&#29256;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-4024"></a><span>
</span><a name="line-4025"></a><span>
</span><a name="line-4026"></a><span>
</span><a name="line-4027"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-4028"></a><span class="hs-comment">-- * CT&#25512;&#35336;</span><span>
</span><a name="line-4029"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-4030"></a><span class="hs-comment">{- |
    &#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;V&#34920;&#12398;&#21015;&#21644;&#65292;
    &#21363;&#12385;&#21830;&#21697;&#21029;&#32207;&#29987;&#20986;&#38989;&#65288;Control Total&#65289;&#12434;&#20027;&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;&#21547;&#12416;&#21508;&#31278;&#22522;&#30990;&#35519;&#26619;&#12363;&#12425;
    &#25512;&#35336;&#12373;&#12428;&#12383;&#21462;&#24341;&#22522;&#26412;&#34920;&#12398;&#34892;&#37096;&#38272;&#12434;V&#34920;&#21015;&#37096;&#38272;&#12395;&#32068;&#12415;&#26367;&#12360;&#12383;&#20516;&#12434;&#22266;&#23450;&#20516;&#12392;&#12375;&#12390;&#29992;&#12356;&#12390;&#12362;&#12426;&#65292;
    &#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#24471;&#12425;&#12428;&#12383;&#21508;&#31278;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12375;&#12390;CT&#12434;&#21508;&#29987;&#26989;&#12395;&#26696;&#20998;&#12377;&#12427;&#20966;&#29702;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;

    &#26412;&#31295;&#12391;&#12399;&#65292;&#21487;&#33021;&#12394;&#38480;&#12426;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12363;&#12425;CT&#12434;&#30452;&#25509;&#21462;&#24471;&#12377;&#12427;&#12371;&#12392;&#12434;&#35430;&#12415;&#12427;&#12364;&#65292;
    &#23455;&#38555;&#12398;V&#34920;&#12398;&#31639;&#20986;&#12395;&#12362;&#12369;&#12427;CT&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12364;&#29992;&#12356;&#12425;&#12428;&#12390;&#12356;&#12427;&#37096;&#38272;&#12399;&#38480;&#23450;&#30340;&#12391;&#12354;&#12427;&#65294;
    &#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12395;&#12424;&#12428;&#12400;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#21462;&#24341;&#22522;&#26412;&#34920;&#12391;&#12399;&#65292;&#24179;&#25104;17&#24180;&#20197;&#21069;&#12395;&#12362;&#12356;&#12390;&#24037;&#26989;&#32113;&#35336;&#65292;
    &#21830;&#26989;&#32113;&#35336;&#21448;&#12399;&#12469;&#12540;&#12499;&#12473;&#26989;&#22522;&#26412;&#32113;&#35336;&#12434;CT&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#21033;&#29992;&#12375;&#12390;&#12356;&#12383;&#35069;&#36896;&#26989;&#65292;&#21830;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#12394;&#12393;&#12398;&#20998;&#37326;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12434;&#22522;&#30990;&#36039;&#26009;&#12392;&#12375;&#12390;&#21033;&#29992;&#12375;&#12390;&#12356;&#12427;&#65294;&#19968;&#26041;&#12381;&#12428;&#20197;&#22806;&#12398;&#20998;&#37326;&#12398;&#12358;&#12385;&#36786;&#26519;&#28417;&#26989;&#12399;&#65292;
    &#20491;&#20154;&#32076;&#21942;&#12398;&#36786;&#26519;&#28417;&#23478;&#12364;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#35519;&#26619;&#23550;&#35937;&#12392;&#12394;&#12387;&#12390;&#12356;&#12394;&#12356;&#12383;&#12417;&#65292;&#12381;&#12398;&#20182;&#12398;&#20998;&#37326;&#12395;&#38306;&#12375;&#12390;&#12399;&#12300;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#24773;&#22577;&#12391;&#25512;&#35336;&#12377;&#12427;&#26041;&#12364;&#65292;
    &#12424;&#12426;&#27491;&#30906;&#12363;&#12388;&#21177;&#29575;&#30340;&#12391;&#12354;&#12427;&#12301;&#12383;&#12417;&#29992;&#12356;&#12390;&#12356;&#12394;&#12356;&#12392;&#12375;&#12390;&#12356;&#12427;

    &#20197;&#38477;&#65292;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12356;&#12390;CT&#25512;&#35336;&#12395;&#12475;&#12531;&#12469;&#12473;&#12434;&#29992;&#12356;&#12383;&#37096;&#38272;&#12398;&#25512;&#35336;&#25163;&#27861;&#21450;&#12403;&#12381;&#12398;&#21839;&#38988;&#28857;&#12395;&#38306;&#12375;&#12390;&#35542;&#12376;&#12383;&#12398;&#12385;&#65292;
    &#29992;&#12356;&#12390;&#12356;&#12394;&#12356;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;CT&#12434;&#25512;&#35336;&#12375;&#12383;&#22580;&#21512;&#12393;&#12398;&#12424;&#12358;&#12394;&#12418;&#12398;&#12395;&#12394;&#12427;&#12363;&#26908;&#35342;&#12377;&#12427;&#65294;


    _5.2.1   &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;CT&#25512;&#35336;&#12395;&#29992;&#12356;&#12390;&#12356;&#12427;&#37096;&#38272;_

    &#12469;&#12540;&#12499;&#12473;&#37096;&#38272;

    &#24179;&#25104;23&#24180;IO&#12391;&#12399;&#65292;&#12469;&#12540;&#12499;&#12473;&#37096;&#38272;&#12398;CT&#25512;&#35336;&#12395;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#20516;&#12434;&#29992;&#12356;&#12390;&#12356;&#12427;&#12364;&#65292;
    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#12469;&#12540;&#12499;&#12473;&#37096;&#38272;&#12395;&#12399;&#26410;&#25226;&#25569;&#37096;&#20998;&#12364;&#22823;&#12365;&#12356;&#12392;&#12356;&#12358;&#21839;&#38988;&#12364;&#12354;&#12427;&#65294;
    &#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12395;&#12424;&#12428;&#12400;&#12469;&#12540;&#12499;&#12473;&#26989;&#12398;&#22770;&#19978;&#31561;&#26410;&#25226;&#25569;&#29575;&#12399;&#12300;&#24773;&#22577;&#36890;&#20449;&#26989;&#12398;&#20869;&#65292;40 &#12452;&#12531;&#12479;&#12540;&#12493;&#12483;&#12488;&#20184;&#38543;&#12469;&#12540;&#12499;&#12473;&#26989;&#12301;
    &#12395;&#12362;&#12356;&#12390;33.3%&#65292;&#12300;&#23487;&#27850;&#26989;&#65292;&#39154;&#39135;&#12469;&#12540;&#12499;&#12473;&#26989;&#12301;&#12395;&#12362;&#12356;&#12390;26%&#65292;&#12300;
    &#12469;&#12540;&#12499;&#12473;&#26989;&#65288;&#20182;&#12395;&#20998;&#39006;&#12373;&#12428;&#12394;&#12356;&#12418;&#12398;&#65289;&#12301;&#12395;&#12362;&#12356;&#12390;20%&#12395;&#19978;&#12426;&#65292;
    &#12300;&#35069;&#36896;&#26989;&#12301;&#12398;12.80&#65285;&#65292;&#12300;&#36786;&#26989;&#65292;&#26519;&#26989;&#12301;&#12398;16.30%&#65292;&#12300;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12301;&#12395;&#12362;&#12369;&#12427;17&#65294;50%&#12394;&#12393;&#12469;&#12540;&#12499;&#12473;&#26989;&#12392;&#27604;&#36611;&#12377;&#12428;&#12400;&#39640;&#12356;&#20516;&#12391;&#12354;&#12427;&#12392;&#12356;&#12360;&#12427;&#65294;

    &#31532;13&#22238;&#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12391;&#12399;&#65292;&#12469;&#12540;&#12499;&#12473;&#37096;&#38272;&#12398;CT&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#65292;&#12414;&#12378;&#20107;&#26989;&#25152;&#12434;&#65292;
    &#20027;&#26989;&#65292;&#21103;&#26989;&#12372;&#12392;&#12395;&#12300;&#22770;&#19978;&#39640;&#21450;&#12403;&#37325;&#35201;&#32773;&#25968;&#12392;&#12418;&#12395;&#25226;&#25569;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#65288;&#22770;&#19978;&#25226;&#25569;&#20998;&#65289;&#12301;
    &#12300;&#24467;&#26989;&#32773;&#25968;&#12399;&#25226;&#25569;&#12373;&#12428;&#12383;&#12364;&#65292;&#22770;&#19978;&#39640;&#12364;&#25226;&#25569;&#12373;&#12428;&#12394;&#12363;&#12387;&#12383;&#20107;&#26989;&#25152;&#65288;&#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#65289;&#12301;&#12398;&#65298;&#21306;&#20998;&#12391;&#20998;&#21106;&#12375;&#65292;
    &#12381;&#12398;&#12358;&#12385;&#65292;&#20027;&#26989;&#12395;&#38306;&#12375;&#12390;&#25226;&#25569;&#20998;&#12539;&#26410;&#25226;&#25569;&#20998;&#21452;&#26041;&#12398;&#22770;&#12426;&#19978;&#12370;&#12434;&#20197;&#19979;&#12398;&#12424;&#12358;&#12395;&#25512;&#35336;&#12375;&#12390;&#12356;&#12427;&#65294;

    &#29987;&#26989;&#36899;&#38306;&#34920;&#12398;&#37096;&#38272;&#20998;&#39006;&#12434;CIO,&#37096;&#38272;&#20998;&#39006;&#12398;&#20869;&#12469;&#12540;&#12499;&#12473;&#29987;&#26989;&#12395;&#35442;&#24403;&#12377;&#12427;&#37096;&#20998;&#12434;CIOS&#8834; CIO,&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12398;&#29987;&#26989;&#20998;&#39006;&#12434;CC&#12392;&#12375;&#12390;&#65292;
    &#12354;&#12427;&#37096;&#38272; \(&#969; \in CIOS \)&#12392;&#23550;&#24540;&#20184;&#12369;&#12425;&#12428;&#12427; \(&#969;' \in ' CC \)&#12392;&#12377;&#12427;&#12392;&#65292;
    &#969; &#12398;&#20027;&#26989;&#30456;&#24403;&#12398;&#25226;&#25569;&#21450;&#12403;&#26410;&#25226;&#25569;&#37096;&#20998;&#12398;&#29983;&#29987;&#38989; \( CT_main [&#969;] \) &#12399;&#65292;&#20197;&#19979;&#12398;&#24335;&#12391;&#27714;&#12417;&#12425;&#12428;&#12427;&#65294;

    \[ CT_{main}=SPP[&#969;] \times compInvEmp[&#969;'] \times activityRate[&#969;] \]

    where

    \[ SPP[&#969;]= \frac{sales[&#969;]}{invEmp[&#969;]} \]

    \[ activityRate[&#969;']= \frac{invEmp[&#969;]}{compTotalEmp[&#969;'] \times \frac{compInvEmp[&#969;']}{totalEmp[&#969;']}} \]

    &#12394;&#12362;&#65292;&#21508;&#22793;&#25968;&#12399;&#20197;&#19979;&#12395;&#24467;&#12358;&#65294;

    * _SPP[&#969;]&#65288;Sales per person&#65289;_

    &#65306;&#969;&#8712;CIOS &#29987;&#26989;&#12398;&#19968;&#20154;&#12354;&#12383;&#12426;&#22770;&#19978;&#39640;

    * _sales[&#969;]_

    : &#969;&#8712;CIOS &#12398;&#22770;&#19978;&#39640;&#65294;IO&#12398;&#37096;&#38272;&#20998;&#39006;&#12395;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#35519;&#26619;&#32080;&#26524;&#12434;&#32068;&#12415;&#26367;&#12360;&#12383;&#32068;&#26367;&#38598;&#35336;&#65288;&#38750;&#20844;&#34920;&#65289;&#12424;&#12426;&#21462;&#24471;&#65294;

    * _invEmp[&#969;](Number of involved employment)_

    : &#29987;&#26989;&#969;&#8712;CIOS&#12398;&#24467;&#26989;&#32773;&#25968;&#12398;&#12358;&#12385;&#65292;&#27966;&#36963;&#65292;&#20986;&#21521;&#31561;&#12391;&#22806;&#37096;&#12395;&#36865;&#12426;&#20986;&#12375;&#12390;&#12356;&#12427;&#24467;&#26989;&#21729;&#12434;&#38500;&#12356;&#12383;&#24467;&#26989;&#21729;&#25968;&#65288;&#20107;&#26989;&#24467;&#26989;&#21729;&#25968;&#65289;&#65294;(\ &#969; \in CIOS \)&#12395;&#38306;&#12375;&#12390;&#12399;&#32068;&#26367;&#38598;&#35336;&#12424;&#12426;&#21462;&#24471;&#65294;

    * activetyRate[&#969;']

    :&#12450;&#12463;&#12486;&#12451;&#12499;&#12486;&#12451;&#29575;; &#20107;&#26989;&#25152;&#12398;&#24467;&#26989;&#32773;&#12398;&#20869;&#65292;&#12381;&#12398;&#20107;&#26989;&#25152;&#12398;&#29987;&#26989;&#26684;&#20184;&#12369; \( &#969;&#8217;\in CC \)&#12395;&#24467;&#20107;&#12375;&#12390;&#12356;&#12427;&#20154;&#25968;&#12398;&#21106;&#21512;

    * compInvEmp[&#969;&#8216;] (Complete Number of involved employments)

    :&#969; &#8712; CIOS&#12392;&#23550;&#24540;&#20184;&#12369;&#12425;&#12428;&#12383;\( &#969;' \in CC )&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12373;&#12428;&#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#12434;&#21547;&#12417;&#12383;&#20107;&#26989;&#25152;&#12398;&#20107;&#26989;&#24467;&#26989;&#21729;&#25968;&#65294;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65300; &#34920;&#12424;&#12426;&#21462;&#24471;&#65294;

    * _totalEmp[&#969;](Total number of employments)_

    :&#29987;&#26989; \( &#969;&#8217;\in CC \) &#12398;&#32207;&#24467;&#26989;&#32773;&#25968;&#65294;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65298;-1-1&#34920; &#12424;&#12426;&#21462;&#24471;&#65294;

    * _compTotalEmp[&#969;&#8217;] (Complete Total Number of Employments)_

    : \( &#969; \in CIOS \)&#12392;&#23550;&#24540;&#20184;&#12369;&#12425;&#12428;&#12383;&#969;&#8712;CC&#12395;&#29987;&#26989;&#26684;&#20184;&#12369;&#12373;&#12428;&#12383;&#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#12434;&#21547;&#12417;&#12394;&#12356;&#20107;&#26989;&#25152;&#12398;&#24467;&#26989;&#21729;&#25968;&#65294;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65300;&#34920;&#12414;&#12383;&#12399;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#31532;&#65298;&#34920; &#12424;&#12426;&#21462;&#24471;(&#31532;&#65298;&#34920;&#12399;&#29987;&#26989;&#32048;&#20998;&#39006;&#12414;&#12391;&#25226;&#25569;&#21487;&#33021;)

    &#12371;&#12398;&#26178; CT_{main}&#12434;&#22793;&#24418;&#12377;&#12427;&#12392;&#65292;&#38917;&#12364;&#25171;&#12385;&#28040;&#12375;&#12354;&#12356;&#65292;

    \[ CT_{main}[&#969;] = sales[&#969;] * \frac{totalEmp[&#969;']}{compTotalEmp[&#969;']} \]

    &#12364;&#24471;&#12425;&#12428;&#12427;&#65294;

    &#35069;&#36896;&#37096;&#38272;&#12539;&#21830;&#26989;&#37096;&#38272;
    &#35069;&#36896;&#37096;&#38272;&#21450;&#12403;&#65292;&#21830;&#26989;&#37096;&#38272;&#12395;&#12362;&#12369;&#12427;CT&#25512;&#35336;&#12391;&#12399;&#65292;

    &gt; &#9312;  &#24467;&#21069;&#12363;&#12425;&#12418;&#65292;&#20840;&#25968;&#35519;&#26619;&#65288;&#24037;&#26989;&#32113;&#35336;&#35519;&#26619;&#65292;&#21830;&#26989;&#32113;&#35336;&#35519;&#26619;&#65289;&#12398;&#12487;&#12540;&#12479;&#12434;&#20351;&#29992;&#12375;&#12390;&#65292;&#25226;&#25569;&#12373;&#12428;&#12383;&#31684;&#22258;&#12391;&#25512;&#35336;&#12375;&#12390;&#12356;&#12427;&#12371;&#12392;
    &gt; &#9313; &#20170;&#22238;&#12398;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12356;&#12390;&#12418;&#26410;&#25226;&#25569;&#20998;&#12364;&#27604;&#36611;&#30340;&#23567;&#12373;&#12356;&#12371;&#12392;
    &gt; &#9314;&#29983;&#29987;&#21205;&#24907;&#32113;&#35336;&#35519;&#26619;&#12394;&#12393;&#65292;&#27604;&#36611;&#21487;&#33021;&#12394;&#12487;&#12540;&#12479;&#12364;&#12354;&#12427;&#12371;&#12392;
    &gt; &#29987;&#26989;&#36899;&#38306;&#25216;&#34899;&#20250;&#35696;&#36039;&#26009; &#12424;&#12426;&#25244;&#31883;&#65288;&#19968;&#37096;&#31558;&#32773;&#32232;&#38598;&#65289;

    &#12398;3&#28857;&#12363;&#12425;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#12391;&#34892;&#12431;&#12428;&#12390;&#12356;&#12427;&#24467;&#26989;&#32773;&#25968;&#12395;&#12424;&#12427;&#35036;&#23436;&#12434;&#34892;&#12431;&#12378;&#65292;
    &#29983;&#29987;&#21205;&#24907;&#32113;&#35336;&#35519;&#26619;&#65292;&#21830;&#26989;&#32113;&#35336;&#35519;&#26619;&#12394;&#12393;&#12398;&#12487;&#12540;&#12479;&#12395;&#12424;&#12427;&#35519;&#25972;&#12398;&#12418;&#12392;&#22770;&#19978;&#39640;&#12364;&#25226;&#25569;&#12373;&#12428;&#12383;&#20107;&#26989;&#25152;&#12398;&#31684;&#22258;&#12391;&#25512;&#35336;&#12434;&#34892;&#12358;&#26041;&#37341;&#12391;&#12354;&#12427;&#12392;&#35500;&#26126;&#12373;&#12428;&#12390;&#12356;&#12427;&#65294;&#24467;&#12387;&#12390;&#65292;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#12398;CT&#12395;&#12399;&#12289;&#12300;&#35069;&#36896;&#26989;&#12301;&#12395;&#12362;&#12369;&#12427;12.80%&#65292;&#12300;&#21368;&#22770;&#26989;&#65292;&#23567;&#22770;&#26989;&#12301;&#12395;&#12362;&#12369;&#12427;17.50%&#12398;&#22770;&#19978;&#39640;&#26410;&#25226;&#25569;&#20998;&#12399;&#22522;&#26412;&#30340;&#12395;&#12399;&#21547;&#12414;&#12428;&#12390;&#12356;&#12394;&#12356;&#65294;
    &#37326;&#26449;.&#20182;&#65288;2017&#65289;&#12391;&#12399;&#65292;&#21830;&#26989;&#37096;&#38272;&#12395;&#12362;&#12369;&#12427;&#12371;&#12398;&#26410;&#25226;&#25569;&#20998;&#12398;&#24433;&#38911;&#12392;&#12375;&#12390;&#24179;&#25104;23&#24180;&#29987;&#26989;&#36899;&#38306;&#34920;&#12395;&#12362;&#12369;&#12427;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#38989;&#12398;&#36942;&#23567;&#35413;&#20385;&#38989;&#12364;
    &#20961;&#12381;7.1-12.3&#20806;&#20870;&#12395;&#19978;&#12427;&#12392;&#35430;&#31639;&#12375;&#12390;&#12362;&#12426;&#65292;&#26410;&#25226;&#25569;&#20998;&#12398;&#35036;&#23450;&#20316;&#26989;&#12434;&#37325;&#35201;&#12394;&#26908;&#35342;&#35506;&#38988;&#12392;&#12375;&#12390;&#25522;&#12370;&#12390;&#12356;&#12427;&#65294;
    &#12394;&#12362;&#65292;&#21516;&#35542;&#25991;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#26410;&#25226;&#25569;&#20998;&#20107;&#26989;&#25152;&#12398;&#24467;&#26989;&#32773;&#25968;&#12434;&#26368;&#22823;&#12465;&#12540;&#12473;&#12391;99&#20154;&#20197;&#19979;&#65292;&#26368;&#23567;&#12465;&#12540;&#12473;&#12391;29&#20154;&#20197;&#19979;&#12392;&#12375;&#12390;&#65292;
    &#26989;&#31278;&#21029;&#12539;&#24467;&#26989;&#32773;&#35215;&#27169;&#21029;&#12398;&#65297;&#20107;&#26989;&#25152;&#12354;&#12383;&#12426;&#21830;&#21697;&#36009;&#22770;&#38989;&#12434;&#20055;&#12378;&#12427;&#12371;&#12392;&#12395;&#12424;&#12387;&#12390;&#26410;&#25226;&#25569;&#20998;&#12510;&#12540;&#12472;&#12531;&#38989;&#12398;&#35430;&#31639;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#65294;

    &#21069;&#36848;&#12398;&#12469;&#12540;&#12499;&#12473;&#26989;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#12381;&#12398;CT_main&#12399;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#22770;&#19978;&#39640;&#12398;&#21644;&#12391;&#12354;&#12427;&#12364;&#65292;&#35069;&#36896;&#37096;&#38272;&#21450;&#12403;&#65292;&#21830;&#26989;&#37096;&#38272;&#12395;&#12362;&#12369;&#12427;CT&#12398;&#35336;&#31639;&#12399;&#12356;&#12367;&#12388;&#12363;&#12398;&#28857;&#12391;&#12469;&#12540;&#12499;&#12473;&#26989;&#12392;&#12399;&#30064;&#12394;&#12427;&#65294;
    &#12414;&#12378;&#65292;&#35069;&#36896;&#26989;&#21450;&#12403;&#65292;&#21830;&#26989;&#12395;&#12362;&#12356;&#12390;&#29987;&#20986;&#38989;&#12434;&#25512;&#35336;&#12377;&#12427;&#12395;&#12399;&#65292;&#22312;&#24235;&#12398;&#31639;&#20986;&#12418;&#21547;&#12417;&#12390;&#35430;&#31639;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#65294;&#12371;&#12398;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21069;&#36848;&#12398;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#12398;&#31680;&#12395;&#12390;&#35542;&#12376;&#12390;&#12356;&#12427;&#65294;
    &#27425;&#12395;SNA&#12395;&#12362;&#12356;&#12390;&#21830;&#26989;&#12395;&#12362;&#12369;&#12427;&#31639;&#20986;&#38989;&#12399;&#65292;&#21830;&#21697;&#12398;&#36009;&#22770;&#38989;&#12391;&#12399;&#12394;&#12367;&#65292;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;&#12434;&#23550;&#35937;&#12392;&#12375;&#12390;&#12362;&#12426;&#65292;&#12300;&#21830;&#26989;&#12510;&#12540;&#12472;&#12531;=&#21830;&#21697;&#36009;&#22770;&#38989;-&#21830;&#21697;&#20181;&#20837;&#12428;&#38989;&#12301;&#12392;&#12375;&#12390;&#23450;&#32681;&#12373;&#12428;&#12427;&#65294;&#12371;&#12398;&#28857;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292; &#12300;4.6&#31456; &#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12301;&#12395;&#12362;&#12356;&#12390;&#35443;&#12375;&#12367;&#25201;&#12387;&#12390;&#12356;&#12427;&#65294;

    &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;CT&#25512;&#35336;&#12395;&#29992;&#12356;&#12390;&#12356;&#12394;&#12356;&#37096;&#38272;
    &#35069;&#36896;&#26989;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#65292;&#21830;&#26989;&#20197;&#22806;&#12398;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12434;CT&#25512;&#35336;&#12395;&#29992;&#12356;&#12390;&#12356;&#12394;&#12356;&#12383;&#12417;&#12381;&#12398;&#25512;&#35336;&#25163;&#27861;&#12364;&#20844;&#12395;&#12399;&#23384;&#22312;&#12375;&#12390;&#12356;&#12394;&#12356;&#65294;&#12381;&#12398;&#28858;&#65292;&#26412;&#31295;&#12391;&#12399;&#65292;&#12469;&#12540;&#12499;&#12473;&#26989;&#12392;&#21516;&#27096;&#12398;&#24467;&#26989;&#21729;&#25968;&#12395;&#12424;&#12427;&#22770;&#12426;&#19978;&#12370;&#12398;&#35036;&#23450;&#12434;&#34892;&#12387;&#12383;&#12358;&#12360;&#12391;&#65292;&#12381;&#12398;&#22770;&#19978;&#12398;&#32207;&#21644;&#12434;CT&#12392;&#12375;&#12390;&#25201;&#12358;&#65294;
    &#35519;&#26619;&#23550;&#35937;&#22806;&#29987;&#26989;&#12398;&#25201;&#12356;
    &#20197;&#19979;&#12398;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#12475;&#12531;&#12469;&#12473;&#12391;&#22770;&#12426;&#19978;&#12370;&#12434;&#24471;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12394;&#12356;&#65294;

    &gt; &#12539;&#36786;&#26989;&#65292;&#26519;&#26989;&#65292;&#28417;&#26989;&#12398;&#20491;&#20154;&#32076;&#21942;&#20107;&#26989;&#25152;&#12398;&#22770;&#12426;&#19978;&#12370;
    &gt; &#12539;&#23478;&#20107;&#12469;&#12540;&#12499;&#12473;&#26989;&#12398;&#20107;&#26989;&#25152;&#12398;&#22770;&#12426;&#19978;&#12370;
    &gt; &#12539;&#22269;&#21450;&#12403;&#22320;&#26041;&#20844;&#20849;&#22243;&#20307;&#12398;&#22770;&#12426;&#19978;&#12370;
    &gt; &#12539;&#33258;&#23478;&#30330;&#38651;&#12394;&#12393;&#12398;&#33258;&#23478;&#29983;&#29987;&#12539;&#33258;&#24049;&#28040;&#36027;

    &#12371;&#12428;&#12425;&#12398;&#37096;&#38272;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#26412;&#31295;&#12391;&#12399;&#21462;&#12426;&#25201;&#12431;&#12378;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#37096;&#38272;&#12398;&#33258;&#20132;&#28857;&#12395;&#12399;&#65296;&#12364;&#35336;&#19978;&#12373;&#12428;&#12427;&#65294;

    fCT&#25512;&#35336;&#12391;&#12399;,&#12371;&#12428;&#12425;&#12398;&#20055;&#25968;&#12434;&#27714;&#12417;&#12427;

    &#12414;&#12383;,&#20351;&#29992;&#12375;&#12394;&#12356;&#20225;&#26989;&#12398;&#12487;&#12540;&#12479;&#12420;,&#22243;&#20307;&#12398;&#12487;&#12540;&#12479;,&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12398;&#20107;&#26989;&#25152;&#12398;&#12487;&#12540;&#12479;&#12434;&#25244;&#12363;&#12377;
-}</span><span>
</span><a name="line-4147"></a><span>
</span><a name="line-4148"></a><span class="hs-identifier">fCT&#20055;&#25968;&#25512;&#35336;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475892"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#ToMakeCTMultiplier"><span class="hs-identifier hs-type">ToMakeCTMultiplier</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679475892"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="VTable.Compliation.html#CTMultiplier"><span class="hs-identifier hs-type">CTMultiplier</span></a><span>
</span><a name="line-4149"></a><a name="fCT%4E57%6570%63A8%8A08"><a href="VTable.Compliation.html#fCT%4E57%6570%63A8%8A08"><span class="hs-identifier">fCT&#20055;&#25968;&#25512;&#35336;</span></a></a><span> </span><a name="local-6989586621679477354"><a href="#local-6989586621679477354"><span class="hs-identifier">refTmcm</span></a></a><span>
</span><a name="line-4150"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477355"><a href="#local-6989586621679477355"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-4151"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477355"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4152"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477354"><span class="hs-identifier hs-var">refTmcm</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">return</span><span class="hs-operator hs-var">.</span><a href="VTable.Compliation.html#makeCTMultiplier"><span class="hs-identifier hs-var">makeCTMultiplier</span></a><span>
</span><a name="line-4153"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477356"><a href="#local-6989586621679477356"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477356"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7DCF%58F2%4E0A"><span class="hs-identifier hs-var">H&#32207;&#22770;&#19978;</span></a><span class="hs-special">)</span><span>       </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477357"><a href="#local-6989586621679477357"><span class="hs-identifier">valSales</span></a></a><span>
</span><a name="line-4154"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477356"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">H&#38599;&#29992;&#24773;&#22577;</span></a><span class="hs-special">)</span><span>     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477358"><a href="#local-6989586621679477358"><span class="hs-identifier">valEmp</span></a></a><span>
</span><a name="line-4155"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477356"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span class="hs-special">)</span><span>     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477359"><a href="#local-6989586621679477359"><span class="hs-identifier">valClas</span></a></a><span>
</span><a name="line-4156"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477356"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477360"><a href="#local-6989586621679477360"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-4157"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#fCT%4E57%6570%63A8%8A08%51E6%7406"><span class="hs-identifier hs-var">fCT&#20055;&#25968;&#25512;&#35336;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477354"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><a href="#local-6989586621679477357"><span class="hs-identifier hs-var">valSales</span></a><span> </span><a href="#local-6989586621679477358"><span class="hs-identifier hs-var">valEmp</span></a><span> </span><a href="#local-6989586621679477359"><span class="hs-identifier hs-var">valClas</span></a><span> </span><a href="#local-6989586621679477360"><span class="hs-identifier hs-var">valKind</span></a><span class="hs-special">)</span><span>
</span><a name="line-4158"></a><span>                 </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#fCT%4E57%6570%63A8%8A08"><span class="hs-identifier hs-var">fCT&#20055;&#25968;&#25512;&#35336;</span></a><span> </span><a href="#local-6989586621679477354"><span class="hs-identifier hs-var">refTmcm</span></a><span>
</span><a name="line-4159"></a><span>
</span><a name="line-4160"></a><span>
</span><a name="line-4161"></a><span class="hs-identifier">fCT&#20055;&#25968;&#25512;&#35336;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#ToMakeCTMultiplier"><span class="hs-identifier hs-type">ToMakeCTMultiplier</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7DCF%58F2%4E0A"><span class="hs-identifier hs-type">Val&#32207;&#22770;&#19978;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">Val&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">Val&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4162"></a><a name="fCT%4E57%6570%63A8%8A08%51E6%7406"><a href="VTable.Compliation.html#fCT%4E57%6570%63A8%8A08%51E6%7406"><span class="hs-identifier">fCT&#20055;&#25968;&#25512;&#35336;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679477361"><a href="#local-6989586621679477361"><span class="hs-identifier">refTmcm</span></a></a><span> </span><a name="local-6989586621679477362"><a href="#local-6989586621679477362"><span class="hs-identifier">valSales</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%96C7%7528%60C5%5831"><span class="hs-identifier hs-var">V&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><a name="local-6989586621679477363"><a href="#local-6989586621679477363"><span class="hs-identifier">emp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477364"><a href="#local-6989586621679477364"><span class="hs-identifier">clas</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679477365"><a href="#local-6989586621679477365"><span class="hs-identifier">kind</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-4163"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#correctPair"><span class="hs-identifier hs-var">correctPair</span></a><span> </span><a href="#local-6989586621679477365"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4164"></a><span>        </span><a href="VTable.Compliation.html#Wrong"><span class="hs-identifier hs-var">Wrong</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4165"></a><span>        </span><a href="VTable.Compliation.html#ES"><span class="hs-identifier hs-var">ES</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477366"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">_&#20107;&#38599;&#29992;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679477361"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><a href="#local-6989586621679477363"><span class="hs-identifier hs-var">emp</span></a><span> </span><a href="#local-6989586621679477364"><span class="hs-identifier hs-var">clas</span></a><span>
</span><a name="line-4166"></a><span>        </span><a href="VTable.Compliation.html#EN"><span class="hs-identifier hs-var">EN</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477366"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">_&#20225;&#38599;&#29992;&#32773;&#25968;</span><span> </span><a href="#local-6989586621679477361"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><a href="#local-6989586621679477363"><span class="hs-identifier hs-var">emp</span></a><span> </span><a href="#local-6989586621679477364"><span class="hs-identifier hs-var">clas</span></a><span>
</span><a name="line-4167"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-4168"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">E&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IORef</span><span> </span><a href="VTable.Compliation.html#ToMakeCTMultiplier"><span class="hs-identifier hs-type">ToMakeCTMultiplier</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#E%96C7%7528%60C5%5831"><span class="hs-identifier hs-type">E&#38599;&#29992;&#24773;&#22577;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#E%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">E&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4169"></a><span>    </span><a name="local-6989586621679477366"><a href="#local-6989586621679477366"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679477367"><a href="#local-6989586621679477367"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679477368"><a href="#local-6989586621679477368"><span class="hs-identifier">refTmcm</span></a></a><span> </span><a name="local-6989586621679477369"><a href="#local-6989586621679477369"><span class="hs-identifier">emp</span></a></a><span> </span><a name="local-6989586621679477370"><a href="#local-6989586621679477370"><span class="hs-identifier">clas</span></a></a><span>
</span><a name="line-4170"></a><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477371"><a href="#local-6989586621679477371"><span class="hs-identifier">smallInt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#23567;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477370"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span>
</span><a name="line-4171"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477372"><a href="#local-6989586621679477372"><span class="hs-identifier">totalEmp</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477367"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679477369"><span class="hs-identifier hs-var">emp</span></a><span class="hs-special">)</span><span>
</span><a name="line-4172"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477368"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477373"><a href="#local-6989586621679477373"><span class="hs-identifier">tmcm</span></a></a><span>
</span><a name="line-4173"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477362"><span class="hs-identifier hs-var">valSales</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4174"></a><span>            </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>   </span><span class="hs-comment">-- &#22770;&#19978;&#26410;&#25226;&#25569;&#20998;</span><span>
</span><a name="line-4175"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477371"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><a href="#local-6989586621679477373"><span class="hs-identifier hs-var">tmcm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4176"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477368"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477371"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477372"><span class="hs-identifier hs-var">totalEmp</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4177"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679477374"><a href="#local-6989586621679477374"><span class="hs-identifier">cTotalEmp</span></a></a><span class="hs-special">,</span><a name="local-6989586621679477375"><a href="#local-6989586621679477375"><span class="hs-identifier">cCompEmp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477368"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477371"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477374"><span class="hs-identifier hs-var">cTotalEmp</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477372"><span class="hs-identifier hs-var">totalEmp</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477375"><span class="hs-identifier hs-var">cCompEmp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4178"></a><span>
</span><a name="line-4179"></a><span>            </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VDouble"><span class="hs-identifier hs-var">VDouble</span></a><span> </span><a name="local-6989586621679477376"><a href="#local-6989586621679477376"><span class="hs-identifier">sales</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#22770;&#19978;&#25226;&#25569;&#20998;</span><span>
</span><a name="line-4180"></a><span>             </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477371"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><a href="#local-6989586621679477373"><span class="hs-identifier hs-var">tmcm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4181"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477368"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477371"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477372"><span class="hs-identifier hs-var">totalEmp</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477372"><span class="hs-identifier hs-var">totalEmp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4182"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679477377"><a href="#local-6989586621679477377"><span class="hs-identifier">cTotalEmp</span></a></a><span class="hs-special">,</span><a name="local-6989586621679477378"><a href="#local-6989586621679477378"><span class="hs-identifier">cCompEmp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477368"><span class="hs-identifier hs-var">refTmcm</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.insert</span><span> </span><a href="#local-6989586621679477371"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477377"><span class="hs-identifier hs-var">cTotalEmp</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477372"><span class="hs-identifier hs-var">totalEmp</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477378"><span class="hs-identifier hs-var">cCompEmp</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477372"><span class="hs-identifier hs-var">totalEmp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4183"></a><span>
</span><a name="line-4184"></a><span>
</span><a name="line-4185"></a><span>
</span><a name="line-4186"></a><span class="hs-identifier">fCT&#20055;&#25968;&#25512;&#35336;&#20966;&#29702;</span><span> </span><a name="local-6989586621679477379"><a href="#local-6989586621679477379"><span class="hs-identifier">icr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4187"></a><span>
</span><a name="line-4188"></a><span class="hs-comment">-- | EN &#12363; ES &#12363; Wrong&#12363;</span><span>
</span><a name="line-4189"></a><span class="hs-keyword">data</span><span> </span><a name="ENESPair"><a href="VTable.Compliation.html#ENESPair"><span class="hs-identifier">ENESPair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EN"><a href="VTable.Compliation.html#EN"><span class="hs-identifier">EN</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ES"><a href="VTable.Compliation.html#ES"><span class="hs-identifier">ES</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Wrong"><a href="VTable.Compliation.html#Wrong"><span class="hs-identifier">Wrong</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-4190"></a><span>
</span><a name="line-4191"></a><span class="hs-comment">-- | &#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12363;&#12388;&#20225;&#26989;&#35519;&#26619;&#31080;&#12414;&#12383;&#12399;&#38750;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#12363;&#12388;&#20107;&#26989;&#25152;&#35519;&#26619;&#31080;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-4192"></a><span class="hs-identifier">correctPair</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#ENESPair"><span class="hs-identifier hs-type">ENESPair</span></a><span>
</span><a name="line-4193"></a><a name="correctPair"><a href="VTable.Compliation.html#correctPair"><span class="hs-identifier">correctPair</span></a></a><span> </span><a name="local-6989586621679477380"><a href="#local-6989586621679477380"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">|</span><span>     </span><a href="#local-6989586621679477381"><span class="hs-identifier hs-var">isNetwork</span></a><span> </span><a href="#local-6989586621679477380"><span class="hs-identifier hs-var">kind</span></a><span>  </span><span class="hs-operator hs-var">&amp;&amp;</span><span>      </span><a href="#local-6989586621679477382"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679477380"><span class="hs-identifier hs-var">kind</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#EN"><span class="hs-identifier hs-var">EN</span></a><span>
</span><a name="line-4194"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span class="hs-special">(</span><a href="#local-6989586621679477381"><span class="hs-identifier hs-var">isNetwork</span></a><span> </span><a href="#local-6989586621679477380"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477382"><span class="hs-identifier hs-var">isEN</span></a><span> </span><a href="#local-6989586621679477380"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#ES"><span class="hs-identifier hs-var">ES</span></a><span>
</span><a name="line-4195"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                               </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#Wrong"><span class="hs-identifier hs-var">Wrong</span></a><span>
</span><a name="line-4196"></a><span>
</span><a name="line-4197"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-4198"></a><span>    </span><span class="hs-comment">--  | &#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#29987;&#26989;&#12363;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-4199"></a><span>    </span><span class="hs-identifier">isNetwork</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Data.Structure.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-type">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-4200"></a><span>    </span><a name="local-6989586621679477381"><a href="#local-6989586621679477381"><span class="hs-identifier">isNetwork</span></a></a><span> </span><a name="local-6989586621679477383"><a href="#local-6989586621679477383"><span class="hs-identifier">kind</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679477383"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-4201"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679477383"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%5EFA%8A2D%30B5%30FC%30D3%30B9A%5B66%6821"><span class="hs-identifier hs-var">E&#24314;&#35373;&#12469;&#12540;&#12499;&#12473;A&#23398;&#26657;</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-4202"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">_&#23550;&#35937;&#29987;&#26989;</span><span> </span><a href="#local-6989586621679477383"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%56E3%4F53"><span class="hs-identifier hs-var">E&#22243;&#20307;</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-4203"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-4204"></a><span>    </span><span class="hs-comment">--  | &#20225;&#26989;&#35519;&#26619;&#31080;&#12363;&#12398;&#21028;&#23450;</span><span>
</span><a name="line-4205"></a><span>    </span><a name="local-6989586621679477382"><a href="#local-6989586621679477382"><span class="hs-identifier">isEN</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#E%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">E&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679477384"><a href="#local-6989586621679477384"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621679477385"><a href="#local-6989586621679477385"><span class="hs-identifier">target</span></a></a><span> </span><a name="local-6989586621679477386"><a href="#local-6989586621679477386"><span class="hs-identifier">subject</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-4206"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477384"><span class="hs-identifier hs-var">kind</span></a><span>    </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%4F01%696D%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#20225;&#26989;&#35519;&#26619;&#31080;</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-4207"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477384"><span class="hs-identifier hs-var">kind</span></a><span>    </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%56E3%4F53%8ABF%67FB%7968"><span class="hs-identifier hs-var">E&#22243;&#20307;&#35519;&#26619;&#31080;</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-4208"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477386"><span class="hs-identifier hs-var">subject</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="VTable.Data.Structure.html#E%56E3%4F53%6CD5%4EBA%7528"><span class="hs-identifier hs-var">E&#22243;&#20307;&#27861;&#20154;&#29992;</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-4209"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-4210"></a><span>
</span><a name="line-4211"></a><span>
</span><a name="line-4212"></a><span>
</span><a name="line-4213"></a><span class="hs-comment">-- | &#29987;&#26989;&#23567;&#20998;&#39006; 0 - 603</span><span>
</span><a name="line-4214"></a><span class="hs-keyword">type</span><span> </span><a name="SmallInt"><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier">SmallInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-4215"></a><span>
</span><a name="line-4216"></a><span class="hs-comment">-- | &#20013;&#20998;&#39006;&#12363;&#12425;MidIit &#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-4217"></a><span class="hs-identifier">small2Int</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span>
</span><a name="line-4218"></a><a name="small2Int"><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier">small2Int</span></a></a><span> </span><a name="local-6989586621679477387"><a href="#local-6989586621679477387"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477387"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#ci%5C0F%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9%6B63%9806"><span class="hs-identifier hs-var">VDC.ci&#23567;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#27491;&#38918;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4219"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477388"><a href="#local-6989586621679477388"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679477388"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-4220"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;error : mid2Small : Can not find in small &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679477387"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-4221"></a><span>
</span><a name="line-4222"></a><span class="hs-comment">-- | SmallInt &#12363;&#12425;&#20013;&#20998;&#39006;&#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-4223"></a><span class="hs-identifier">int2Small</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span>
</span><a name="line-4224"></a><a name="int2Small"><a href="VTable.Compliation.html#int2Small"><span class="hs-identifier">int2Small</span></a></a><span> </span><a name="local-6989586621679477389"><a href="#local-6989586621679477389"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679477389"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#ic%5C0F%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9%6B63%9806"><span class="hs-identifier hs-var">VDC.ic&#23567;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#27491;&#38918;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4225"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477390"><a href="#local-6989586621679477390"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477390"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-4226"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;error : int2Small : Can not find in small &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679477389"><span class="hs-identifier hs-var">num</span></a><span>
</span><a name="line-4227"></a><span>
</span><a name="line-4228"></a><span>
</span><a name="line-4229"></a><span class="hs-comment">-- | &#29987;&#26989;&#21029;&#12395;&#20055;&#12376;&#12427;&#35036;&#23450;&#12398;&#20055;&#25968;</span><span>
</span><a name="line-4230"></a><span class="hs-keyword">type</span><span> </span><a name="CTMultiplier"><a href="VTable.Compliation.html#CTMultiplier"><span class="hs-identifier">CTMultiplier</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-4231"></a><span>
</span><a name="line-4232"></a><span class="hs-comment">-- | &#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#12434;&#21547;&#12417;&#12394;&#12356;&#29987;&#26989;&#12398;&#24467;&#26989;&#32773;&#25968;</span><span>
</span><a name="line-4233"></a><span class="hs-keyword">type</span><span> </span><a name="CompTotalEmp"><a href="VTable.Compliation.html#CompTotalEmp"><span class="hs-identifier">CompTotalEmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-4234"></a><span>
</span><a name="line-4235"></a><span class="hs-comment">-- | &#22770;&#19978;&#26410;&#25226;&#25569;&#20998;&#12434;&#21547;&#12417;&#12383;&#29987;&#26989;&#12398;&#24467;&#26989;&#32773;&#25968;</span><span>
</span><a name="line-4236"></a><span class="hs-keyword">type</span><span> </span><a name="TotalEmp"><a href="VTable.Compliation.html#TotalEmp"><span class="hs-identifier">TotalEmp</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-4237"></a><span>
</span><a name="line-4238"></a><span class="hs-keyword">type</span><span> </span><a name="ToMakeCTMultiplier"><a href="VTable.Compliation.html#ToMakeCTMultiplier"><span class="hs-identifier">ToMakeCTMultiplier</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#TotalEmp"><span class="hs-identifier hs-type">TotalEmp</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#CompTotalEmp"><span class="hs-identifier hs-type">CompTotalEmp</span></a><span class="hs-special">)</span><span>
</span><a name="line-4239"></a><span>
</span><a name="line-4240"></a><span class="hs-identifier">makeCTMultiplier</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#ToMakeCTMultiplier"><span class="hs-identifier hs-type">ToMakeCTMultiplier</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#CTMultiplier"><span class="hs-identifier hs-type">CTMultiplier</span></a><span>
</span><a name="line-4241"></a><a name="makeCTMultiplier"><a href="VTable.Compliation.html#makeCTMultiplier"><span class="hs-identifier">makeCTMultiplier</span></a></a><span> </span><a name="local-6989586621679477391"><a href="#local-6989586621679477391"><span class="hs-identifier">tmcm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.map</span><span> </span><a href="#local-6989586621679477392"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679477391"><span class="hs-identifier hs-var">tmcm</span></a><span>
</span><a name="line-4242"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4243"></a><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#TotalEmp"><span class="hs-identifier hs-type">TotalEmp</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#CompTotalEmp"><span class="hs-identifier hs-type">CompTotalEmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-4244"></a><span>  </span><a name="local-6989586621679477392"><a href="#local-6989586621679477392"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679477393"><a href="#local-6989586621679477393"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679477394"><a href="#local-6989586621679477394"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679477394"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-4245"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477393"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679477394"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-4246"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477393"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679477394"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-4247"></a><span>
</span><a name="line-4248"></a><span>
</span><a name="line-4249"></a><span>
</span><a name="line-4250"></a><span>
</span><a name="line-4251"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-4252"></a><span class="hs-comment">-- * &#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#21029;&#29987;&#20986;&#38989;&#12398;&#25226;&#25569;</span><span>
</span><a name="line-4253"></a><span class="hs-comment">-----------------------------------------------------------</span><span>
</span><a name="line-4254"></a><span class="hs-keyword">type</span><span> </span><a name="IndustryInt"><a href="VTable.Compliation.html#IndustryInt"><span class="hs-identifier">IndustryInt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-4255"></a><span class="hs-keyword">type</span><span> </span><a name="CommodityInt"><a href="VTable.Compliation.html#CommodityInt"><span class="hs-identifier">CommodityInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-4256"></a><span>
</span><a name="line-4257"></a><span class="hs-comment">-- | &#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#12398;&#29987;&#20986;&#38989;&#12434;&#35352;&#37682;&#12375;&#12383;Array</span><span>
</span><a name="line-4258"></a><span class="hs-comment">--</span><span>
</span><a name="line-4259"></a><span class="hs-comment">-- &#34892;&#12364;&#29987;&#26989;&#65292; &#21015;&#12364;&#29983;&#29987;&#29289;</span><span>
</span><a name="line-4260"></a><span class="hs-keyword">type</span><span> </span><a name="IndCommArray"><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier">IndCommArray</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#IndustryInt"><span class="hs-identifier hs-type">IndustryInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#CommodityInt"><span class="hs-identifier hs-type">CommodityInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-4261"></a><span>
</span><a name="line-4262"></a><span class="hs-identifier">empICASmallDetail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span>
</span><a name="line-4263"></a><a name="empICASmallDetail"><a href="VTable.Compliation.html#empICASmallDetail"><span class="hs-identifier">empICASmallDetail</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">newArray</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Classification.html#numOf%7D30%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#32048;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-4264"></a><span>
</span><a name="line-4265"></a><span class="hs-comment">-- | Table&#12434;&#12381;&#12398;&#12414;&#12414;&#20986;&#21147;&#12377;&#12427;</span><span>
</span><a name="line-4266"></a><span class="hs-identifier">writeVTable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4267"></a><a name="writeVTable"><a href="VTable.Compliation.html#writeVTable"><span class="hs-identifier">writeVTable</span></a></a><span> </span><a name="local-6989586621679477395"><a href="#local-6989586621679477395"><span class="hs-identifier">outputFile</span></a></a><span> </span><a name="local-6989586621679477396"><a href="#local-6989586621679477396"><span class="hs-identifier">ica</span></a></a><span>
</span><a name="line-4268"></a><span>    </span><span class="hs-glyph">=</span><span>   </span><span class="hs-identifier hs-var">getBounds</span><span> </span><a href="#local-6989586621679477396"><span class="hs-identifier hs-var">ica</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679477397"><a href="#local-6989586621679477397"><span class="hs-identifier">start</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679477398"><a href="#local-6989586621679477398"><span class="hs-identifier">end</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-4269"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477399"><a href="#local-6989586621679477399"><span class="hs-identifier">maxSmallInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679477398"><span class="hs-identifier hs-var">end</span></a><span>
</span><a name="line-4270"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477400"><a href="#local-6989586621679477400"><span class="hs-identifier">maxDetaInt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679477398"><span class="hs-identifier hs-var">end</span></a><span>
</span><a name="line-4271"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">withFile</span><span> </span><a href="#local-6989586621679477395"><span class="hs-identifier hs-var">outputFile</span></a><span> </span><span class="hs-identifier hs-var">WriteMode</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477401"><a href="#local-6989586621679477401"><span class="hs-identifier">wHandle</span></a></a><span>
</span><a name="line-4272"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679477399"><span class="hs-identifier hs-var">maxSmallInt</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477402"><a href="#local-6989586621679477402"><span class="hs-identifier">smallInt</span></a></a><span>
</span><a name="line-4273"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">forM</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679477400"><span class="hs-identifier hs-var">maxDetaInt</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477403"><a href="#local-6989586621679477403"><span class="hs-identifier">detaInt</span></a></a><span>
</span><a name="line-4274"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">T.pack</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477396"><span class="hs-identifier hs-var">ica</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477402"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><a href="#local-6989586621679477403"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4275"></a><span>    </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">CSV.hPutCsvLn</span><span> </span><a href="#local-6989586621679477401"><span class="hs-identifier hs-var">wHandle</span></a><span>
</span><a name="line-4276"></a><span>
</span><a name="line-4277"></a><span>
</span><a name="line-4278"></a><span class="hs-keyword">type</span><span> </span><a name="IndustrySize"><a href="VTable.Compliation.html#IndustrySize"><span class="hs-identifier">IndustrySize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-4279"></a><span>
</span><a name="line-4280"></a><span class="hs-identifier">readTable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#IndustrySize"><span class="hs-identifier hs-type">IndustrySize</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#IndustrySize"><span class="hs-identifier hs-type">IndustrySize</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span>
</span><a name="line-4281"></a><a name="readTable"><a href="VTable.Compliation.html#readTable"><span class="hs-identifier">readTable</span></a></a><span> </span><a name="local-6989586621679477404"><a href="#local-6989586621679477404"><span class="hs-identifier">inputFile</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679477405"><a href="#local-6989586621679477405"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679477406"><a href="#local-6989586621679477406"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="VTable.Compliation.html#empICASmallDetail"><span class="hs-identifier hs-var">empICASmallDetail</span></a><span>  </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477407"><a href="#local-6989586621679477407"><span class="hs-identifier">ica</span></a></a><span>
</span><a name="line-4282"></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">withFile</span><span> </span><a href="#local-6989586621679477404"><span class="hs-identifier hs-var">inputFile</span></a><span> </span><span class="hs-identifier hs-var">ReadMode</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477408"><a href="#local-6989586621679477408"><span class="hs-identifier">rHandle</span></a></a><span>
</span><a name="line-4283"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477405"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477409"><a href="#local-6989586621679477409"><span class="hs-identifier">smallInt</span></a></a><span>
</span><a name="line-4284"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.head</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">parseCSVErr</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">TO.hGetLine</span><span> </span><a href="#local-6989586621679477408"><span class="hs-identifier hs-var">rHandle</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477410"><a href="#local-6989586621679477410"><span class="hs-identifier">line</span></a></a><span>
</span><a name="line-4285"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477406"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477411"><a href="#local-6989586621679477411"><span class="hs-identifier">detaInt</span></a></a><span>
</span><a name="line-4286"></a><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477407"><span class="hs-identifier hs-var">ica</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477409"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477411"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.Conversion.html#textToDouble"><span class="hs-identifier hs-var">VCC.textToDouble</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477410"><span class="hs-identifier hs-var">line</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679477411"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4287"></a><span>                        </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679477407"><span class="hs-identifier hs-var">ica</span></a><span>
</span><a name="line-4288"></a><span>
</span><a name="line-4289"></a><span>
</span><a name="line-4290"></a><span>
</span><a name="line-4291"></a><span class="hs-comment">{- |
V&#34920;&#12398;&#20316;&#25104;&#12395;&#21033;&#29992;&#12373;&#12428;&#12427;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#32068;&#26367;&#38598;&#35336;&#12399;&#65292;
&#12300;&#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#35519;&#26619;&#21697;&#30446;&#21029;&#22770;&#19978;&#38989;&#12301;&#21450;&#12403;&#65292;&#12300;&#20107;&#26989;&#25152;&#29987;&#26989;&#21029;&#12539;&#20107;&#26989;&#21029;&#22770;&#19978;&#38989;&#12301;&#12391;&#12354;&#12427;&#65294;

&#26412;&#31456;&#12391;&#23450;&#32681;&#12375;&#12390;&#12365;&#12383;&#35576;&#12293;&#12398;&#20966;&#29702;&#12434;&#32068;&#12415;&#21512;&#12431;&#12379;&#12427;&#12371;&#12392;&#12391;&#65292;
&#12475;&#12531;&#12469;&#12473;&#20998;&#39006;&#12395;&#12362;&#12369;&#12427;&#20107;&#26989;&#25152;&#21029;&#21830;&#21697;&#21029;&#29987;&#20986;&#38989;&#21450;&#12403;&#29987;&#26989;&#21029;&#21830;&#21697;&#21029;&#29987;&#20986;&#38989;&#12434;&#27714;&#12417;&#12427;&#12371;&#12392;&#12364;&#21487;&#33021;&#12392;&#12394;&#12427;&#65294;
&#22522;&#26412;&#30340;&#12395;&#12399;&#65292;&#20385;&#26684;&#22793;&#25563;&#65292;&#22312;&#24235;&#21697;&#35413;&#20385;&#35519;&#25972;&#65292;&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#29983;&#29987;&#37327;&#25226;&#25569;&#65292;&#20225;&#26989;&#12398;&#20107;&#26989;&#25152;&#12408;&#12398;&#20998;&#21106;&#65292;
&#12510;&#12540;&#12472;&#12531;&#25512;&#35336;&#12398;&#38918;&#12395;&#20966;&#29702;&#12434;&#34892;&#12356;&#65292;&#21103;&#26989;&#12398;&#20998;&#35299;&#12434;&#12377;&#12427;&#12371;&#12392;&#12391;&#65292;&#20107;&#26989;&#25152;&#21029;&#21830;&#21697;&#29987;&#20986;&#38989;&#12364;&#27714;&#12417;&#12425;&#12428;&#65292;
&#20107;&#26989;&#25152;&#21029;&#21830;&#21697;&#29987;&#20986;&#38989;&#12434;&#29987;&#26989;&#21029;&#12395;&#38598;&#35336;&#12377;&#12427;&#12371;&#12392;&#12391;&#65292;&#29987;&#26989;&#21029;&#21830;&#21697;&#21029;&#29987;&#20986;&#38989;&#12364;&#27714;&#12417;&#12425;&#12428;&#12427;&#65294;
-}</span><span>
</span><a name="line-4301"></a><span>
</span><a name="line-4302"></a><span class="hs-identifier">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679475891"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="VTable.Compliation.html#CTMultiplier"><span class="hs-identifier hs-type">CTMultiplier</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConduitT</span><span> </span><a href="VTable.Data.Structure.html#IOCensusRow"><span class="hs-identifier hs-type">IOCensusRow</span></a><span> </span><span class="hs-identifier hs-type">Void</span><span> </span><a href="#local-6989586621679475891"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span>
</span><a name="line-4303"></a><a name="f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D"><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D"><span class="hs-identifier">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;</span></a></a><span> </span><a name="local-6989586621679477412"><a href="#local-6989586621679477412"><span class="hs-identifier">ctm</span></a></a><span> </span><a name="local-6989586621679477413"><a href="#local-6989586621679477413"><span class="hs-identifier">ica</span></a></a><span>
</span><a name="line-4304"></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">await</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477422"><a href="#local-6989586621679477422"><span class="hs-identifier">maybeIcr</span></a></a><span>
</span><a name="line-4305"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477422"><span class="hs-identifier hs-var">maybeIcr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4306"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477414"><span class="hs-identifier hs-var">multipleICA</span></a><span> </span><a href="#local-6989586621679477412"><span class="hs-identifier hs-var">ctm</span></a><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span>
</span><a name="line-4307"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477423"><a href="#local-6989586621679477423"><span class="hs-identifier">icr</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477423"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-var">H&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477424"><a href="#local-6989586621679477424"><span class="hs-identifier">valComm</span></a></a><span>
</span><a name="line-4308"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477423"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">H&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-special">)</span><span>              </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477425"><a href="#local-6989586621679477425"><span class="hs-identifier">valClas</span></a></a><span>
</span><a name="line-4309"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477423"><span class="hs-identifier hs-var">icr</span></a><span> </span><a href="VTable.Data.Structure.html#H%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">H&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span class="hs-special">)</span><span>           </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477426"><a href="#local-6989586621679477426"><span class="hs-identifier">valKind</span></a></a><span>
</span><a name="line-4310"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477426"><span class="hs-identifier hs-var">valKind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4311"></a><span>                      </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;</span></a><span> </span><a href="#local-6989586621679477412"><span class="hs-identifier hs-var">ctm</span></a><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span>
</span><a name="line-4312"></a><span>                      </span><a href="VTable.Data.Structure.html#V%8ABF%67FB%7968%306E%7A2E%985E"><span class="hs-identifier hs-var">V&#35519;&#26619;&#31080;&#12398;&#31278;&#39006;</span></a><span> </span><a name="local-6989586621679477427"><a href="#local-6989586621679477427"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Compliation.html#correctPair"><span class="hs-identifier hs-var">correctPair</span></a><span> </span><a href="#local-6989586621679477427"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- &#20225;&#26989;&#35519;&#26619;&#31080;&#31561;&#12398;&#20516;&#12434;&#25244;&#12367;</span><span>
</span><a name="line-4313"></a><span>                                              </span><a href="VTable.Compliation.html#EN"><span class="hs-identifier hs-var">EN</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D%51E6%7406"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span> </span><a href="#local-6989586621679477424"><span class="hs-identifier hs-var">valComm</span></a><span> </span><a href="#local-6989586621679477425"><span class="hs-identifier hs-var">valClas</span></a><span class="hs-special">)</span><span>
</span><a name="line-4314"></a><span>                                                    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;</span></a><span> </span><a href="#local-6989586621679477412"><span class="hs-identifier hs-var">ctm</span></a><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span>
</span><a name="line-4315"></a><span>                                              </span><a href="VTable.Compliation.html#ES"><span class="hs-identifier hs-var">ES</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D%51E6%7406"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;&#20966;&#29702;</span></a><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span> </span><a href="#local-6989586621679477424"><span class="hs-identifier hs-var">valComm</span></a><span> </span><a href="#local-6989586621679477425"><span class="hs-identifier hs-var">valClas</span></a><span class="hs-special">)</span><span>
</span><a name="line-4316"></a><span>                                                    </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;</span></a><span> </span><a href="#local-6989586621679477412"><span class="hs-identifier hs-var">ctm</span></a><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span>
</span><a name="line-4317"></a><span>                                              </span><a href="VTable.Compliation.html#Wrong"><span class="hs-identifier hs-var">Wrong</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D"><span class="hs-identifier hs-var">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;</span></a><span> </span><a href="#local-6989586621679477412"><span class="hs-identifier hs-var">ctm</span></a><span> </span><a href="#local-6989586621679477413"><span class="hs-identifier hs-var">ica</span></a><span>
</span><a name="line-4318"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-4319"></a><span>    </span><span class="hs-identifier">multipleICA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#CTMultiplier"><span class="hs-identifier hs-type">CTMultiplier</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4320"></a><span>    </span><a name="local-6989586621679477414"><a href="#local-6989586621679477414"><span class="hs-identifier">multipleICA</span></a></a><span> </span><a name="local-6989586621679477415"><a href="#local-6989586621679477415"><span class="hs-identifier">ctm</span></a></a><span> </span><a name="local-6989586621679477416"><a href="#local-6989586621679477416"><span class="hs-identifier">ica</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477417"><a href="#local-6989586621679477417"><span class="hs-identifier">ctmList</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">Map.toList</span><span> </span><a href="#local-6989586621679477415"><span class="hs-identifier hs-var">ctm</span></a><span>
</span><a name="line-4321"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">CMP.forM_</span><span> </span><a href="#local-6989586621679477417"><span class="hs-identifier hs-var">ctmList</span></a><span>     </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679477418"><a href="#local-6989586621679477418"><span class="hs-identifier">smallInt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477419"><a href="#local-6989586621679477419"><span class="hs-identifier">multi</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-4322"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">CMP.forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%7D30%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#32048;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477420"><a href="#local-6989586621679477420"><span class="hs-identifier">detaInt</span></a></a><span>
</span><a name="line-4323"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477416"><span class="hs-identifier hs-var">ica</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477418"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477420"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477421"><a href="#local-6989586621679477421"><span class="hs-identifier">cv</span></a></a><span>
</span><a name="line-4324"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477416"><span class="hs-identifier hs-var">ica</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477418"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477420"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477421"><span class="hs-identifier hs-var">cv</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679477419"><span class="hs-identifier hs-var">multi</span></a><span class="hs-special">)</span><span>
</span><a name="line-4325"></a><span>
</span><a name="line-4326"></a><span>
</span><a name="line-4327"></a><span class="hs-identifier">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;&#20966;&#29702;</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%4E8B%696D%6240%5225%751F%7523%7269%5225%58F2%4E0A%9AD8"><span class="hs-identifier hs-type">Val&#20107;&#26989;&#25152;&#21029;&#29983;&#29987;&#29289;&#21029;&#22770;&#19978;&#39640;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Val%7523%696D%683C%4ED8"><span class="hs-identifier hs-type">Val&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4328"></a><a name="f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D%51E6%7406"><a href="VTable.Compliation.html#f%7523%696D%5225%751F%7523%7269%5225%7523%51FA%984D%51E6%7406"><span class="hs-identifier">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;&#20966;&#29702;</span></a></a><span> </span><a name="local-6989586621679477428"><a href="#local-6989586621679477428"><span class="hs-identifier">ica</span></a></a><span> </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>         </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4329"></a><span class="hs-identifier">f&#29987;&#26989;&#21029;&#29983;&#29987;&#29289;&#21029;&#29987;&#20986;&#38989;&#20966;&#29702;</span><span> </span><a name="local-6989586621679477429"><a href="#local-6989586621679477429"><span class="hs-identifier">ica</span></a></a><span> </span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#VCars"><span class="hs-identifier hs-var">VCars</span></a><span> </span><a name="local-6989586621679477430"><a href="#local-6989586621679477430"><span class="hs-identifier">comm</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679477431"><a href="#local-6989586621679477431"><span class="hs-identifier">valClass</span></a></a><span>
</span><a name="line-4330"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477431"><span class="hs-identifier hs-var">valClass</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4331"></a><span>        </span><a href="VTable.Data.Structure.html#Null"><span class="hs-identifier hs-var">Null</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477440"><a href="#local-6989586621679477440"><span class="hs-identifier">smallInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><span class="hs-string">&quot;&#9651;&#9651;&#9651;&quot;</span><span>       </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679477432"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679477429"><span class="hs-identifier hs-var">ica</span></a><span> </span><a href="#local-6989586621679477440"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><a href="#local-6989586621679477430"><span class="hs-identifier hs-var">comm</span></a><span>
</span><a name="line-4332"></a><span>        </span><a href="VTable.Data.Structure.html#V%7523%696D%683C%4ED8"><span class="hs-identifier hs-var">V&#29987;&#26989;&#26684;&#20184;</span></a><span> </span><a name="local-6989586621679477441"><a href="#local-6989586621679477441"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477442"><a href="#local-6989586621679477442"><span class="hs-identifier">smallInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_&#23567;&#20998;&#39006;</span><span> </span><a href="#local-6989586621679477441"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679477432"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679477429"><span class="hs-identifier hs-var">ica</span></a><span> </span><a href="#local-6989586621679477442"><span class="hs-identifier hs-var">smallInt</span></a><span> </span><a href="#local-6989586621679477430"><span class="hs-identifier hs-var">comm</span></a><span>
</span><a name="line-4333"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-4334"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VTable.Compliation.html#IndCommArray"><span class="hs-identifier hs-type">IndCommArray</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Structure.html#Cars"><span class="hs-identifier hs-type">Cars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4335"></a><span>        </span><a name="local-6989586621679477432"><a href="#local-6989586621679477432"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679477433"><a href="#local-6989586621679477433"><span class="hs-identifier">ica</span></a></a><span> </span><a name="local-6989586621679477434"><a href="#local-6989586621679477434"><span class="hs-identifier">smallInt</span></a></a><span> </span><a name="local-6989586621679477435"><a href="#local-6989586621679477435"><span class="hs-identifier">comm</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">V.forM_</span><span> </span><a href="#local-6989586621679477435"><span class="hs-identifier hs-var">comm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="VTable.Data.Structure.html#Car"><span class="hs-identifier hs-var">Car</span></a><span> </span><a name="local-6989586621679477436"><a href="#local-6989586621679477436"><span class="hs-identifier">va</span></a></a><span> </span><a name="local-6989586621679477437"><a href="#local-6989586621679477437"><span class="hs-identifier">na</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-4336"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477438"><a href="#local-6989586621679477438"><span class="hs-identifier">detaInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#deta2Int"><span class="hs-identifier hs-var">deta2Int</span></a><span> </span><a href="#local-6989586621679477437"><span class="hs-identifier hs-var">na</span></a><span>
</span><a name="line-4337"></a><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477433"><span class="hs-identifier hs-var">ica</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477434"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477438"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477439"><a href="#local-6989586621679477439"><span class="hs-identifier">cv</span></a></a><span>
</span><a name="line-4338"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477433"><span class="hs-identifier hs-var">ica</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477434"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477438"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477439"><span class="hs-identifier hs-var">cv</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477436"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">)</span><span>
</span><a name="line-4339"></a><span>
</span><a name="line-4340"></a><span>
</span><a name="line-4341"></a><span>
</span><a name="line-4342"></a><span>
</span><a name="line-4343"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-4344"></a><span class="hs-comment">-- * &#37096;&#38272;&#21517;&#12398;&#22793;&#25563; (&#12475;&#12531;&#12469;&#12473;&#20998;&#39006;&#12363;&#12425;IO&#20998;&#39006;&#12408;&#12398;&#22793;&#25563;)</span><span>
</span><a name="line-4345"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-4346"></a><span>
</span><a name="line-4347"></a><span class="hs-comment">{- |
&#29987;&#26989;&#26684;&#20184;&#12369;Null&#12398;&#22580;&#21512; &#26684;&#20184;&#12369;&#19981;&#26126;&#12408;&#25391;&#26367;

&#37096;&#38272;&#20869;&#26684;&#20184;&#12369;&#19981;&#26126;&#21450;&#12403;,&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12399;,&#20840;&#12390;&#36817;&#38563;&#37096;&#38272;&#12395;&#27604;&#20363;&#25353;&#20998;&#12377;&#12427;(&#12393;&#12398;&#12424;&#12358;&#12395;&#20966;&#29702;&#12375;&#12390;&#12356;&#12427;&#12398;&#12363;&#19981;&#26126;.)

&#12367;&#12377;&#12441;&#12539;&#24259;&#29289;
7466 00 &#35069;&#36896;&#24037;&#31243;&#12363;&#12425;&#12390;&#12441;&#12383;&#12367;&#12377;&#12441;&#12539;&#24259;&#29289;

&#12395;&#38306;&#12375;&#12390; &#35069;&#36896;&#26989;&#12398;&#27573;&#38542;&#12391;&#30330;&#29983;&#37096;&#38272;&#12395;&#25391;&#12426;&#20998;&#12369;



&#12414;&#12383;&#65292;&#23633;&#12539;&#21103;&#29987;&#29289;&#12395;&#38306;&#12375;&#12390;&#12399;&#65292;&#21462;&#24341;&#22522;&#26412;&#34920;&#12395;&#12362;&#12369;&#12427;&#23633;&#12539;&#21103;&#29987;&#29289;&#30330;&#29983;&#37096;&#38272;&#12434;V&#34920;&#29987;&#26989;&#20998;&#39006;&#12408;&#32068;&#26367;&#12360;&#65292;&#12381;&#12398;&#20516;&#12434;&#12475;&#12531;&#12469;&#12473;&#12363;&#12425;&#27714;&#12417;&#12425;&#12428;&#12383;&#29987;&#26989;&#215;&#21830;&#21697;&#34920;&#12398;&#24403;&#35442;&#20132;&#28857;&#12395;&#35336;&#19978;&#12375;&#12390;&#12356;&#12427;&#65294;

 &#26412;&#31295;&#12391;&#12399;V&#34920;&#12398;&#20316;&#25104;&#12399;&#22823;&#12414;&#12363;&#12395;&#65292;&#20197;&#19979;&#9312;~&#9316;&#12398;&#20316;&#26989;&#12434;&#24819;&#23450;&#12375;&#12390;&#12356;&#12427;&#65294;
&#12394;&#12362;&#65292;&#29694;&#34892;&#12398;V&#34920;&#12398;&#20316;&#25104;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#23633;&#65292;&#21103;&#29987;&#29289;&#12398;&#25512;&#35336;&#12395;&#12362;&#12356;&#12390;&#21462;&#24341;&#22522;&#26412;&#34920;&#12434;&#32076;&#30001;&#12375;&#12390;&#12362;&#12426;&#65292;&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#20197;&#22806;&#12398;&#21508;&#31278;&#22522;&#30990;&#32113;&#35336;&#20516;&#12418;&#12381;&#12398;&#25512;&#35336;&#12395;&#21033;&#29992;&#12375;&#12390;&#12356;&#12427;&#65294;
 &#26412;&#30740;&#31350;&#12399;&#65292;&#39165;&#12367;&#12414;&#12391;&#21516;&#19968;&#12487;&#12540;&#12479;&#12434;&#21033;&#29992;&#12377;&#12427;&#12371;&#12392;&#12391;&#25512;&#35336;&#25163;&#27861;&#27598;&#12398;&#24046;&#30064;&#12434;&#20998;&#26512;&#12377;&#12427;&#12371;&#12392;&#12434;&#30446;&#30340;&#12392;&#12375;&#12390;&#12362;&#12426;&#65292;&#12475;&#12531;&#12469;&#12473;&#12487;&#12540;&#12479;&#12363;&#12425;&#30452;&#25509;&#30340;&#12395;&#20516;&#12434;&#27083;&#25104;&#12377;&#12427;&#12392;&#12356;&#12358;&#28857;&#12391;&#65292;
&#25512;&#35336;&#25163;&#27861;&#12364;&#29694;&#34892;&#12398;&#12418;&#12398;&#12392;&#12399;&#30064;&#12394;&#12427;&#65294;
&#24190;&#12388;&#12363;&#12398;&#35036;&#36275;&#12391;&#12365;&#12394;&#12356;&#27010;&#24565;&#31561;&#12418;&#12381;&#12398;&#12414;&#12414;&#26410;&#25226;&#25569;&#12392;&#12375;&#12390;&#25201;&#12356;&#65292;&#22823;&#12365;&#12394;&#38917;&#30446;&#12395;&#12388;&#12356;&#12390;&#12399;&#20182;&#12398;&#32113;&#35336;&#12434;&#29992;&#12356;&#12390;&#31777;&#26131;&#30340;&#12395;&#25512;&#35336;&#12377;&#12427;&#12394;&#12393;&#65292;&#31777;&#26131;&#30340;&#20316;&#25104;&#25163;&#27861;&#12434;&#25505;&#29992;&#12377;&#12427;&#65294;

-}</span><span>
</span><a name="line-4368"></a><span>
</span><a name="line-4369"></a><span>
</span><a name="line-4370"></a><span>
</span><a name="line-4371"></a><span class="hs-comment">-- | &#32048;&#20998;&#39006; -&gt; &#23567;&#20998;&#39006;&#12408;&#12398;&#25391;&#26367;</span><span>
</span><a name="line-4372"></a><span class="hs-identifier">f&#32048;&#20998;&#39006;&#25391;&#26367;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#DetaInt"><span class="hs-identifier hs-type">DetaInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-4373"></a><a name="f%7D30%5206%985E%632F%66FF"><a href="VTable.Compliation.html#f%7D30%5206%985E%632F%66FF"><span class="hs-identifier">f&#32048;&#20998;&#39006;&#25391;&#26367;</span></a></a><span> </span><a name="local-6989586621679477443"><a href="#local-6989586621679477443"><span class="hs-identifier">sd</span></a></a><span>  </span><span class="hs-glyph">=</span><span>   </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">newArray</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477444"><a href="#local-6989586621679477444"><span class="hs-identifier">initial</span></a></a><span>
</span><a name="line-4374"></a><span>                </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679477445"><a href="#local-6989586621679477445"><span class="hs-identifier">smallInt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-4375"></a><span>                        </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%7D30%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#32048;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477446"><a href="#local-6989586621679477446"><span class="hs-identifier">detaInt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-4376"></a><span>                            </span><span class="hs-keyword">case</span><span> </span><a href="VTable.Data.Classification.html#elevateStratum"><span class="hs-identifier hs-var">elevateStratum</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#int2Deta"><span class="hs-identifier hs-var">int2Deta</span></a><span> </span><a href="#local-6989586621679477446"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#Small"><span class="hs-identifier hs-var">Small</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4377"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;f&#32048;&#20998;&#39006;&#25391;&#26367;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#int2Deta"><span class="hs-identifier hs-var">int2Deta</span></a><span> </span><a href="#local-6989586621679477446"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4378"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477447"><a href="#local-6989586621679477447"><span class="hs-identifier">newSmall</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477448"><a href="#local-6989586621679477448"><span class="hs-identifier">newSmallInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477447"><span class="hs-identifier hs-var">newSmall</span></a><span>
</span><a name="line-4379"></a><span>                                                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477443"><span class="hs-identifier hs-var">sd</span></a><span>      </span><span class="hs-special">(</span><a href="#local-6989586621679477445"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477446"><span class="hs-identifier hs-var">detaInt</span></a><span class="hs-special">)</span><span>     </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477449"><a href="#local-6989586621679477449"><span class="hs-identifier">tempDetaVal</span></a></a><span>
</span><a name="line-4380"></a><span>                                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477444"><span class="hs-identifier hs-var">initial</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477445"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477448"><span class="hs-identifier hs-var">newSmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477450"><a href="#local-6989586621679477450"><span class="hs-identifier">tempSmallVal</span></a></a><span>
</span><a name="line-4381"></a><span>                                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477444"><span class="hs-identifier hs-var">initial</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477445"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477448"><span class="hs-identifier hs-var">newSmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477449"><span class="hs-identifier hs-var">tempDetaVal</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477450"><span class="hs-identifier hs-var">tempSmallVal</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4382"></a><span>                </span><span class="hs-operator hs-var">&gt;&gt;</span><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679477444"><span class="hs-identifier hs-var">initial</span></a><span>
</span><a name="line-4383"></a><span>
</span><a name="line-4384"></a><span>
</span><a name="line-4385"></a><span>
</span><a name="line-4386"></a><span>
</span><a name="line-4387"></a><span class="hs-comment">{- |  f&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#25391;&#26367;, f&#26684;&#20184;&#12369;&#19981;&#33021;&#25391;&#26367;&#12395;&#20351;&#29992;

&#27604;&#20363;&#25353;&#20998;&#12377;&#12427;&#12364;, &#37197;&#20998;&#20808;&#12398;&#20516;&#12364;0&#12398;&#22580;&#21512;&#12399;&#31561;&#20998;&#12377;&#12427;

&#25391;&#26367;&#20808;&#12364;&#20840;&#12390;0&#12384;&#12387;&#12383;&#22580;&#21512;&#31561;&#20998;&#12377;&#12427;&#12392;,&#12411;&#12412;&#20840;&#12390;&#12398;&#12475;&#12523;&#12395;&#20516;&#12364;&#20837;&#12387;&#12390;&#12375;&#12414;&#12358;.

&#25391;&#26367;&#20808;&#12364;&#20840;&#12390;0&#12384;&#12387;&#12383;&#22580;&#21512;&#12395;&#12399;,&#12381;&#12398;&#21830;&#21697;/&#29987;&#26989;&#25353;&#20998;&#20808;&#12398;&#12398;&#33258;&#20132;&#28857;&#12395;&#39131;&#12400;&#12377;.

&#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#20998;&#39006;&#12391;&#12399;, V&#34920;&#12398;&#20998;&#39006;&#12395;&#12362;&#12369;&#12427;&#65378;111 &#20998;&#39006;&#19981;&#26126;&#65379;&#12398;&#12424;&#12358;&#12395;&#20998;&#39006;&#20840;&#20307;&#12395;
&#12362;&#12369;&#12427;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#20182;&#12395;, &#65378;&#36786;&#26519;&#27700;&#29987;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#65379;, &#65378;&#32789;&#31278;&#36786;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#65379;&#12398;&#12424;&#12358;&#12395;&#24190;&#12388;&#12363;&#12398;&#27573;&#38542;&#21029;&#12395;&#26684;&#20184;&#12369;&#19981;&#33021;&#12364;&#23384;&#22312;&#12377;&#12427;.
&#12371;&#12428;&#12425;&#12398;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#27573;&#38542;&#12364;,V&#34920;&#12398;&#20998;&#39006;&#12424;&#12426;&#12418;&#32048;&#12363;&#12356;&#22580;&#21512;&#12395;&#12399;,&#23550;&#24540;&#12377;&#12427;V&#34920;&#12398;&#20998;&#39006;&#12395;&#12381;&#12398;&#20516;&#12434;&#35336;&#19978;&#12377;&#12427;&#12371;&#12392;&#12364;&#21487;&#33021;&#12391;&#12354;&#12427;&#12364;,
&#65378;&#36786;&#26519;&#27700;&#29987;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#65379;&#12394;&#12393;&#12399;, V&#34920;&#12398;&#37096;&#38272;&#12395;&#25391;&#12426;&#20998;&#12369;&#12427;&#20197;&#21069;&#12395;, &#32076;&#28168;&#12475;&#12531;&#12469;&#12473;&#12395;&#12362;&#12369;&#12427;&#20182;&#12398;&#37096;&#38272;&#12395;&#20107;&#21069;&#12395;&#25391;&#12426;&#20998;&#12369;&#12427;&#24517;&#35201;&#24615;&#12364;&#12354;&#12427;
   &#26412;&#31295;&#12391;&#12399;, &#12381;&#12428;&#12425;&#12398;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#21830;&#21697;&#21450;&#12403;&#29987;&#26989;&#12395;&#23550;&#12375;&#12390;,&#65378;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#25391;&#26367;&#20808;&#12392;&#24819;&#23450;&#12373;&#12428;&#12427;&#20505;&#35036;&#65379;(&#65378;&#36786;&#26519;&#27700;&#29987;&#26989;&#20869;&#26684;&#20184;&#12369;&#19981;&#33021;&#65379;&#12395;&#23550;&#12375;&#12390;,
   &#65378;&#32789;&#31278;&#36786;&#26989;&#65379;,&#65378;&#30044;&#29987;&#65379;,&#65378;&#36786;&#26989;&#12469;&#12540;&#12499;&#12473;&#65379;,&#65378;&#26519;&#26989;&#65379;,&#65378;&#28417;&#26989;&#65379;&#12394;&#12393;)&#12434;&#36984;&#23450;&#12375;,&#12381;&#12428;&#12425;&#12398;&#37096;&#38272;&#12395;&#35336;&#19978;&#12373;&#12428;&#12390;&#12356;&#12427;&#20516;&#12395;&#27604;&#20363;&#12375;&#12390;&#25353;&#20998;&#12375;&#12390;&#12356;&#12427;.
&#12375;&#12363;&#12375;, &#65378;&#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#25391;&#26367;&#20808;&#12392;&#24819;&#23450;&#12373;&#12428;&#12427;&#20505;&#35036;&#65379;&#12398;&#25391;&#12426;&#20998;&#12369;&#21069;&#12398;&#20516;&#12364;&#20840;&#12390;0&#12391;&#12354;&#12387;&#12383;&#22580;&#21512;&#12399;,
&#12381;&#12428;&#12425;&#12398;&#12475;&#12523;&#12395;&#25353;&#20998;&#12399;&#12379;&#12378;,&#12381;&#12398;&#25391;&#12426;&#20998;&#12369;&#20808;&#12398;&#29987;&#26989;,&#21830;&#21697;&#12398;&#33258;&#20132;&#28857;&#12395;&#31561;&#20998;&#12375;&#12390;&#35336;&#19978;&#12375;&#12390;&#12356;&#12427;.
&#12371;&#12398;&#20966;&#29702;&#12395;&#12424;&#12387;&#12390;,&#24190;&#12388;&#12363;&#12398;&#37096;&#38272;&#12398;&#33258;&#20132;&#28857;&#12398;&#20516;&#12364;&#23455;&#38555;&#12398;&#20516;&#12424;&#12426;&#12418;&#36942;&#21104;&#12395;&#12394;&#12427;&#12371;&#12392;&#12364;&#20104;&#24819;&#12373;&#12428;&#12427;&#28857;&#12395;&#30041;&#24847;&#12373;&#12428;&#12383;&#12356;.
 &#33258;&#20132;&#28857;&#12395;&#25391;&#12426;&#20998;&#12369;&#12427;&#38555;&#12395;&#12418;,&#26412;&#26469;&#12391;&#12354;&#12428;&#12400;&#31561;&#20998;&#12434;&#34892;&#12358;&#12424;&#12426;&#12418;,&#27604;&#20363;&#25353;&#20998;&#12434;&#34892;&#12358;&#26041;&#12364;&#12424;&#12426;&#27491;&#30906;&#12394;&#12418;&#12398;&#12392;&#12394;&#12427;&#12371;&#12392;&#12364;&#20104;&#24819;&#12373;&#12428;&#12427;&#12364;,
 &#33258;&#20132;&#28857;&#12398;&#20516;&#12364;0&#12391;&#12354;&#12387;&#12383;&#22580;&#21512;&#12395;&#21029;&#12398;&#20516;&#12434;&#21442;&#29031;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12426;,&#12381;&#12398;&#21442;&#29031;&#20516;&#12364;0&#12391;&#20250;&#12387;&#12383;&#22580;&#21512;&#12395;&#12392;&#20999;&#12426;&#12364;&#12394;&#12367;&#12394;&#12427;&#12383;&#12417;,&#12371;&#12398;&#12424;&#12358;&#12394;&#20966;&#29702;&#12392;&#12394;&#12387;&#12383;.


-}</span><span>
</span><a name="line-4409"></a><span>
</span><a name="line-4410"></a><span class="hs-identifier">f&#36817;&#38563;&#37096;&#38272;&#25391;&#26367;</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-4411"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span> </span><span class="hs-special">[</span><a href="VTable.Data.Classification.html#Industry"><span class="hs-identifier hs-type">Industry</span></a><span class="hs-special">]</span><span>
</span><a name="line-4412"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4413"></a><a name="f%8FD1%96A3%90E8%9580%632F%66FF"><a href="VTable.Compliation.html#f%8FD1%96A3%90E8%9580%632F%66FF"><span class="hs-identifier">f&#36817;&#38563;&#37096;&#38272;&#25391;&#26367;</span></a></a><span> </span><a name="local-6989586621679477451"><a href="#local-6989586621679477451"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679477452"><a href="#local-6989586621679477452"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4414"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477453"><a href="#local-6989586621679477453"><span class="hs-identifier">ks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.keys</span><span> </span><a href="#local-6989586621679477452"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-4415"></a><span>    </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477453"><span class="hs-identifier hs-var">ks</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477454"><a href="#local-6989586621679477454"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#23567;&#20998;&#39006;</span><span>
</span><a name="line-4416"></a><span>        </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477455"><a href="#local-6989586621679477455"><span class="hs-identifier">smallInt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- &#34892;&#12434;&#20998;&#37197;</span><span>
</span><a name="line-4417"></a><span>                </span><a name="local-6989586621679477456"><a href="#local-6989586621679477456"><span class="hs-identifier">tempSum</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-4418"></a><span>                </span><a name="local-6989586621679477457"><a href="#local-6989586621679477457"><span class="hs-identifier">tempDistVal</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477455"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#20998;&#37197;&#12373;&#12428;&#12427;&#12354;&#12427;&#29987;&#26989;(smallInt)&#12398;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;(k)</span><span>
</span><a name="line-4419"></a><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477457"><span class="hs-identifier hs-var">tempDistVal</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4420"></a><span>                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4421"></a><span>                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4422"></a><span>                        </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477455"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-comment">-- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#23567;&#20998;&#39006;&#20998;&#37197;&#12373;&#12428;&#12427;&#12398;&#12391;&#65296;&#32622;&#12365;</span><span>
</span><a name="line-4423"></a><span>                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477458"><a href="#local-6989586621679477458"><span class="hs-identifier">maybeVs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679477452"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-4424"></a><span>                        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477458"><span class="hs-identifier hs-var">maybeVs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4425"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;&#36817;&#38563;&#37096;&#38272;&#25391;&#26367;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">(</span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;&#35442;&#24403;&#12377;&#12427;&#37096;&#38272;&#12364;&#12354;&#12426;&#12414;&#12379;&#12435;.&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4426"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477459"><a href="#local-6989586621679477459"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4427"></a><span>                                </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477459"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477460"><a href="#local-6989586621679477460"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4428"></a><span>                                    </span><a name="local-6989586621679477461"><a href="#local-6989586621679477461"><span class="hs-identifier">temp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477455"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477460"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#29987;&#26989;smallInt&#12398;&#20998;&#37197;&#20808; v</span><span>
</span><a name="line-4429"></a><span>                                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477461"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4430"></a><span>                                        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4431"></a><span>                                        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477456"><span class="hs-identifier hs-var">tempSum</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477461"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4432"></a><span>
</span><a name="line-4433"></a><span>                                </span><a name="local-6989586621679477462"><a href="#local-6989586621679477462"><span class="hs-identifier">forDiv</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477456"><span class="hs-identifier hs-var">tempSum</span></a><span>
</span><a name="line-4434"></a><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477462"><span class="hs-identifier hs-var">forDiv</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4435"></a><span>                                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477463"><a href="#local-6989586621679477463"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679477459"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span>
</span><a name="line-4436"></a><span>                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477459"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477464"><a href="#local-6989586621679477464"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477464"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477464"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477465"><a href="#local-6989586621679477465"><span class="hs-identifier">temp</span></a></a><span>
</span><a name="line-4437"></a><span>                                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477464"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477464"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477465"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477457"><span class="hs-identifier hs-var">tempDistVal</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477463"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4438"></a><span>
</span><a name="line-4439"></a><span>                                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477459"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477466"><a href="#local-6989586621679477466"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4440"></a><span>                                        </span><a name="local-6989586621679477467"><a href="#local-6989586621679477467"><span class="hs-identifier">temp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477455"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477466"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-4441"></a><span>                                        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477467"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4442"></a><span>                                            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4443"></a><span>                                            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477455"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477466"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477467"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477457"><span class="hs-identifier hs-var">tempDistVal</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477467"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477462"><span class="hs-identifier hs-var">forDiv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4444"></a><span>
</span><a name="line-4445"></a><span>        </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477468"><a href="#local-6989586621679477468"><span class="hs-identifier">smallInt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- &#34892;&#12434;&#20998;&#37197;</span><span>
</span><a name="line-4446"></a><span>                </span><a name="local-6989586621679477469"><a href="#local-6989586621679477469"><span class="hs-identifier">tempSum</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newIORef</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-4447"></a><span>                </span><a name="local-6989586621679477470"><a href="#local-6989586621679477470"><span class="hs-identifier">tempDistVal</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477468"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#20998;&#37197;&#12373;&#12428;&#12427;&#12354;&#12427;&#29987;&#26989;(smallInt)&#12398;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;(k)</span><span>
</span><a name="line-4448"></a><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477470"><span class="hs-identifier hs-var">tempDistVal</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4449"></a><span>                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4450"></a><span>                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4451"></a><span>                        </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477468"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-comment">-- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#23567;&#20998;&#39006;&#20998;&#37197;&#12373;&#12428;&#12427;&#12398;&#12391;&#65296;&#32622;&#12365;</span><span>
</span><a name="line-4452"></a><span>                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477471"><a href="#local-6989586621679477471"><span class="hs-identifier">maybeVs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679477452"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-4453"></a><span>                        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679477471"><span class="hs-identifier hs-var">maybeVs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4454"></a><span>                            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;&#36817;&#38563;&#37096;&#38272;&#25391;&#26367;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">(</span><a href="#local-6989586621679477454"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;&#35442;&#24403;&#12377;&#12427;&#37096;&#38272;&#12364;&#12354;&#12426;&#12414;&#12379;&#12435;.&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4455"></a><span>                            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477472"><a href="#local-6989586621679477472"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4456"></a><span>                                </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477472"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477473"><a href="#local-6989586621679477473"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4457"></a><span>                                    </span><a name="local-6989586621679477474"><a href="#local-6989586621679477474"><span class="hs-identifier">temp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477473"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477468"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &#29987;&#26989;smallInt&#12398;&#20998;&#37197;&#20808; v</span><span>
</span><a name="line-4458"></a><span>                                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477474"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4459"></a><span>                                        </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4460"></a><span>                                        </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">modifyIORef'</span><span> </span><a href="#local-6989586621679477469"><span class="hs-identifier hs-var">tempSum</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477474"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4461"></a><span>
</span><a name="line-4462"></a><span>                                </span><a name="local-6989586621679477475"><a href="#local-6989586621679477475"><span class="hs-identifier">forDiv</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readIORef</span><span> </span><a href="#local-6989586621679477469"><span class="hs-identifier hs-var">tempSum</span></a><span>
</span><a name="line-4463"></a><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477475"><span class="hs-identifier hs-var">forDiv</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4464"></a><span>                                    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477476"><a href="#local-6989586621679477476"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.length</span><span> </span><a href="#local-6989586621679477472"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span>
</span><a name="line-4465"></a><span>                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477472"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477477"><a href="#local-6989586621679477477"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477477"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477477"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477478"><a href="#local-6989586621679477478"><span class="hs-identifier">temp</span></a></a><span>
</span><a name="line-4466"></a><span>                                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477477"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477477"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477478"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477470"><span class="hs-identifier hs-var">tempDistVal</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477476"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4467"></a><span>
</span><a name="line-4468"></a><span>                                    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><a href="#local-6989586621679477472"><span class="hs-identifier hs-var">vs</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477479"><a href="#local-6989586621679477479"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-4469"></a><span>                                        </span><a name="local-6989586621679477480"><a href="#local-6989586621679477480"><span class="hs-identifier">temp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477479"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477468"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">)</span><span>
</span><a name="line-4470"></a><span>                                        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477480"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4471"></a><span>                                            </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4472"></a><span>                                            </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477451"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#small2Int"><span class="hs-identifier hs-var">small2Int</span></a><span> </span><a href="#local-6989586621679477479"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477468"><span class="hs-identifier hs-var">smallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477480"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477470"><span class="hs-identifier hs-var">tempDistVal</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477480"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679477475"><span class="hs-identifier hs-var">forDiv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4473"></a><span>
</span><a name="line-4474"></a><span>
</span><a name="line-4475"></a><span>
</span><a name="line-4476"></a><span>
</span><a name="line-4477"></a><span class="hs-comment">-- | &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#25391;&#26367;</span><span>
</span><a name="line-4478"></a><span class="hs-comment">--</span><span>
</span><a name="line-4479"></a><span class="hs-comment">-- &#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12434;&#36817;&#38563;&#37096;&#38272;&#12395;&#27604;&#20363;&#25353;&#20998;&#12377;&#12427;.</span><span>
</span><a name="line-4480"></a><span>
</span><a name="line-4481"></a><span class="hs-identifier">f&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#25391;&#26367;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-4482"></a><a name="f%7BA1%7406%88DC%52A9%7684%696D%52D9%632F%66FF"><a href="VTable.Compliation.html#f%7BA1%7406%88DC%52A9%7684%696D%52D9%632F%66FF"><span class="hs-identifier">f&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#25391;&#26367;</span></a></a><span> </span><a name="local-6989586621679477481"><a href="#local-6989586621679477481"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%8FD1%96A3%90E8%9580%632F%66FF"><span class="hs-identifier hs-var">f&#36817;&#38563;&#37096;&#38272;&#25391;&#26367;</span></a><span> </span><a href="#local-6989586621679477481"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="VTable.Data.Classification.html#ss%7BA1%7406%88DC%52A9%7684%696D%52D9"><span class="hs-identifier hs-var">ss&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679477481"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-4483"></a><span>
</span><a name="line-4484"></a><span>
</span><a name="line-4485"></a><span class="hs-comment">-- | &#26684;&#20184;&#12369;&#19981;&#33021;&#12398;&#25391;&#26367;</span><span>
</span><a name="line-4486"></a><span class="hs-identifier">f&#26684;&#20184;&#12369;&#19981;&#33021;&#25391;&#26367;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-4487"></a><a name="f%683C%4ED8%3051%4E0D%80FD%632F%66FF"><a href="VTable.Compliation.html#f%683C%4ED8%3051%4E0D%80FD%632F%66FF"><span class="hs-identifier">f&#26684;&#20184;&#12369;&#19981;&#33021;&#25391;&#26367;</span></a></a><span> </span><a name="local-6989586621679477482"><a href="#local-6989586621679477482"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VTable.Compliation.html#f%8FD1%96A3%90E8%9580%632F%66FF"><span class="hs-identifier hs-var">f&#36817;&#38563;&#37096;&#38272;&#25391;&#26367;</span></a><span> </span><a href="#local-6989586621679477482"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="VTable.Data.Classification.html#ss%683C%4ED8%3051%4E0D%80FD"><span class="hs-identifier hs-var">ss&#26684;&#20184;&#12369;&#19981;&#33021;</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679477482"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-4488"></a><span>
</span><a name="line-4489"></a><span>
</span><a name="line-4490"></a><span>
</span><a name="line-4491"></a><span>
</span><a name="line-4492"></a><span class="hs-keyword">type</span><span> </span><a name="VArray"><a href="VTable.Compliation.html#VArray"><span class="hs-identifier">VArray</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-4493"></a><span>
</span><a name="line-4494"></a><span>
</span><a name="line-4495"></a><span class="hs-comment">-- | V&#34920;&#20998;&#39006; 0 - 124</span><span>
</span><a name="line-4496"></a><span class="hs-keyword">type</span><span> </span><a name="VInt"><a href="VTable.Compliation.html#VInt"><span class="hs-identifier">VInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-4497"></a><span>
</span><a name="line-4498"></a><span class="hs-comment">-- | V&#34920;&#20998;&#39006;&#12363;&#12425;VInt&#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-4499"></a><span class="hs-identifier">v2Int</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Data.Classification.html#IndustryV"><span class="hs-identifier hs-type">IndustryV</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Compliation.html#VInt"><span class="hs-identifier hs-type">VInt</span></a><span>
</span><a name="line-4500"></a><a name="v2Int"><a href="VTable.Compliation.html#v2Int"><span class="hs-identifier">v2Int</span></a></a><span> </span><a name="local-6989586621679477483"><a href="#local-6989586621679477483"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679477483"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="VTable.Data.Classification.html#ciV%8868%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9%6B63%9806"><span class="hs-identifier hs-var">VDC.ciV&#34920;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#27491;&#38918;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4501"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477484"><a href="#local-6989586621679477484"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679477484"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-4502"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;error : v2Int : Can not find&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">ushow</span><span> </span><a href="#local-6989586621679477483"><span class="hs-identifier hs-var">tx</span></a><span>
</span><a name="line-4503"></a><span>
</span><a name="line-4504"></a><span class="hs-comment">-- | VInt &#12363;&#12425;V&#34920;&#20998;&#39006;&#12408;&#12398;&#22793;&#25563;</span><span>
</span><a name="line-4505"></a><span class="hs-identifier">int2v</span><span> </span><span class="hs-glyph">::</span><span>  </span><a href="VTable.Compliation.html#VInt"><span class="hs-identifier hs-type">VInt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="VTable.Data.Classification.html#IndustryV"><span class="hs-identifier hs-type">IndustryV</span></a><span>
</span><a name="line-4506"></a><a name="int2v"><a href="VTable.Compliation.html#int2v"><span class="hs-identifier">int2v</span></a></a><span> </span><a name="local-6989586621679477485"><a href="#local-6989586621679477485"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679477485"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#icV%8868%5206%985E%30A4%30F3%30C7%30C3%30AF%30B9%6B63%9806"><span class="hs-identifier hs-var">VDC.icV&#34920;&#20998;&#39006;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#27491;&#38918;</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4507"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477486"><a href="#local-6989586621679477486"><span class="hs-identifier">deta</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679477486"><span class="hs-identifier hs-var">deta</span></a><span>
</span><a name="line-4508"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;error : int2V : Can not find &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679477485"><span class="hs-identifier hs-var">num</span></a><span>
</span><a name="line-4509"></a><span>
</span><a name="line-4510"></a><span class="hs-comment">{- | &#12475;&#12531;&#12469;&#12473;&#20998;&#39006;&#12363;&#12425;IO&#20998;&#39006;&#12408;&#12398;&#22793;&#25563;

    &#26684;&#20184;&#12369;&#19981;&#33021;&#12392;&#31649;&#29702;&#35036;&#21161;&#30340;&#26989;&#21209;&#12398;&#21015;,&#34892;&#12399;&#12371;&#12371;&#12391;&#28040;&#12360;&#12427;.

    V&#34920;&#20998;&#39006;&#12398;&#26041;&#12364;&#32048;&#12363;&#12356;&#38917;&#30446;,&#20998;&#39006;&#12398;&#21512;&#12431;&#12394;&#12356;&#38917;&#30446;&#12395;&#38306;&#12375;&#12390;&#12399;,(&#26283;&#23450;&#30340;&#12395;)&#31561;&#20998;

-}</span><span>
</span><a name="line-4517"></a><span>
</span><a name="line-4518"></a><span class="hs-identifier">fV&#34920;&#22793;&#25563;</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#SmallInt"><span class="hs-identifier hs-type">SmallInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#VInt"><span class="hs-identifier hs-type">VInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#VInt"><span class="hs-identifier hs-type">VInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-4519"></a><a name="fV%8868%5909%63DB"><a href="VTable.Compliation.html#fV%8868%5909%63DB"><span class="hs-identifier">fV&#34920;&#22793;&#25563;</span></a></a><span> </span><a name="local-6989586621679477487"><a href="#local-6989586621679477487"><span class="hs-identifier">sd</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">newArray</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOfV%8868%5206%985E"><span class="hs-identifier hs-var">VDC.numOfV&#34920;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="VTable.Data.Classification.html#numOfV%8868%5206%985E"><span class="hs-identifier hs-var">VDC.numOfV&#34920;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IOArray</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#VInt"><span class="hs-identifier hs-type">VInt</span></a><span class="hs-special">,</span><span> </span><a href="VTable.Compliation.html#VInt"><span class="hs-identifier hs-type">VInt</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679477488"><a href="#local-6989586621679477488"><span class="hs-identifier">initial</span></a></a><span>
</span><a name="line-4520"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477489"><a href="#local-6989586621679477489"><span class="hs-identifier">smallIntFst</span></a></a><span>
</span><a name="line-4521"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#int2Small"><span class="hs-identifier hs-var">int2Small</span></a><span> </span><a href="#local-6989586621679477489"><span class="hs-identifier hs-var">smallIntFst</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#cc%5C0F%5206%985EV%8868%5206%985E"><span class="hs-identifier hs-var">cc&#23567;&#20998;&#39006;V&#34920;&#20998;&#39006;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4522"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;fv&#34920;&#36820;&#36996;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">ushow</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#int2Small"><span class="hs-identifier hs-var">int2Small</span></a><span> </span><a href="#local-6989586621679477489"><span class="hs-identifier hs-var">smallIntFst</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4523"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477490"><a href="#local-6989586621679477490"><span class="hs-identifier">vintFsts</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477491"><a href="#local-6989586621679477491"><span class="hs-identifier">divNumFst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679477490"><span class="hs-identifier hs-var">vintFsts</span></a><span class="hs-special">)</span><span>                                             </span><span class="hs-comment">-- &#31561;&#20998;&#12377;&#12427;&#12383;&#12417;&#12398;&#20998;&#27597;1&#12388;&#12417;</span><span>
</span><a name="line-4524"></a><span>                                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">L.map</span><span> </span><a href="VTable.Compliation.html#v2Int"><span class="hs-identifier hs-var">v2Int</span></a><span> </span><a href="#local-6989586621679477490"><span class="hs-identifier hs-var">vintFsts</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477492"><a href="#local-6989586621679477492"><span class="hs-identifier">vintFst</span></a></a><span>
</span><a name="line-4525"></a><span>                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><a href="VTable.Data.Classification.html#numOf%5C0F%5206%985E"><span class="hs-identifier hs-var">VDC.numOf&#23567;&#20998;&#39006;</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477493"><a href="#local-6989586621679477493"><span class="hs-identifier">smallIntSnd</span></a></a><span>
</span><a name="line-4526"></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span> </span><a href="#local-6989586621679477487"><span class="hs-identifier hs-var">sd</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477489"><span class="hs-identifier hs-var">smallIntFst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477493"><span class="hs-identifier hs-var">smallIntSnd</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477494"><a href="#local-6989586621679477494"><span class="hs-identifier">toAdd</span></a></a><span>
</span><a name="line-4527"></a><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#int2Small"><span class="hs-identifier hs-var">int2Small</span></a><span> </span><a href="#local-6989586621679477493"><span class="hs-identifier hs-var">smallIntSnd</span></a><span class="hs-special">)</span><span> </span><a href="VTable.Data.Classification.html#cc%5C0F%5206%985EV%8868%5206%985E"><span class="hs-identifier hs-var">cc&#23567;&#20998;&#39006;V&#34920;&#20998;&#39006;</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-4528"></a><span>                                                    </span><span class="hs-identifier hs-var">Nothing</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;fv&#34920;&#22793;&#25563;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">ushow</span><span> </span><span class="hs-special">(</span><a href="VTable.Compliation.html#int2Small"><span class="hs-identifier hs-var">int2Small</span></a><span> </span><a href="#local-6989586621679477493"><span class="hs-identifier hs-var">smallIntSnd</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-4529"></a><span>                                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679477495"><a href="#local-6989586621679477495"><span class="hs-identifier">vintSnds</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679477496"><a href="#local-6989586621679477496"><span class="hs-identifier">divNumSnd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679477495"><span class="hs-identifier hs-var">vintSnds</span></a><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- &#31561;&#20998;&#12377;&#12427;&#12383;&#12417;&#12398;&#20998;&#27597;2&#12388;&#12417;</span><span>
</span><a name="line-4530"></a><span>                                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">forM_</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="VTable.Compliation.html#v2Int"><span class="hs-identifier hs-var">v2Int</span></a><span> </span><a href="#local-6989586621679477495"><span class="hs-identifier hs-var">vintSnds</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679477497"><a href="#local-6989586621679477497"><span class="hs-identifier">vintSnd</span></a></a><span>
</span><a name="line-4531"></a><span>                                                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">readArray</span><span>  </span><a href="#local-6989586621679477488"><span class="hs-identifier hs-var">initial</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477492"><span class="hs-identifier hs-var">vintFst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477497"><span class="hs-identifier hs-var">vintSnd</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679477498"><a href="#local-6989586621679477498"><span class="hs-identifier">currentDob</span></a></a><span>
</span><a name="line-4532"></a><span>                                                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">writeArray</span><span> </span><a href="#local-6989586621679477488"><span class="hs-identifier hs-var">initial</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477492"><span class="hs-identifier hs-var">vintFst</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679477497"><span class="hs-identifier hs-var">vintSnd</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679477494"><span class="hs-identifier hs-var">toAdd</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679477491"><span class="hs-identifier hs-var">divNumFst</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679477496"><span class="hs-identifier hs-var">divNumSnd</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679477498"><span class="hs-identifier hs-var">currentDob</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4533"></a><span>            </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679477488"><span class="hs-identifier hs-var">initial</span></a><span>
</span><a name="line-4534"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-4535"></a><span class="hs-comment">------------------------------------------------------------------</span><span>
</span><a name="line-4536"></a><span>
</span><a name="line-4537"></a><span>
</span><a name="line-4538"></a><span>
</span><a name="line-4539"></a><span>
</span><a name="line-4540"></a><span>
</span><a name="line-4541"></a><span>
</span><a name="line-4542"></a><span>
</span><a name="line-4543"></a><span>
</span><a name="line-4544"></a></pre></body></html>